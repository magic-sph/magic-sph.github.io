<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Chebyshev polynomials and cosine transforms &mdash; Magic 5.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Magic 5.2 documentation" href="../contents.html" />
    <link rel="up" title="Description of the Fortran modules" href="../api.html" />
    <link rel="next" title="Radial derivatives and integration" href="derInt.html" />
    <link rel="prev" title="Non-linear part of the time stepping (radial loop)" href="timeAdvNonLinear.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="derInt.html" title="Radial derivatives and integration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chebyshev-polynomials-and-cosine-transforms">
<span id="secfortranlibs"></span><h1>Chebyshev polynomials and cosine transforms<a class="headerlink" href="#chebyshev-polynomials-and-cosine-transforms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/chebyshev_polynoms_mod">
<span id="chebyshev-polynoms-f90"></span><h2><code class="docutils literal"><span class="pre">chebyshev_polynoms.f90</span></code><a class="headerlink" href="#f/chebyshev_polynoms_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/chebyshev_polynoms_mod/get_chebs" title="f/chebyshev_polynoms_mod/get_chebs"><code class="xref f f-var docutils literal"><span class="pre">get_chebs</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/chebyshev_polynoms_mod/cheb_grid" title="f/chebyshev_polynoms_mod/cheb_grid"><code class="xref f f-func docutils literal"><span class="pre">cheb_grid()</span></code></a>, <a class="reference internal" href="#f/chebyshev_polynoms_mod/get_chebs_direct" title="f/chebyshev_polynoms_mod/get_chebs_direct"><code class="xref f f-func docutils literal"><span class="pre">get_chebs_direct()</span></code></a>, <a class="reference internal" href="#f/chebyshev_polynoms_mod/get_chebs_recurr" title="f/chebyshev_polynoms_mod/get_chebs_recurr"><code class="xref f f-func docutils literal"><span class="pre">get_chebs_recurr()</span></code></a>, <a class="reference internal" href="#f/chebyshev_polynoms_mod/get_chebs_even" title="f/chebyshev_polynoms_mod/get_chebs_even"><code class="xref f f-func docutils literal"><span class="pre">get_chebs_even()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_newmap" title="f/logic/l_newmap"><code class="xref f f-func docutils literal"><span class="pre">l_newmap()</span></code></a>): Module containing the logicals that control the run</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/chebyshev_polynoms_mod/get_chebs">
<code class="descclassname">chebyshev_polynoms_mod/</code><code class="descname">get_chebs</code><em> [</em><em>public</em><em>]</em><a class="headerlink" href="#f/chebyshev_polynoms_mod/get_chebs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/chebyshev_polynoms_mod/get_chebs_recurr">
<em class="property">subroutine  </em><code class="descclassname">chebyshev_polynoms_mod/</code><code class="descname">get_chebs_recurr</code><span class="sig-paren">(</span><em>n_r</em>, <em>a</em>, <em>b</em>, <em>y</em>, <em>n_r_max</em>, <em>cheb</em>, <em>dcheb</em>, <em>d2cheb</em>, <em>d3cheb</em>, <em>dim1</em>, <em>dim2</em>, <em>map_fac1</em>, <em>map_fac2</em>, <em>map_fac3</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebyshev_polynoms_mod/get_chebs_recurr" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Construct Chebychev polynomials and their first, second,
and third derivative up to degree n_r at n_r points x
in the interval [a,b]. Since the Chebs are only defined
in [-1,1] we have to use a map, mapping the points x
points y in the interval [-1,1]. This map is executed
by the subroutine cheb_grid and has to be done
before calling this program.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of grid points</li>
<li><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: interval boundaries [a,b]</li>
<li><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>y</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: n_r grid points in interval [a,b]</li>
<li><strong>n_r_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of</li>
<li><strong>cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: cheb(i,j) is Chebychev pol.</li>
<li><strong>dcheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: first derivative of cheb</li>
<li><strong>d2cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: second derivative o cheb</li>
<li><strong>d3cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: third derivative of cheb</li>
<li><strong>dim1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimensions of cheb,dcheb,....</li>
<li><strong>dim2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map_fac1</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map_fac2</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map_fac3</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/chebyshev_polynoms_mod/get_chebs_even">
<em class="property">subroutine  </em><code class="descclassname">chebyshev_polynoms_mod/</code><code class="descname">get_chebs_even</code><span class="sig-paren">(</span><em>n_r</em>, <em>a</em>, <em>b</em>, <em>y</em>, <em>n_r_max</em>, <em>cheb</em>, <em>dcheb</em>, <em>d2cheb</em>, <em>dim1</em>, <em>dim2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebyshev_polynoms_mod/get_chebs_even" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of grid points</li>
<li><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: interval boundaries [a,b]</li>
<li><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>y</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: n_r grid points in interval [a,b]</li>
<li><strong>n_r_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: max number of radial points, dims of y</li>
<li><strong>cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: cheb(i,j) is Chebychev pol.</li>
<li><strong>dcheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: first derivative of cheb</li>
<li><strong>d2cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: second derivative o cheb</li>
<li><strong>dim1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimensions of cheb,dcheb,......</li>
<li><strong>dim2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="precalcModules.html#f/radial_functions/radial" title="f/radial_functions/radial"><code class="xref f f-func docutils literal"><span class="pre">radial()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/chebyshev_polynoms_mod/get_chebs_direct">
<em class="property">subroutine  </em><code class="descclassname">chebyshev_polynoms_mod/</code><code class="descname">get_chebs_direct</code><span class="sig-paren">(</span><em>n_r</em>, <em>a</em>, <em>b</em>, <em>y</em>, <em>n_r_max</em>, <em>cheb</em>, <em>dcheb</em>, <em>d2cheb</em>, <em>d3cheb</em>, <em>dim1</em>, <em>dim2</em>, <em>map_fac1</em>, <em>map_fac2</em>, <em>map_fac3</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebyshev_polynoms_mod/get_chebs_direct" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Construct Chebychev polynomials and their first, second,
and third derivative up to degree n_r at n_r points x
in the interval [a,b]. Since the Chebs are only defined
in [-1,1] we have to use a map, mapping the points x
points y in the interval [-1,1]. This map is executed
by the subroutine cheb_grid and has to be done
before calling this program.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of grid points</li>
<li><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: interval boundaries [a,b]</li>
<li><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>y</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: n_r grid points in interval [a,b]</li>
<li><strong>n_r_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of</li>
<li><strong>cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: cheb(i,j) is Chebychev pol.</li>
<li><strong>dcheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: first derivative of cheb</li>
<li><strong>d2cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: second derivative o cheb</li>
<li><strong>d3cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: third derivative of cheb</li>
<li><strong>dim1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimensions of cheb,dcheb,....</li>
<li><strong>dim2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map_fac1</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map_fac2</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map_fac3</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/chebyshev_polynoms_mod/cheb_grid">
<em class="property">subroutine  </em><code class="descclassname">chebyshev_polynoms_mod/</code><code class="descname">cheb_grid</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>n</em>, <em>x</em>, <em>y</em>, <em>a1</em>, <em>a2</em>, <em>x0</em>, <em>lbd</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebyshev_polynoms_mod/cheb_grid" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Given the interval [a,b] the routine returns the
n+1 points that should be used to support a
Chebychev expansion. These are the n+1 extrema y(i) of
the Chebychev polynomial of degree n in the
interval [-1,1].
The respective points mapped into the interval of
question [a,b] are the x(i).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">x(i) and y(i) are stored in the reversed order:
x(1)=b, x(n+1)=a, y(1)=1, y(n+1)=-1</p>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: interval boundaries</li>
<li><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree of Cheb polynomial to be represented by the grid points</li>
<li><strong>x</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: grid points in interval [a,b]</li>
<li><strong>y</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: grid points in interval [-1,1]</li>
<li><strong>a1</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>a2</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>x0</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lbd</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOAdd.html#f/chebint_mod/chebintinit" title="f/chebint_mod/chebintinit"><code class="xref f f-func docutils literal"><span class="pre">chebintinit()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/init_rnb" title="f/rms/init_rnb"><code class="xref f f-func docutils literal"><span class="pre">init_rnb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/radial" title="f/radial_functions/radial"><code class="xref f f-func docutils literal"><span class="pre">radial()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/cosine_transform_odd">
<span id="cosine-transform-odd-f90"></span><h2><code class="docutils literal"><span class="pre">cosine_transform_odd.f90</span></code><a class="headerlink" href="#f/cosine_transform_odd" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/cosine_transform_odd/costf1_complex_1d" title="f/cosine_transform_odd/costf1_complex_1d"><code class="xref f f-func docutils literal"><span class="pre">costf1_complex_1d()</span></code></a>, <a class="reference internal" href="#f/cosine_transform_odd/costf1_real_1d" title="f/cosine_transform_odd/costf1_real_1d"><code class="xref f f-func docutils literal"><span class="pre">costf1_real_1d()</span></code></a>, <a class="reference internal" href="#f/cosine_transform_odd/costf1_complex" title="f/cosine_transform_odd/costf1_complex"><code class="xref f f-func docutils literal"><span class="pre">costf1_complex()</span></code></a>, <a class="reference internal" href="#f/cosine_transform_odd/costf1_real" title="f/cosine_transform_odd/costf1_real"><code class="xref f f-func docutils literal"><span class="pre">costf1_real()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="#f/fft_fac_mod" title="f/fft_fac_mod"><code class="xref f f-mod docutils literal"><span class="pre">fft_fac_mod</span></code></a> (<a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_complex()</span></code></a>, <a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_real()</span></code></a>)</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal"><span class="pre">factorise()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal"><span class="pre">cos72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_real" title="f/truncation/lm_max_real"><code class="xref f f-func docutils literal"><span class="pre">lm_max_real()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/cosine_transform_odd/unknown_type">
<em class="property">type  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/cosine_transform_odd/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">i_costf_init</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">d_costf_init</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/cosine_transform_odd/initialize">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">initialize</code><span class="sig-paren">(</span><em>this</em>, <em>n</em>, <em>ni</em>, <em>nd</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/initialize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate and store several
values that will be needed for a fast cosine transform of the
first kind. The actual transform is performed by the
subroutine costf1.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ni</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nd</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal"><span class="pre">factorise()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/finalize">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">finalize</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/finalize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_complex">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">costf1_complex</code><span class="sig-paren">(</span><em>this</em>, <em>f</em>, <em>n_f_max</em>, <em>n_f_start</em>, <em>n_f_stop</em>, <em>f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_complex" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to perform a multiple
cosine transforms for n+1 datapoints
on the columns numbered n_f_start to n_f_stop in the array
f(n_f_max,n+1)
Depending whether the input f contains data or coeff arrays
coeffs or data are returned in f.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>f</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: data/coeff input</li>
<li><strong>n_f_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: number of columns in f,f2</li>
<li><strong>n_f_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: columns to be transformed</li>
<li><strong>n_f_stop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>f2</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: work array of the same size as f</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_complex()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_complex_1d">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">costf1_complex_1d</code><span class="sig-paren">(</span><em>this</em>, <em>f</em>, <em>f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_complex_1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>f</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: data/coeff input</li>
<li><strong>f2</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: work array of the same size as f</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_complex()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_real">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">costf1_real</code><span class="sig-paren">(</span><em>this</em>, <em>f</em>, <em>n_f_max</em>, <em>n_f_start</em>, <em>n_f_stop</em>, <em>f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_real" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>f</strong> (n_f_max,*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: data/coeff input</li>
<li><strong>n_f_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: number of columns in f,f2</li>
<li><strong>n_f_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: columns to be transformed</li>
<li><strong>n_f_stop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>f2</strong> (n_f_max,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: work array of the same size as f</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_real_1d">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_odd/</code><code class="descname">costf1_real_1d</code><span class="sig-paren">(</span><em>this</em>, <em>f</em>, <em>f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_real_1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>f</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: data/coeff input</li>
<li><strong>f2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: work array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/cosine_transform_even">
<span id="cosine-transform-even-f90"></span><h2><code class="docutils literal"><span class="pre">cosine_transform_even.f90</span></code><a class="headerlink" href="#f/cosine_transform_even" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/cosine_transform_even/costf2" title="f/cosine_transform_even/costf2"><code class="xref f f-func docutils literal"><span class="pre">costf2()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="#f/fft_fac_mod" title="f/fft_fac_mod"><code class="xref f f-mod docutils literal"><span class="pre">fft_fac_mod</span></code></a> (<a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_complex()</span></code></a>)</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal"><span class="pre">factorise()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal"><span class="pre">cos72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/cosine_transform_even/unknown_type">
<em class="property">type  </em><code class="descclassname">cosine_transform_even/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/cosine_transform_even/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">i_costf_init</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">d_costf_init</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/cosine_transform_even/initialize">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_even/</code><code class="descname">initialize</code><span class="sig-paren">(</span><em>this</em>, <em>n</em>, <em>ni</em>, <em>nd</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_even/initialize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate several things
needed for the cheb transform.
Prepares costf2 for even number of grid points.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ni</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nd</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal"><span class="pre">factorise()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_even/finalize">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_even/</code><code class="descname">finalize</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_even/finalize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_even/costf2">
<em class="property">subroutine  </em><code class="descclassname">cosine_transform_even/</code><code class="descname">costf2</code><span class="sig-paren">(</span><em>this</em>, <em>f</em>, <em>n_f_max</em>, <em>n_f_start</em>, <em>n_f_stop</em>, <em>f2</em>, <em>isign</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_even/costf2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to perform a multiple
cosine transforms for n+1 datapoints
on the columns numbered n_f_start to n_f_stop in the array
y(n_f_max,n+1)
Depending whether the input y contains data or coeff arrays
coeffs or data are returned in y.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>f</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: data/coeff input</li>
<li><strong>n_f_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: number of columns in y,y2</li>
<li><strong>n_f_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: columns to be transformed</li>
<li><strong>n_f_stop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>f2</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: work array of the same size as y</li>
<li><strong>isign</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: = +1 (-1) for forward (backward) transform</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_complex()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/fft_fac_mod">
<span id="fft-fac-f90"></span><h2><code class="docutils literal"><span class="pre">fft_fac.f90</span></code><a class="headerlink" href="#f/fft_fac_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_complex()</span></code></a>, <a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal"><span class="pre">fft_fac_real()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal"><span class="pre">cos72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/fft_fac_mod/fft_fac_real">
<em class="property">subroutine  </em><code class="descclassname">fft_fac_mod/</code><code class="descname">fft_fac_real</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>trigs</em>, <em>nv</em>, <em>l1</em>, <em>l2</em>, <em>n</em>, <em>ifac</em>, <em>la</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft_fac_mod/fft_fac_real" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>main part of Fourier / Chebychev transform
called in costf1, costf2</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>trigs</strong> (2 * n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nv</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>ifac</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/cosine_transform_odd/costf1_real_1d" title="f/cosine_transform_odd/costf1_real_1d"><code class="xref f f-func docutils literal"><span class="pre">costf1_real_1d()</span></code></a>, <a class="reference internal" href="#f/cosine_transform_odd/costf1_real" title="f/cosine_transform_odd/costf1_real"><code class="xref f f-func docutils literal"><span class="pre">costf1_real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft_fac_mod/fft_fac_complex">
<em class="property">subroutine  </em><code class="descclassname">fft_fac_mod/</code><code class="descname">fft_fac_complex</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>trigs</em>, <em>nv</em>, <em>l1</em>, <em>l2</em>, <em>n</em>, <em>ifac</em>, <em>la</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft_fac_mod/fft_fac_complex" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>main part of Fourier / Chebychev transform
called in costf1, costf2</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>trigs</strong> (2 * n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nv</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>ifac</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/cosine_transform_odd/costf1_complex_1d" title="f/cosine_transform_odd/costf1_complex_1d"><code class="xref f f-func docutils literal"><span class="pre">costf1_complex_1d()</span></code></a>, <a class="reference internal" href="#f/cosine_transform_even/costf2" title="f/cosine_transform_even/costf2"><code class="xref f f-func docutils literal"><span class="pre">costf2()</span></code></a>, <a class="reference internal" href="#f/cosine_transform_odd/costf1_complex" title="f/cosine_transform_odd/costf1_complex"><code class="xref f f-func docutils literal"><span class="pre">costf1_complex()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="legendre-transforms">
<h1>Legendre transforms<a class="headerlink" href="#legendre-transforms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/plms_theta">
<span id="plms-f90"></span><h2><code class="docutils literal"><span class="pre">plms.f90</span></code><a class="headerlink" href="#f/plms_theta" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>, <a class="reference internal" href="#f/plms_theta/plm_thetaas" title="f/plms_theta/plm_thetaas"><code class="xref f f-func docutils literal"><span class="pre">plm_thetaas()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/osq4pi" title="f/constants/osq4pi"><code class="xref f f-func docutils literal"><span class="pre">osq4pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/plms_theta/plm_theta">
<em class="property">subroutine  </em><code class="descclassname">plms_theta/</code><code class="descname">plm_theta</code><span class="sig-paren">(</span><em>theta</em>, <em>max_degree</em>, <em>max_order</em>, <em>m0</em>, <em>plma</em>, <em>dtheta_plma</em>, <em>ndim_plma</em>, <em>norm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/plms_theta/plm_theta" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: angle in degrees</li>
<li><strong>max_degree</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: required max degree of plm</li>
<li><strong>max_order</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: required max order of plm</li>
<li><strong>m0</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: basic wave number</li>
<li><strong>plma</strong> (ndim_plma)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: ass. legendres at theta</li>
<li><strong>dtheta_plma</strong> (ndim_plma)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: their theta derivative</li>
<li><strong>ndim_plma</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimension of plma and dtheta_plma</li>
<li><strong>norm</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: =0 fully normalised</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOAdd.html#f/outpv3/outpv" title="f/outpv3/outpv"><code class="xref f f-func docutils literal"><span class="pre">outpv()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/egeos_mod/getegeos" title="f/egeos_mod/getegeos"><code class="xref f f-func docutils literal"><span class="pre">getegeos()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/omega/lnpas2tr" title="f/omega/lnpas2tr"><code class="xref f f-func docutils literal"><span class="pre">lnpas2tr()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/horizontal" title="f/horizontal_data/horizontal"><code class="xref f f-func docutils literal"><span class="pre">horizontal()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/plms_theta/plm_thetaas">
<em class="property">subroutine  </em><code class="descclassname">plms_theta/</code><code class="descname">plm_thetaas</code><span class="sig-paren">(</span><em>theta</em>, <em>max_degree</em>, <em>plma</em>, <em>dtheta_plma</em>, <em>ndim_plma</em>, <em>norm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/plms_theta/plm_thetaas" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>The produces the plm for all degrees and order=0 for a given theta
plus dtheta_plma=sin(theta)* (d plm)/(d theta)</p>
<dl class="docutils">
<dt>Norm determins the normalisation: n=0 &#8211; surface normalised,</dt>
<dd>n=1 &#8211; Schmidt normalised,
n=2 &#8211; fully normalised.</dd>
</dl>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: angle in degrees</li>
<li><strong>max_degree</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: required max degree of plm</li>
<li><strong>plma</strong> (ndim_plma)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: ass. legendres at theta</li>
<li><strong>dtheta_plma</strong> (ndim_plma)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: their theta derivative</li>
<li><strong>ndim_plma</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimension of plma and dtheta_plma</li>
<li><strong>norm</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: =0 fully normalised</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="precalcModules.html#f/horizontal_data/horizontal" title="f/horizontal_data/horizontal"><code class="xref f f-func docutils literal"><span class="pre">horizontal()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/leg_helper_mod">
<span id="legendre-helpers-f90"></span><h2><code class="docutils literal"><span class="pre">legendre_helpers.f90</span></code><a class="headerlink" href="#f/leg_helper_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/leg_helper_mod/initialize" title="f/leg_helper_mod/initialize"><code class="xref f f-func docutils literal"><span class="pre">initialize()</span></code></a>, <a class="reference internal" href="#f/leg_helper_mod/legprepg" title="f/leg_helper_mod/legprepg"><code class="xref f f-func docutils literal"><span class="pre">legprepg()</span></code></a>, <a class="reference internal" href="#f/leg_helper_mod/legprep" title="f/leg_helper_mod/legprep"><code class="xref f f-func docutils literal"><span class="pre">legprep()</span></code></a>, <a class="reference internal" href="#f/leg_helper_mod/legprep_ic" title="f/leg_helper_mod/legprep_ic"><code class="xref f f-func docutils literal"><span class="pre">legprep_ic()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="IOAdd.html#f/torsional_oscillations/ddzasl" title="f/torsional_oscillations/ddzasl"><code class="xref f f-func docutils literal"><span class="pre">ddzasl()</span></code></a>): This module contains information for TO calculation and output</li>
<li><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/z_rloc" title="f/fields/z_rloc"><code class="xref f f-func docutils literal"><span class="pre">z_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/s_rloc" title="f/fields/s_rloc"><code class="xref f f-func docutils literal"><span class="pre">s_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddw_rloc" title="f/fields/ddw_rloc"><code class="xref f f-func docutils literal"><span class="pre">ddw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dj_rloc" title="f/fields/dj_rloc"><code class="xref f f-func docutils literal"><span class="pre">dj_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_rloc" title="f/fields/b_rloc"><code class="xref f f-func docutils literal"><span class="pre">b_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddb_rloc" title="f/fields/ddb_rloc"><code class="xref f f-func docutils literal"><span class="pre">ddb_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/db_rloc" title="f/fields/db_rloc"><code class="xref f f-func docutils literal"><span class="pre">db_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dw_rloc" title="f/fields/dw_rloc"><code class="xref f f-func docutils literal"><span class="pre">dw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/p_rloc" title="f/fields/p_rloc"><code class="xref f f-func docutils literal"><span class="pre">p_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/aj_rloc" title="f/fields/aj_rloc"><code class="xref f f-func docutils literal"><span class="pre">aj_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dp_rloc" title="f/fields/dp_rloc"><code class="xref f f-func docutils literal"><span class="pre">dp_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dz_rloc" title="f/fields/dz_rloc"><code class="xref f f-func docutils literal"><span class="pre">dz_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ds_rloc" title="f/fields/ds_rloc"><code class="xref f f-func docutils literal"><span class="pre">ds_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/omega_ma" title="f/fields/omega_ma"><code class="xref f f-func docutils literal"><span class="pre">omega_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/omega_ic" title="f/fields/omega_ic"><code class="xref f f-func docutils literal"><span class="pre">omega_ic()</span></code></a>): This module contains the potential fields and their radial derivatives</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data"><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_fluxprofs" title="f/logic/l_fluxprofs"><code class="xref f f-func docutils literal"><span class="pre">l_fluxprofs()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal"><span class="pre">l_conv()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="baseModules.html#f/grenoble" title="f/grenoble: This module contains all variables for the case of an imposed IC dipole"><code class="xref f f-mod docutils literal"><span class="pre">grenoble</span></code></a> (<a class="reference internal" href="baseModules.html#f/grenoble/lgrenoble" title="f/grenoble/lgrenoble"><code class="xref f f-func docutils literal"><span class="pre">lgrenoble()</span></code></a>, <a class="reference internal" href="baseModules.html#f/grenoble/ddb0" title="f/grenoble/ddb0"><code class="xref f f-func docutils literal"><span class="pre">ddb0()</span></code></a>, <a class="reference internal" href="baseModules.html#f/grenoble/b0" title="f/grenoble/b0"><code class="xref f f-func docutils literal"><span class="pre">b0()</span></code></a>, <a class="reference internal" href="baseModules.html#f/grenoble/db0" title="f/grenoble/db0"><code class="xref f f-func docutils literal"><span class="pre">db0()</span></code></a>): This module contains all variables for the case of an imposed IC dipole</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/leg_helper_mod/unknown_type">
<em class="property">type  </em><code class="descclassname">leg_helper_mod/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/leg_helper_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">bcmb</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">omegaic</code><em> [</em><em>real</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dlhz</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">bhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dlhw</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">bhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">omegama</code><em> [</em><em>real</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dlhj</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dlhb</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">zas</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dzas</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">ddzas</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dpr</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dlhdw</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">sr</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dsr</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dvhdrg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dvhdrc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">cbhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">cbhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">prer</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/leg_helper_mod/initialize">
<em class="property">subroutine  </em><code class="descclassname">leg_helper_mod/</code><code class="descname">initialize</code><span class="sig-paren">(</span><em>this</em>, <em>lm_max</em>, <em>lm_maxmag</em>, <em>l_max</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/initialize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>lm_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lm_maxmag</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/legprepg">
<em class="property">subroutine  </em><code class="descclassname">leg_helper_mod/</code><code class="descname">legprepg</code><span class="sig-paren">(</span><em>this</em>, <em>nr</em>, <em>nbc</em>, <em>lderiv</em>, <em>lrmscalc</em>, <em>l_frame</em>, <em>ltonext</em>, <em>ltonext2</em>, <em>ltocalc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/legprepg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to prepare Legendre transforms
from (r,l,m) space to (r,theta,m) space by calculating
auxiliary arrays dpdw,dpddw, ....... dLhj which contain
combinations of harmonic coeffs multiplied with (l,m)-dependend
factors as well as the radial dependence:</p>
<blockquote>
<div><ul class="simple">
<li>nBc  =0 standard inner radial grid point</li>
<li>nBc  =1 radial velocity zero, spatial derivs not needed</li>
<li>nBc  =2 all velocity comp. zero, spatial derivs not needed</li>
</ul>
</div></blockquote>
<p>lDeriv=.true. field derivatives required</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: radial level</li>
<li><strong>nbc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: boundary condition</li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: get also field derivatives !</li>
<li><strong>lrmscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Rms force balance ?</li>
<li><strong>l_frame</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Calculate movie frame?</li>
<li><strong>ltonext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: for TO output</li>
<li><strong>ltonext2</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltocalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/legprep">
<em class="property">subroutine  </em><code class="descclassname">leg_helper_mod/</code><code class="descname">legprep</code><span class="sig-paren">(</span><em>w</em>, <em>dw</em>, <em>ddw</em>, <em>z</em>, <em>dz</em>, <em>dlh</em>, <em>lm_max</em>, <em>l_max</em>, <em>minc</em>, <em>r</em>, <em>lderiv</em>, <em>lhor</em>, <em>dlhw</em>, <em>vhg</em>, <em>vhc</em>, <em>dlhz</em>, <em>cvhg</em>, <em>cvhc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/legprep" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to prepare Legendre transforms
from (r,l,m) space to (r,theta,m) space by calculating
auxiliary arrays w, dw, ddw, ....... which contain
combinations of harmonic coeffs multiplied with (l,m)-dependend
factors as well as possible the radial dependencies.</p>
<p>lDeriv=.true. field derivatives required  for curl of field</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dlh</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lm_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>minc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lhor</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dlhw</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vhg</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vhc</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dlhz</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvhg</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvhc</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal"><span class="pre">fields_average()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/legprep_ic">
<em class="property">subroutine  </em><code class="descclassname">leg_helper_mod/</code><code class="descname">legprep_ic</code><span class="sig-paren">(</span><em>w</em>, <em>dw</em>, <em>ddw</em>, <em>z</em>, <em>dz</em>, <em>dlh</em>, <em>lm_max</em>, <em>l_max</em>, <em>minc</em>, <em>r</em>, <em>r_icb</em>, <em>lderiv</em>, <em>lhor</em>, <em>lcondic</em>, <em>dlhw</em>, <em>vhg</em>, <em>vhc</em>, <em>dlhz</em>, <em>cvhg</em>, <em>cvhc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/legprep_ic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to prepare Legendre transforms
from (r,l,m) space to (r,theta,m) space by calculating
auxiliary arrays dLhw,vhG, ......... which contain
combinations of harmonic coeffs multiplied with (l,m)-dependend
factors as well as possible the radial dependencies.</p>
<p>lDeriv=.true. field derivatives required  for curl of field</p>
<p>Note: This routine is used for the inner core magnetic field
which has a special radial function ansatz. It can also be
used to prepare the calculation of a field in an insulating
inner core for lCondIC=.false.. For this the w has to be the
outer core poloidal field and nR is the grid point for the ICB.
In any case legTF can be used for the following Legendre
transform and fftJW for the Fourier transform.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dlh</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lm_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>minc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r_icb</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lhor</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lcondic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dlhw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dlhz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOBinaryOutputs.html#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal"><span class="pre">store_movie_frame_ic()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal"><span class="pre">graphout_ic()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/legendre_spec_to_grid">
<span id="legendre-spec-to-grid-f90"></span><h2><code class="docutils literal"><span class="pre">legendre_spec_to_grid.f90</span></code><a class="headerlink" href="#f/legendre_spec_to_grid" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/legendre_spec_to_grid/lmas2pt" title="f/legendre_spec_to_grid/lmas2pt"><code class="xref f f-func docutils literal"><span class="pre">lmas2pt()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/legtf" title="f/legendre_spec_to_grid/legtf"><code class="xref f f-func docutils literal"><span class="pre">legtf()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/legtfg" title="f/legendre_spec_to_grid/legtfg"><code class="xref f f-func docutils literal"><span class="pre">legtfg()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/legtfgnomag" title="f/legendre_spec_to_grid/legtfgnomag"><code class="xref f f-func docutils literal"><span class="pre">legtfgnomag()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dplm" title="f/horizontal_data/dplm"><code class="xref f f-func docutils literal"><span class="pre">dplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/d_mc2m" title="f/horizontal_data/d_mc2m"><code class="xref f f-func docutils literal"><span class="pre">d_mc2m()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstop" title="f/horizontal_data/lstop"><code class="xref f f-func docutils literal"><span class="pre">lstop()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lmodd" title="f/horizontal_data/lmodd"><code class="xref f f-func docutils literal"><span class="pre">lmodd()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn2" title="f/horizontal_data/osn2"><code class="xref f f-func docutils literal"><span class="pre">osn2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/plm" title="f/horizontal_data/plm"><code class="xref f f-func docutils literal"><span class="pre">plm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstart" title="f/horizontal_data/lstart"><code class="xref f f-func docutils literal"><span class="pre">lstart()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_ht" title="f/logic/l_ht"><code class="xref f f-func docutils literal"><span class="pre">l_ht()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="#f/leg_helper_mod" title="f/leg_helper_mod"><code class="xref f f-mod docutils literal"><span class="pre">leg_helper_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">leg_helper_t()</span></code>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2mc" title="f/blocking/lm2mc"><code class="xref f f-func docutils literal"><span class="pre">lm2mc()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal"><span class="pre">n_m_max()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/legtfg">
<em class="property">subroutine  </em><code class="descclassname">legendre_spec_to_grid/</code><code class="descname">legtfg</code><span class="sig-paren">(</span><em>nbc</em>, <em>lderiv</em>, <em>lviscbccalc</em>, <em>lfluxprofcalc</em>, <em>nthetastart</em>, <em>vrc</em>, <em>vtc</em>, <em>vpc</em>, <em>dvrdrc</em>, <em>dvtdrc</em>, <em>dvpdrc</em>, <em>cvrc</em>, <em>dvrdtc</em>, <em>dvrdpc</em>, <em>dvtdpc</em>, <em>dvpdpc</em>, <em>brc</em>, <em>btc</em>, <em>bpc</em>, <em>cbrc</em>, <em>cbtc</em>, <em>cbpc</em>, <em>sc</em>, <em>drsc</em>, <em>dsdtc</em>, <em>dsdpc</em>, <em>pc</em>, <em>leg_helper</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/legtfg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform from (nR,l,m) to (nR,nTheta,m) [spectral to grid]
where nTheta numbers the colatitudes and l is the degree of
the spherical harmonic representation.</p>
<p>Transforms entropy, velocity and magnetic field components
and terms involving spatial derivatives.
The symmetry properties of the P_lm with respect to the equator
are used. The equatorially anti-symmetric (EA) contribution is
added to (subracted from ) the equatorially symmetric (ES) contribution
in northern (southern) hemisphere.</p>
<blockquote>
<div><ul>
<li><p class="first">nBc            : (input) accounts for special conditions on radial boundaries</p>
<blockquote>
<div><dl class="docutils">
<dt>-nBc=2 <span class="classifier-delimiter">:</span> <span class="classifier">we are dealing with a no slip boundary, v_r and v_theta are</span></dt>
<dd><p class="first last">zero and v_phi=r sin(theta) omega, where omega is the rotation rate of the
boundary (mantle of IC), only magn. field terms are calculated, v is
set later.</p>
</dd>
<dt>-nBc=1 <span class="classifier-delimiter">:</span> <span class="classifier">a free slip bounday: v_r is zero, derivatives of v and B</span></dt>
<dd><p class="first last">are not needed, only components of v,B and entropy
are calculated</p>
</dd>
</dl>
<p>-nBc=0       : normal case, interior grid point</p>
</div></blockquote>
</li>
<li><p class="first">lDeriv=.true.  : (input) calculate derivatives</p>
</li>
<li><p class="first">nThetaStart    : (input) transformation is done for the range of
points nThetaStart &lt;= nTheta &lt;= nThetaStart-1+sizeThetaB</p>
</li>
<li><p class="first">Plm            : associated Legendre polynomials</p>
</li>
<li><p class="first">dPlm           : sin(theta) d Plm / d theta</p>
</li>
<li><p class="first">osn2           : 1/sin(theta)^2</p>
</li>
<li><p class="first">vrc, ...., drSc: (output) components in (nTheta,m)-space</p>
</li>
<li><p class="first">dLhw,....,cbhC : (input) help arrays calculated in s_legPrep.f</p>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nbc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lviscbccalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lfluxprofcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvtdrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvpdrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvtdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvpdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>brc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cbrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cbtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cbpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>sc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>drsc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dsdtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dsdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>pc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>leg_helper</strong><em> [</em><em>leg_helper_t</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_grid_space()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/legtfgnomag">
<em class="property">subroutine  </em><code class="descclassname">legendre_spec_to_grid/</code><code class="descname">legtfgnomag</code><span class="sig-paren">(</span><em>nbc</em>, <em>lderiv</em>, <em>lviscbccalc</em>, <em>lfluxprofcalc</em>, <em>nthetastart</em>, <em>vrc</em>, <em>vtc</em>, <em>vpc</em>, <em>dvrdrc</em>, <em>dvtdrc</em>, <em>dvpdrc</em>, <em>cvrc</em>, <em>dvrdtc</em>, <em>dvrdpc</em>, <em>dvtdpc</em>, <em>dvpdpc</em>, <em>sc</em>, <em>drsc</em>, <em>dsdtc</em>, <em>dsdpc</em>, <em>pc</em>, <em>leg_helper</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/legtfgnomag" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Same as legTFG for non-magnetic cases</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nbc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lviscbccalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lfluxprofcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvtdrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvpdrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvtdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvpdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>sc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>drsc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dsdtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dsdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>pc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>leg_helper</strong><em> [</em><em>leg_helper_t</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_grid_space()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/legtf">
<em class="property">subroutine  </em><code class="descclassname">legendre_spec_to_grid/</code><code class="descname">legtf</code><span class="sig-paren">(</span><em>dlhw</em>, <em>vhg</em>, <em>vhc</em>, <em>dlhz</em>, <em>cvhg</em>, <em>cvhc</em>, <em>l_max</em>, <em>minc</em>, <em>nthetastart</em>, <em>sizethetab</em>, <em>plm</em>, <em>dplm</em>, <em>lhor</em>, <em>lderiv</em>, <em>vrc</em>, <em>vtc</em>, <em>vpc</em>, <em>cvrc</em>, <em>cvtc</em>, <em>cvpc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/legtf" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>&#8216;Legendre transform&#8217; from (nR,l,m) to (nR,nTheta,m) [spectral to grid]
where nTheta numbers the colatitudes and l and m are degree and
order of the spherical harmonic representation.</p>
<p>Calculates all three spherical components vrc,vtc,vpc of a field as
well as its curl (cvrc,cvtc,cvpc) that is given a spherical harmonis poloidal
toroidal decomposition. s_legPrep.f has to be called first and
provides the input fields dLhW, .....
The symmetry properties of the P_lm with respect to the equator
are used. The equatorially anti-symmetric (EA) contribution is
added to (subracted from ) the equatorially symmetric (ES) contribution
in northern (southern) hemisphere.</p>
<p>Output is given for all sizeThetaB colatitudes in a colatitude block
that starts with colatitude nThetaStart. At output, each component
in the northern hemisphere is followed by the component in the
southern hemisphere.
The Plms and dPlms=sin(theta) d Plm / d theta are only given
for the colatitudes in the northern hemisphere.</p>
<blockquote>
<div><ul class="simple">
<li>dLhw,....,cvhC : (input) arrays provided by s_legPrep.f</li>
<li>l_max          : (input) maximum spherical harmonic degree</li>
<li>minc           : (input) azimuthal symmetry</li>
<li>nThetaStart    : (input) transformation is done for the range of
points nThetaStart &lt;= nTheta &lt;= nThetaStart-1+sizeThetaB</li>
<li>sizeThetaB     : (input) size theta block</li>
<li>Plm            : (input) associated Legendre polynomials</li>
<li>dPlm           : (input) sin(theta) d Plm / d theta</li>
<li>lHor=.true.    : (input) calculate horizontal componenst</li>
<li>lDeriv=.true.  : (input) calculate curl of field</li>
<li>vrc, ....,cvpc : (output) components in (nTheta,m)-space</li>
</ul>
</div></blockquote>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dlhw</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vhg</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vhc</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dlhz</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvhg</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvhc</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>minc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sizethetab</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>plm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dplm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lhor</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal"><span class="pre">store_movie_frame_ic()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal"><span class="pre">graphout_ic()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/lmas2pt">
<em class="property">subroutine  </em><code class="descclassname">legendre_spec_to_grid/</code><code class="descname">lmas2pt</code><span class="sig-paren">(</span><em>alm</em>, <em>aij</em>, <em>nthetastart</em>, <em>nthetablocksize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/lmas2pt" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Spherical harmonic transform from alm(l) to aij(theta)
Done within the range [nThetaStart,n_thetaStart+nThetaBlockSize-1]
only considering axisymmetric contributions.
alm contains only m=0 coefficients</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alm</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space</li>
<li><strong>aij</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: field in (theta,phi)-space</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>nthetablocksize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOGeneral.html#f/outpar_mod/outperppar" title="f/outpar_mod/outperppar"><code class="xref f f-func docutils literal"><span class="pre">outperppar()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outmisc_mod/outmisc" title="f/outmisc_mod/outmisc"><code class="xref f f-func docutils literal"><span class="pre">outmisc()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/outpar" title="f/outpar_mod/outpar"><code class="xref f f-func docutils literal"><span class="pre">outpar()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/legendre_grid_to_spec">
<span id="legendre-grid-to-spec-f90"></span><h2><code class="docutils literal"><span class="pre">legendre_grid_to_spec.f90</span></code><a class="headerlink" href="#f/legendre_grid_to_spec" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtf1" title="f/legendre_grid_to_spec/legtf1"><code class="xref f f-func docutils literal"><span class="pre">legtf1()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal"><span class="pre">legtf2()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtf3" title="f/legendre_grid_to_spec/legtf3"><code class="xref f f-func docutils literal"><span class="pre">legtf3()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal"><span class="pre">legtfas()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/wplm" title="f/horizontal_data/wplm"><code class="xref f f-func docutils literal"><span class="pre">wplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lmoddp" title="f/horizontal_data/lmoddp"><code class="xref f f-func docutils literal"><span class="pre">lmoddp()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstopp" title="f/horizontal_data/lstopp"><code class="xref f f-func docutils literal"><span class="pre">lstopp()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstartp" title="f/horizontal_data/lstartp"><code class="xref f f-func docutils literal"><span class="pre">lstartp()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal"><span class="pre">lmp_max()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf1">
<em class="property">subroutine  </em><code class="descclassname">legendre_grid_to_spec/</code><code class="descname">legtf1</code><span class="sig-paren">(</span><em>nthetastart</em>, <em>f1lm</em>, <em>f1tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf1" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
f1TM (input) to f1LM (output)
One call to this routine does part of the transform
by summation over theta points in one theta block:
nThetaStart,..,nThetaStart+n_theta_block-1</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</li>
<li><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_lm_space()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initv" title="f/init_fields/initv"><code class="xref f f-func docutils literal"><span class="pre">initv()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal"><span class="pre">inits()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf2">
<em class="property">subroutine  </em><code class="descclassname">legendre_grid_to_spec/</code><code class="descname">legtf2</code><span class="sig-paren">(</span><em>nthetastart</em>, <em>f1lm</em>, <em>f2lm</em>, <em>f1tm</em>, <em>f2tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
f1TM,f2TM (input) to f1LM,f2LM (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
nThetaStart,..,nThetaStart+n_theta_block-1</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</li>
<li><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>f2lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>f2tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_lm_space()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal"><span class="pre">get_br_v_bcs()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf3">
<em class="property">subroutine  </em><code class="descclassname">legendre_grid_to_spec/</code><code class="descname">legtf3</code><span class="sig-paren">(</span><em>nthetastart</em>, <em>f1lm</em>, <em>f2lm</em>, <em>f3lm</em>, <em>f1tm</em>, <em>f2tm</em>, <em>f3tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf3" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
ancl1/2/3 (input) to flm1/2/3 (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
nThetaStart,..,nThetaStart+n_theta_block-1</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</li>
<li><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>f2lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>f3lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>f2tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>f3tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_lm_space()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dtblm()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtfas">
<em class="property">subroutine  </em><code class="descclassname">legendre_grid_to_spec/</code><code class="descname">legtfas</code><span class="sig-paren">(</span><em>flm1</em>, <em>ft1</em>, <em>lmmax</em>, <em>nthetastart</em>, <em>sizethetab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtfas" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
ancl1/2 (input) to flm1/2 (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
n_theta_min,..,n_theta_min+n_theta_block-1</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>flm1</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>ft1</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Number of modes to be processed</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</li>
<li><strong>sizethetab</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Size of theta block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_fluxes" title="f/nl_special_calc/get_fluxes"><code class="xref f f-func docutils literal"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_nlblayers" title="f/nl_special_calc/get_nlblayers"><code class="xref f f-func docutils literal"><span class="pre">get_nlblayers()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtfas2">
<em class="property">subroutine  </em><code class="descclassname">legendre_grid_to_spec/</code><code class="descname">legtfas2</code><span class="sig-paren">(</span><em>flm1</em>, <em>flm2</em>, <em>ft1</em>, <em>ft2</em>, <em>lmmax</em>, <em>nthetastart</em>, <em>sizethetab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtfas2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
ancl1/2 (input) to flm1/2 (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
n_theta_min,..,n_theta_min+n_theta_block-1</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>flm1</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>flm2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>ft1</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ft2</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Number of modes to be processed</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</li>
<li><strong>sizethetab</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Size of theta block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_fluxes" title="f/nl_special_calc/get_fluxes"><code class="xref f f-func docutils literal"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_helicity" title="f/nl_special_calc/get_helicity"><code class="xref f f-func docutils literal"><span class="pre">get_helicity()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_nlblayers" title="f/nl_special_calc/get_nlblayers"><code class="xref f f-func docutils literal"><span class="pre">get_nlblayers()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_perppar" title="f/nl_special_calc/get_perppar"><code class="xref f f-func docutils literal"><span class="pre">get_perppar()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="fourier-transforms">
<h1>Fourier transforms<a class="headerlink" href="#fourier-transforms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/fft">
<span id="fft-f90"></span><h2><code class="docutils literal"><span class="pre">fft.f90</span></code><a class="headerlink" href="#f/fft" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This file contains the subroutines called by fftJW:
fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/fft/nd" title="f/fft/nd"><code class="xref f f-var docutils literal"><span class="pre">nd</span></code></a>, <a class="reference internal" href="#f/fft/ni" title="f/fft/ni"><code class="xref f f-var docutils literal"><span class="pre">ni</span></code></a>, <a class="reference internal" href="#f/fft/i_fft_init" title="f/fft/i_fft_init"><code class="xref f f-var docutils literal"><span class="pre">i_fft_init</span></code></a>, <a class="reference internal" href="#f/fft/d_fft_init" title="f/fft/d_fft_init"><code class="xref f f-var docutils literal"><span class="pre">d_fft_init</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/fft/wpass3jw" title="f/fft/wpass3jw"><code class="xref f f-func docutils literal"><span class="pre">wpass3jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass4jw" title="f/fft/wpass4jw"><code class="xref f f-func docutils literal"><span class="pre">wpass4jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass5jw" title="f/fft/wpass5jw"><code class="xref f f-func docutils literal"><span class="pre">wpass5jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass2jw" title="f/fft/wpass2jw"><code class="xref f f-func docutils literal"><span class="pre">wpass2jw()</span></code></a>, <a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a>, <a class="reference internal" href="#f/fft/fft99ajw" title="f/fft/fft99ajw"><code class="xref f f-func docutils literal"><span class="pre">fft99ajw()</span></code></a>, <a class="reference internal" href="#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="#f/fft/fft_to_real" title="f/fft/fft_to_real"><code class="xref f f-func docutils literal"><span class="pre">fft_to_real()</span></code></a>, <a class="reference internal" href="#f/fft/init_fft" title="f/fft/init_fft"><code class="xref f f-func docutils literal"><span class="pre">init_fft()</span></code></a>, <a class="reference internal" href="#f/fft/fft99bjw" title="f/fft/fft99bjw"><code class="xref f f-func docutils literal"><span class="pre">fft99bjw()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal"><span class="pre">factorise()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a>: Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal"><span class="pre">cos72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a>: This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/fft/ni">
<code class="descclassname">fft/</code><code class="descname">ni</code><em> [</em><em>integer</em><em>,</em><em>private/parameter=100</em><em>]</em><a class="headerlink" href="#f/fft/ni" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fft/nd">
<code class="descclassname">fft/</code><code class="descname">nd</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/fft/nd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fft/d_fft_init">
<code class="descclassname">fft/</code><code class="descname">d_fft_init</code> (:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fft/d_fft_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fft/i_fft_init">
<code class="descclassname">fft/</code><code class="descname">i_fft_init</code> (100)<em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/fft/i_fft_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/fft/init_fft">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">init_fft</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/init_fft" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate and store several
values that will be needed for a fast fft transform.
The actual transform is performed by the subroutine fftJW.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Dimension of problem, number of grid points</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="precalcModules.html#f/horizontal_data/horizontal" title="f/horizontal_data/horizontal"><code class="xref f f-func docutils literal"><span class="pre">horizontal()</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal"><span class="pre">factorise()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft_to_real">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">fft_to_real</code><span class="sig-paren">(</span><em>f</em>, <em>ld_f</em>, <em>nrep</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft_to_real" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (ld_f,nrep)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>ld_f</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>nrep</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOAdd.html#f/egeos_mod/getdvptr" title="f/egeos_mod/getdvptr"><code class="xref f f-func docutils literal"><span class="pre">getdvptr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outpv3/getpvptr" title="f/outpv3/getpvptr"><code class="xref f f-func docutils literal"><span class="pre">getpvptr()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft_thetab">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">fft_thetab</code><span class="sig-paren">(</span><em>f</em>, <em>dir</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft_thetab" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>dir</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: back or forth transform</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_lm_space()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initv" title="f/init_fields/initv"><code class="xref f f-func docutils literal"><span class="pre">initv()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal"><span class="pre">inits()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/get_btor" title="f/out_dtb_frame/get_btor"><code class="xref f f-func docutils literal"><span class="pre">get_btor()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_grid_space()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/get_b_surface" title="f/out_movie/get_b_surface"><code class="xref f f-func docutils literal"><span class="pre">get_b_surface()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal"><span class="pre">store_movie_frame_ic()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/get_bpol" title="f/out_dtb_frame/get_bpol"><code class="xref f f-func docutils literal"><span class="pre">get_bpol()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/lm2pt" title="f/out_dtb_frame/lm2pt"><code class="xref f f-func docutils literal"><span class="pre">lm2pt()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal"><span class="pre">graphout_ic()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fftjw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">fftjw</code><span class="sig-paren">(</span><em>a</em>, <em>ld_a</em>, <em>n</em>, <em>isign</em>, <em>nsize</em>, <em>wrk</em>, <em>wd1</em>, <em>wd2</em>, <em>i_fft_init</em>, <em>d_fft_init</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fftjw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>The routines has been adopted by Gary Glatzmaier and has
subsequently been modified by Uli Christensen and Johannes Wicht</p>
<p>It performs a number of simultaneous real/half-complex
periodic fast fourier transforms or corresponding inverse
transforms, using ordinary spatial order of
gridpoint values.  given a set
of real data vectors, the package returns a set of
&#8220;half-complex&#8221; fourier coefficient vectors, or vice
versa.  the length of the transforms must be an even
number that has no other factors except possibly powers
of 2, 3, and 5.  this version of fft991 is
optimized for use on the cray-1.</p>
<dl class="docutils">
<dt>on input     a(ld_a,*)</dt>
<dd><blockquote class="first">
<div>an array of length (ld_a,nsize) containing the input data
or coefficient vectors.  This array is overwritten by
the results.</div></blockquote>
<dl class="last docutils">
<dt>n</dt>
<dd>the length of each transform (see definition of
transforms, below).</dd>
<dt>nsize</dt>
<dd>the number of transforms to be done simultaneously.</dd>
<dt>isign</dt>
<dd><dl class="first last docutils">
<dt>= +1 for a transform from fourier coefficients to</dt>
<dd>gridpoint values.</dd>
<dt>= -1 for a transform from gridpoint values to fourier</dt>
<dd>coefficients.</dd>
</dl>
</dd>
</dl>
</dd>
<dt>on output    a</dt>
<dd><p class="first">if isign = +1, and n_theta_max coefficient vectors are supplied
each containing the sequence</p>
<p>a(0),b(0),a(1),b(1),...,a(n/2),b(n/2)  (n+2 values)</p>
<p>then the result consists of n_theta_max data vectors each
containing the corresponding n+2 gridpoint values</p>
<dl class="docutils">
<dt>for fft991, x(0), x(1), x(2),...,x(n-1),0,0.</dt>
<dd>(n+2) real values with x(n)=x(n+1)=0</dd>
<dt>when isign = +1, the transform is defined by</dt>
<dd>x(j)=sum(k=0,...,n-1)(c(k)*exp(2*i*j*k*pi/n))
where c(k)=a(k)+i*b(k) and c(n-k)=a(k)-i*b(k)
and i=sqrt (-1)
for k=0,...,n/2    i.e., (n/2+1) complex values
with c(0) = c(n) = a(0) and c(n/2)=a(n/2)=0</dd>
</dl>
<p>if isign = -1, and n_theta_max data vectors are supplied each
containing a sequence of gridpoint values x(j) as
defined above, then the result consists of n_theta_max vectors
each containing the corresponding fourier cofficients
a(k), b(k), 0  &lt;=  k .le n/2.</p>
<dl class="docutils">
<dt>when isign = -1, the inverse transform is defined by</dt>
<dd>c(k)=(1/n)*sum(j=0,...,n-1)(x(j)*exp(-2*i*j*k*pi/n))
where c(k)=a(k)+i*b(k) and i=sqrt(-1)
for k=0,...,n/2</dd>
</dl>
<p>a call with isign=+1 followed by a call with isign=-1
(or vice versa) returns the original data.</p>
<p class="last">note the fact that the gridpoint values x(j) are real
implies that b(0)=b(n/2)=0.  for a call with isign=+1,
it is not actually necessary to supply these zeros.
note starting from grid with x(n)=x(n+1)=0
then transforming to spectral (sign=-1)
then c(n/2)=a(n/2) is not necessarily 0
unless there is no aliasing.</p>
</dd>
</dl>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (ld_a,*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: fields to be transformed</li>
<li><strong>ld_a</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of a</li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimension of problem</li>
<li><strong>isign</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: back/forth transtorm for isign=1/-1</li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of fields for</li>
<li><strong>wrk</strong> (wd1,wd2)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: work array</li>
<li><strong>wd1</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>wd2</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>i_fft_init</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: factorization information from init_fft</li>
<li><strong>d_fft_init</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: trigonometric functions from init_fft</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="#f/fft/fft_to_real" title="f/fft/fft_to_real"><code class="xref f f-func docutils literal"><span class="pre">fft_to_real()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fft99ajw" title="f/fft/fft99ajw"><code class="xref f f-func docutils literal"><span class="pre">fft99ajw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass2jw" title="f/fft/wpass2jw"><code class="xref f f-func docutils literal"><span class="pre">wpass2jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass3jw" title="f/fft/wpass3jw"><code class="xref f f-func docutils literal"><span class="pre">wpass3jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass4jw" title="f/fft/wpass4jw"><code class="xref f f-func docutils literal"><span class="pre">wpass4jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass5jw" title="f/fft/wpass5jw"><code class="xref f f-func docutils literal"><span class="pre">wpass5jw()</span></code></a>, <a class="reference internal" href="#f/fft/fft99bjw" title="f/fft/fft99bjw"><code class="xref f f-func docutils literal"><span class="pre">fft99bjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft99ajw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">fft99ajw</code><span class="sig-paren">(</span><em>a</em>, <em>work</em>, <em>trigs</em>, <em>nrp</em>, <em>nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft99ajw" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>work</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft99bjw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">fft99bjw</code><span class="sig-paren">(</span><em>work</em>, <em>a</em>, <em>trigsf</em>, <em>nrp</em>, <em>nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft99bjw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>postprocessing step (isign=-1)
(gridpoint to spectral transform)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>work</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>trigsf</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass2jw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">wpass2jw</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>trigs</em>, <em>nrp</em>, <em>nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass2jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>reduction for factor 2</p>
<p>if(la /= 1) stop &#8216;call to wpass2 with la  /=  1&#8217;</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass3jw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">wpass3jw</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>trigs</em>, <em>nrp</em>, <em>la</em>, <em>nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass3jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>called in fftJW</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass4jw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">wpass4jw</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>trigs</em>, <em>nrp</em>, <em>la</em>, <em>nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass4jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>called in fftJW
reduction for factor 4</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass5jw">
<em class="property">subroutine  </em><code class="descclassname">fft/</code><code class="descname">wpass5jw</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>trigs</em>, <em>nrp</em>, <em>la</em>, <em>nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass5jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>called in fftJW
reduction for factor 5</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal"><span class="pre">fftjw()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="linear-algebra">
<h1>Linear algebra<a class="headerlink" href="#linear-algebra" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/algebra">
<span id="algebra-f90"></span><h2><code class="docutils literal"><span class="pre">algebra.f90</span></code><a class="headerlink" href="#f/algebra" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/algebra/zero_tolerance" title="f/algebra/zero_tolerance"><code class="xref f f-var docutils literal"><span class="pre">zero_tolerance</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/algebra/sgesl" title="f/algebra/sgesl"><code class="xref f f-func docutils literal"><span class="pre">sgesl()</span></code></a>, <a class="reference internal" href="#f/algebra/cgeslml" title="f/algebra/cgeslml"><code class="xref f f-func docutils literal"><span class="pre">cgeslml()</span></code></a>, <a class="reference internal" href="#f/algebra/cgesl" title="f/algebra/cgesl"><code class="xref f f-func docutils literal"><span class="pre">cgesl()</span></code></a>, <a class="reference internal" href="#f/algebra/sgefa" title="f/algebra/sgefa"><code class="xref f f-func docutils literal"><span class="pre">sgefa()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><code class="xref f f-mod docutils literal"><span class="pre">omp_lib</span></code></li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/algebra/zero_tolerance">
<code class="descclassname">algebra/</code><code class="descname">zero_tolerance</code><em> [</em><em>real</em><em>,</em><em>private/parameter=1.0e-15_cp</em><em>]</em><a class="headerlink" href="#f/algebra/zero_tolerance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/algebra/cgesl">
<em class="property">subroutine  </em><code class="descclassname">algebra/</code><code class="descname">cgesl</code><span class="sig-paren">(</span><em>a</em>, <em>ia</em>, <em>n</em>, <em>ip</em>, <em>bc1</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/cgesl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This routine does the backward substitution into a lu-decomposed real
matrix a (to solve a * x = bc1) were bc1 is the right hand side
vector. On return x is stored in bc1.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (ia,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: real n X n matrix</li>
<li><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: first dim of a</li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimension of problem</li>
<li><strong>ip</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot pointer of legth n</li>
<li><strong>bc1</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: on input RHS of problem</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="initModules.html#f/init_fields/j_cond" title="f/init_fields/j_cond"><code class="xref f f-func docutils literal"><span class="pre">j_cond()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal"><span class="pre">updatez()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/cgeslml">
<em class="property">subroutine  </em><code class="descclassname">algebra/</code><code class="descname">cgeslml</code><span class="sig-paren">(</span><em>a</em>, <em>ia</em>, <em>n</em>, <em>ip</em>, <em>bc</em>, <em>ldbc</em>, <em>nrhss</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/cgeslml" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This routine does the backward substitution into a lu-decomposed real
matrix a (to solve a * x = bc ) simultaneously for nRHSs complex
vectors bc. On return the results are stored in the bc.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (ia,n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: real n X n matrix</li>
<li><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of a</li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: dimension of problem</li>
<li><strong>ip</strong> (n)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot pointer of length n</li>
<li><strong>bc</strong> (ldbc,nrhss)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: on input RHS of problem</li>
<li><strong>ldbc</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of bc</li>
<li><strong>nrhss</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: number of right-hand sides</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal"><span class="pre">updatewp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/updates_ala" title="f/updates_mod/updates_ala"><code class="xref f f-func docutils literal"><span class="pre">updates_ala()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/sgesl">
<em class="property">subroutine  </em><code class="descclassname">algebra/</code><code class="descname">sgesl</code><span class="sig-paren">(</span><em>a</em>, <em>ia</em>, <em>n</em>, <em>ip</em>, <em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/sgesl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>like the linpack routine
backward substitution of vector b into lu-decomposed matrix a
to solve  a * x = b for a single real vector b</p>
<p>sub sgefa must be called once first to initialize a and ip</p>
<p>a: (input)  nxn real matrix
n: (input)  size of a and b
ip: (input) pivot pointer array of length n
b: (in/output) rhs-vector on input, solution on output</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (ia,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: first dim of a</li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dim of problem</li>
<li><strong>ip</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot information</li>
<li><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal"><span class="pre">inits()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/s_cond" title="f/init_fields/s_cond"><code class="xref f f-func docutils literal"><span class="pre">s_cond()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/getbackground" title="f/radial_functions/getbackground"><code class="xref f f-func docutils literal"><span class="pre">getbackground()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/updates_ala" title="f/updates_mod/updates_ala"><code class="xref f f-func docutils literal"><span class="pre">updates_ala()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/sgefa">
<em class="property">subroutine  </em><code class="descclassname">algebra/</code><code class="descname">sgefa</code><span class="sig-paren">(</span><em>a</em>, <em>ia</em>, <em>n</em>, <em>ip</em>, <em>info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/sgefa" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>like the linpack routine</p>
<p>lu decomposes the real matrix a(n,n) via gaussian elimination</p>
<p>a: (in/output) real nxn matrix on input, lu-decomposed matrix on output
ia: (input) first dimension of a (must be &gt;= n)
n: (input) 2nd dimension and rank of a
ip: (output) pivot pointer array
info: (output) error message when  /=  0</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (ia,*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ip</strong> (*)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em> :: pivoting information</li>
<li><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="initModules.html#f/init_fields/j_cond" title="f/init_fields/j_cond"><code class="xref f f-func docutils literal"><span class="pre">j_cond()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/get_z10mat" title="f/updatez_mod/get_z10mat"><code class="xref f f-func docutils literal"><span class="pre">get_z10mat()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal"><span class="pre">inits()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/s_cond" title="f/init_fields/s_cond"><code class="xref f f-func docutils literal"><span class="pre">s_cond()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_bmat" title="f/updateb_mod/get_bmat"><code class="xref f f-func docutils literal"><span class="pre">get_bmat()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/getbackground" title="f/radial_functions/getbackground"><code class="xref f f-func docutils literal"><span class="pre">getbackground()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/get_s0mat" title="f/updates_mod/get_s0mat"><code class="xref f f-func docutils literal"><span class="pre">get_s0mat()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/get_smat" title="f/updates_mod/get_smat"><code class="xref f f-func docutils literal"><span class="pre">get_smat()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/get_zmat" title="f/updatez_mod/get_zmat"><code class="xref f f-func docutils literal"><span class="pre">get_zmat()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/get_wpmat" title="f/updatewp_mod/get_wpmat"><code class="xref f f-func docutils literal"><span class="pre">get_wpmat()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Chebyshev polynomials and cosine transforms</a><ul>
<li><a class="reference internal" href="#f/chebyshev_polynoms_mod"><code class="docutils literal"><span class="pre">chebyshev_polynoms.f90</span></code></a></li>
<li><a class="reference internal" href="#f/cosine_transform_odd"><code class="docutils literal"><span class="pre">cosine_transform_odd.f90</span></code></a></li>
<li><a class="reference internal" href="#f/cosine_transform_even"><code class="docutils literal"><span class="pre">cosine_transform_even.f90</span></code></a></li>
<li><a class="reference internal" href="#f/fft_fac_mod"><code class="docutils literal"><span class="pre">fft_fac.f90</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#legendre-transforms">Legendre transforms</a><ul>
<li><a class="reference internal" href="#f/plms_theta"><code class="docutils literal"><span class="pre">plms.f90</span></code></a></li>
<li><a class="reference internal" href="#f/leg_helper_mod"><code class="docutils literal"><span class="pre">legendre_helpers.f90</span></code></a></li>
<li><a class="reference internal" href="#f/legendre_spec_to_grid"><code class="docutils literal"><span class="pre">legendre_spec_to_grid.f90</span></code></a></li>
<li><a class="reference internal" href="#f/legendre_grid_to_spec"><code class="docutils literal"><span class="pre">legendre_grid_to_spec.f90</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fourier-transforms">Fourier transforms</a><ul>
<li><a class="reference internal" href="#f/fft"><code class="docutils literal"><span class="pre">fft.f90</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-algebra">Linear algebra</a><ul>
<li><a class="reference internal" href="#f/algebra"><code class="docutils literal"><span class="pre">algebra.f90</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="timeAdvNonLinear.html"
                        title="previous chapter">Non-linear part of the time stepping (radial loop)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="derInt.html"
                        title="next chapter">Radial derivatives and integration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/legFourierChebAlgebra.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="derInt.html" title="Radial derivatives and integration"
             >next</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>