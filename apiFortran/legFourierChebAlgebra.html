
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Chebyshev polynomials and cosine transforms &#8212; Magic 5.9 documentation</title>
    <link rel="stylesheet" href="../_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Radial derivatives and integration" href="derInt.html" />
    <link rel="prev" title="Non-linear part of the time stepping (radial loop)" href="timeAdvNonLinear.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="derInt.html" title="Radial derivatives and integration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chebyshev-polynomials-and-cosine-transforms">
<span id="secfortranlibs"></span><h1>Chebyshev polynomials and cosine transforms<a class="headerlink" href="#chebyshev-polynomials-and-cosine-transforms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/chebyshev_polynoms_mod">
<span id="chebyshev-polynoms-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">chebyshev_polynoms.f90</span></code><a class="headerlink" href="#f/chebyshev_polynoms_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/chebyshev_polynoms_mod/cheb_grid" title="f/chebyshev_polynoms_mod/cheb_grid"><code class="xref f f-func docutils literal notranslate"><span class="pre">cheb_grid()</span></code></a>, <a class="reference internal" href="#f/chebyshev_polynoms_mod/get_chebs_even" title="f/chebyshev_polynoms_mod/get_chebs_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_chebs_even()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_newmap" title="f/logic/l_newmap"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_newmap()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/map_function" title="f/num_param/map_function"><code class="xref f f-func docutils literal notranslate"><span class="pre">map_function()</span></code></a>): Module containing numerical and control parameters</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/chebyshev_polynoms_mod/get_chebs_even">
<em class="property">subroutine  </em><code class="sig-prename descclassname">chebyshev_polynoms_mod/</code><code class="sig-name descname">get_chebs_even</code><span class="sig-paren">(</span><em class="sig-param">n_r</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">y</em>, <em class="sig-param">n_r_max</em>, <em class="sig-param">cheb</em>, <em class="sig-param">dcheb</em>, <em class="sig-param">d2cheb</em>, <em class="sig-param">dim1</em>, <em class="sig-param">dim2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebyshev_polynoms_mod/get_chebs_even" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Construct even Chebychev polynomials and their first,
second and third derivative up to degree 2*(n_r/2) at
(n_r/2) points x in the interval [a,b].
Since the Chebs are only defined in [-1,1] we have to
map the points x in [a,b] onto points y in the
interval [-1,1]. This map is contructed by
the subroutine cheb_x_map_e.f which must be called
before entering this subroutine.
For even Chebs we need only half the point of the map,
these (n_r/2) points are in the interval [1,0[ .
NOTE the reversed order in the points: y(1)=-1, y(n_r)=1.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: n_r grid points in interval [a,b]</p></li>
<li><p><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: only even chebs stored !</p></li>
<li><p><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: interval boundaries [a,b]</p></li>
<li><p><strong>cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: cheb(i,j) is Chebychev pol.</p></li>
<li><p><strong>dcheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: first derivative of cheb</p></li>
<li><p><strong>d2cheb</strong> (dim1,dim2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: second derivative o cheb</p></li>
<li><p><strong>dim1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dim2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimensions of cheb,dcheb,……</p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>n_r_max</strong><em> [</em><em>integer</em><em>,</em><em>in,optional/default=len(y)</em><em>]</em> :: max number of radial points, dims of y</p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="precalcModules.html#f/radial_functions/radial" title="f/radial_functions/radial"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/chebyshev_polynoms_mod/cheb_grid">
<em class="property">subroutine  </em><code class="sig-prename descclassname">chebyshev_polynoms_mod/</code><code class="sig-name descname">cheb_grid</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">n</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">a1</em>, <em class="sig-param">a2</em>, <em class="sig-param">x0</em>, <em class="sig-param">lbd</em>, <em class="sig-param">l_map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebyshev_polynoms_mod/cheb_grid" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Given the interval [a,b] the routine returns the</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: <p>degree of Cheb polynomial to be represented by the grid points
Chebychev expansion. These are the n+1 extrema y(i) of
the Chebychev polynomial of degree n in the
interval [-1,1].
The respective points mapped into the interval of
question [a,b] are the x(i).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>x(i) and y(i) are stored in the reversed order:</p>
</div>
</p></li>
<li><p><strong>x</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: grid points in interval [a,b]</p></li>
<li><p><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: interval boundaries</p></li>
<li><p><strong>y</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: grid points in interval [-1,1]</p></li>
<li><p><strong>a1</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>a2</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>x0</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbd</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_map</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Chebyshev mapping</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/chebint_mod/chebintinit" title="f/chebint_mod/chebintinit"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebintinit()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_mapping()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/radial" title="f/radial_functions/radial"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/cosine_transform_odd">
<span id="cosine-transform-odd-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">cosine_transform_odd.f90</span></code><a class="headerlink" href="#f/cosine_transform_odd" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_real" title="f/truncation/lm_max_real"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max_real()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="#f/fft_fac_mod" title="f/fft_fac_mod"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fft_fac_mod</span></code></a> (<a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_complex()</span></code></a>, <a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_real()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos72()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal notranslate"><span class="pre">factorise()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/cosine_transform_odd/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/cosine_transform_odd/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">d_costf_init</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">i_costf_init</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/cosine_transform_odd/initialize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">n</em>, <em class="sig-param">ni</em>, <em class="sig-param">nd</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/initialize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate and store several
values that will be needed for a fast cosine transform of the
first kind. The actual transform is performed by the
subroutine costf1.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ni</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nd</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal notranslate"><span class="pre">factorise()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/finalize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">finalize</code><span class="sig-paren">(</span><em class="sig-param">this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/finalize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_complex">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">costf1_complex</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">f</em>, <em class="sig-param">n_f_max</em>, <em class="sig-param">n_f_start</em>, <em class="sig-param">n_f_stop</em>, <em class="sig-param">f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_complex" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to perform a multiple
cosine transforms for n+1 datapoints
on the columns numbered n_f_start to n_f_stop in the array
f(n_f_max,n+1)
Depending whether the input f contains data or coeff arrays
coeffs or data are returned in f.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>f</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>n_f_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_f_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_f_stop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f2</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_complex()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_complex_1d">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">costf1_complex_1d</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">f</em>, <em class="sig-param">f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_complex_1d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>f</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f2</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_real">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">costf1_real</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">f</em>, <em class="sig-param">n_f_max</em>, <em class="sig-param">n_f_start</em>, <em class="sig-param">n_f_stop</em>, <em class="sig-param">f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_real" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>f</strong> (n_f_max,*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>n_f_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_f_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_f_stop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f2</strong> (n_f_max,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_real()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_odd/costf1_real_1d">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_odd/</code><code class="sig-name descname">costf1_real_1d</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">f</em>, <em class="sig-param">f2</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_odd/costf1_real_1d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>f</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/cosine_transform_even">
<span id="cosine-transform-even-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">cosine_transform_even.f90</span></code><a class="headerlink" href="#f/cosine_transform_even" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/cosine_transform_even/costf2" title="f/cosine_transform_even/costf2"><code class="xref f f-func docutils literal notranslate"><span class="pre">costf2()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="#f/fft_fac_mod" title="f/fft_fac_mod"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fft_fac_mod</span></code></a> (<a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_complex()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos72()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal notranslate"><span class="pre">factorise()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/cosine_transform_even/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">cosine_transform_even/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/cosine_transform_even/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">d_costf_init</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">i_costf_init</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/cosine_transform_even/initialize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_even/</code><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">n</em>, <em class="sig-param">ni</em>, <em class="sig-param">nd</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_even/initialize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate several things
needed for the cheb transform.
Prepares costf2 for even number of grid points.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ni</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nd</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal notranslate"><span class="pre">factorise()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_even/finalize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_even/</code><code class="sig-name descname">finalize</code><span class="sig-paren">(</span><em class="sig-param">this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_even/finalize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/cosine_transform_even/costf2">
<em class="property">subroutine  </em><code class="sig-prename descclassname">cosine_transform_even/</code><code class="sig-name descname">costf2</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">f</em>, <em class="sig-param">n_f_max</em>, <em class="sig-param">n_f_start</em>, <em class="sig-param">n_f_stop</em>, <em class="sig-param">f2</em>, <em class="sig-param">isign</em><span class="sig-paren">)</span><a class="headerlink" href="#f/cosine_transform_even/costf2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to perform a multiple
cosine transforms for n+1 datapoints
on the columns numbered n_f_start to n_f_stop in the array
y(n_f_max,n+1)
Depending whether the input y contains data or coeff arrays
coeffs or data are returned in y.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>f</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Difference of odd terms</p></li>
<li><p><strong>n_f_max</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: number of columns in y,y2</p></li>
<li><p><strong>n_f_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_f_stop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: columns to be transformed</p></li>
<li><p><strong>f2</strong> (n_f_max,*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: work array of the same size as y</p></li>
<li><p><strong>isign</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: = +1 (-1) for forward (backward) transform</p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_complex()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/fft_fac_mod">
<span id="fft-fac-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">fft_fac.f90</span></code><a class="headerlink" href="#f/fft_fac_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fft_fac_mod/fft_fac_complex" title="f/fft_fac_mod/fft_fac_complex"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_complex()</span></code></a>, <a class="reference internal" href="#f/fft_fac_mod/fft_fac_real" title="f/fft_fac_mod/fft_fac_real"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_fac_real()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/fft_fac_mod/fft_fac_real">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft_fac_mod/</code><code class="sig-name descname">fft_fac_real</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nv</em>, <em class="sig-param">l1</em>, <em class="sig-param">l2</em>, <em class="sig-param">n</em>, <em class="sig-param">ifac</em>, <em class="sig-param">la</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft_fac_mod/fft_fac_real" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>main part of Fourier / Chebychev transform
called in costf1, costf2</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (2 * n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nv</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ifac</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,optional/default=(len(trigs))/(2)</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft_fac_mod/fft_fac_complex">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft_fac_mod/</code><code class="sig-name descname">fft_fac_complex</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nv</em>, <em class="sig-param">l1</em>, <em class="sig-param">l2</em>, <em class="sig-param">n</em>, <em class="sig-param">ifac</em>, <em class="sig-param">la</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft_fac_mod/fft_fac_complex" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>main part of Fourier / Chebychev transform
called in costf1, costf2</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>c</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (2 * n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nv</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ifac</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,optional/default=(len(trigs))/(2)</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/cosine_transform_even/costf2" title="f/cosine_transform_even/costf2"><code class="xref f f-func docutils literal notranslate"><span class="pre">costf2()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="legendre-transforms">
<h1>Legendre transforms<a class="headerlink" href="#legendre-transforms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/plms_theta">
<span id="plms-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">plms.f90</span></code><a class="headerlink" href="#f/plms_theta" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">plm_theta()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/osq4pi" title="f/constants/osq4pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">osq4pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/plms_theta/plm_theta">
<em class="property">subroutine  </em><code class="sig-prename descclassname">plms_theta/</code><code class="sig-name descname">plm_theta</code><span class="sig-paren">(</span><em class="sig-param">theta</em>, <em class="sig-param">max_degree</em>, <em class="sig-param">max_order</em>, <em class="sig-param">m0</em>, <em class="sig-param">plma</em>, <em class="sig-param">dtheta_plma</em>, <em class="sig-param">ndim_plma</em>, <em class="sig-param">norm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/plms_theta/plm_theta" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This produces the <span class="math notranslate nohighlight">\(P_{\ell}^m\)</span> for all degrees <span class="math notranslate nohighlight">\(\ell\)</span> and
orders <span class="math notranslate nohighlight">\(m\)</span> for a given colatitude. <span class="math notranslate nohighlight">\(\theta\)</span>, as well as
<span class="math notranslate nohighlight">\(\sin \theta d P_{\ell}^m /d\theta\)</span>.  The order is as follows:</p>
<blockquote>
<div><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plma</strong> (ndim_plma)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: associated Legendre polynomials at theta</p></li>
<li><p><strong>plma</strong> :: associated Legendre polynomials at theta</p></li>
<li><p><strong>plma</strong> :: associated Legendre polynomials at theta
…</p></li>
<li><p><strong>plma</strong> :: associated Legendre polynomials at theta</p></li>
<li><p><strong>plma</strong> :: associated Legendre polynomials at theta</p></li>
<li><p><strong>plma</strong> :: <dl class="simple">
<dt>associated Legendre polynomials at theta</dt><dd></dd>
<dt>Several normalisation are supported:</dt><dd><ul>
<li><p>n=0 – surface normalised,</p></li>
<li><p>n=1 – Schmidt normalised,</p></li>
<li><p>n=2 – fully normalised.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>theta</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: angle in degrees</p></li>
<li><p><strong>max_degree</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: required max degree of plm</p></li>
<li><p><strong>max_order</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: required max order of plm</p></li>
<li><p><strong>m0</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: basic wave number</p></li>
<li><p><strong>dtheta_plma</strong> (ndim_plma)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: their theta derivative</p></li>
<li><p><strong>ndim_plma</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimension of plma and dtheta_plma</p></li>
<li><p><strong>norm</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: =0 fully normalised</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="precalcModules.html#f/horizontal_data/horizontal" title="f/horizontal_data/horizontal"><code class="xref f f-func docutils literal notranslate"><span class="pre">horizontal()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/magnetic_energy/initialize_magnetic_energy" title="f/magnetic_energy/initialize_magnetic_energy"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_magnetic_energy()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos_mod/getegeos" title="f/geos_mod/getegeos"><code class="xref f f-func docutils literal notranslate"><span class="pre">getegeos()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos_mod/outpv" title="f/geos_mod/outpv"><code class="xref f f-func docutils literal notranslate"><span class="pre">outpv()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/omega/lnpas2tr" title="f/omega/lnpas2tr"><code class="xref f f-func docutils literal notranslate"><span class="pre">lnpas2tr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/leg_helper_mod">
<span id="legendre-helpers-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">legendre_helpers.f90</span></code><a class="headerlink" href="#f/leg_helper_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/leg_helper_mod/legprep" title="f/leg_helper_mod/legprep"><code class="xref f f-func docutils literal notranslate"><span class="pre">legprep()</span></code></a>, <a class="reference internal" href="#f/leg_helper_mod/legprep_ic" title="f/leg_helper_mod/legprep_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">legprep_ic()</span></code></a>, <a class="reference internal" href="#f/leg_helper_mod/legprepg" title="f/leg_helper_mod/legprepg"><code class="xref f f-func docutils literal notranslate"><span class="pre">legprepg()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_axi()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal notranslate"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="IOAdd.html#f/torsional_oscillations/ddzasl" title="f/torsional_oscillations/ddzasl"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddzasl()</span></code></a>): This module contains information for TO calculation and output</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/special" title="f/special: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes"><code class="xref f f-mod docutils literal notranslate"><span class="pre">special</span></code></a> (<a class="reference internal" href="baseModules.html#f/special/lgrenoble" title="f/special/lgrenoble"><code class="xref f f-func docutils literal notranslate"><span class="pre">lgrenoble()</span></code></a>, <a class="reference internal" href="baseModules.html#f/special/b0" title="f/special/b0"><code class="xref f f-func docutils literal notranslate"><span class="pre">b0()</span></code></a>, <a class="reference internal" href="baseModules.html#f/special/db0" title="f/special/db0"><code class="xref f f-func docutils literal notranslate"><span class="pre">db0()</span></code></a>, <a class="reference internal" href="baseModules.html#f/special/ddb0" title="f/special/ddb0"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddb0()</span></code></a>): This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlh()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_adv_curl" title="f/logic/l_adv_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_adv_curl()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/z_rloc" title="f/fields/z_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">z_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dz_rloc" title="f/fields/dz_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dz_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_rloc" title="f/fields/b_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">b_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/db_rloc" title="f/fields/db_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">db_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddb_rloc" title="f/fields/ddb_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddb_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/aj_rloc" title="f/fields/aj_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">aj_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dj_rloc" title="f/fields/dj_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dj_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dw_rloc" title="f/fields/dw_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddw_rloc" title="f/fields/ddw_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/omega_ic" title="f/fields/omega_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/omega_ma" title="f/fields/omega_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ma()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/leg_helper_mod/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">leg_helper_mod/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/leg_helper_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">bcmb</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">bhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">bhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">cbhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">cbhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">cvhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">cvhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">ddzas</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dlhb</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dlhdw</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dlhj</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dlhw</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dlhz</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dvhdrc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dvhdrg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dzas</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">omegaic</code><em> [</em><em>real</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">omegama</code><em> [</em><em>real</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">vhc</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">vhg</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">zas</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/leg_helper_mod/initialize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">leg_helper_mod/</code><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">lm_max</em>, <em class="sig-param">lm_maxmag</em>, <em class="sig-param">l_max</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/initialize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lm_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm_maxmag</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/finalize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">leg_helper_mod/</code><code class="sig-name descname">finalize</code><span class="sig-paren">(</span><em class="sig-param">this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/finalize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/legprepg">
<em class="property">subroutine  </em><code class="sig-prename descclassname">leg_helper_mod/</code><code class="sig-name descname">legprepg</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">nr</em>, <em class="sig-param">nbc</em>, <em class="sig-param">lderiv</em>, <em class="sig-param">lrmscalc</em>, <em class="sig-param">l_frame</em>, <em class="sig-param">ltonext</em>, <em class="sig-param">ltonext2</em>, <em class="sig-param">ltocalc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/legprepg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to prepare Legendre transforms
from (r,l,m) space to (r,theta,m) space by calculating
auxiliary arrays dpdw,dpddw, ……. dLhj which contain
combinations of harmonic coeffs multiplied with (l,m)-dependend
factors as well as the radial dependence:</p>
<blockquote>
<div><ul class="simple">
<li><p>nBc  =0 standard inner radial grid point</p></li>
<li><p>nBc  =1 radial velocity zero, spatial derivs not needed</p></li>
<li><p>nBc  =2 all velocity comp. zero, spatial derivs not needed</p></li>
</ul>
</div></blockquote>
<p>lDeriv=.true. field derivatives required</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: radial level</p></li>
<li><p><strong>nbc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: boundary condition</p></li>
<li><p><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: get also field derivatives !</p></li>
<li><p><strong>lrmscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Rms force balance ?</p></li>
<li><p><strong>l_frame</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Calculate movie frame?</p></li>
<li><p><strong>ltonext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: for TO output</p></li>
<li><p><strong>ltonext2</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ltocalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/legprep">
<em class="property">subroutine  </em><code class="sig-prename descclassname">leg_helper_mod/</code><code class="sig-name descname">legprep</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">z</em>, <em class="sig-param">dz</em>, <em class="sig-param">dlh</em>, <em class="sig-param">lm_max</em>, <em class="sig-param">l_max</em>, <em class="sig-param">minc</em>, <em class="sig-param">r</em>, <em class="sig-param">lderiv</em>, <em class="sig-param">lhor</em>, <em class="sig-param">dlhw</em>, <em class="sig-param">vhg</em>, <em class="sig-param">vhc</em>, <em class="sig-param">dlhz</em>, <em class="sig-param">cvhg</em>, <em class="sig-param">cvhc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/legprep" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to prepare Legendre transforms
from (r,l,m) space to (r,theta,m) space by calculating
auxiliary arrays w, dw, ddw, ……. which contain
combinations of harmonic coeffs multiplied with (l,m)-dependend
factors as well as possible the radial dependencies.</p>
<p>lDeriv=.true. field derivatives required  for curl of field</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dlh</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>minc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lhor</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dlhw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dlhz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>cvhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>cvhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>lm_max</strong><em> [</em><em>integer</em><em>,</em><em>in,optional/default=len(w)</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/leg_helper_mod/legprep_ic">
<em class="property">subroutine  </em><code class="sig-prename descclassname">leg_helper_mod/</code><code class="sig-name descname">legprep_ic</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">z</em>, <em class="sig-param">dz</em>, <em class="sig-param">dlh</em>, <em class="sig-param">lm_max</em>, <em class="sig-param">l_max</em>, <em class="sig-param">minc</em>, <em class="sig-param">r</em>, <em class="sig-param">r_icb</em>, <em class="sig-param">lderiv</em>, <em class="sig-param">lhor</em>, <em class="sig-param">lcondic</em>, <em class="sig-param">dlhw</em>, <em class="sig-param">vhg</em>, <em class="sig-param">vhc</em>, <em class="sig-param">dlhz</em>, <em class="sig-param">cvhg</em>, <em class="sig-param">cvhc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/leg_helper_mod/legprep_ic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to prepare Legendre transforms
from (r,l,m) space to (r,theta,m) space by calculating
auxiliary arrays dLhw,vhG, ……… which contain
combinations of harmonic coeffs multiplied with (l,m)-dependend
factors as well as possible the radial dependencies.</p>
<p>lDeriv=.true. field derivatives required  for curl of field</p>
<p>Note: This routine is used for the inner core magnetic field
which has a special radial function ansatz. It can also be
used to prepare the calculation of a field in an insulating
inner core for lCondIC=.false.. For this the w has to be the
outer core poloidal field and nR is the grid point for the ICB.
In any case legTF can be used for the following Legendre
transform and fftJW for the Fourier transform.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Only poloidal</p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dlh</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>minc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_icb</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: rDep2=rDep/r</p></li>
<li><p><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lhor</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lcondic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dlhw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dlhz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>cvhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>cvhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>lm_max</strong><em> [</em><em>integer</em><em>,</em><em>in,optional/default=len(w)</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/legendre_spec_to_grid">
<span id="legendre-spec-to-grid-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">legendre_spec_to_grid.f90</span></code><a class="headerlink" href="#f/legendre_spec_to_grid" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/legendre_spec_to_grid/leg_dphi_vec" title="f/legendre_spec_to_grid/leg_dphi_vec"><code class="xref f f-func docutils literal notranslate"><span class="pre">leg_dphi_vec()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/leg_pol_to_grad_spat" title="f/legendre_spec_to_grid/leg_pol_to_grad_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">leg_pol_to_grad_spat()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/leg_polsphtor_to_spat" title="f/legendre_spec_to_grid/leg_polsphtor_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">leg_polsphtor_to_spat()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/leg_scal_to_grad_spat" title="f/legendre_spec_to_grid/leg_scal_to_grad_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">leg_scal_to_grad_spat()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/leg_scal_to_spat" title="f/legendre_spec_to_grid/leg_scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">leg_scal_to_spat()</span></code></a>, <a class="reference internal" href="#f/legendre_spec_to_grid/lmas2pt" title="f/legendre_spec_to_grid/lmas2pt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmas2pt()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_axi()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal notranslate"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal notranslate"><span class="pre">sizethetab()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2mc" title="f/blocking/lm2mc"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2mc()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/plm" title="f/horizontal_data/plm"><code class="xref f f-func docutils literal notranslate"><span class="pre">plm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dplm" title="f/horizontal_data/dplm"><code class="xref f f-func docutils literal notranslate"><span class="pre">dplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstart" title="f/horizontal_data/lstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">lstart()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstop" title="f/horizontal_data/lstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lstop()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lmodd" title="f/horizontal_data/lmodd"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmodd()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/d_mc2m" title="f/horizontal_data/d_mc2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">d_mc2m()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn2" title="f/horizontal_data/osn2"><code class="xref f f-func docutils literal notranslate"><span class="pre">osn2()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="#f/leg_helper_mod" title="f/leg_helper_mod"><code class="xref f f-mod docutils literal notranslate"><span class="pre">leg_helper_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">leg_helper_t()</span></code>)</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/leg_polsphtor_to_spat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_spec_to_grid/</code><code class="sig-name descname">leg_polsphtor_to_spat</code><span class="sig-paren">(</span><em class="sig-param">l_calc</em>, <em class="sig-param">nthetastart</em>, <em class="sig-param">qlm</em>, <em class="sig-param">bhg</em>, <em class="sig-param">bhc</em>, <em class="sig-param">brc</em>, <em class="sig-param">btc</em>, <em class="sig-param">bpc</em><span class="optional">[</span>, <em class="sig-param">n_thetas</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/leg_polsphtor_to_spat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Take Q,S,T and transform them to vectors</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_calc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>qlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Poloidal</p></li>
<li><p><strong>bhg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bhc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>brc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>btc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>n_thetas</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/leg_pol_to_grad_spat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_spec_to_grid/</code><code class="sig-name descname">leg_pol_to_grad_spat</code><span class="sig-paren">(</span><em class="sig-param">l_calc</em>, <em class="sig-param">nthetastart</em>, <em class="sig-param">qlm</em>, <em class="sig-param">dvrdtc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/leg_pol_to_grad_spat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Poloidal to d/dth</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_calc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>qlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/leg_dphi_vec">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_spec_to_grid/</code><code class="sig-name descname">leg_dphi_vec</code><span class="sig-paren">(</span><em class="sig-param">l_calc</em>, <em class="sig-param">nthetastart</em>, <em class="sig-param">vrc</em>, <em class="sig-param">vtc</em>, <em class="sig-param">vpc</em>, <em class="sig-param">dvrdpc</em>, <em class="sig-param">dvtdpc</em>, <em class="sig-param">dvpdpc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/leg_dphi_vec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Take the phi derivative of an input vector</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_calc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vrc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvtdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvpdpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/leg_scal_to_spat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_spec_to_grid/</code><code class="sig-name descname">leg_scal_to_spat</code><span class="sig-paren">(</span><em class="sig-param">nthetastart</em>, <em class="sig-param">slm</em>, <em class="sig-param">sc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/leg_scal_to_spat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform from (l) to (theta) for a scalar input field</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>slm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/leg_scal_to_grad_spat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_spec_to_grid/</code><code class="sig-name descname">leg_scal_to_grad_spat</code><span class="sig-paren">(</span><em class="sig-param">nthetastart</em>, <em class="sig-param">slm</em>, <em class="sig-param">gradtc</em>, <em class="sig-param">gradpc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/leg_scal_to_grad_spat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Transform s(l) into dsdt(theta) and dsdp(theta)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>slm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>gradtc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>gradpc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_spec_to_grid/lmas2pt">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_spec_to_grid/</code><code class="sig-name descname">lmas2pt</code><span class="sig-paren">(</span><em class="sig-param">alm</em>, <em class="sig-param">aij</em>, <em class="sig-param">nthetastart</em>, <em class="sig-param">nthetablocksize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_spec_to_grid/lmas2pt" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Spherical harmonic transform from alm(l) to aij(theta)
Done within the range [nThetaStart,n_thetaStart+nThetaBlockSize-1]
only considering axisymmetric contributions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alm</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space</p></li>
<li><p><strong>aij</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: field in (theta,phi)-space</p></li>
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: last theta</p></li>
<li><p><strong>nthetablocksize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/outmisc_mod/outhelicity" title="f/outmisc_mod/outhelicity"><code class="xref f f-func docutils literal notranslate"><span class="pre">outhelicity()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/outpar" title="f/outpar_mod/outpar"><code class="xref f f-func docutils literal notranslate"><span class="pre">outpar()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/outperppar" title="f/outpar_mod/outperppar"><code class="xref f f-func docutils literal notranslate"><span class="pre">outperppar()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/power/get_power" title="f/power/get_power"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_power()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/legendre_grid_to_spec">
<span id="legendre-grid-to-spec-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">legendre_grid_to_spec.f90</span></code><a class="headerlink" href="#f/legendre_grid_to_spec" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/legendre_grid_to_spec/legtf1" title="f/legendre_grid_to_spec/legtf1"><code class="xref f f-func docutils literal notranslate"><span class="pre">legtf1()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal notranslate"><span class="pre">legtf2()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtf3" title="f/legendre_grid_to_spec/legtf3"><code class="xref f f-func docutils literal notranslate"><span class="pre">legtf3()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtf_spher_tor" title="f/legendre_grid_to_spec/legtf_spher_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">legtf_spher_tor()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal notranslate"><span class="pre">legtfas()</span></code></a>, <a class="reference internal" href="#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal notranslate"><span class="pre">legtfas2()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmp_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal notranslate"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal notranslate"><span class="pre">sizethetab()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/lstartp" title="f/horizontal_data/lstartp"><code class="xref f f-func docutils literal notranslate"><span class="pre">lstartp()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/wplm" title="f/horizontal_data/wplm"><code class="xref f f-func docutils literal notranslate"><span class="pre">wplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lmoddp" title="f/horizontal_data/lmoddp"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmoddp()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/lstopp" title="f/horizontal_data/lstopp"><code class="xref f f-func docutils literal notranslate"><span class="pre">lstopp()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/wdplm" title="f/horizontal_data/wdplm"><code class="xref f f-func docutils literal notranslate"><span class="pre">wdplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/d_mc2m" title="f/horizontal_data/d_mc2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">d_mc2m()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/ci" title="f/constants/ci"><code class="xref f f-func docutils literal notranslate"><span class="pre">ci()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf1">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_grid_to_spec/</code><code class="sig-name descname">legtf1</code><span class="sig-paren">(</span><em class="sig-param">nthetastart</em>, <em class="sig-param">f1lm</em>, <em class="sig-param">f1tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf1" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
f1TM (input) to f1LM (output)
One call to this routine does part of the transform
by summation over theta points in one theta block:
nThetaStart,..,nThetaStart+n_theta_block-1</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</p></li>
<li><p><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/init_fields/initv" title="f/init_fields/initv"><code class="xref f f-func docutils literal notranslate"><span class="pre">initv()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal notranslate"><span class="pre">inits()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initxi" title="f/init_fields/initxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initxi()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf2">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_grid_to_spec/</code><code class="sig-name descname">legtf2</code><span class="sig-paren">(</span><em class="sig-param">nthetastart</em>, <em class="sig-param">f1lm</em>, <em class="sig-param">f2lm</em>, <em class="sig-param">f1tm</em>, <em class="sig-param">f2tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
f1TM,f2TM (input) to f1LM,f2LM (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
nThetaStart,..,nThetaStart+n_theta_block-1</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</p></li>
<li><p><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f2lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f2tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf3">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_grid_to_spec/</code><code class="sig-name descname">legtf3</code><span class="sig-paren">(</span><em class="sig-param">nthetastart</em>, <em class="sig-param">f1lm</em>, <em class="sig-param">f2lm</em>, <em class="sig-param">f3lm</em>, <em class="sig-param">f1tm</em>, <em class="sig-param">f2tm</em>, <em class="sig-param">f3tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf3" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
ancl1/2/3 (input) to flm1/2/3 (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
nThetaStart,..,nThetaStart+n_theta_block-1</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</p></li>
<li><p><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f2lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f3lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f2tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f3tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtf_spher_tor">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_grid_to_spec/</code><code class="sig-name descname">legtf_spher_tor</code><span class="sig-paren">(</span><em class="sig-param">nthetastart</em>, <em class="sig-param">f1lm</em>, <em class="sig-param">f2lm</em>, <em class="sig-param">f1tm</em>, <em class="sig-param">f2tm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtf_spher_tor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Vector Legendre transform
vt(n_r,n_theta,m), vp(n_r,n_theta,m) to Spheroidal(n_r,l,m)
and Toroidal(n_r,l,m)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</p></li>
<li><p><strong>f1lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f2lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>f1tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f2tm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_space()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtfas">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_grid_to_spec/</code><code class="sig-name descname">legtfas</code><span class="sig-paren">(</span><em class="sig-param">flm1</em>, <em class="sig-param">ft1</em>, <em class="sig-param">lmmax</em>, <em class="sig-param">nthetastart</em>, <em class="sig-param">sizethetab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtfas" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
ancl1/2 (input) to flm1/2 (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
n_theta_min,..,n_theta_min+n_theta_block-1</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flm1</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ft1</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: ASymm</p></li>
<li><p><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Number of modes to be processed</p></li>
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</p></li>
<li><p><strong>sizethetab</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: thetas in NHS</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_nlblayers" title="f/nl_special_calc/get_nlblayers"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_nlblayers()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_fluxes" title="f/nl_special_calc/get_fluxes"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_visc_heat" title="f/nl_special_calc/get_visc_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_visc_heat()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/legendre_grid_to_spec/legtfas2">
<em class="property">subroutine  </em><code class="sig-prename descclassname">legendre_grid_to_spec/</code><code class="sig-name descname">legtfas2</code><span class="sig-paren">(</span><em class="sig-param">flm1</em>, <em class="sig-param">flm2</em>, <em class="sig-param">ft1</em>, <em class="sig-param">ft2</em>, <em class="sig-param">lmmax</em>, <em class="sig-param">nthetastart</em>, <em class="sig-param">sizethetab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/legendre_grid_to_spec/legtfas2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Legendre transform (n_r,n_theta,m) to (n_r,l,m)
[grid to spectral] for 2 arrays
ancl1/2 (input) to flm1/2 (output)
One call to this routine does part of the transform
by summation over theta points in on theta block:
n_theta_min,..,n_theta_min+n_theta_block-1</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flm1</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>flm2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ft1</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: ASymm</p></li>
<li><p><strong>ft2</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Number of modes to be processed</p></li>
<li><p><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: First no of theta on block</p></li>
<li><p><strong>sizethetab</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: thetas in NHS</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal notranslate"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_nlblayers" title="f/nl_special_calc/get_nlblayers"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_nlblayers()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_perppar" title="f/nl_special_calc/get_perppar"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_perppar()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_fluxes" title="f/nl_special_calc/get_fluxes"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_helicity" title="f/nl_special_calc/get_helicity"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_helicity()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="fourier-transforms">
<h1>Fourier transforms<a class="headerlink" href="#fourier-transforms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/fft">
<span id="fft-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">fft.f90</span></code><a class="headerlink" href="#f/fft" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This file contains the subroutines called by fftJW:
fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fft/d_fft_init" title="f/fft/d_fft_init"><code class="xref f f-var docutils literal notranslate"><span class="pre">d_fft_init</span></code></a>, <a class="reference internal" href="#f/fft/i_fft_init" title="f/fft/i_fft_init"><code class="xref f f-var docutils literal notranslate"><span class="pre">i_fft_init</span></code></a>, <a class="reference internal" href="#f/fft/nd" title="f/fft/nd"><code class="xref f f-var docutils literal notranslate"><span class="pre">nd</span></code></a>, <a class="reference internal" href="#f/fft/ni" title="f/fft/ni"><code class="xref f f-var docutils literal notranslate"><span class="pre">ni</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fft99ajw" title="f/fft/fft99ajw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft99ajw()</span></code></a>, <a class="reference internal" href="#f/fft/fft99bjw" title="f/fft/fft99bjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft99bjw()</span></code></a>, <a class="reference internal" href="#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="#f/fft/fft_to_real" title="f/fft/fft_to_real"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_to_real()</span></code></a>, <a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a>, <a class="reference internal" href="#f/fft/finalize_fft" title="f/fft/finalize_fft"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_fft()</span></code></a>, <a class="reference internal" href="#f/fft/init_fft" title="f/fft/init_fft"><code class="xref f f-func docutils literal notranslate"><span class="pre">init_fft()</span></code></a>, <a class="reference internal" href="#f/fft/wpass2jw" title="f/fft/wpass2jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass2jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass3jw" title="f/fft/wpass3jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass3jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass4jw" title="f/fft/wpass4jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass4jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass5jw" title="f/fft/wpass5jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass5jw()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal notranslate"><span class="pre">factorise()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin36" title="f/constants/sin36"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin60" title="f/constants/sin60"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin60()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/sin72" title="f/constants/sin72"><code class="xref f f-func docutils literal notranslate"><span class="pre">sin72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos36" title="f/constants/cos36"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos36()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/cos72" title="f/constants/cos72"><code class="xref f f-func docutils literal notranslate"><span class="pre">cos72()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a>: This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a>: Module containing blocking information</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/fft/d_fft_init">
<code class="sig-prename descclassname">fft/</code><code class="sig-name descname">d_fft_init</code> (*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fft/d_fft_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fft/i_fft_init">
<code class="sig-prename descclassname">fft/</code><code class="sig-name descname">i_fft_init</code> (100)<em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/fft/i_fft_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fft/nd">
<code class="sig-prename descclassname">fft/</code><code class="sig-name descname">nd</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/fft/nd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fft/ni">
<code class="sig-prename descclassname">fft/</code><code class="sig-name descname">ni</code><em> [</em><em>integer</em><em>,</em><em>private/parameter/optional/default=100</em><em>]</em><a class="headerlink" href="#f/fft/ni" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/fft/init_fft">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">init_fft</code><span class="sig-paren">(</span><em class="sig-param">n</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/init_fft" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate and store several
values that will be needed for a fast fft transform.
The actual transform is performed by the subroutine fftJW.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Dimension of problem, number of grid points</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="precalcModules.html#f/horizontal_data/horizontal" title="f/horizontal_data/horizontal"><code class="xref f f-func docutils literal notranslate"><span class="pre">horizontal()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/factorise" title="f/useful/factorise"><code class="xref f f-func docutils literal notranslate"><span class="pre">factorise()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/finalize_fft">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">finalize_fft</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/finalize_fft" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="precalcModules.html#f/horizontal_data/finalize_horizontal_data" title="f/horizontal_data/finalize_horizontal_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_horizontal_data()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft_to_real">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">fft_to_real</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">ld_f</em>, <em class="sig-param">nrep</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft_to_real" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (ld_f,nrep)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ld_f</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>nrep</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/geos_mod/getdvptr" title="f/geos_mod/getdvptr"><code class="xref f f-func docutils literal notranslate"><span class="pre">getdvptr()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft_thetab">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">fft_thetab</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">dir</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft_thetab" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dir</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: back or forth transform</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initv" title="f/init_fields/initv"><code class="xref f f-func docutils literal notranslate"><span class="pre">initv()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal notranslate"><span class="pre">inits()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initxi" title="f/init_fields/initxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initxi()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/get_bpol" title="f/out_dtb_frame/get_bpol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bpol()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/get_btor" title="f/out_dtb_frame/get_btor"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_btor()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/lm2pt" title="f/out_dtb_frame/lm2pt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2pt()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/get_b_surface" title="f/out_movie/get_b_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_b_surface()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_space()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fftjw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">fftjw</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">ld_a</em>, <em class="sig-param">n</em>, <em class="sig-param">isign</em>, <em class="sig-param">nsize</em>, <em class="sig-param">wrk</em>, <em class="sig-param">wd1</em>, <em class="sig-param">wd2</em>, <em class="sig-param">i_fft_init</em>, <em class="sig-param">d_fft_init</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fftjw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>The routines has been adopted by Gary Glatzmaier and has
subsequently been modified by Uli Christensen and Johannes Wicht</p>
<p>It performs a number of simultaneous real/half-complex
periodic fast fourier transforms or corresponding inverse
transforms, using ordinary spatial order of
gridpoint values.  given a set
of real data vectors, the package returns a set of
“half-complex” fourier coefficient vectors, or vice
versa.  the length of the transforms must be an even
number that has no other factors except possibly powers
of 2, 3, and 5.  this version of fft991 is
optimized for use on the cray-1.</p>
<dl>
<dt>on input     a(ld_a,*)</dt><dd><blockquote>
<div><p>an array of length (ld_a,nsize) containing the input data
or coefficient vectors.  This array is overwritten by
the results.</p>
</div></blockquote>
<dl class="simple">
<dt>n</dt><dd><p>the length of each transform (see definition of
transforms, below).</p>
</dd>
<dt>nsize</dt><dd><p>the number of transforms to be done simultaneously.</p>
</dd>
<dt>isign</dt><dd><dl class="simple">
<dt>= +1 for a transform from fourier coefficients to</dt><dd><p>gridpoint values.</p>
</dd>
<dt>= -1 for a transform from gridpoint values to fourier</dt><dd><p>coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>on output    a</dt><dd><p>if isign = +1, and n_theta_max coefficient vectors are supplied
each containing the sequence</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (ld_a,*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: <p>’</p>
<p>then the result consists of n_theta_max data vectors each
containing the corresponding n+2 gridpoint values</p>
<dl class="simple">
<dt>for fft991, x(0), x(1), x(2),…,x(n-1),0,0.</dt><dd><p>(n+2) real values with x(n)=x(n+1)=0</p>
</dd>
<dt>when isign = +1, the transform is defined by</dt><dd><p>x(j)=sum(k=0,…,n-1)(c(k)*exp(2*i*j*k*pi/n))
where c(k)=a(k)+i*b(k) and c(n-k)=a(k)-i*b(k)
and i=sqrt (-1)
for k=0,…,n/2    i.e., (n/2+1) complex values
with c(0) = c(n) = a(0) and c(n/2)=a(n/2)=0</p>
</dd>
</dl>
<p>if isign = -1, and n_theta_max data vectors are supplied each
containing a sequence of gridpoint values x(j) as
defined above, then the result consists of n_theta_max vectors
each containing the corresponding fourier cofficients</p>
</p></li>
<li><p><strong>a</strong> :: <p>’</p>
<dl class="simple">
<dt>when isign = -1, the inverse transform is defined by</dt><dd><p>c(k)=(1/n)*sum(j=0,…,n-1)(x(j)*exp(-2*i*j*k*pi/n))
where c(k)=a(k)+i*b(k) and i=sqrt(-1)
for k=0,…,n/2</p>
</dd>
</dl>
</p></li>
<li><p><strong>a</strong> :: <p>’
(or vice versa) returns the original data.</p>
<p>note the fact that the gridpoint values x(j) are real
implies that b(0)=b(n/2)=0.  for a call with isign=+1,
it is not actually necessary to supply these zeros.
note starting from grid with x(n)=x(n+1)=0
then transforming to spectral (sign=-1)
then c(n/2)=a(n/2) is not necessarily 0
unless there is no aliasing.</p>
</p></li>
<li><p><strong>ld_a</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of a</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: <p>’</p>
</p></li>
<li><p><strong>isign</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: back/forth transtorm for isign=1/-1</p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of fields for</p></li>
<li><p><strong>wrk</strong> (wd1,wd2)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: work array</p></li>
<li><p><strong>wd1</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>wd2</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>i_fft_init</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: factorization information from init_fft</p></li>
<li><p><strong>d_fft_init</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: trigonometric functions from init_fft</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fft_to_real" title="f/fft/fft_to_real"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_to_real()</span></code></a>, <a class="reference internal" href="#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft_thetab()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/fft/fft99ajw" title="f/fft/fft99ajw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft99ajw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass2jw" title="f/fft/wpass2jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass2jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass3jw" title="f/fft/wpass3jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass3jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass4jw" title="f/fft/wpass4jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass4jw()</span></code></a>, <a class="reference internal" href="#f/fft/wpass5jw" title="f/fft/wpass5jw"><code class="xref f f-func docutils literal notranslate"><span class="pre">wpass5jw()</span></code></a>, <a class="reference internal" href="#f/fft/fft99bjw" title="f/fft/fft99bjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fft99bjw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft99ajw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">fft99ajw</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">work</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nrp</em>, <em class="sig-param">nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft99ajw" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>work</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/fft99bjw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">fft99bjw</code><span class="sig-paren">(</span><em class="sig-param">work</em>, <em class="sig-param">a</em>, <em class="sig-param">trigsf</em>, <em class="sig-param">nrp</em>, <em class="sig-param">nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/fft99bjw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>postprocessing step (isign=-1)
(gridpoint to spectral transform)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>work</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>trigsf</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass2jw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">wpass2jw</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nrp</em>, <em class="sig-param">nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass2jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>reduction for factor 2</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass3jw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">wpass3jw</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nrp</em>, <em class="sig-param">la</em>, <em class="sig-param">nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass3jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>called in fftJW</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass4jw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">wpass4jw</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nrp</em>, <em class="sig-param">la</em>, <em class="sig-param">nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass4jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>called in fftJW
reduction for factor 4</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/fft/wpass5jw">
<em class="property">subroutine  </em><code class="sig-prename descclassname">fft/</code><code class="sig-name descname">wpass5jw</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">trigs</em>, <em class="sig-param">nrp</em>, <em class="sig-param">la</em>, <em class="sig-param">nsize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fft/wpass5jw" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>called in fftJW
reduction for factor 5</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>c</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>trigs</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrp</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>la</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nsize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fft/fftjw" title="f/fft/fftjw"><code class="xref f f-func docutils literal notranslate"><span class="pre">fftjw()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="linear-algebra">
<h1>Linear algebra<a class="headerlink" href="#linear-algebra" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/real_matrices">
<span id="matrices-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">matrices.f90</span></code><a class="headerlink" href="#f/real_matrices" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/real_matrices/mat_add" title="f/real_matrices/mat_add"><code class="xref f f-func docutils literal notranslate"><span class="pre">mat_add()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/real_matrices/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">real_matrices/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/real_matrices/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">dat</code> (,)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">l_pivot</code><em> [</em><em>logical</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">ncol</code><em> [</em><em>integer</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">nrow</code><em> [</em><em>integer</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">pivot</code> (*)<em> [</em><em>integer</em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="function">
<dt id="f/real_matrices/mat_add">
<em class="property">function  </em><code class="sig-prename descclassname">real_matrices/</code><code class="sig-name descname">mat_add</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">b</em><span class="sig-paren">)</span><a class="headerlink" href="#f/real_matrices/mat_add" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>b</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p><strong>mat_add</strong><em> [</em><em>integer</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="f/dense_matrices"></span><p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a>: This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_realmat()</span></code>)</p></li>
<li><p><a class="reference internal" href="#f/algebra" title="f/algebra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">algebra</span></code></a> (<a class="reference internal" href="#f/algebra/solve_mat" title="f/algebra/solve_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_mat()</span></code></a>, <a class="reference internal" href="#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>)</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/dense_matrices/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/dense_matrices/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/dense_matrices/initialize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">nx</em>, <em class="sig-param">ny</em>, <em class="sig-param">l_pivot</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/initialize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Memory allocation</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>nx</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ny</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_pivot</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/dense_matrices/finalize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">finalize</code><span class="sig-paren">(</span><em class="sig-param">this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/finalize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Memory deallocation</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/dense_matrices/prepare">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">prepare</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/prepare" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/dense_matrices/solve_real_single">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">solve_real_single</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/solve_real_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/dense_matrices/solve_complex_single">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">solve_complex_single</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/solve_complex_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/dense_matrices/solve_complex_multi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">solve_complex_multi</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">rhs</em>, <em class="sig-param">nrhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/solve_complex_multi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (,)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>nrhs</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/dense_matrices/set_data">
<em class="property">subroutine  </em><code class="sig-prename descclassname">dense_matrices/</code><code class="sig-name descname">set_data</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">dat</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dense_matrices/set_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dat</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="f/band_matrices"></span><p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/band_matrices/prepare" title="f/band_matrices/prepare"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare()</span></code></a>, <a class="reference internal" href="#f/band_matrices/set_data" title="f/band_matrices/set_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">set_data()</span></code></a>, <a class="reference internal" href="#f/band_matrices/solve_complex_multi" title="f/band_matrices/solve_complex_multi"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_complex_multi()</span></code></a>, <a class="reference internal" href="#f/band_matrices/solve_complex_single" title="f/band_matrices/solve_complex_single"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_complex_single()</span></code></a>, <a class="reference internal" href="#f/band_matrices/solve_real_single" title="f/band_matrices/solve_real_single"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_real_single()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a>: This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_realmat()</span></code>)</p></li>
<li><p><a class="reference internal" href="#f/algebra" title="f/algebra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">algebra</span></code></a> (<a class="reference internal" href="#f/algebra/solve_tridiag" title="f/algebra/solve_tridiag"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_tridiag()</span></code></a>, <a class="reference internal" href="#f/algebra/prepare_tridiag" title="f/algebra/prepare_tridiag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_tridiag()</span></code></a>, <a class="reference internal" href="#f/algebra/prepare_band" title="f/algebra/prepare_band"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_band()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_band" title="f/algebra/solve_band"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_band()</span></code></a>)</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/band_matrices/unknown_type">
<em class="property">type  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">unknown_type</code><a class="headerlink" href="#f/band_matrices/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields</dt>
<dd class="field-odd"><ul class="simple">
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">du2</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">kl</code><em> [</em><em>integer</em><em>]</em></p></li>
<li><p><code class="sig-name descname">% </code><code class="sig-name descname">ku</code><em> [</em><em>integer</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/band_matrices/initialize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">nx</em>, <em class="sig-param">ny</em>, <em class="sig-param">l_pivot</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/initialize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Memory allocation</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>nx</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ny</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_pivot</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/band_matrices/finalize">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">finalize</code><span class="sig-paren">(</span><em class="sig-param">this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/finalize" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Memory deallocation</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/band_matrices/prepare">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">prepare</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/prepare" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/algebra/prepare_tridiag" title="f/algebra/prepare_tridiag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_tridiag()</span></code></a>, <a class="reference internal" href="#f/algebra/prepare_band" title="f/algebra/prepare_band"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_band()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/band_matrices/solve_real_single">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">solve_real_single</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/solve_real_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/band_matrices/solve_complex_single">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">solve_complex_single</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/solve_complex_single" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/band_matrices/solve_complex_multi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">solve_complex_multi</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">rhs</em>, <em class="sig-param">nrhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/solve_complex_multi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (,)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>nrhs</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/band_matrices/set_data">
<em class="property">subroutine  </em><code class="sig-prename descclassname">band_matrices/</code><code class="sig-name descname">set_data</code><span class="sig-paren">(</span><em class="sig-param">this</em>, <em class="sig-param">dat</em><span class="sig-paren">)</span><a class="headerlink" href="#f/band_matrices/set_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dat</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/algebra">
<span id="algebra-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">algebra.f90</span></code><a class="headerlink" href="#f/algebra" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/algebra/solve_band" title="f/algebra/solve_band"><code class="xref f f-var docutils literal notranslate"><span class="pre">solve_band</span></code></a>, <a class="reference internal" href="#f/algebra/solve_mat" title="f/algebra/solve_mat"><code class="xref f f-var docutils literal notranslate"><span class="pre">solve_mat</span></code></a>, <a class="reference internal" href="#f/algebra/solve_tridiag" title="f/algebra/solve_tridiag"><code class="xref f f-var docutils literal notranslate"><span class="pre">solve_tridiag</span></code></a>, <a class="reference internal" href="#f/algebra/zero_tolerance" title="f/algebra/zero_tolerance"><code class="xref f f-var docutils literal notranslate"><span class="pre">zero_tolerance</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/algebra/prepare_band" title="f/algebra/prepare_band"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_band()</span></code></a>, <a class="reference internal" href="#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="#f/algebra/prepare_tridiag" title="f/algebra/prepare_tridiag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_tridiag()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_band_complex_rhs" title="f/algebra/solve_band_complex_rhs"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_band_complex_rhs()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_band_complex_rhs_multi" title="f/algebra/solve_band_complex_rhs_multi"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_band_complex_rhs_multi()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_band_real_rhs" title="f/algebra/solve_band_real_rhs"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_band_real_rhs()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_mat_complex_rhs" title="f/algebra/solve_mat_complex_rhs"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_mat_complex_rhs()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_mat_complex_rhs_multi" title="f/algebra/solve_mat_complex_rhs_multi"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_mat_complex_rhs_multi()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_mat_real_rhs" title="f/algebra/solve_mat_real_rhs"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_mat_real_rhs()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_tridiag_complex_rhs" title="f/algebra/solve_tridiag_complex_rhs"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_tridiag_complex_rhs()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_tridiag_complex_rhs_multi" title="f/algebra/solve_tridiag_complex_rhs_multi"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_tridiag_complex_rhs_multi()</span></code></a>, <a class="reference internal" href="#f/algebra/solve_tridiag_real_rhs" title="f/algebra/solve_tridiag_real_rhs"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_tridiag_real_rhs()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/algebra/solve_band">
<code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_band</code><em> [</em><em>public</em><em>]</em><a class="headerlink" href="#f/algebra/solve_band" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/algebra/solve_mat">
<code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_mat</code><em> [</em><em>public</em><em>]</em><a class="headerlink" href="#f/algebra/solve_mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/algebra/solve_tridiag">
<code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_tridiag</code><em> [</em><em>public</em><em>]</em><a class="headerlink" href="#f/algebra/solve_tridiag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/algebra/zero_tolerance">
<code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">zero_tolerance</code><em> [</em><em>real</em><em>,</em><em>private/parameter/optional/default=1.0e-15_cp</em><em>]</em><a class="headerlink" href="#f/algebra/zero_tolerance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/algebra/solve_mat_complex_rhs">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_mat_complex_rhs</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">ia</em>, <em class="sig-param">n</em>, <em class="sig-param">ip</em>, <em class="sig-param">bc1</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_mat_complex_rhs" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine does the backward substitution into a lu-decomposed real
matrix a (to solve a * x = bc1) were bc1 is the right hand side
vector. On return x is stored in bc1.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (ia,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: real n X n matrix</p></li>
<li><p><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: first dim of a</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dimension of problem</p></li>
<li><p><strong>ip</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot pointer of legth n</p></li>
<li><p><strong>bc1</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: on input RHS of problem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_mat_complex_rhs_multi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_mat_complex_rhs_multi</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">ia</em>, <em class="sig-param">n</em>, <em class="sig-param">ip</em>, <em class="sig-param">bc</em>, <em class="sig-param">nrhss</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_mat_complex_rhs_multi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine does the backward substitution into a lu-decomposed real
matrix a (to solve a * x = bc ) simultaneously for nRHSs complex
vectors bc. On return the results are stored in the bc.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (ia,n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: real n X n matrix</p></li>
<li><p><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: leading dimension of a</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: dimension of problem</p></li>
<li><p><strong>ip</strong> (n)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot pointer of length n</p></li>
<li><p><strong>bc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: on input RHS of problem</p></li>
<li><p><strong>nrhss</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of right-hand sides</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_mat_real_rhs">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_mat_real_rhs</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">ia</em>, <em class="sig-param">n</em>, <em class="sig-param">ip</em>, <em class="sig-param">b</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_mat_real_rhs" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>like the linpack routine
backward substitution of vector b into lu-decomposed matrix a
to solve  a * x = b for a single real vector b</p>
<p>sub sgefa must be called once first to initialize a and ip</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (ia,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: input)  nxn real matrix</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dim of problem</p></li>
<li><p><strong>ip</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot information</p></li>
<li><p><strong>b</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: in/output) rhs-vector on input, solution on output</p></li>
<li><p><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: first dim of a</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/prepare_mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">prepare_mat</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">ia</em>, <em class="sig-param">n</em>, <em class="sig-param">ip</em>, <em class="sig-param">info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/prepare_mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>like the linpack routine</p>
<p>lu decomposes the real matrix a(n,n) via gaussian elimination</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (ia,*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: in/output) real nxn matrix on input, lu-decomposed matrix on output</p></li>
<li><p><strong>ia</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: input) first dimension of a (must be &gt;= n)</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: input) 2nd dimension and rank of a</p></li>
<li><p><strong>ip</strong> (*)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em> :: pivoting information</p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em> :: output) error message when  /=  0</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/init_fields/inits" title="f/init_fields/inits"><code class="xref f f-func docutils literal notranslate"><span class="pre">inits()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initxi" title="f/init_fields/initxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initxi()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/j_cond" title="f/init_fields/j_cond"><code class="xref f f-func docutils literal notranslate"><span class="pre">j_cond()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/pt_cond" title="f/init_fields/pt_cond"><code class="xref f f-func docutils literal notranslate"><span class="pre">pt_cond()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/ps_cond" title="f/init_fields/ps_cond"><code class="xref f f-func docutils literal notranslate"><span class="pre">ps_cond()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/getbackground" title="f/radial_functions/getbackground"><code class="xref f f-func docutils literal notranslate"><span class="pre">getbackground()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod/get_wpsmat" title="f/updatewps_mod/get_wpsmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpsmat()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod/get_ps0mat" title="f/updatewps_mod/get_ps0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ps0mat()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_band_real_rhs">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_band_real_rhs</code><span class="sig-paren">(</span><em class="sig-param">abd</em>, <em class="sig-param">n</em>, <em class="sig-param">kl</em>, <em class="sig-param">ku</em>, <em class="sig-param">pivot</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_band_real_rhs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abd</strong> (2*kl+ku+1,n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>kl</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ku</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pivot</strong> (n)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (n)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_band_complex_rhs">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_band_complex_rhs</code><span class="sig-paren">(</span><em class="sig-param">abd</em>, <em class="sig-param">n</em>, <em class="sig-param">kl</em>, <em class="sig-param">ku</em>, <em class="sig-param">pivot</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_band_complex_rhs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abd</strong> (2*kl+ku+1,n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>kl</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ku</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pivot</strong> (n)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (n)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_band_complex_rhs_multi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_band_complex_rhs_multi</code><span class="sig-paren">(</span><em class="sig-param">abd</em>, <em class="sig-param">n</em>, <em class="sig-param">kl</em>, <em class="sig-param">ku</em>, <em class="sig-param">pivot</em>, <em class="sig-param">rhs</em>, <em class="sig-param">nrhss</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_band_complex_rhs_multi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abd</strong> (2*kl+ku+1,n)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>kl</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ku</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pivot</strong> (n)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>rhs</strong> (,)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>nrhss</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/prepare_band">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">prepare_band</code><span class="sig-paren">(</span><em class="sig-param">abd</em>, <em class="sig-param">n</em>, <em class="sig-param">kl</em>, <em class="sig-param">ku</em>, <em class="sig-param">pivot</em>, <em class="sig-param">info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/prepare_band" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>abd</strong> (2*kl+ku+1,n)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>kl</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ku</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pivot</strong> (n)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/band_matrices/prepare" title="f/band_matrices/prepare"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_tridiag_real_rhs">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_tridiag_real_rhs</code><span class="sig-paren">(</span><em class="sig-param">dl</em>, <em class="sig-param">d</em>, <em class="sig-param">du</em>, <em class="sig-param">du2</em>, <em class="sig-param">n</em>, <em class="sig-param">pivot</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_tridiag_real_rhs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dl</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lower</p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Diagonal</p></li>
<li><p><strong>du</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lower</p></li>
<li><p><strong>du2</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Upper</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dim of problem</p></li>
<li><p><strong>pivot</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot information</p></li>
<li><p><strong>rhs</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_tridiag_complex_rhs">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_tridiag_complex_rhs</code><span class="sig-paren">(</span><em class="sig-param">dl</em>, <em class="sig-param">d</em>, <em class="sig-param">du</em>, <em class="sig-param">du2</em>, <em class="sig-param">n</em>, <em class="sig-param">pivot</em>, <em class="sig-param">rhs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_tridiag_complex_rhs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dl</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lower</p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Diagonal</p></li>
<li><p><strong>du</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lower</p></li>
<li><p><strong>du2</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Upper</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dim of problem</p></li>
<li><p><strong>pivot</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot information</p></li>
<li><p><strong>rhs</strong> (*)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/solve_tridiag_complex_rhs_multi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">solve_tridiag_complex_rhs_multi</code><span class="sig-paren">(</span><em class="sig-param">dl</em>, <em class="sig-param">d</em>, <em class="sig-param">du</em>, <em class="sig-param">du2</em>, <em class="sig-param">n</em>, <em class="sig-param">pivot</em>, <em class="sig-param">rhs</em>, <em class="sig-param">nrhss</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/solve_tridiag_complex_rhs_multi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dl</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lower</p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Diagonal</p></li>
<li><p><strong>du</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lower</p></li>
<li><p><strong>du2</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Upper</p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: dim of problem</p></li>
<li><p><strong>pivot</strong> (*)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: pivot information</p></li>
<li><p><strong>rhs</strong> (,)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>nrhss</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Number of right-hand side</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/algebra/prepare_tridiag">
<em class="property">subroutine  </em><code class="sig-prename descclassname">algebra/</code><code class="sig-name descname">prepare_tridiag</code><span class="sig-paren">(</span><em class="sig-param">dl</em>, <em class="sig-param">d</em>, <em class="sig-param">du</em>, <em class="sig-param">du2</em>, <em class="sig-param">n</em>, <em class="sig-param">pivot</em>, <em class="sig-param">info</em><span class="sig-paren">)</span><a class="headerlink" href="#f/algebra/prepare_tridiag" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dl</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>d</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>du</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>du2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>n</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pivot</strong> (*)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>info</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/band_matrices/prepare" title="f/band_matrices/prepare"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Chebyshev polynomials and cosine transforms</a><ul>
<li><a class="reference internal" href="#f/chebyshev_polynoms_mod"><code class="docutils literal notranslate"><span class="pre">chebyshev_polynoms.f90</span></code></a></li>
<li><a class="reference internal" href="#f/cosine_transform_odd"><code class="docutils literal notranslate"><span class="pre">cosine_transform_odd.f90</span></code></a></li>
<li><a class="reference internal" href="#f/cosine_transform_even"><code class="docutils literal notranslate"><span class="pre">cosine_transform_even.f90</span></code></a></li>
<li><a class="reference internal" href="#f/fft_fac_mod"><code class="docutils literal notranslate"><span class="pre">fft_fac.f90</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#legendre-transforms">Legendre transforms</a><ul>
<li><a class="reference internal" href="#f/plms_theta"><code class="docutils literal notranslate"><span class="pre">plms.f90</span></code></a></li>
<li><a class="reference internal" href="#f/leg_helper_mod"><code class="docutils literal notranslate"><span class="pre">legendre_helpers.f90</span></code></a></li>
<li><a class="reference internal" href="#f/legendre_spec_to_grid"><code class="docutils literal notranslate"><span class="pre">legendre_spec_to_grid.f90</span></code></a></li>
<li><a class="reference internal" href="#f/legendre_grid_to_spec"><code class="docutils literal notranslate"><span class="pre">legendre_grid_to_spec.f90</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fourier-transforms">Fourier transforms</a><ul>
<li><a class="reference internal" href="#f/fft"><code class="docutils literal notranslate"><span class="pre">fft.f90</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-algebra">Linear algebra</a><ul>
<li><a class="reference internal" href="#f/real_matrices"><code class="docutils literal notranslate"><span class="pre">matrices.f90</span></code></a></li>
<li><a class="reference internal" href="#f/algebra"><code class="docutils literal notranslate"><span class="pre">algebra.f90</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="timeAdvNonLinear.html"
                        title="previous chapter">Non-linear part of the time stepping (radial loop)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="derInt.html"
                        title="next chapter">Radial derivatives and integration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/legFourierChebAlgebra.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="derInt.html" title="Radial derivatives and integration"
             >next</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>