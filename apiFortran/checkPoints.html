
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Reading and storing check points (restart files) &#8212; Magic 6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Useful additional libraries" href="misc.html" />
    <link rel="prev" title="IO: RMS force balance, torsional oscillations, misc" href="IOAdd.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="misc.html" title="Useful additional libraries"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="IOAdd.html" title="IO: RMS force balance, torsional oscillations, misc"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reading and storing check points (restart files)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="reading-and-storing-check-points-restart-files">
<span id="secfortranrestart"></span><h1>Reading and storing check points (restart files)<a class="headerlink" href="#reading-and-storing-check-points-restart-files" title="Permalink to this heading">¶</a></h1>
<section id="f/readcheckpoints">
<span id="readcheckpoints-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">readCheckPoints.f90</span></code><a class="headerlink" href="#f/readcheckpoints" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains the functions that can help reading and
mapping of the restart files</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/bytes_allocated" title="f/readcheckpoints/bytes_allocated"><code class="xref f f-var docutils literal notranslate"><span class="pre">bytes_allocated</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/l_axi_old" title="f/readcheckpoints/l_axi_old"><code class="xref f f-var docutils literal notranslate"><span class="pre">l_axi_old</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/lreadr" title="f/readcheckpoints/lreadr"><code class="xref f f-var docutils literal notranslate"><span class="pre">lreadr</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/lreads" title="f/readcheckpoints/lreads"><code class="xref f f-var docutils literal notranslate"><span class="pre">lreads</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/lreadxi" title="f/readcheckpoints/lreadxi"><code class="xref f f-var docutils literal notranslate"><span class="pre">lreadxi</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/n_start_file" title="f/readcheckpoints/n_start_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_start_file</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/ratio1" title="f/readcheckpoints/ratio1"><code class="xref f f-var docutils literal notranslate"><span class="pre">ratio1</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/ratio1_old" title="f/readcheckpoints/ratio1_old"><code class="xref f f-var docutils literal notranslate"><span class="pre">ratio1_old</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/ratio2" title="f/readcheckpoints/ratio2"><code class="xref f f-var docutils literal notranslate"><span class="pre">ratio2</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/ratio2_old" title="f/readcheckpoints/ratio2_old"><code class="xref f f-var docutils literal notranslate"><span class="pre">ratio2_old</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/finish_start_fields" title="f/readcheckpoints/finish_start_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_start_fields()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/getlm2lmo" title="f/readcheckpoints/getlm2lmo"><code class="xref f f-func docutils literal notranslate"><span class="pre">getlm2lmo()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatahydro" title="f/readcheckpoints/mapdatahydro"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatahydro()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatamag" title="f/readcheckpoints/mapdatamag"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatamag()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatar" title="f/readcheckpoints/mapdatar"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatar()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/maponefield" title="f/readcheckpoints/maponefield"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/maponefield_mpi" title="f/readcheckpoints/maponefield_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield_mpi()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_field" title="f/readcheckpoints/read_map_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_field()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_field_mpi" title="f/readcheckpoints/read_map_one_field_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_field_mpi()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_scalar" title="f/readcheckpoints/read_map_one_scalar"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_scalar()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_scalar_mpi" title="f/readcheckpoints/read_map_one_scalar_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_scalar_mpi()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">iso_fortran_env</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">output_unit()</span></code>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/scatter_from_rank0_to_lo" title="f/communications/scatter_from_rank0_to_lo"><code class="xref f f-func docutils literal notranslate"><span class="pre">scatter_from_rank0_to_lo()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">lo2r_one()</span></code>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/dw_lmloc" title="f/fields/dw_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dw_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddw_lmloc" title="f/fields/ddw_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddw_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ds_lmloc" title="f/fields/ds_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ds_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dp_lmloc" title="f/fields/dp_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dp_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dz_lmloc" title="f/fields/dz_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dz_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dxi_lmloc" title="f/fields/dxi_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dxi_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/db_lmloc" title="f/fields/db_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">db_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddb_lmloc" title="f/fields/ddb_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddb_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dj_lmloc" title="f/fields/dj_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dj_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddj_lmloc" title="f/fields/ddj_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddj_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/db_ic_lmloc" title="f/fields/db_ic_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">db_ic_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddb_ic_lmloc" title="f/fields/ddb_ic_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddb_ic_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dj_ic_lmloc" title="f/fields/dj_ic_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dj_ic_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddj_ic_lmloc" title="f/fields/ddj_ic_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddj_ic_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nalias" title="f/truncation/nalias"><code class="xref f f-func docutils literal notranslate"><span class="pre">nalias()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_tot" title="f/truncation/n_phi_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_max" title="f/truncation/m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmagmem" title="f/truncation/lmagmem"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmagmem()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/fd_stretch" title="f/truncation/fd_stretch"><code class="xref f f-func docutils literal notranslate"><span class="pre">fd_stretch()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/fd_ratio" title="f/truncation/fd_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">fd_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_min" title="f/truncation/m_min"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_min()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_sric" title="f/logic/l_sric"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_sric()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_srma" title="f/logic/l_srma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_srma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_ab1" title="f/logic/l_ab1"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_ab1()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_bridge_step" title="f/logic/l_bridge_step"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_bridge_step()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_z10mat" title="f/logic/l_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_z10mat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_par_solve" title="f/logic/l_mag_par_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_par_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm_balance" title="f/blocking/lm_balance"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_balance()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/start_file" title="f/init_fields/start_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_file()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/inform" title="f/init_fields/inform"><code class="xref f f-func docutils literal notranslate"><span class="pre">inform()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ic1" title="f/init_fields/tomega_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ic2" title="f/init_fields/tomega_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ma1" title="f/init_fields/tomega_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ma2" title="f/init_fields/tomega_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ma2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ic1" title="f/init_fields/omega_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ic1" title="f/init_fields/omegaosz_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ic2" title="f/init_fields/omega_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ic2" title="f/init_fields/omegaosz_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ma1" title="f/init_fields/omega_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ma1" title="f/init_fields/omegaosz_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ma2" title="f/init_fields/omega_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ma2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ma2" title="f/init_fields/omegaosz_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ma2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tshift_ic1" title="f/init_fields/tshift_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">tshift_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tshift_ic2" title="f/init_fields/tshift_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">tshift_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tshift_ma1" title="f/init_fields/tshift_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">tshift_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tshift_ma2" title="f/init_fields/tshift_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">tshift_ma2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tipdipole" title="f/init_fields/tipdipole"><code class="xref f f-func docutils literal notranslate"><span class="pre">tipdipole()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/scale_b" title="f/init_fields/scale_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">scale_b()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/scale_v" title="f/init_fields/scale_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">scale_v()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/scale_s" title="f/init_fields/scale_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">scale_s()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/scale_xi" title="f/init_fields/scale_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">scale_xi()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic" title="f/radial_functions/chebt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_norm_ic" title="f/radial_functions/cheb_norm_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">cheb_norm_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/alph1" title="f/num_param/alph1"><code class="xref f f-func docutils literal notranslate"><span class="pre">alph1()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/alph2" title="f/num_param/alph2"><code class="xref f f-func docutils literal notranslate"><span class="pre">alph2()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/alpha" title="f/num_param/alpha"><code class="xref f f-func docutils literal notranslate"><span class="pre">alpha()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sc" title="f/physical_parameters/sc"><code class="xref f f-func docutils literal notranslate"><span class="pre">sc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/raxi" title="f/physical_parameters/raxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">raxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">lffac()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/c_z10_omega_ic" title="f/constants/c_z10_omega_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_z10_omega_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_z10_omega_ma" title="f/constants/c_z10_omega_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_z10_omega_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_lorentz_ma" title="f/constants/c_lorentz_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_lorentz_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_lorentz_ic" title="f/constants/c_lorentz_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_lorentz_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_ic" title="f/constants/c_moi_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_ma" title="f/constants/c_moi_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_ma()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev" title="f/chebyshev"><code class="xref f f-mod docutils literal notranslate"><span class="pre">chebyshev</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev/type_cheb_odd" title="f/chebyshev/type_cheb_odd"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_cheb_odd()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/radial_scheme" title="f/radial_scheme: This is an abstract type that defines the radial scheme used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_scheme</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/radial_scheme/type_rscheme" title="f/radial_scheme/type_rscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_rscheme()</span></code></a>): This is an abstract type that defines the radial scheme used in MagIC</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/finite_differences" title="f/finite_differences: This module is used to calculate the radial grid when finite differences are requested"><code class="xref f f-mod docutils literal notranslate"><span class="pre">finite_differences</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/finite_differences/type_fd" title="f/finite_differences/type_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_fd()</span></code></a>): This module is used to calculate the radial grid when finite differences are requested</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform_odd" title="f/cosine_transform_odd: This module contains the built-in type I discrete Cosine Transforms. This implementation is based on Numerical Recipes and FFTPACK. This only works for ``n_r_max-1 = 2**a 3**b 5**c``, with a,b,c integers...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">cosine_transform_odd</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform_odd/costf_odd_t" title="f/cosine_transform_odd/costf_odd_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">costf_odd_t()</span></code></a>): This module contains the built-in type I discrete Cosine Transforms. This implementation is based on Numerical Recipes and FFTPACK. This only works for <code class="docutils literal notranslate"><span class="pre">n_r_max-1</span> <span class="pre">=</span> <span class="pre">2**a</span> <span class="pre">3**b</span> <span class="pre">5**c</span></code>, with a,b,c integers….</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/polynomial_interpolation" title="f/useful/polynomial_interpolation"><code class="xref f f-func docutils literal notranslate"><span class="pre">polynomial_interpolation()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod" title="f/updatewp_mod: This module handles the time advance of the poloidal potential w and the pressure p. It contains the computation of the implicit terms and the linear solves."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatewp_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a>): This module handles the time advance of the poloidal potential w and the pressure p. It contains the computation of the implicit terms and the linear solves.</p></li>
<li><p><a class="reference internal" href="timeAdvLinear.html#f/updatez_mod" title="f/updatez_mod: This module handles the time advance of the toroidal potential z It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatez_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>): This module handles the time advance of the toroidal potential z It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="timeAdvLinear.html#f/updates_mod" title="f/updates_mod: This module handles the time advance of the entropy s. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updates_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a>): This module handles the time advance of the entropy s. It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="timeAdvLinear.html#f/updatexi_mod" title="f/updatexi_mod: This module handles the time advance of the chemical composition xi. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatexi_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a>): This module handles the time advance of the chemical composition xi. It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="timeAdvLinear.html#f/updateb_mod" title="f/updateb_mod: This module handles the time advance of the magnetic field potentials b and aj as well as the inner core counterparts b_ic and aj_ic. It contains the computation of the implicit terms and the linear"><code class="xref f f-mod docutils literal notranslate"><span class="pre">updateb_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a>): This module handles the time advance of the magnetic field potentials b and aj as well as the inner core counterparts b_ic and aj_ic. It contains the computation of the implicit terms and the linear</p></li>
<li><p><a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod" title="f/updatewps_mod: This module handles the time advance of the poloidal potential w, the pressure p and the entropy s in one single matrix per degree. It contains the computation of the implicit terms and the linear"><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatewps_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a>): This module handles the time advance of the poloidal potential w, the pressure p and the entropy s in one single matrix per degree. It contains the computation of the implicit terms and the linear</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_array/type_tarray" title="f/time_array/type_tarray"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/time_array/type_tscalar" title="f/time_array/type_tscalar"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscalar()</span></code></a>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/bytes_allocated">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">bytes_allocated</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/optional/default=0</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/bytes_allocated" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/l_axi_old">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">l_axi_old</span></span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/l_axi_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/lreadr">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">lreadr</span></span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/lreadr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/lreads">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">lreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/lreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/lreadxi">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">lreadxi</span></span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/lreadxi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/n_start_file">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">n_start_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/n_start_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/ratio1">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">ratio1</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/ratio1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/ratio1_old">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">ratio1_old</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/ratio1_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/ratio2">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">ratio2</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/ratio2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/readcheckpoints/ratio2_old">
<span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">ratio2_old</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/readcheckpoints/ratio2_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/readstartfields_old">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">readstartfields_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/readstartfields_old" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to read the old restart files produced
by MagIC. This is now deprecated with the change of the file format.
This is still needed to read old files.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/getlm2lmo" title="f/readcheckpoints/getlm2lmo"><code class="xref f f-func docutils literal notranslate"><span class="pre">getlm2lmo()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatahydro" title="f/readcheckpoints/mapdatahydro"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatahydro()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/scatter_from_rank0_to_lo" title="f/communications/scatter_from_rank0_to_lo"><code class="xref f f-func docutils literal notranslate"><span class="pre">scatter_from_rank0_to_lo()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatamag" title="f/readcheckpoints/mapdatamag"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatamag()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/finish_start_fields" title="f/readcheckpoints/finish_start_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_start_fields()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/readstartfields">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">readstartfields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/readstartfields" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to read the restart files produced
by MagIC.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/time_schemes/print_info" title="f/time_schemes/print_info"><code class="xref f f-func docutils literal notranslate"><span class="pre">print_info()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/getlm2lmo" title="f/readcheckpoints/getlm2lmo"><code class="xref f f-func docutils literal notranslate"><span class="pre">getlm2lmo()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_scalar" title="f/readcheckpoints/read_map_one_scalar"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_scalar()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_field" title="f/readcheckpoints/read_map_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_field()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/maponefield" title="f/readcheckpoints/maponefield"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/scatter_from_rank0_to_lo" title="f/communications/scatter_from_rank0_to_lo"><code class="xref f f-func docutils literal notranslate"><span class="pre">scatter_from_rank0_to_lo()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/finish_start_fields" title="f/readcheckpoints/finish_start_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_start_fields()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/read_map_one_scalar">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">read_map_one_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fh</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">nexp_old</span></em>, <em class="sig-param"><span class="pre">nimp_old</span></em>, <em class="sig-param"><span class="pre">nold_old</span></em>, <em class="sig-param"><span class="pre">tscheme_family_old</span></em>, <em class="sig-param"><span class="pre">dscal_dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/read_map_one_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fh</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>nexp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nimp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nold_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme_family_old</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dscal_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/read_map_one_field">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">read_map_one_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fh</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">wold</span></em>, <em class="sig-param"><span class="pre">work</span></em>, <em class="sig-param"><span class="pre">scale_w</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">dim1</span></em>, <em class="sig-param"><span class="pre">nexp_old</span></em>, <em class="sig-param"><span class="pre">nimp_old</span></em>, <em class="sig-param"><span class="pre">nold_old</span></em>, <em class="sig-param"><span class="pre">tscheme_family_old</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">l_map</span></em>, <em class="sig-param"><span class="pre">l_transp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/read_map_one_field" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fh</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>wold</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>work</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>scale_w</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dim1</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nexp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nimp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nold_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme_family_old</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>l_map</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_transp</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: do we need to transpose to lm-loc</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/maponefield" title="f/readcheckpoints/maponefield"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/scatter_from_rank0_to_lo" title="f/communications/scatter_from_rank0_to_lo"><code class="xref f f-func docutils literal notranslate"><span class="pre">scatter_from_rank0_to_lo()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/readstartfields_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">readstartfields_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/readstartfields_mpi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to read the restart files produced
by MagIC using MPI-IO</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/mpiio_setup" title="f/parallel_mod/mpiio_setup"><code class="xref f f-func docutils literal notranslate"><span class="pre">mpiio_setup()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/time_schemes/print_info" title="f/time_schemes/print_info"><code class="xref f f-func docutils literal notranslate"><span class="pre">print_info()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/getlm2lmo" title="f/readcheckpoints/getlm2lmo"><code class="xref f f-func docutils literal notranslate"><span class="pre">getlm2lmo()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_scalar_mpi" title="f/readcheckpoints/read_map_one_scalar_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_scalar_mpi()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/getblocks" title="f/parallel_mod/getblocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">getblocks()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_field_mpi" title="f/readcheckpoints/read_map_one_field_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_field_mpi()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/maponefield" title="f/readcheckpoints/maponefield"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/scatter_from_rank0_to_lo" title="f/communications/scatter_from_rank0_to_lo"><code class="xref f f-func docutils literal notranslate"><span class="pre">scatter_from_rank0_to_lo()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/finish_start_fields" title="f/readcheckpoints/finish_start_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_start_fields()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/read_map_one_scalar_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">read_map_one_scalar_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fh</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">nexp_old</span></em>, <em class="sig-param"><span class="pre">nimp_old</span></em>, <em class="sig-param"><span class="pre">nold_old</span></em>, <em class="sig-param"><span class="pre">tscheme_family_old</span></em>, <em class="sig-param"><span class="pre">dscal_dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/read_map_one_scalar_mpi" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fh</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>nexp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nimp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nold_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme_family_old</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dscal_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/read_map_one_field_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">read_map_one_field_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fh</span></em>, <em class="sig-param"><span class="pre">info</span></em>, <em class="sig-param"><span class="pre">datatype</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">wold</span></em>, <em class="sig-param"><span class="pre">lm_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">nrstart_old</span></em>, <em class="sig-param"><span class="pre">nrstop_old</span></em>, <em class="sig-param"><span class="pre">radial_balance_old</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">dim1</span></em>, <em class="sig-param"><span class="pre">scale_w</span></em>, <em class="sig-param"><span class="pre">nexp_old</span></em>, <em class="sig-param"><span class="pre">nimp_old</span></em>, <em class="sig-param"><span class="pre">nold_old</span></em>, <em class="sig-param"><span class="pre">tscheme_family_old</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">disp</span></em>, <em class="sig-param"><span class="pre">l_map</span></em>, <em class="sig-param"><span class="pre">l_transp</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_read_field_only</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/read_map_one_field_mpi" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fh</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>info</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>datatype</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>wold</strong> (lm_max_old,1 - nrstart_old + nrstop_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrstart_old</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>nrstop_old</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>radial_balance_old</strong> (<a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs">n_procs</a>)<em> [</em><em>load </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dim1</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>scale_w</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nexp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nimp_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nold_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme_family_old</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>disp</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>l_map</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_transp</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Do we need to transpose d?dt arrays?</p></li>
</ul>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>l_read_field_only</strong><em> [</em><em>logical </em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/maponefield_mpi" title="f/readcheckpoints/maponefield_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield_mpi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/getlm2lmo">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">getlm2lmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_r_max</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">l_max</span></em>, <em class="sig-param"><span class="pre">l_max_old</span></em>, <em class="sig-param"><span class="pre">m_min</span></em>, <em class="sig-param"><span class="pre">m_min_old</span></em>, <em class="sig-param"><span class="pre">m_max</span></em>, <em class="sig-param"><span class="pre">m_max_old</span></em>, <em class="sig-param"><span class="pre">minc</span></em>, <em class="sig-param"><span class="pre">minc_old</span></em>, <em class="sig-param"><span class="pre">lm_max</span></em>, <em class="sig-param"><span class="pre">lm_max_old</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/getlm2lmo" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_r_max</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_max</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>m_min</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>m_min_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>m_max</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>m_max_old</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>minc</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>minc_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm_max</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm_max_old</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: data found in startfile</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/maponefield_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">maponefield_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">wold</span></em>, <em class="sig-param"><span class="pre">lm_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">nrstart_old</span></em>, <em class="sig-param"><span class="pre">nrstop_old</span></em>, <em class="sig-param"><span class="pre">radial_balance_old</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">dim1</span></em>, <em class="sig-param"><span class="pre">lbc1</span></em>, <em class="sig-param"><span class="pre">l_ic</span></em>, <em class="sig-param"><span class="pre">scale_w</span></em>, <em class="sig-param"><span class="pre">w</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/maponefield_mpi" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wold</strong> (lm_max_old,1 - nrstart_old + nrstop_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrstart_old</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>nrstop_old</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>radial_balance_old</strong> (<a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs">n_procs</a>)<em> [</em><em>load </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dim1</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc1</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>scale_w</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/read_map_one_field_mpi" title="f/readcheckpoints/read_map_one_field_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_field_mpi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/mapdatar" title="f/readcheckpoints/mapdatar"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatar()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/maponefield">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">maponefield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">wo</span></em>, <em class="sig-param"><span class="pre">scale_w</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">dim1</span></em>, <em class="sig-param"><span class="pre">lbc1</span></em>, <em class="sig-param"><span class="pre">l_ic</span></em>, <em class="sig-param"><span class="pre">w</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/maponefield" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wo</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>scale_w</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dim1</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc1</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/read_map_one_field" title="f/readcheckpoints/read_map_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">read_map_one_field()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/mapdatar" title="f/readcheckpoints/mapdatar"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatar()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/mapdatahydro">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">mapdatahydro</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">wo</span></em>, <em class="sig-param"><span class="pre">zo</span></em>, <em class="sig-param"><span class="pre">po</span></em>, <em class="sig-param"><span class="pre">so</span></em>, <em class="sig-param"><span class="pre">xio</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">lm_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">lbc1</span></em>, <em class="sig-param"><span class="pre">lbc2</span></em>, <em class="sig-param"><span class="pre">lbc3</span></em>, <em class="sig-param"><span class="pre">lbc4</span></em>, <em class="sig-param"><span class="pre">lbc5</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/mapdatahydro" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wo</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>zo</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>po</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>so</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xio</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>lm_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc1</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc2</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc3</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc4</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc5</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>s</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>xi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/mapdatar" title="f/readcheckpoints/mapdatar"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatar()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/mapdatamag">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">mapdatamag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">wo</span></em>, <em class="sig-param"><span class="pre">zo</span></em>, <em class="sig-param"><span class="pre">po</span></em>, <em class="sig-param"><span class="pre">so</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">n_rad_tot</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">lm_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">lm2lmo</span></em>, <em class="sig-param"><span class="pre">dim1</span></em>, <em class="sig-param"><span class="pre">l_ic</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/mapdatamag" title="Permalink to this definition">¶</a></dt>
<dd><p>— Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wo</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>zo</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>po</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>so</strong> (lm_max_old,n_r_max_old)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_rad_tot</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>lm_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm2lmo</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dim1</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>s</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,dim1)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/readcheckpoints/mapdatar" title="f/readcheckpoints/mapdatar"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatar()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/mapdatar">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">mapdatar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">datar</span></em>, <em class="sig-param"><span class="pre">r_old</span></em>, <em class="sig-param"><span class="pre">n_rad_tot</span></em>, <em class="sig-param"><span class="pre">n_r_max_old</span></em>, <em class="sig-param"><span class="pre">n_r_maxl</span></em>, <em class="sig-param"><span class="pre">lbc</span></em>, <em class="sig-param"><span class="pre">l_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/mapdatar" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Copy (interpolate) data (read from disc file) from old grid structure
to new grid. Linear interploation is used in r if the radial grid
structure differs</p>
<p>called in mapdata</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datar</strong> (*)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em> :: old data</p></li>
<li><p><strong>r_old</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_rad_tot</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_r_maxl</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lbc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/maponefield_mpi" title="f/readcheckpoints/maponefield_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield_mpi()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/maponefield" title="f/readcheckpoints/maponefield"><code class="xref f f-func docutils literal notranslate"><span class="pre">maponefield()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatahydro" title="f/readcheckpoints/mapdatahydro"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatahydro()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/mapdatamag" title="f/readcheckpoints/mapdatamag"><code class="xref f f-func docutils literal notranslate"><span class="pre">mapdatamag()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/polynomial_interpolation" title="f/useful/polynomial_interpolation"><code class="xref f f-func docutils literal notranslate"><span class="pre">polynomial_interpolation()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/finish_start_fields">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">finish_start_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">minc_old</span></em>, <em class="sig-param"><span class="pre">l_mag_old</span></em>, <em class="sig-param"><span class="pre">omega_ic1old</span></em>, <em class="sig-param"><span class="pre">omega_ma1old</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/finish_start_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>minc_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_mag_old</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic1old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ma1old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/readcheckpoints/print_info">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">readcheckpoints/</span></span><span class="sig-name descname"><span class="pre">print_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ra_old</span></em>, <em class="sig-param"><span class="pre">ek_old</span></em>, <em class="sig-param"><span class="pre">pr_old</span></em>, <em class="sig-param"><span class="pre">sc_old</span></em>, <em class="sig-param"><span class="pre">raxi_old</span></em>, <em class="sig-param"><span class="pre">pm_old</span></em>, <em class="sig-param"><span class="pre">radratio_old</span></em>, <em class="sig-param"><span class="pre">sigma_ratio_old</span></em>, <em class="sig-param"><span class="pre">n_phi_tot_old</span></em>, <em class="sig-param"><span class="pre">nalias_old</span></em>, <em class="sig-param"><span class="pre">l_max_old</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/readcheckpoints/print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ek_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pr_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sc_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>raxi_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pm_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>radratio_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sigma_ratio_old</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_phi_tot_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nalias_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_max_old</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/storecheckpoints">
<span id="storecheckpoints-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">storeCheckPoints.f90</span></code><a class="headerlink" href="#f/storecheckpoints" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains several subroutines that can be used to store the
checkpoint_#.tag files</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/storecheckpoints/store" title="f/storecheckpoints/store"><code class="xref f f-func docutils literal notranslate"><span class="pre">store()</span></code></a>, <a class="reference internal" href="#f/storecheckpoints/store_mpi" title="f/storecheckpoints/store_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_mpi()</span></code></a>, <a class="reference internal" href="#f/storecheckpoints/write_one_field" title="f/storecheckpoints/write_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_one_field()</span></code></a>, <a class="reference internal" href="#f/storecheckpoints/write_one_field_mpi" title="f/storecheckpoints/write_one_field_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_one_field_mpi()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">iso_fortran_env</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">output_unit()</span></code>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_ic()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">lo2r_one()</span></code>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nalias" title="f/truncation/nalias"><code class="xref f f-func docutils literal notranslate"><span class="pre">nalias()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_tot" title="f/truncation/n_phi_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_max" title="f/truncation/m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/fd_stretch" title="f/truncation/fd_stretch"><code class="xref f f-func docutils literal notranslate"><span class="pre">fd_stretch()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/fd_ratio" title="f/truncation/fd_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">fd_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_min" title="f/truncation/m_min"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_min()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/raxi" title="f/physical_parameters/raxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">raxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sc" title="f/physical_parameters/sc"><code class="xref f f-func docutils literal notranslate"><span class="pre">sc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/stef" title="f/physical_parameters/stef"><code class="xref f f-func docutils literal notranslate"><span class="pre">stef()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/alph1" title="f/num_param/alph1"><code class="xref f f-func docutils literal notranslate"><span class="pre">alph1()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/alph2" title="f/num_param/alph2"><code class="xref f f-func docutils literal notranslate"><span class="pre">alph2()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/inform" title="f/init_fields/inform"><code class="xref f f-func docutils literal notranslate"><span class="pre">inform()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ic1" title="f/init_fields/omega_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ic1" title="f/init_fields/omegaosz_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ic1" title="f/init_fields/tomega_ic1"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ic1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ic2" title="f/init_fields/omega_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ic2" title="f/init_fields/omegaosz_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ic2" title="f/init_fields/tomega_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ic2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ma1" title="f/init_fields/omega_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ma1" title="f/init_fields/omegaosz_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ma1" title="f/init_fields/tomega_ma1"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ma1()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omega_ma2" title="f/init_fields/omega_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ma2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/omegaosz_ma2" title="f/init_fields/omegaosz_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">omegaosz_ma2()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/tomega_ma2" title="f/init_fields/tomega_ma2"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomega_ma2()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_par_solve" title="f/logic/l_mag_par_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_par_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="misc.html#f/charmanip" title="f/charmanip: This module contains several useful routines to manipule character strings"><code class="xref f f-mod docutils literal notranslate"><span class="pre">charmanip</span></code></a> (<a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal notranslate"><span class="pre">dble2str()</span></code></a>): This module contains several useful routines to manipule character strings</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_array/type_tarray" title="f/time_array/type_tarray"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/time_array/type_tscalar" title="f/time_array/type_tscalar"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscalar()</span></code></a>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/storecheckpoints/store">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">storecheckpoints/</span></span><span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em>, <em class="sig-param"><span class="pre">l_stop_time</span></em>, <em class="sig-param"><span class="pre">l_new_rst_file</span></em>, <em class="sig-param"><span class="pre">l_ave_file</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/storecheckpoints/store" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine stores the results in a checkpoint file.
In addition to the magnetic field and velocity potentials
we also store the time derivative terms djdt(lm,nR),dbdt(lm,nR), …
to allow to restart with 2nd order Adams-Bashforth scheme.
To minimize the memory imprint, a gather/write strategy has been adopted
here. This implies that only one global array dimension(lm_max,n_r_max)
is required.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_stop_time</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_new_rst_file</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ave_file</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal notranslate"><span class="pre">dble2str()</span></code></a>, <a class="reference internal" href="#f/storecheckpoints/write_one_field" title="f/storecheckpoints/write_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_one_field()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/storecheckpoints/write_one_field">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">storecheckpoints/</span></span><span class="sig-name descname"><span class="pre">write_one_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fh</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">work</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/storecheckpoints/write_one_field" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fh</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: file unit</p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em> :: Time scheme</p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: field</p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>work</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="#f/storecheckpoints/store" title="f/storecheckpoints/store"><code class="xref f f-func docutils literal notranslate"><span class="pre">store()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/storecheckpoints/store_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">storecheckpoints/</span></span><span class="sig-name descname"><span class="pre">store_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em>, <em class="sig-param"><span class="pre">l_stop_time</span></em>, <em class="sig-param"><span class="pre">l_new_rst_file</span></em>, <em class="sig-param"><span class="pre">l_ave_file</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/storecheckpoints/store_mpi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine stores the results in a checkpoint file.
In addition to the magnetic field and velocity potentials
we also store the time derivative terms djdt(lm,nR),dbdt(lm,nR), …
to allow to restart with 2nd order Adams-Bashforth scheme.
To minimize the memory imprint, a gather/write strategy has been adopted
here. This implies that only one global array dimension(lm_max,n_r_max)
is required.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_stop_time</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_new_rst_file</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ave_file</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>s</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal notranslate"><span class="pre">dble2str()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/mpiio_setup" title="f/parallel_mod/mpiio_setup"><code class="xref f f-func docutils literal notranslate"><span class="pre">mpiio_setup()</span></code></a>, <a class="reference internal" href="#f/storecheckpoints/write_one_field_mpi" title="f/storecheckpoints/write_one_field_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_one_field_mpi()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/storecheckpoints/write_one_field_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">storecheckpoints/</span></span><span class="sig-name descname"><span class="pre">write_one_field_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fh</span></em>, <em class="sig-param"><span class="pre">info</span></em>, <em class="sig-param"><span class="pre">datatype</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">work</span></em>, <em class="sig-param"><span class="pre">size_tmp</span></em>, <em class="sig-param"><span class="pre">disp</span></em>, <em class="sig-param"><span class="pre">l_transp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/storecheckpoints/write_one_field_mpi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to write one field and its associated possible
help arrays (d?dt) which are required to time advance the solution.
This is using MPI-IO with R-distributed arrays.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fh</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: file unit</p></li>
<li><p><strong>info</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: MPI file info</p></li>
<li><p><strong>datatype</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: MPI file info</p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray </em><em>,</em><em>in</em><em>]</em> :: time advance arrays</p></li>
<li><p><strong>work</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>size_tmp</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>disp</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>l_transp</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Do we need to transpose anything?</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/storecheckpoints/store_mpi" title="f/storecheckpoints/store_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_mpi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Reading and storing check points (restart files)</a><ul>
<li><a class="reference internal" href="#f/readcheckpoints"><code class="docutils literal notranslate"><span class="pre">readCheckPoints.f90</span></code></a></li>
<li><a class="reference internal" href="#f/storecheckpoints"><code class="docutils literal notranslate"><span class="pre">storeCheckPoints.f90</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="IOAdd.html"
                          title="previous chapter">IO: RMS force balance, torsional oscillations, misc</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="misc.html"
                          title="next chapter">Useful additional libraries</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/checkPoints.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="misc.html" title="Useful additional libraries"
             >next</a> |</li>
        <li class="right" >
          <a href="IOAdd.html" title="IO: RMS force balance, torsional oscillations, misc"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Reading and storing check points (restart files)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>