
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Main program magic.f90 &#8212; Magic 6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Base modules" href="baseModules.html" />
    <link rel="prev" title="Description of the Fortran modules" href="../api.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="baseModules.html" title="Base modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../api.html" title="Description of the Fortran modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Main program <code class="docutils literal notranslate"><span class="pre">magic.f90</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="main-program-magic-f90">
<span id="secfortranmagic"></span><h1>Main program <code class="docutils literal notranslate"><span class="pre">magic.f90</span></code><a class="headerlink" href="#main-program-magic-f90" title="Permalink to this heading">¶</a></h1>
<dl>
<dt class="sig sig-object f" id="f/magic">
<em class="property"><span class="pre">program</span>&#160; </em><span class="sig-name descname"><span class="pre">magic</span></span><a class="headerlink" href="#f/magic" title="Permalink to this definition">¶</a></dt>
<dd><p>A dynamic dynamo model driven by thermal convection
in a rotating spherical fluid shell.
This version can solve for both Boussinesq and anelastic fluids and
non-dimensional variables are used throughout the whole code.</p>
<dl class="field-list simple">
<dt class="field-odd">Use <span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">iso_fortran_env</span></code>, <a class="reference internal" href="misc.html#f/charmanip" title="f/charmanip: This module contains several useful routines to manipule character strings"><code class="xref f f-mod docutils literal notranslate"><span class="pre">charmanip</span></code></a> (<a class="reference internal" href="misc.html#f/charmanip/write_long_string" title="f/charmanip/write_long_string"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_long_string()</span></code></a>), <a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a>, <a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/courant_mod" title="f/courant_mod: This module handles the computation of Courant factors on grid space. It then checks whether the timestep size needs to be modified."><code class="xref f f-mod docutils literal notranslate"><span class="pre">courant_mod</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/courant_mod/initialize_courant" title="f/courant_mod/initialize_courant"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_courant()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/courant_mod/finalize_courant" title="f/courant_mod/finalize_courant"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_courant()</span></code></a>), <a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/initialize_der_arrays" title="f/radial_der/initialize_der_arrays"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_der_arrays()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/finalize_der_arrays" title="f/radial_der/finalize_der_arrays"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_der_arrays()</span></code></a>), <a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/initialize_radial_functions" title="f/radial_functions/initialize_radial_functions"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radial_functions()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/finalize_radial_functions" title="f/radial_functions/finalize_radial_functions"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radial_functions()</span></code></a>), <a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal notranslate"><span class="pre">torsional_oscillations</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/initialize_blocking" title="f/blocking/initialize_blocking"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_blocking()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/finalize_blocking" title="f/blocking/finalize_blocking"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_blocking()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>), <a class="reference internal" href="timeAdvance.html#f/timing" title="f/timing: This module contains functions that are used to measure the time spent."><code class="xref f f-mod docutils literal notranslate"><span class="pre">timing</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">timer_type()</span></code>), <a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast" title="f/fieldslast: This module contains all the work arrays of the previous time-steps needed to time advance the code. They are needed in the time-stepping scheme...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fieldslast</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/codeversion" title="f/constants/codeversion"><code class="xref f f-func docutils literal notranslate"><span class="pre">codeversion()</span></code></a>), <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/initialize_movie_data" title="f/movie_data/initialize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_movie_data()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/finalize_movie_data" title="f/movie_data/finalize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_movie_data()</span></code></a>), <a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/initialize_rms" title="f/rms/initialize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_rms()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/finalize_rms" title="f/rms/finalize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_rms()</span></code></a>), <a class="reference internal" href="IOAdd.html#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="IOAdd.html#f/dtb_mod/initialize_dtb_mod" title="f/dtb_mod/initialize_dtb_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_dtb_mod()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/finalize_dtb_mod" title="f/dtb_mod/finalize_dtb_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_dtb_mod()</span></code></a>), <a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/initialize_radial_data" title="f/radial_data/initialize_radial_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radial_data()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/finalize_radial_data" title="f/radial_data/finalize_radial_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radial_data()</span></code></a>), <a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radialloop</span></code></a> (<a class="reference internal" href="timeAdvNonLinear.html#f/radialloop/initialize_radialloop" title="f/radialloop/initialize_radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radialloop()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/radialloop/finalize_radialloop" title="f/radialloop/finalize_radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radialloop()</span></code></a>), <a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod" title="f/lmloop_mod"><code class="xref f f-mod docutils literal notranslate"><span class="pre">lmloop_mod</span></code></a> (<a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>), <a class="reference internal" href="precalcModules.html#f/precalculations" title="f/precalculations"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precalculations</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields" title="f/start_fields: This module is used to set-up the initial starting fields. They can be obtained by reading a starting checkpoint file or by setting some starting conditions."><code class="xref f f-mod docutils literal notranslate"><span class="pre">start_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/kinetic_energy" title="f/kinetic_energy: This module handles the computation of kinetic energy and the time-averaged radial profiles."><code class="xref f f-mod docutils literal notranslate"><span class="pre">kinetic_energy</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/magnetic_energy" title="f/magnetic_energy: This module handles the computation and the writing of the diagnostic files related to magnetic energy: e_mag_oc.TAG, e_mag_ic.TAG, dipole.TAG, eMagR.TAG"><code class="xref f f-mod docutils literal notranslate"><span class="pre">magnetic_energy</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod" title="f/fields_average_mod: This module is used when one wants to store time-averaged quantities"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields_average_mod</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos" title="f/geos: This module is used to compute z-integrated diagnostics such as the degree of geostrophy or the separation of energies between inside and outside the tangent cylinder. This makes use of a local Simpson's method. This also"><code class="xref f f-mod docutils literal notranslate"><span class="pre">geos</span></code></a> (<a class="reference internal" href="IOAdd.html#f/geos/initialize_geos" title="f/geos/initialize_geos"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_geos()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos/finalize_geos" title="f/geos/finalize_geos"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_geos()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/spectra" title="f/spectra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">spectra</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/spectra/initialize_spectra" title="f/spectra/initialize_spectra"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_spectra()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/finalize_spectra" title="f/spectra/finalize_spectra"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_spectra()</span></code></a>), <a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/output_mod" title="f/output_mod: This module handles the calls to the different output routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_mod</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/output_mod/initialize_output" title="f/output_mod/initialize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_output()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/finalize_output" title="f/output_mod/finalize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_output()</span></code></a>), <a class="reference internal" href="IOAdd.html#f/outto_mod" title="f/outto_mod: This module handles the writing of TO-related outputs: zonal force balance and z-integrated terms. This is a re-implementation of the spectral method used up to MagIC 5.10, which formerly relies on calculation of Plm on the cylindrical grid...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">outto_mod</span></code></a> (<a class="reference internal" href="IOAdd.html#f/outto_mod/initialize_outto_mod" title="f/outto_mod/initialize_outto_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outto_mod()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/finalize_outto_mod" title="f/outto_mod/finalize_outto_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outto_mod()</span></code></a>), <a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>, <a class="reference internal" href="initModules.html#f/namelists" title="f/namelists: Read and print the input namelist"><code class="xref f f-mod docutils literal notranslate"><span class="pre">namelists</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod" title="f/step_time_mod"><code class="xref f f-mod docutils literal notranslate"><span class="pre">step_time_mod</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/step_time_mod/initialize_step_time" title="f/step_time_mod/initialize_step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_step_time()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a>), <a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/initialize_communications" title="f/communications/initialize_communications"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_communications()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/finalize_communications" title="f/communications/finalize_communications"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_communications()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/power" title="f/power: This module handles the writing of the power budget"><code class="xref f f-mod docutils literal notranslate"><span class="pre">power</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/power/initialize_output_power" title="f/power/initialize_output_power"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_output_power()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/power/finalize_output_power" title="f/power/finalize_output_power"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_output_power()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/outpar_mod" title="f/outpar_mod: This module is used to compute several time-averaged radial profiles: fluxes, boundary layers, etc."><code class="xref f f-mod docutils literal notranslate"><span class="pre">outpar_mod</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outpar_mod/initialize_outpar_mod" title="f/outpar_mod/initialize_outpar_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outpar_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/finalize_outpar_mod" title="f/outpar_mod/finalize_outpar_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outpar_mod()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/outmisc_mod" title="f/outmisc_mod: This module contains several subroutines that can compute and store various informations: helicity (helicity.TAG), heat transfer (heat.TAG), phase field (phase.TAG) and North/South hemisphericity of energies (hemi.TAG)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">outmisc_mod</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outmisc_mod/initialize_outmisc_mod" title="f/outmisc_mod/initialize_outmisc_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outmisc_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outmisc_mod/finalize_outmisc_mod" title="f/outmisc_mod/finalize_outmisc_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outmisc_mod()</span></code></a>), <a class="reference internal" href="IOGeneral.html#f/outrot" title="f/outrot: This module handles the writing of several diagnostic files related to the rotation: angular momentum (AM.TAG), drift (drift.TAG), inner core and mantle rotations...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">outrot</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outrot/initialize_outrot" title="f/outrot/initialize_outrot"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outrot()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/finalize_outrot" title="f/outrot/finalize_outrot"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outrot()</span></code></a>), <a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a>, <a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>), <a class="reference internal" href="IOAdd.html#f/probe_mod" title="f/probe_mod: Module for artificial sensors to compare time series of physical data with experiments. Probes are located in a radially symmetrical way"><code class="xref f f-mod docutils literal notranslate"><span class="pre">probe_mod</span></code></a> (<a class="reference internal" href="IOAdd.html#f/probe_mod/initialize_probes" title="f/probe_mod/initialize_probes"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_probes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/probe_mod/finalize_probes" title="f/probe_mod/finalize_probes"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_probes()</span></code></a>), <a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>), <a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/initialize_sht" title="f/sht/initialize_sht"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_sht()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/finalize_sht" title="f/sht/finalize_sht"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_sht()</span></code></a>)</p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/parallel" title="f/parallel_mod/parallel"><code class="xref f f-func docutils literal notranslate"><span class="pre">parallel()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/write_long_string" title="f/charmanip/write_long_string"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_long_string()</span></code></a>, <a class="reference internal" href="initModules.html#f/namelists/readnamelists" title="f/namelists/readnamelists"><code class="xref f f-func docutils literal notranslate"><span class="pre">readnamelists()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/initialize_output" title="f/output_mod/initialize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_output()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/checktruncation" title="f/truncation/checktruncation"><code class="xref f f-func docutils literal notranslate"><span class="pre">checktruncation()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/initialize_memory_counter" title="f/mem_alloc/initialize_memory_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_memory_counter()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/initialize_blocking" title="f/blocking/initialize_blocking"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_blocking()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/initialize_sht" title="f/sht/initialize_sht"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_sht()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/initialize_radial_data" title="f/radial_data/initialize_radial_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radial_data()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/initialize_radial_functions" title="f/radial_functions/initialize_radial_functions"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radial_functions()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/initialize_horizontal_data" title="f/horizontal_data/initialize_horizontal_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_horizontal_data()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/radialloop/initialize_radialloop" title="f/radialloop/initialize_radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radialloop()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/initialize_num_param" title="f/num_param/initialize_num_param"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_num_param()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/initialize_init_fields" title="f/init_fields/initialize_init_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_init_fields()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/initialize_fields" title="f/fields/initialize_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_fields()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/initialize_fieldslast" title="f/fieldslast/initialize_fieldslast"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_fieldslast()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/initialize_step_time" title="f/step_time_mod/initialize_step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_step_time()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/initialize_communications" title="f/communications/initialize_communications"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_communications()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/initialize_der_arrays" title="f/radial_der/initialize_der_arrays"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_der_arrays()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/kinetic_energy/initialize_kinetic_energy" title="f/kinetic_energy/initialize_kinetic_energy"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_kinetic_energy()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/magnetic_energy/initialize_magnetic_energy" title="f/magnetic_energy/initialize_magnetic_energy"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_magnetic_energy()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/initialize_spectra" title="f/spectra/initialize_spectra"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_spectra()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/initialize_outpar_mod" title="f/outpar_mod/initialize_outpar_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outpar_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outmisc_mod/initialize_outmisc_mod" title="f/outmisc_mod/initialize_outmisc_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outmisc_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/initialize_outrot" title="f/outrot/initialize_outrot"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outrot()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/power/initialize_output_power" title="f/power/initialize_output_power"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_output_power()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/initialize_fields_average_mod" title="f/fields_average_mod/initialize_fields_average_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_fields_average_mod()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/initialize_to" title="f/torsional_oscillations/initialize_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_to()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/precalculations/precalc" title="f/precalculations/precalc"><code class="xref f f-func docutils literal notranslate"><span class="pre">precalc()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos/initialize_geos" title="f/geos/initialize_geos"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_geos()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/initialize_outto_mod" title="f/outto_mod/initialize_outto_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outto_mod()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/initialize_movie_data" title="f/movie_data/initialize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_movie_data()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/initialize_dtb_mod" title="f/dtb_mod/initialize_dtb_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_dtb_mod()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/probe_mod/initialize_probes" title="f/probe_mod/initialize_probes"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_probes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/initialize_rms" title="f/rms/initialize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_rms()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/finalize_memory_counter" title="f/mem_alloc/finalize_memory_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_memory_counter()</span></code></a>, <a class="reference internal" href="initModules.html#f/namelists/writenamelists" title="f/namelists/writenamelists"><code class="xref f f-func docutils literal notranslate"><span class="pre">writenamelists()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/courant_mod/initialize_courant" title="f/courant_mod/initialize_courant"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_courant()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/precalculations/precalctimes" title="f/precalculations/precalctimes"><code class="xref f f-func docutils literal notranslate"><span class="pre">precalctimes()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/precalculations/writeinfo" title="f/precalculations/writeinfo"><code class="xref f f-func docutils literal notranslate"><span class="pre">writeinfo()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/finalize_movie_data" title="f/movie_data/finalize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_movie_data()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/finalize_rms" title="f/rms/finalize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_rms()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/outto_mod/finalize_outto_mod" title="f/outto_mod/finalize_outto_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outto_mod()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/finalize_to" title="f/torsional_oscillations/finalize_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_to()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos/finalize_geos" title="f/geos/finalize_geos"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_geos()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/finalize_dtb_mod" title="f/dtb_mod/finalize_dtb_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_dtb_mod()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/fields_average_mod/finalize_fields_average_mod" title="f/fields_average_mod/finalize_fields_average_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_fields_average_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/power/finalize_output_power" title="f/power/finalize_output_power"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_output_power()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/finalize_outrot" title="f/outrot/finalize_outrot"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outrot()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outmisc_mod/finalize_outmisc_mod" title="f/outmisc_mod/finalize_outmisc_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outmisc_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/finalize_outpar_mod" title="f/outpar_mod/finalize_outpar_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outpar_mod()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/finalize_spectra" title="f/spectra/finalize_spectra"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_spectra()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/magnetic_energy/finalize_magnetic_energy" title="f/magnetic_energy/finalize_magnetic_energy"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_magnetic_energy()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/kinetic_energy/finalize_kinetic_energy" title="f/kinetic_energy/finalize_kinetic_energy"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_kinetic_energy()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/probe_mod/finalize_probes" title="f/probe_mod/finalize_probes"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_probes()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/courant_mod/finalize_courant" title="f/courant_mod/finalize_courant"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_courant()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/finalize_communications" title="f/communications/finalize_communications"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_communications()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/finalize_fieldslast" title="f/fieldslast/finalize_fieldslast"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_fieldslast()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/finalize_fields" title="f/fields/finalize_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_fields()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/finalize_init_fields" title="f/init_fields/finalize_init_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_init_fields()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/finalize_num_param" title="f/num_param/finalize_num_param"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_num_param()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a>, <a class="reference internal" href="timeAdvNonLinear.html#f/radialloop/finalize_radialloop" title="f/radialloop/finalize_radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radialloop()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/finalize_sht" title="f/sht/finalize_sht"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_sht()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/finalize_der_arrays" title="f/radial_der/finalize_der_arrays"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_der_arrays()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/finalize_horizontal_data" title="f/horizontal_data/finalize_horizontal_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_horizontal_data()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/finalize_radial_functions" title="f/radial_functions/finalize_radial_functions"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radial_functions()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/finalize_blocking" title="f/blocking/finalize_blocking"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_blocking()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/finalize_radial_data" title="f/radial_data/finalize_radial_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radial_data()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/finalize_output" title="f/output_mod/finalize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_output()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../api.html"
                          title="previous chapter">Description of the Fortran modules</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="baseModules.html"
                          title="next chapter">Base modules</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/magic.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="baseModules.html" title="Base modules"
             >next</a> |</li>
        <li class="right" >
          <a href="../api.html" title="Description of the Fortran modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Main program <code class="docutils literal notranslate"><span class="pre">magic.f90</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>