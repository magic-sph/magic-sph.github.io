<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>IO: RMS force balance, torsional oscillations, misc &#8212; Magic 6.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.2 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reading and storing check points (restart files)" href="checkPoints.html" />
    <link rel="prev" title="IO: graphic files, movie files, coeff files and potential files" href="IOBinaryOutputs.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="checkPoints.html" title="Reading and storing check points (restart files)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="IOBinaryOutputs.html" title="IO: graphic files, movie files, coeff files and potential files"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">IO: RMS force balance, torsional oscillations, misc</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="io-rms-force-balance-torsional-oscillations-misc">
<span id="secfortranioadd"></span><h1>IO: RMS force balance, torsional oscillations, misc<a class="headerlink" href="#io-rms-force-balance-torsional-oscillations-misc" title="Permalink to this heading">¶</a></h1>
<section id="f/rms">
<span id="rms-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">RMS.f90</span></code><a class="headerlink" href="#f/rms" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains the calculation of the RMS force balance and induction
terms.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/rms/adv2hint" title="f/rms/adv2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">adv2hint</span></code></a>, <a class="reference internal" href="#f/rms/advp2" title="f/rms/advp2"><code class="xref f f-var docutils literal notranslate"><span class="pre">advp2</span></code></a>, <a class="reference internal" href="#f/rms/advp2lm" title="f/rms/advp2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">advp2lm</span></code></a>, <a class="reference internal" href="#f/rms/advrmsl" title="f/rms/advrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">advrmsl</span></code></a>, <a class="reference internal" href="#f/rms/advrmslnr" title="f/rms/advrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">advrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/advt2" title="f/rms/advt2"><code class="xref f f-var docutils literal notranslate"><span class="pre">advt2</span></code></a>, <a class="reference internal" href="#f/rms/advt2lm" title="f/rms/advt2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">advt2lm</span></code></a>, <a class="reference internal" href="#f/rms/arc2hint" title="f/rms/arc2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">arc2hint</span></code></a>, <a class="reference internal" href="#f/rms/arcmag2hint" title="f/rms/arcmag2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">arcmag2hint</span></code></a>, <a class="reference internal" href="#f/rms/arcmagrmsl" title="f/rms/arcmagrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">arcmagrmsl</span></code></a>, <a class="reference internal" href="#f/rms/arcmagrmslnr" title="f/rms/arcmagrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">arcmagrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/arcrmsl" title="f/rms/arcrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">arcrmsl</span></code></a>, <a class="reference internal" href="#f/rms/arcrmslnr" title="f/rms/arcrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">arcrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/buo_temp2hint" title="f/rms/buo_temp2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo_temp2hint</span></code></a>, <a class="reference internal" href="#f/rms/buo_temprmsl" title="f/rms/buo_temprmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo_temprmsl</span></code></a>, <a class="reference internal" href="#f/rms/buo_temprmslnr" title="f/rms/buo_temprmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo_temprmslnr</span></code></a>, <a class="reference internal" href="#f/rms/buo_xi2hint" title="f/rms/buo_xi2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo_xi2hint</span></code></a>, <a class="reference internal" href="#f/rms/buo_xirmsl" title="f/rms/buo_xirmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo_xirmsl</span></code></a>, <a class="reference internal" href="#f/rms/buo_xirmslnr" title="f/rms/buo_xirmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo_xirmslnr</span></code></a>, <a class="reference internal" href="#f/rms/cfp2" title="f/rms/cfp2"><code class="xref f f-var docutils literal notranslate"><span class="pre">cfp2</span></code></a>, <a class="reference internal" href="#f/rms/cfp2lm" title="f/rms/cfp2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">cfp2lm</span></code></a>, <a class="reference internal" href="#f/rms/cft2" title="f/rms/cft2"><code class="xref f f-var docutils literal notranslate"><span class="pre">cft2</span></code></a>, <a class="reference internal" href="#f/rms/cft2lm" title="f/rms/cft2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">cft2lm</span></code></a>, <a class="reference internal" href="#f/rms/cia2hint" title="f/rms/cia2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">cia2hint</span></code></a>, <a class="reference internal" href="#f/rms/ciarmsl" title="f/rms/ciarmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">ciarmsl</span></code></a>, <a class="reference internal" href="#f/rms/ciarmslnr" title="f/rms/ciarmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">ciarmslnr</span></code></a>, <a class="reference internal" href="#f/rms/clf2hint" title="f/rms/clf2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">clf2hint</span></code></a>, <a class="reference internal" href="#f/rms/clfrmsl" title="f/rms/clfrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">clfrmsl</span></code></a>, <a class="reference internal" href="#f/rms/clfrmslnr" title="f/rms/clfrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">clfrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/cor2hint" title="f/rms/cor2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">cor2hint</span></code></a>, <a class="reference internal" href="#f/rms/corrmsl" title="f/rms/corrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">corrmsl</span></code></a>, <a class="reference internal" href="#f/rms/corrmslnr" title="f/rms/corrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">corrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">difpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-var docutils literal notranslate"><span class="pre">difpollmr</span></code></a>, <a class="reference internal" href="#f/rms/difrmsl" title="f/rms/difrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">difrmsl</span></code></a>, <a class="reference internal" href="#f/rms/difrmslnr" title="f/rms/difrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">difrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/diftor2hint" title="f/rms/diftor2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">diftor2hint</span></code></a>, <a class="reference internal" href="#f/rms/dpdpc" title="f/rms/dpdpc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dpdpc</span></code></a>, <a class="reference internal" href="#f/rms/dpdtc" title="f/rms/dpdtc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dpdtc</span></code></a>, <a class="reference internal" href="#f/rms/dpkindrc" title="f/rms/dpkindrc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dpkindrc</span></code></a>, <a class="reference internal" href="#f/rms/dpkindrlm" title="f/rms/dpkindrlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">dpkindrlm</span></code></a>, <a class="reference internal" href="#f/rms/dr_facc" title="f/rms/dr_facc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dr_facc</span></code></a>, <a class="reference internal" href="#f/rms/dtbpol2hint" title="f/rms/dtbpol2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtbpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtbpollmr" title="f/rms/dtbpollmr"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtbpollmr</span></code></a>, <a class="reference internal" href="#f/rms/dtbrms_file" title="f/rms/dtbrms_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtbrms_file</span></code></a>, <a class="reference internal" href="#f/rms/dtbtor2hint" title="f/rms/dtbtor2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtbtor2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtvp" title="f/rms/dtvp"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvp</span></code></a>, <a class="reference internal" href="#f/rms/dtvplm" title="f/rms/dtvplm"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvplm</span></code></a>, <a class="reference internal" href="#f/rms/dtvr" title="f/rms/dtvr"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvr</span></code></a>, <a class="reference internal" href="#f/rms/dtvrlm" title="f/rms/dtvrlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvrlm</span></code></a>, <a class="reference internal" href="#f/rms/dtvrms_file" title="f/rms/dtvrms_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvrms_file</span></code></a>, <a class="reference internal" href="#f/rms/dtvt" title="f/rms/dtvt"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvt</span></code></a>, <a class="reference internal" href="#f/rms/dtvtlm" title="f/rms/dtvtlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtvtlm</span></code></a>, <a class="reference internal" href="#f/rms/geo2hint" title="f/rms/geo2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">geo2hint</span></code></a>, <a class="reference internal" href="#f/rms/geormsl" title="f/rms/geormsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">geormsl</span></code></a>, <a class="reference internal" href="#f/rms/geormslnr" title="f/rms/geormslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">geormslnr</span></code></a>, <a class="reference internal" href="#f/rms/iner2hint" title="f/rms/iner2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">iner2hint</span></code></a>, <a class="reference internal" href="#f/rms/inerrmsl" title="f/rms/inerrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">inerrmsl</span></code></a>, <a class="reference internal" href="#f/rms/inerrmslnr" title="f/rms/inerrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">inerrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/lf2hint" title="f/rms/lf2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">lf2hint</span></code></a>, <a class="reference internal" href="#f/rms/lfp2" title="f/rms/lfp2"><code class="xref f f-var docutils literal notranslate"><span class="pre">lfp2</span></code></a>, <a class="reference internal" href="#f/rms/lfp2lm" title="f/rms/lfp2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">lfp2lm</span></code></a>, <a class="reference internal" href="#f/rms/lfrlm" title="f/rms/lfrlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">lfrlm</span></code></a>, <a class="reference internal" href="#f/rms/lfrmsl" title="f/rms/lfrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">lfrmsl</span></code></a>, <a class="reference internal" href="#f/rms/lfrmslnr" title="f/rms/lfrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">lfrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/lft2" title="f/rms/lft2"><code class="xref f f-var docutils literal notranslate"><span class="pre">lft2</span></code></a>, <a class="reference internal" href="#f/rms/lft2lm" title="f/rms/lft2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">lft2lm</span></code></a>, <a class="reference internal" href="#f/rms/mag2hint" title="f/rms/mag2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">mag2hint</span></code></a>, <a class="reference internal" href="#f/rms/magrmsl" title="f/rms/magrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">magrmsl</span></code></a>, <a class="reference internal" href="#f/rms/magrmslnr" title="f/rms/magrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">magrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/n_cheb_maxc" title="f/rms/n_cheb_maxc"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_cheb_maxc</span></code></a>, <a class="reference internal" href="#f/rms/n_dtbrms_file" title="f/rms/n_dtbrms_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_dtbrms_file</span></code></a>, <a class="reference internal" href="#f/rms/n_dtvrms_file" title="f/rms/n_dtvrms_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_dtvrms_file</span></code></a>, <a class="reference internal" href="#f/rms/n_r_maxc" title="f/rms/n_r_maxc"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_r_maxc</span></code></a>, <a class="reference internal" href="#f/rms/ncut" title="f/rms/ncut"><code class="xref f f-var docutils literal notranslate"><span class="pre">ncut</span></code></a>, <a class="reference internal" href="#f/rms/pfp2lm" title="f/rms/pfp2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">pfp2lm</span></code></a>, <a class="reference internal" href="#f/rms/pft2lm" title="f/rms/pft2lm"><code class="xref f f-var docutils literal notranslate"><span class="pre">pft2lm</span></code></a>, <a class="reference internal" href="#f/rms/plf2hint" title="f/rms/plf2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">plf2hint</span></code></a>, <a class="reference internal" href="#f/rms/plfrmsl" title="f/rms/plfrmsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">plfrmsl</span></code></a>, <a class="reference internal" href="#f/rms/plfrmslnr" title="f/rms/plfrmslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">plfrmslnr</span></code></a>, <a class="reference internal" href="#f/rms/pre2hint" title="f/rms/pre2hint"><code class="xref f f-var docutils literal notranslate"><span class="pre">pre2hint</span></code></a>, <a class="reference internal" href="#f/rms/prermsl" title="f/rms/prermsl"><code class="xref f f-var docutils literal notranslate"><span class="pre">prermsl</span></code></a>, <a class="reference internal" href="#f/rms/prermslnr" title="f/rms/prermslnr"><code class="xref f f-var docutils literal notranslate"><span class="pre">prermslnr</span></code></a>, <a class="reference internal" href="#f/rms/rc" title="f/rms/rc"><code class="xref f f-var docutils literal notranslate"><span class="pre">rc</span></code></a>, <a class="reference internal" href="#f/rms/vp_old" title="f/rms/vp_old"><code class="xref f f-var docutils literal notranslate"><span class="pre">vp_old</span></code></a>, <a class="reference internal" href="#f/rms/vr_old" title="f/rms/vr_old"><code class="xref f f-var docutils literal notranslate"><span class="pre">vr_old</span></code></a>, <a class="reference internal" href="#f/rms/vt_old" title="f/rms/vt_old"><code class="xref f f-var docutils literal notranslate"><span class="pre">vt_old</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/compute_lm_forces" title="f/rms/compute_lm_forces"><code class="xref f f-func docutils literal notranslate"><span class="pre">compute_lm_forces()</span></code></a>, <a class="reference internal" href="#f/rms/dtbrms" title="f/rms/dtbrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbrms()</span></code></a>, <a class="reference internal" href="#f/rms/dtvrms" title="f/rms/dtvrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtvrms()</span></code></a>, <a class="reference internal" href="#f/rms/finalize_rms" title="f/rms/finalize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_rms()</span></code></a>, <a class="reference internal" href="#f/rms/get_force" title="f/rms/get_force"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_force()</span></code></a>, <a class="reference internal" href="#f/rms/get_nl_rms" title="f/rms/get_nl_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_nl_rms()</span></code></a>, <a class="reference internal" href="#f/rms/init_rnb" title="f/rms/init_rnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">init_rnb()</span></code></a>, <a class="reference internal" href="#f/rms/initialize_rms" title="f/rms/initialize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_rms()</span></code></a>, <a class="reference internal" href="#f/rms/transform_to_grid_rms" title="f/rms/transform_to_grid_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_rms()</span></code></a>, <a class="reference internal" href="#f/rms/transform_to_lm_rms" title="f/rms/transform_to_lm_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_rms()</span></code></a>, <a class="reference internal" href="#f/rms/zerorms" title="f/rms/zerorms"><code class="xref f f-func docutils literal notranslate"><span class="pre">zerorms()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lma" title="f/blocking/lm2lma"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2lma()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lms" title="f/blocking/lm2lms"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2lms()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/finite_differences" title="f/finite_differences: This module is used to calculate the radial grid when finite differences are requested"><code class="xref f f-mod docutils literal notranslate"><span class="pre">finite_differences</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/finite_differences/type_fd" title="f/finite_differences/type_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_fd()</span></code></a>): This module is used to calculate the radial grid when finite differences are requested</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev" title="f/chebyshev"><code class="xref f f-mod docutils literal notranslate"><span class="pre">chebyshev</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev/type_cheb_odd" title="f/chebyshev/type_cheb_odd"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_cheb_odd()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/radial_scheme" title="f/radial_scheme: This is an abstract type that defines the radial scheme used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_scheme</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/radial_scheme/type_rscheme" title="f/radial_scheme/type_rscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_rscheme()</span></code></a>): This is an abstract type that defines the radial scheme used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_cheb_max" title="f/truncation/n_cheb_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_cheb_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max_dtb" title="f/truncation/n_r_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/fd_ratio" title="f/truncation/fd_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">fd_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/fd_stretch" title="f/truncation/fd_stretch"><code class="xref f f-func docutils literal notranslate"><span class="pre">fd_stretch()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">corfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/buofac" title="f/physical_parameters/buofac"><code class="xref f f-func docutils literal notranslate"><span class="pre">buofac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/chemfac" title="f/physical_parameters/chemfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">chemfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/thexpnb" title="f/physical_parameters/thexpnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">thexpnb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">vischeatfac()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/radial_balance" title="f/radial_data/radial_balance"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial_balance()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or3" title="f/radial_functions/or3"><code class="xref f f-func docutils literal notranslate"><span class="pre">or3()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal notranslate"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal notranslate"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ogrun" title="f/radial_functions/ogrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">ogrun()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/alpha0" title="f/radial_functions/alpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">alpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/l_r" title="f/radial_functions/l_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_corr" title="f/logic/l_corr"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_corr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_newmap" title="f/logic/l_newmap"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_newmap()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_2d_rms" title="f/logic/l_2d_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_2d_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_par_solve" title="f/logic/l_mag_par_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_par_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_adv_curl" title="f/logic/l_adv_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_adv_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anelastic_liquid" title="f/logic/l_anelastic_liquid"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_anelastic_liquid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_non_rot" title="f/logic/l_non_rot"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_non_rot()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/alph1" title="f/num_param/alph1"><code class="xref f f-func docutils literal notranslate"><span class="pre">alph1()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/alph2" title="f/num_param/alph2"><code class="xref f f-func docutils literal notranslate"><span class="pre">alph2()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta_e2" title="f/horizontal_data/o_sin_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/cosn_theta_e2" title="f/horizontal_data/cosn_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">cosn_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta2a" title="f/horizontal_data/dtheta2a"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta2a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal notranslate"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta2s" title="f/horizontal_data/dtheta2s"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta2s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a>): Radial integration functions</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/rdea" title="f/output_data/rdea"><code class="xref f f-func docutils literal notranslate"><span class="pre">rdea()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/rcut" title="f/output_data/rcut"><code class="xref f f-func docutils literal notranslate"><span class="pre">rcut()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal notranslate"><span class="pre">runid()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform_odd" title="f/cosine_transform_odd: This module contains the built-in type I discrete Cosine Transforms. This implementation is based on Numerical Recipes and FFTPACK. This only works for ``n_r_max-1 = 2**a 3**b 5**c``, with a,b,c integers...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">cosine_transform_odd</span></code></a>: This module contains the built-in type I discrete Cosine Transforms. This implementation is based on Numerical Recipes and FFTPACK. This only works for <code class="docutils literal notranslate"><span class="pre">n_r_max-1</span> <span class="pre">=</span> <span class="pre">2**a</span> <span class="pre">3**b</span> <span class="pre">5**c</span></code>, with a,b,c integers….</p></li>
<li><p><a class="reference internal" href="#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_poltorrms" title="f/rms_helpers/get_poltorrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_poltorrms()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpollm" title="f/rms_helpers/hint2dpollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2dpollm()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hintrms" title="f/rms_helpers/hintrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">hintrms()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="#f/dtb_mod/pdiflm_lmloc" title="f/dtb_mod/pdiflm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">pdiflm_lmloc()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm_lmloc" title="f/dtb_mod/tdiflm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">tdiflm_lmloc()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm_lmloc" title="f/dtb_mod/pstrlm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">pstrlm_lmloc()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm_lmloc" title="f/dtb_mod/padvlm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">padvlm_lmloc()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm_lmloc" title="f/dtb_mod/tadvlm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">tadvlm_lmloc()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm_lmloc" title="f/dtb_mod/tstrlm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">tstrlm_lmloc()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm_lmloc" title="f/dtb_mod/tomelm_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomelm_lmloc()</span></code></a>): This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output….</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="misc.html#f/mean_sd" title="f/mean_sd: This module contains a small type that simply handles two arrays (mean and SD) This type is used for time-averaged outputs (and their standard deviations)."><code class="xref f f-mod docutils literal notranslate"><span class="pre">mean_sd</span></code></a> (<a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">mean_sd_type()</span></code></a>, <a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">mean_sd_2d_type()</span></code></a>): This module contains a small type that simply handles two arrays (mean and SD) This type is used for time-averaged outputs (and their standard deviations).</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sphertor" title="f/sht/spat_to_sphertor"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sphertor()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_qst" title="f/sht/spat_to_qst"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_qst()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_sh" title="f/sht/scal_to_sh"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_sh()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_grad_spat" title="f/sht/scal_to_grad_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_grad_spat()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/adv2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">adv2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/adv2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/advp2">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">advp2</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/advp2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/advp2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">advp2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/advp2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/advrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">advrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/advrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/advrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">advrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/advrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/advt2">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">advt2</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/advt2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/advt2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">advt2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/advt2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/arc2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">arc2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/arc2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/arcmag2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">arcmag2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/arcmag2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/arcmagrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">arcmagrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/arcmagrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/arcmagrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">arcmagrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/arcmagrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/arcrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">arcrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/arcrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/arcrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">arcrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/arcrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/buo_temp2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">buo_temp2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/buo_temp2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/buo_temprmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">buo_temprmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/buo_temprmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/buo_temprmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">buo_temprmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/buo_temprmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/buo_xi2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">buo_xi2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/buo_xi2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/buo_xirmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">buo_xirmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/buo_xirmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/buo_xirmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">buo_xirmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/buo_xirmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/cfp2">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">cfp2</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/cfp2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/cfp2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">cfp2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/cfp2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/cft2">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">cft2</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/cft2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/cft2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">cft2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/cft2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/cia2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">cia2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/cia2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/ciarmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">ciarmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/ciarmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/ciarmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">ciarmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/ciarmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/clf2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">clf2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/clf2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/clfrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">clfrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/clfrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/clfrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">clfrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/clfrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/cor2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">cor2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/cor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/corrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">corrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/corrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/corrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">corrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/corrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/difpol2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">difpol2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/difpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/difpollmr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">difpollmr</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/difpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/difrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">difrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/difrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/difrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">difrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/difrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/diftor2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">diftor2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/diftor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dpdpc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dpdpc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dpdpc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dpdtc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dpdtc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dpdtc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dpkindrc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dpkindrc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dpkindrc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dpkindrlm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dpkindrlm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dpkindrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dr_facc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dr_facc</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dr_facc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtbpol2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtbpol2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtbpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtbpollmr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtbpollmr</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtbpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtbrms_file">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtbrms_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtbrms_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtbtor2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtbtor2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtbtor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvp">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvp</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvplm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvplm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvplm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvr</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvrlm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvrlm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvrms_file">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvrms_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvrms_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvt">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvt</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/dtvtlm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvtlm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/dtvtlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/geo2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">geo2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/geo2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/geormsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">geormsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/geormsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/geormslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">geormslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/geormslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/iner2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">iner2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/iner2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/inerrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">inerrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/inerrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/inerrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">inerrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/inerrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lf2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lf2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lf2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lfp2">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lfp2</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lfp2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lfp2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lfp2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lfp2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lfrlm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lfrlm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lfrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lfrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lfrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lfrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lfrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lfrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lfrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lft2">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lft2</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lft2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/lft2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">lft2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/lft2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/mag2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">mag2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/mag2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/magrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">magrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/magrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/magrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">magrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/magrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/n_cheb_maxc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">n_cheb_maxc</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/n_cheb_maxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of Chebyshevs</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/n_dtbrms_file">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">n_dtbrms_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/n_dtbrms_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/n_dtvrms_file">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">n_dtvrms_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/n_dtvrms_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/n_r_maxc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">n_r_maxc</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/n_r_maxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of radial points</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/ncut">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">ncut</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/ncut" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points for the cut-off</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/pfp2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">pfp2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/pfp2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/pft2lm">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">pft2lm</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/pft2lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/plf2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">plf2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/plf2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/plfrmsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">plfrmsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/plfrmsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/plfrmslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">plfrmslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/plfrmslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/pre2hint">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">pre2hint</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/pre2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/prermsl">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">prermsl</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_type" title="f/mean_sd/mean_sd_type"><em><span class="pre">mean_sd_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/prermsl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/prermslnr">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">prermslnr</span></span><em> <span class="pre">[</span></em><a class="reference internal" href="misc.html#f/mean_sd/mean_sd_2d_type" title="f/mean_sd/mean_sd_2d_type"><em><span class="pre">mean_sd_2d_type</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/prermslnr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/rc">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">rc</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut-off radii</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/vp_old">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">vp_old</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/vp_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/vr_old">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">vr_old</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/vr_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/rms/vt_old">
<span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">vt_old</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/rms/vt_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/rms/initialize_rms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">initialize_rms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/initialize_rms" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory allocation of arrays used in the computation of r.m.s. force balance</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/init_rnb" title="f/rms/init_rnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">init_rnb()</span></code></a>, <a class="reference internal" href="#f/rms/zerorms" title="f/rms/zerorms"><code class="xref f f-func docutils literal notranslate"><span class="pre">zerorms()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/finalize_rms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">finalize_rms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/finalize_rms" title="Permalink to this definition">¶</a></dt>
<dd><p>Deallocate arrays used for r.m.s. force balance computation</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/zerorms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">zerorms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/zerorms" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeros integrals that are set in get_td, update_z,
update_wp, update_b, dtVrms and dtBrms</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/rms/initialize_rms" title="f/rms/initialize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_rms()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/init_rnb">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">init_rnb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">r</span></em>, <em class="sig-param"><span class="pre">rcut</span></em>, <em class="sig-param"><span class="pre">rdea</span></em>, <em class="sig-param"><span class="pre">r2</span></em>, <em class="sig-param"><span class="pre">n_r_max2</span></em>, <em class="sig-param"><span class="pre">n_cheb_max2</span></em>, <em class="sig-param"><span class="pre">ns</span></em>, <em class="sig-param"><span class="pre">rscheme_rms</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/init_rnb" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Prepares the usage of a cut back radial grid where nS points
on both boundaries are discarded.
The aim actually is to discard boundary effects, but just
not considering the boundary grid points does not work when
you also want radial derivatives and integrals. For these
we use the Chebychev transform which needs are particular number
of grid points so that the fast cosine transform can be
applied. Therefor more than just 2 points have to be
thrown away, which may make sense anyway.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>rcut</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>rdea</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>r2</strong> (*)<em> [</em><em>real </em><em>,</em><em>out,allocatable</em><em>]</em></p></li>
<li><p><strong>n_r_max2</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: ‘)</p></li>
<li><p><strong>n_cheb_max2</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ns</strong><em> [</em><em>integer </em><em>,</em><em>out</em><em>]</em> :: ‘)</p></li>
<li><p><strong>rscheme_rms</strong><em> [</em><em>real </em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/initialize_rms" title="f/rms/initialize_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_rms()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/get_nl_rms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">get_nl_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">dvrdr</span></em>, <em class="sig-param"><span class="pre">dvrdt</span></em>, <em class="sig-param"><span class="pre">dvrdp</span></em>, <em class="sig-param"><span class="pre">dvtdr</span></em>, <em class="sig-param"><span class="pre">dvtdp</span></em>, <em class="sig-param"><span class="pre">dvpdr</span></em>, <em class="sig-param"><span class="pre">dvpdp</span></em>, <em class="sig-param"><span class="pre">cvr</span></em>, <em class="sig-param"><span class="pre">advt</span></em>, <em class="sig-param"><span class="pre">advp</span></em>, <em class="sig-param"><span class="pre">lft</span></em>, <em class="sig-param"><span class="pre">lfp</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmscalc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/get_nl_rms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the r.m.s. force balance terms which need to
be computed on the grid</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial level</p></li>
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvtdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvtdp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvpdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvpdp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cvr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>advt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>advp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lft</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lfp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em> :: time scheme</p></li>
<li><p><strong>lrmscalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/transform_to_grid_rms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">transform_to_grid_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">p_rloc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/transform_to_grid_rms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to transform the arrays used in r.m.s. force
calculations from the spectral space to the physical grid.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial level</p></li>
<li><p><strong>p_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em> :: pressure in LM space</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/riter_mod/transform_to_grid_space" title="f/riter_mod/transform_to_grid_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_space()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_grad_spat" title="f/sht/scal_to_grad_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_grad_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/transform_to_lm_rms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">transform_to_lm_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">lfr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/transform_to_lm_rms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to transform the arrays used in r.m.s. force
calculations from the physical grid to spectral space.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial level</p></li>
<li><p><strong>lfr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>inout</em><em>]</em> :: radial component of the Lorentz force</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/riter_mod/transform_to_lm_space" title="f/riter_mod/transform_to_lm_space"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_space()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_sh" title="f/sht/scal_to_sh"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_sh()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sphertor" title="f/sht/spat_to_sphertor"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sphertor()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_qst" title="f/sht/spat_to_qst"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_qst()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/compute_lm_forces">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">compute_lm_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">w_rloc</span></em>, <em class="sig-param"><span class="pre">dw_rloc</span></em>, <em class="sig-param"><span class="pre">ddw_rloc</span></em>, <em class="sig-param"><span class="pre">z_rloc</span></em>, <em class="sig-param"><span class="pre">s_rloc</span></em>, <em class="sig-param"><span class="pre">xi_rloc</span></em>, <em class="sig-param"><span class="pre">p_rloc</span></em>, <em class="sig-param"><span class="pre">dp_rloc</span></em>, <em class="sig-param"><span class="pre">advrlm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/compute_lm_forces" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine finalizes the computation of the r.m.s. spectra once
the quantities are back in spectral space.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dw_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: phi-deriv of dw/dr</p></li>
<li><p><strong>ddw_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>s_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>p_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dp_rloc</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>advrlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/rms_helpers/hintrms" title="f/rms_helpers/hintrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">hintrms()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/get_force">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">get_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">force2hint</span></em>, <em class="sig-param"><span class="pre">forcerms</span></em>, <em class="sig-param"><span class="pre">forcermsl</span></em>, <em class="sig-param"><span class="pre">forcermslnr</span></em>, <em class="sig-param"><span class="pre">volc</span></em>, <em class="sig-param"><span class="pre">nrms_sets</span></em>, <em class="sig-param"><span class="pre">timepassed</span></em>, <em class="sig-param"><span class="pre">timenorm</span></em>, <em class="sig-param"><span class="pre">l_stop_time</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">forcepol2hint</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">forcetor2hint</span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/get_force" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to compute the contributions of the
forces in the Navier-Stokes equation</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force2hint</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>forcerms</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>forcermsl</strong><em> [</em><em>mean_sd_type </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>forcermslnr</strong><em> [</em><em>mean_sd_2d_type </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>volc</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrms_sets</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timepassed</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timenorm</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_stop_time</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>forcepol2hint</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>forcetor2hint</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real </em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/rms/dtvrms" title="f/rms/dtvrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtvrms()</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/dtvrms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtvrms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">nrms_sets</span></em>, <em class="sig-param"><span class="pre">timepassed</span></em>, <em class="sig-param"><span class="pre">timenorm</span></em>, <em class="sig-param"><span class="pre">l_stop_time</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/dtvrms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine calculates and stores the different contributions
of the forces entering the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nrms_sets</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>timepassed</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timenorm</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_stop_time</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="#f/rms/get_force" title="f/rms/get_force"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_force()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms/dtbrms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms/</span></span><span class="sig-name descname"><span class="pre">dtbrms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/dtbrms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/rms_helpers/get_poltorrms" title="f/rms_helpers/get_poltorrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_poltorrms()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpollm" title="f/rms_helpers/hint2dpollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2dpollm()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/rms_helpers">
<span id="rms-helpers-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">RMS_helpers.f90</span></code><a class="headerlink" href="#f/rms_helpers" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains several useful subroutines required to compute RMS
diagnostics</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/rms_helpers/get_poltorrms" title="f/rms_helpers/get_poltorrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_poltorrms()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpollm" title="f/rms_helpers/hint2dpollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2dpollm()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hintrms" title="f/rms_helpers/hintrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">hintrms()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/reduce_radial" title="f/communications/reduce_radial"><code class="xref f f-func docutils literal notranslate"><span class="pre">reduce_radial()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a>): Radial integration functions</p></li>
<li><p><a class="reference internal" href="blocking.html#f/lmmapping" title="f/lmmapping"><code class="xref f f-mod docutils literal notranslate"><span class="pre">lmmapping</span></code></a> (<a class="reference internal" href="blocking.html#f/lmmapping/mappings" title="f/lmmapping/mappings"><code class="xref f f-func docutils literal notranslate"><span class="pre">mappings()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/rms_helpers/get_poltorrms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms_helpers/</span></span><span class="sig-name descname"><span class="pre">get_poltorrms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pol</span></em>, <em class="sig-param"><span class="pre">drpol</span></em>, <em class="sig-param"><span class="pre">tor</span></em>, <em class="sig-param"><span class="pre">llm</span></em>, <em class="sig-param"><span class="pre">ulm</span></em>, <em class="sig-param"><span class="pre">polrms</span></em>, <em class="sig-param"><span class="pre">torrms</span></em>, <em class="sig-param"><span class="pre">polasrms</span></em>, <em class="sig-param"><span class="pre">torasrms</span></em>, <em class="sig-param"><span class="pre">map</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/get_poltorrms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>calculates integral PolRms=sqrt( Integral (pol^2 dV) )
calculates integral TorRms=sqrt( Integral (tor^2 dV) )
plus axisymmetric parts.
integration in theta,phi by summation of spherical harmonics
integration in r by using Chebycheff integrals
The mapping map gives the mapping lm to l,m for the input
arrays Pol,drPol and Tor
Output: PolRms,TorRms,PolAsRms,TorAsRms</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pol</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Poloidal field Potential</p></li>
<li><p><strong>drpol</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Radial derivative of Pol</p></li>
<li><p><strong>tor</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Toroidal field Potential</p></li>
<li><p><strong>llm</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>ulm</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>polrms</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>torrms</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>polasrms</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>torasrms</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>map</strong><em> [</em><em>mappings </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/dtbrms" title="f/rms/dtbrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbrms()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms_helpers/hint2dpol">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms_helpers/</span></span><span class="sig-name descname"><span class="pre">hint2dpol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dpol</span></em>, <em class="sig-param"><span class="pre">lmstart</span></em>, <em class="sig-param"><span class="pre">lmstop</span></em>, <em class="sig-param"><span class="pre">pol2hint</span></em>, <em class="sig-param"><span class="pre">map</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/hint2dpol" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpol</strong> (1 - lmstart + lmstop)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Toroidal field Potential</p></li>
<li><p><strong>lmstart</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>lmstop</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>pol2hint</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>map</strong><em> [</em><em>mappings </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/dtvrms" title="f/rms/dtvrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtvrms()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms_helpers/hint2dpollm">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms_helpers/</span></span><span class="sig-name descname"><span class="pre">hint2dpollm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dpol</span></em>, <em class="sig-param"><span class="pre">lmstart</span></em>, <em class="sig-param"><span class="pre">lmstop</span></em>, <em class="sig-param"><span class="pre">pol2hint</span></em>, <em class="sig-param"><span class="pre">map</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/hint2dpollm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dpol</strong> (1 - lmstart + lmstop)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lmstart</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>lmstop</strong><em> [</em><em>integer </em><em>,</em><em>in,required</em><em>]</em></p></li>
<li><p><strong>pol2hint</strong> (1 - lmstart + lmstop)<em> [</em><em>real </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>map</strong><em> [</em><em>mappings </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/dtbrms" title="f/rms/dtbrms"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbrms()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/rms_helpers/hintrms">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">rms_helpers/</span></span><span class="sig-name descname"><span class="pre">hintrms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">f</span></em>, <em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">lmstart</span></em>, <em class="sig-param"><span class="pre">lmstop</span></em>, <em class="sig-param"><span class="pre">f2hint</span></em>, <em class="sig-param"><span class="pre">map</span></em>, <em class="sig-param"><span class="pre">sphertor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/hintrms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lmstart</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lmstop</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>f2hint</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>map</strong><em> [</em><em>mappings </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sphertor</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/rms/compute_lm_forces" title="f/rms/compute_lm_forces"><code class="xref f f-func docutils literal notranslate"><span class="pre">compute_lm_forces()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/dtb_mod">
<span id="dtb-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">dtB.f90</span></code><a class="headerlink" href="#f/dtb_mod" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains magnetic field stretching and advection terms
plus a separate omega-effect.
It is used for movie output.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/dtb_mod/dtb_lmloc_container" title="f/dtb_mod/dtb_lmloc_container"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtb_lmloc_container</span></code></a>, <a class="reference internal" href="#f/dtb_mod/dtb_rloc_container" title="f/dtb_mod/dtb_rloc_container"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtb_rloc_container</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm" title="f/dtb_mod/padvlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">padvlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm_lmloc" title="f/dtb_mod/padvlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">padvlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm_rloc" title="f/dtb_mod/padvlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">padvlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlmic" title="f/dtb_mod/padvlmic"><code class="xref f f-var docutils literal notranslate"><span class="pre">padvlmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlmic_lmloc" title="f/dtb_mod/padvlmic_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">padvlmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm" title="f/dtb_mod/pdiflm"><code class="xref f f-var docutils literal notranslate"><span class="pre">pdiflm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm_lmloc" title="f/dtb_mod/pdiflm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">pdiflm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflmic" title="f/dtb_mod/pdiflmic"><code class="xref f f-var docutils literal notranslate"><span class="pre">pdiflmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflmic_lmloc" title="f/dtb_mod/pdiflmic_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">pdiflmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm" title="f/dtb_mod/pstrlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">pstrlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm_lmloc" title="f/dtb_mod/pstrlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">pstrlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm_rloc" title="f/dtb_mod/pstrlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">pstrlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm" title="f/dtb_mod/tadvlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm_lmloc" title="f/dtb_mod/tadvlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm_rloc" title="f/dtb_mod/tadvlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlmic" title="f/dtb_mod/tadvlmic"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvlmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlmic_lmloc" title="f/dtb_mod/tadvlmic_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvlmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvrlm_lmloc" title="f/dtb_mod/tadvrlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvrlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvrlm_rloc" title="f/dtb_mod/tadvrlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tadvrlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm" title="f/dtb_mod/tdiflm"><code class="xref f f-var docutils literal notranslate"><span class="pre">tdiflm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm_lmloc" title="f/dtb_mod/tdiflm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tdiflm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflmic" title="f/dtb_mod/tdiflmic"><code class="xref f f-var docutils literal notranslate"><span class="pre">tdiflmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflmic_lmloc" title="f/dtb_mod/tdiflmic_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tdiflmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm" title="f/dtb_mod/tomelm"><code class="xref f f-var docutils literal notranslate"><span class="pre">tomelm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm_lmloc" title="f/dtb_mod/tomelm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tomelm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm_rloc" title="f/dtb_mod/tomelm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tomelm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomerlm_lmloc" title="f/dtb_mod/tomerlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tomerlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomerlm_rloc" title="f/dtb_mod/tomerlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tomerlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm" title="f/dtb_mod/tstrlm"><code class="xref f f-var docutils literal notranslate"><span class="pre">tstrlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm_lmloc" title="f/dtb_mod/tstrlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tstrlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm_rloc" title="f/dtb_mod/tstrlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tstrlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrrlm_lmloc" title="f/dtb_mod/tstrrlm_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tstrrlm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrrlm_rloc" title="f/dtb_mod/tstrrlm_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">tstrrlm_rloc</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/dtb_mod/dtb_gather_lo_on_rank0" title="f/dtb_mod/dtb_gather_lo_on_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtb_gather_lo_on_rank0()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/finalize_dtb_mod" title="f/dtb_mod/finalize_dtb_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_dtb_mod()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dh_dtblm" title="f/dtb_mod/get_dh_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dh_dtblm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblmfinish()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/initialize_dtb_mod" title="f/dtb_mod/initialize_dtb_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_dtb_mod()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max_dtb" title="f/truncation/n_r_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max_dtb" title="f/truncation/n_r_ic_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_cheb_max" title="f/truncation/n_cheb_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_cheb_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/ldtbmem" title="f/truncation/ldtbmem"><code class="xref f f-func docutils literal notranslate"><span class="pre">ldtbmem()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_ic()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/mpi_transp_mod" title="f/mpi_transp_mod: This is an abstract class that will be used to define MPI transposers The actual implementation is deferred to either point-to-point (MPI_Isend and MPI_IRecv) communications or all-to-all (MPI_AlltoAll)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mpi_transp_mod</span></code></a> (<a class="reference internal" href="parallelModules.html#f/mpi_transp_mod/type_mpitransp" title="f/mpi_transp_mod/type_mpitransp"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_mpitransp()</span></code></a>): This is an abstract class that will be used to define MPI transposers The actual implementation is deferred to either point-to-point (MPI_Isend and MPI_IRecv) communications or all-to-all (MPI_AlltoAll)</p></li>
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">mpi_ptop_mod</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_mpiptop()</span></code>): This module contains the implementation of MPI_Isend/MPI_Irecv global transpose</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/opm" title="f/physical_parameters/opm"><code class="xref f f-func docutils literal notranslate"><span class="pre">opm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/o_sr" title="f/physical_parameters/o_sr"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sr()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/lambda" title="f/radial_functions/lambda"><code class="xref f f-func docutils literal notranslate"><span class="pre">lambda()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dllambda" title="f/radial_functions/dllambda"><code class="xref f f-func docutils literal notranslate"><span class="pre">dllambda()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or3" title="f/radial_functions/or3"><code class="xref f f-func docutils literal notranslate"><span class="pre">or3()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal notranslate"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_b" title="f/horizontal_data/hdif_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_b()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta_e2" title="f/horizontal_data/o_sin_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1s" title="f/horizontal_data/dtheta1s"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta1s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1a" title="f/horizontal_data/dtheta1a"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta1a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/cosn_theta_e2" title="f/horizontal_data/cosn_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">cosn_theta_e2()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtrmagspec" title="f/logic/l_dtrmagspec"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_dtrmagspec()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtbmovie" title="f/logic/l_dtbmovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_dtbmovie()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lms" title="f/blocking/lm2lms"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2lms()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lma" title="f/blocking/lm2lma"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2lma()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="#f/radial_spectra" title="f/radial_spectra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_spectra</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_sh" title="f/sht/scal_to_sh"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_sh()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sphertor" title="f/sht/spat_to_sphertor"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sphertor()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>): Radial derivatives functions</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/dtb_lmloc_container">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">dtb_lmloc_container</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/target/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/dtb_lmloc_container" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/dtb_rloc_container">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">dtb_rloc_container</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/target/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/dtb_rloc_container" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/padvlm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">padvlm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/padvlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/padvlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">padvlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/padvlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/padvlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">padvlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/padvlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/padvlmic">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">padvlmic</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/padvlmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/padvlmic_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">padvlmic_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/padvlmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pdiflm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pdiflm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pdiflm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pdiflm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pdiflm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pdiflm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pdiflmic">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pdiflmic</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pdiflmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pdiflmic_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pdiflmic_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pdiflmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pstrlm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pstrlm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pstrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pstrlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pstrlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pstrlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/pstrlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">pstrlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/pstrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvlm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvlm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvlmic">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvlmic</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvlmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvlmic_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvlmic_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvlmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvrlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvrlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvrlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tadvrlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tadvrlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tadvrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tdiflm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tdiflm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tdiflm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tdiflm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tdiflm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tdiflm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tdiflmic">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tdiflmic</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tdiflmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tdiflmic_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tdiflmic_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tdiflmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tomelm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tomelm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tomelm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tomelm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tomelm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tomelm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tomelm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tomelm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tomelm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tomerlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tomerlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tomerlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tomerlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tomerlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tomerlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tstrlm">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tstrlm</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tstrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tstrlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tstrlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tstrlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tstrlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tstrlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tstrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tstrrlm_lmloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tstrrlm_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">pointer/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tstrrlm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/dtb_mod/tstrrlm_rloc">
<span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">tstrrlm_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/pointer</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/dtb_mod/tstrrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/dtb_mod/initialize_dtb_mod">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_dtb_mod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/initialize_dtb_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory allocation</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_mod/finalize_dtb_mod">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_dtb_mod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/finalize_dtb_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory deallocation</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_mod/dtb_gather_lo_on_rank0">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">dtb_gather_lo_on_rank0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/dtb_gather_lo_on_rank0" title="Permalink to this definition">¶</a></dt>
<dd><p>MPI gather on rank0 for dtBmovie outputs.
This routine should really be suppressed once the movie
outputs have been improved</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblmfinish()</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_mod/get_dtblm">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">get_dtblm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">btvrlm</span></em>, <em class="sig-param"><span class="pre">bpvrlm</span></em>, <em class="sig-param"><span class="pre">brvtlm</span></em>, <em class="sig-param"><span class="pre">brvplm</span></em>, <em class="sig-param"><span class="pre">btvplm</span></em>, <em class="sig-param"><span class="pre">bpvtlm</span></em>, <em class="sig-param"><span class="pre">brvzlm</span></em>, <em class="sig-param"><span class="pre">btvzlm</span></em>, <em class="sig-param"><span class="pre">bpvtbtvpcotlm</span></em>, <em class="sig-param"><span class="pre">bpvtbtvpsn2lm</span></em>, <em class="sig-param"><span class="pre">btvzsn2lm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/get_dtblm" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine calculates non-linear products in grid-space for radial
level nR.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>btvrlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bpvrlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>brvtlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>brvplm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>btvplm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bpvtlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>brvzlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>btvzlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bpvtbtvpcotlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bpvtbtvpsn2lm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>btvzsn2lm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sphertor" title="f/sht/spat_to_sphertor"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sphertor()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_sh" title="f/sht/scal_to_sh"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_sh()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_mod/get_dh_dtblm">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">get_dh_dtblm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">btvrlm</span></em>, <em class="sig-param"><span class="pre">bpvrlm</span></em>, <em class="sig-param"><span class="pre">brvtlm</span></em>, <em class="sig-param"><span class="pre">brvplm</span></em>, <em class="sig-param"><span class="pre">btvplm</span></em>, <em class="sig-param"><span class="pre">bpvtlm</span></em>, <em class="sig-param"><span class="pre">brvzlm</span></em>, <em class="sig-param"><span class="pre">btvzlm</span></em>, <em class="sig-param"><span class="pre">bpvtbtvpcotlm</span></em>, <em class="sig-param"><span class="pre">bpvtbtvpsn2lm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/get_dh_dtblm" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this routine is to calculate theta and phi
derivative related terms of the magnetic production and
advection terms and store them.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>btvrlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bpvrlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>brvtlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>brvplm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>btvplm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bpvtlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>brvzlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>btvzlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bpvtbtvpcotlm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bpvtbtvpsn2lm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_mod/get_dtblmfinish">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_mod/</span></span><span class="sig-name descname"><span class="pre">get_dtblmfinish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">ddb_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em>, <em class="sig-param"><span class="pre">ddj_ic</span></em>, <em class="sig-param"><span class="pre">l_frame</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/get_dtblmfinish" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input of variables:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_frame</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="#f/radial_spectra/rbrspec" title="f/radial_spectra/rbrspec"><code class="xref f f-func docutils literal notranslate"><span class="pre">rbrspec()</span></code></a>, <a class="reference internal" href="#f/radial_spectra/rbpspec" title="f/radial_spectra/rbpspec"><code class="xref f f-func docutils literal notranslate"><span class="pre">rbpspec()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/dtb_gather_lo_on_rank0" title="f/dtb_mod/dtb_gather_lo_on_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtb_gather_lo_on_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/dtb_arrays_mod">
<span id="dtb-arrays-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">dtB_arrays.f90</span></code><a class="headerlink" href="#f/dtb_arrays_mod" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Types<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/dtb_arrays_mod/dtb_arrays_t" title="f/dtb_arrays_mod/dtb_arrays_t"><code class="xref f f-type docutils literal notranslate"><span class="pre">dtb_arrays_t</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max_dtb()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl>
<dt class="sig sig-object f" id="f/dtb_arrays_mod/dtb_arrays_t">
<em class="property"><span class="pre">type</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">dtb_arrays_t</span></span><a class="headerlink" href="#f/dtb_arrays_mod/dtb_arrays_t" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">bpvrlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">bpvtbtvpcotlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">bpvtbtvpsn2lm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">bpvtlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">brvplm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">brvtlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">brvzlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">btvplm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">btvrlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">btvzlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">btvzsn2lm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/dtb_arrays_mod/initialize">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">this</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_arrays_mod/initialize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real </em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_arrays_mod/finalize">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">this</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_arrays_mod/finalize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real </em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/dtb_arrays_mod/set_zero">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">dtb_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">set_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">this</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_arrays_mod/set_zero" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real </em><em>]</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/out_dtb_frame">
<span id="out-dtb-frame-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">out_dtB_frame.f90</span></code><a class="headerlink" href="#f/out_dtb_frame" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/out_dtb_frame/get_bpol" title="f/out_dtb_frame/get_bpol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bpol()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_btor" title="f/out_dtb_frame/get_btor"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_btor()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_dtb" title="f/out_dtb_frame/get_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtb()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/lm2pt" title="f/out_dtb_frame/lm2pt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2pt()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a>: This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic" title="f/radial_functions/chebt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_fac_ic" title="f/radial_functions/dr_fac_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_fac_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic_even" title="f/radial_functions/chebt_ic_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic_even()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="#f/dtb_mod/pstrlm" title="f/dtb_mod/pstrlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">pstrlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm" title="f/dtb_mod/padvlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">padvlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm" title="f/dtb_mod/pdiflm"><code class="xref f f-func docutils literal notranslate"><span class="pre">pdiflm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm" title="f/dtb_mod/tstrlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">tstrlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm" title="f/dtb_mod/tadvlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">tadvlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm" title="f/dtb_mod/tdiflm"><code class="xref f f-func docutils literal notranslate"><span class="pre">tdiflm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlmic" title="f/dtb_mod/padvlmic"><code class="xref f f-func docutils literal notranslate"><span class="pre">padvlmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflmic" title="f/dtb_mod/pdiflmic"><code class="xref f f-func docutils literal notranslate"><span class="pre">pdiflmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlmic" title="f/dtb_mod/tadvlmic"><code class="xref f f-func docutils literal notranslate"><span class="pre">tadvlmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm" title="f/dtb_mod/tomelm"><code class="xref f f-func docutils literal notranslate"><span class="pre">tomelm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflmic" title="f/dtb_mod/tdiflmic"><code class="xref f f-func docutils literal notranslate"><span class="pre">tdiflmic()</span></code></a>): This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output….</p></li>
<li><p><a class="reference internal" href="IOBinaryOutputs.html#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_type()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields_ic()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_file()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_const()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_surface()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/movie_const" title="f/movie_data/movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_const()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_type()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/ci" title="f/constants/ci"><code class="xref f f-func docutils literal notranslate"><span class="pre">ci()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der_even" title="f/radial_der_even"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der_even</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_drns_even()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/sphtor_to_spat" title="f/sht/sphtor_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">sphtor_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_spat" title="f/sht/scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/out_dtb_frame/write_dtb_frame">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_dtb_frame/</span></span><span class="sig-name descname"><span class="pre">write_dtb_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_movie</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/write_dtb_frame" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Controls output of specific movie frames related to magnetic field
production and diffusion.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_movie</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/write_movie_frame" title="f/out_movie/write_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_movie_frame()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/out_dtb_frame/get_dtb" title="f/out_dtb_frame/get_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtb()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_bpol" title="f/out_dtb_frame/get_bpol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bpol()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_btor" title="f/out_dtb_frame/get_btor"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_btor()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/lm2pt" title="f/out_dtb_frame/lm2pt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2pt()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_drns_even()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_dtb_frame/get_dtb">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_dtb_frame/</span></span><span class="sig-name descname"><span class="pre">get_dtb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtb</span></em>, <em class="sig-param"><span class="pre">dtblm</span></em>, <em class="sig-param"><span class="pre">dimb1</span></em>, <em class="sig-param"><span class="pre">dimb2</span></em>, <em class="sig-param"><span class="pre">n_r</span></em>, <em class="sig-param"><span class="pre">l_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/get_dtb" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtb</strong> (*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Result Field with dim&gt;=n_theta_block</p></li>
<li><p><strong>dtblm</strong> (dimb1,dimb2)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dimb1</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>dimb2</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p></li>
<li><p><strong>n_r</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</p></li>
<li><p><strong>l_ic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: =true if inner core field</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_dtb_frame/get_bpol">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_dtb_frame/</span></span><span class="sig-name descname"><span class="pre">get_bpol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pollm</span></em>, <em class="sig-param"><span class="pre">dpollm</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">rt</span></em>, <em class="sig-param"><span class="pre">lic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/get_bpol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the components
Br, Bt, and Bp of the poloidal magnetic field PolLM (l,m space)
at the radial grid point r=rT and the block of theta grid points
from n_theta=n_theta_start to n_theta=n_theta_start+n_theta_block-1
and for all phis.
For lIC=.true. the inner core field is calculated,
to get the IC field for a conducting inner core PolLM has to be
the poloidal field at the ICB.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pollm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</p></li>
<li><p><strong>dpollm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: dr field in (l,m)-space for rT</p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>rt</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: radius</p></li>
<li><p><strong>lic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: true for inner core, special rDep !</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_dtb_frame/get_btor">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_dtb_frame/</span></span><span class="sig-name descname"><span class="pre">get_btor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tlm</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">rt</span></em>, <em class="sig-param"><span class="pre">lic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/get_btor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the components
Bt and Bp of the toroidal magnetic field  Tlm (in l,m space)
at the radial grid point r=rT and the block of theta grid points
from n_theta=n_theta_start to n_theta=n_theta_start+n_theta_block-1
and for all phis.
For lIC=.true. the inner core field is calculated,
to get the IC field for a conducting inner core Plm has to be
the toroidal field at the ICB.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>rt</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: radius</p></li>
<li><p><strong>lic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: true for inner core, special rDep !</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/sphtor_to_spat" title="f/sht/sphtor_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">sphtor_to_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_dtb_frame/lm2pt">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_dtb_frame/</span></span><span class="sig-name descname"><span class="pre">lm2pt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">alm</span></em>, <em class="sig-param"><span class="pre">aij</span></em>, <em class="sig-param"><span class="pre">rt</span></em>, <em class="sig-param"><span class="pre">lic</span></em>, <em class="sig-param"><span class="pre">lrcomp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/lm2pt" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Spherical harmonic transform from alm(l,m) to aij(phi,theta)
Radial field components are calculated for lrComp=.true.
Done within the range [n_theta_min,n_theta_min+n_theta_block-1]
Used only for graphic output.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alm</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space</p></li>
<li><p><strong>aij</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: field in (theta,phi)-space</p></li>
<li><p><strong>rt</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: true for inner core, extra factor !</p></li>
<li><p><strong>lrcomp</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: true for radial field components</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_spat" title="f/sht/scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/torsional_oscillations">
<span id="to-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">TO.f90</span></code><a class="headerlink" href="#f/torsional_oscillations" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains information for TO calculation and output</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/torsional_oscillations/bplast" title="f/torsional_oscillations/bplast"><code class="xref f f-var docutils literal notranslate"><span class="pre">bplast</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpsdas_rloc" title="f/torsional_oscillations/bpsdas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bpsdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzas_rloc" title="f/torsional_oscillations/bpzas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bpzas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzdas_rloc" title="f/torsional_oscillations/bpzdas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bpzdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bs2as_rloc" title="f/torsional_oscillations/bs2as_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bs2as_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bslast" title="f/torsional_oscillations/bslast"><code class="xref f f-var docutils literal notranslate"><span class="pre">bslast</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspas_rloc" title="f/torsional_oscillations/bspas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bspas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspdas_rloc" title="f/torsional_oscillations/bspdas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bspdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bszas_rloc" title="f/torsional_oscillations/bszas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bszas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bzlast" title="f/torsional_oscillations/bzlast"><code class="xref f f-var docutils literal notranslate"><span class="pre">bzlast</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bzpdas_rloc" title="f/torsional_oscillations/bzpdas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">bzpdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/ddzasl" title="f/torsional_oscillations/ddzasl"><code class="xref f f-var docutils literal notranslate"><span class="pre">ddzasl</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzasl" title="f/torsional_oscillations/dzasl"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzasl</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzastras_rloc" title="f/torsional_oscillations/dzastras_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzastras_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzcoras_rloc" title="f/torsional_oscillations/dzcoras_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzcoras_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzddvpas_rloc" title="f/torsional_oscillations/dzddvpas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzddvpas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzddvplmr" title="f/torsional_oscillations/dzddvplmr"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzddvplmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzdvpas_rloc" title="f/torsional_oscillations/dzdvpas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzdvpas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzdvplmr" title="f/torsional_oscillations/dzdvplmr"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzdvplmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzlfas_rloc" title="f/torsional_oscillations/dzlfas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzlfas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzrstras_rloc" title="f/torsional_oscillations/dzrstras_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzrstras_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzstras_rloc" title="f/torsional_oscillations/dzstras_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzstras_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/v2as_rloc" title="f/torsional_oscillations/v2as_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">v2as_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/vas_rloc" title="f/torsional_oscillations/vas_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">vas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/zasl" title="f/torsional_oscillations/zasl"><code class="xref f f-var docutils literal notranslate"><span class="pre">zasl</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/torsional_oscillations/finalize_to" title="f/torsional_oscillations/finalize_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_to()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/get_pas" title="f/torsional_oscillations/get_pas"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal notranslate"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/gettofinish" title="f/torsional_oscillations/gettofinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">gettofinish()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/gettonext" title="f/torsional_oscillations/gettonext"><code class="xref f f-func docutils literal notranslate"><span class="pre">gettonext()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/initialize_to" title="f/torsional_oscillations/initialize_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_to()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/prep_to_axi" title="f/torsional_oscillations/prep_to_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">prep_to_axi()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">iso_fortran_env</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">output_unit()</span></code>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxstr" title="f/truncation/n_r_maxstr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or3" title="f/radial_functions/or3"><code class="xref f f-func docutils literal notranslate"><span class="pre">or3()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal notranslate"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">corfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1a" title="f/horizontal_data/dtheta1a"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta1a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1s" title="f/horizontal_data/dtheta1s"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta1s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal notranslate"><span class="pre">lverbose()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sh_axi" title="f/sht/spat_to_sh_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sh_axi()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bplast">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bplast</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bplast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bpsdas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bpsdas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bpsdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bpzas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bpzas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bpzas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bpzdas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bpzdas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bpzdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bs2as_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bs2as_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bs2as_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bslast">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bslast</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bslast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bspas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bspas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bspas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bspdas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bspdas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bspdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bszas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bszas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bszas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bzlast">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bzlast</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bzlast" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/bzpdas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">bzpdas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/bzpdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/ddzasl">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">ddzasl</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/ddzasl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzasl">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzasl</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzasl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzastras_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzastras_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzastras_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzcoras_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzcoras_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzcoras_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzddvpas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzddvpas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzddvpas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzddvplmr">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzddvplmr</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzddvplmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzdvpas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzdvpas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzdvpas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzdvplmr">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzdvplmr</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzdvplmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzlfas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzlfas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzlfas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzrstras_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzrstras_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzrstras_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/dzstras_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">dzstras_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/dzstras_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/v2as_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">v2as_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/v2as_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/vas_rloc">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">vas_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/vas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/torsional_oscillations/zasl">
<span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">zasl</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/torsional_oscillations/zasl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/initialize_to">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">initialize_to</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/initialize_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the memory needed</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/finalize_to">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">finalize_to</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/finalize_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Deallocate the memory</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/prep_to_axi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">prep_to_axi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dz</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/prep_to_axi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dz</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/getto">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">getto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">cvr</span></em>, <em class="sig-param"><span class="pre">dvpdr</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">cbr</span></em>, <em class="sig-param"><span class="pre">cbt</span></em>, <em class="sig-param"><span class="pre">dzrstrlm</span></em>, <em class="sig-param"><span class="pre">dzastrlm</span></em>, <em class="sig-param"><span class="pre">dzcorlm</span></em>, <em class="sig-param"><span class="pre">dzlflm</span></em>, <em class="sig-param"><span class="pre">dtlast</span></em>, <em class="sig-param"><span class="pre">nr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/getto" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This program calculates various axisymmetric linear
and nonlinear variables for a radial grid point nR and
a theta-block.
Input are the fields vr,vt,vp,cvr,dvpdr
Output are linear azimuthally averaged  field VpAS (flow phi component),
VpAS2 (square of flow phi component), V2AS (V*V),
and Coriolis force Cor. These are give in (r,theta)-space.
Also in (r,theta)-space are azimuthally averaged correlations of
non-axisymmetric flow components and the respective squares:
Vsp=Vs*Vp,Vzp,Vsz,VspC,VzpC,VszC. These are used to calulcate
the respective correlations and Reynolds stress.
In addition three output field are given in (lm,r) space:
dzRstrLMr,dzAstrLMr,dzCorLM,dzLFLM.</p>
<p>These are used to calculate the total Reynolds stress,
advection and viscous stress later. Their calculation
retraces the calculations done in the time-stepping part
of the code.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cvr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvpdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cbr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cbt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzrstrlm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzastrlm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzcorlm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzlflm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dtlast</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: last time step</p></li>
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial grid point</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sh_axi" title="f/sht/spat_to_sh_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sh_axi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/gettonext">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">gettonext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">ltonext</span></em>, <em class="sig-param"><span class="pre">ltonext2</span></em>, <em class="sig-param"><span class="pre">dt</span></em>, <em class="sig-param"><span class="pre">dtlast</span></em>, <em class="sig-param"><span class="pre">nr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/gettonext" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Preparing TO calculation by storing flow and magnetic field
contribution to build time derivative.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ltonext</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ltonext2</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dt</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dtlast</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/gettofinish">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">gettofinish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">dtlast</span></em>, <em class="sig-param"><span class="pre">dzrstrlm</span></em>, <em class="sig-param"><span class="pre">dzastrlm</span></em>, <em class="sig-param"><span class="pre">dzcorlm</span></em>, <em class="sig-param"><span class="pre">dzlflm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/gettofinish" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This program was previously part of getTO(…)
It has now been separated to get it out of the theta-block loop.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dtlast</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzrstrlm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzastrlm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzcorlm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dzlflm</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/torsional_oscillations/get_pas" title="f/torsional_oscillations/get_pas"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pas()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/torsional_oscillations/get_pas">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">torsional_oscillations/</span></span><span class="sig-name descname"><span class="pre">get_pas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tlm</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">nr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/get_pas" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the axisymmetric
component Bp of an axisymmetric toroidal field Tlm
given in spherical harmonic space (1:lmax+1).
Unscrambling of theta is also ensured</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tlm</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</p></li>
<li><p><strong>bp</strong> (*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/torsional_oscillations/gettofinish" title="f/torsional_oscillations/gettofinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">gettofinish()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/to_arrays_mod">
<span id="to-arrays-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">TO_arrays.f90</span></code><a class="headerlink" href="#f/to_arrays_mod" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Types<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/to_arrays_mod/to_arrays_t" title="f/to_arrays_mod/to_arrays_t"><code class="xref f f-type docutils literal notranslate"><span class="pre">to_arrays_t</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl>
<dt class="sig sig-object f" id="f/to_arrays_mod/to_arrays_t">
<em class="property"><span class="pre">type</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">to_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">to_arrays_t</span></span><a class="headerlink" href="#f/to_arrays_mod/to_arrays_t" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">dzastrlm</span> (*)<em> [</em><em>real </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">dzcorlm</span> (*)<em> [</em><em>real </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">dzlflm</span> (*)<em> [</em><em>real </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">dzrstrlm</span> (*)<em> [</em><em>real </em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/to_arrays_mod/initialize">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">to_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">this</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/to_arrays_mod/initialize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real </em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/to_arrays_mod/finalize">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">to_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">this</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/to_arrays_mod/finalize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real </em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/to_arrays_mod/set_zero">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">to_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">set_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">this</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/to_arrays_mod/set_zero" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>this</strong><em> [</em><em>real </em><em>]</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/outto_mod">
<span id="out-to-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">out_TO.f90</span></code><a class="headerlink" href="#f/outto_mod" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the writing of TO-related outputs: zonal force balance and
z-integrated terms. This is a re-implementation of the spectral method used up
to MagIC 5.10, which formerly relies on calculation of Plm on the cylindrical grid.
This was quite costly and not portable on large truncations. As such, a local
4th order method is preferred here.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/outto_mod/bpsdas" title="f/outto_mod/bpsdas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bpsdas</span></code></a>, <a class="reference internal" href="#f/outto_mod/bpzas" title="f/outto_mod/bpzas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bpzas</span></code></a>, <a class="reference internal" href="#f/outto_mod/bpzdas" title="f/outto_mod/bpzdas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bpzdas</span></code></a>, <a class="reference internal" href="#f/outto_mod/bs2as" title="f/outto_mod/bs2as"><code class="xref f f-var docutils literal notranslate"><span class="pre">bs2as</span></code></a>, <a class="reference internal" href="#f/outto_mod/bspas" title="f/outto_mod/bspas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bspas</span></code></a>, <a class="reference internal" href="#f/outto_mod/bspdas" title="f/outto_mod/bspdas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bspdas</span></code></a>, <a class="reference internal" href="#f/outto_mod/bszas" title="f/outto_mod/bszas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bszas</span></code></a>, <a class="reference internal" href="#f/outto_mod/bzpdas" title="f/outto_mod/bzpdas"><code class="xref f f-var docutils literal notranslate"><span class="pre">bzpdas</span></code></a>, <a class="reference internal" href="#f/outto_mod/cyl" title="f/outto_mod/cyl"><code class="xref f f-var docutils literal notranslate"><span class="pre">cyl</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzastras" title="f/outto_mod/dzastras"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzastras</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzcoras" title="f/outto_mod/dzcoras"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzcoras</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzddvpas" title="f/outto_mod/dzddvpas"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzddvpas</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzdvpas" title="f/outto_mod/dzdvpas"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzdvpas</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzlfas" title="f/outto_mod/dzlfas"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzlfas</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzrstras" title="f/outto_mod/dzrstras"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzrstras</span></code></a>, <a class="reference internal" href="#f/outto_mod/dzstras" title="f/outto_mod/dzstras"><code class="xref f f-var docutils literal notranslate"><span class="pre">dzstras</span></code></a>, <a class="reference internal" href="#f/outto_mod/h" title="f/outto_mod/h"><code class="xref f f-var docutils literal notranslate"><span class="pre">h</span></code></a>, <a class="reference internal" href="#f/outto_mod/movfile" title="f/outto_mod/movfile"><code class="xref f f-var docutils literal notranslate"><span class="pre">movfile</span></code></a>, <a class="reference internal" href="#f/outto_mod/n_nhs_file" title="f/outto_mod/n_nhs_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_nhs_file</span></code></a>, <a class="reference internal" href="#f/outto_mod/n_s_max" title="f/outto_mod/n_s_max"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_s_max</span></code></a>, <a class="reference internal" href="#f/outto_mod/n_s_otc" title="f/outto_mod/n_s_otc"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_s_otc</span></code></a>, <a class="reference internal" href="#f/outto_mod/n_shs_file" title="f/outto_mod/n_shs_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_shs_file</span></code></a>, <a class="reference internal" href="#f/outto_mod/n_to_file" title="f/outto_mod/n_to_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_to_file</span></code></a>, <a class="reference internal" href="#f/outto_mod/n_tomov_file" title="f/outto_mod/n_tomov_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_tomov_file</span></code></a>, <a class="reference internal" href="#f/outto_mod/ntomovsets" title="f/outto_mod/ntomovsets"><code class="xref f f-var docutils literal notranslate"><span class="pre">ntomovsets</span></code></a>, <a class="reference internal" href="#f/outto_mod/oh" title="f/outto_mod/oh"><code class="xref f f-var docutils literal notranslate"><span class="pre">oh</span></code></a>, <a class="reference internal" href="#f/outto_mod/tofile" title="f/outto_mod/tofile"><code class="xref f f-var docutils literal notranslate"><span class="pre">tofile</span></code></a>, <a class="reference internal" href="#f/outto_mod/v2as" title="f/outto_mod/v2as"><code class="xref f f-var docutils literal notranslate"><span class="pre">v2as</span></code></a>, <a class="reference internal" href="#f/outto_mod/vas" title="f/outto_mod/vas"><code class="xref f f-var docutils literal notranslate"><span class="pre">vas</span></code></a>, <a class="reference internal" href="#f/outto_mod/volcyl_oc" title="f/outto_mod/volcyl_oc"><code class="xref f f-var docutils literal notranslate"><span class="pre">volcyl_oc</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/outto_mod/cylmean" title="f/outto_mod/cylmean"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean()</span></code></a>, <a class="reference internal" href="#f/outto_mod/finalize_outto_mod" title="f/outto_mod/finalize_outto_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_outto_mod()</span></code></a>, <a class="reference internal" href="#f/outto_mod/gather_from_rloc_to_rank0" title="f/outto_mod/gather_from_rloc_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_rloc_to_rank0()</span></code></a>, <a class="reference internal" href="#f/outto_mod/get_dds" title="f/outto_mod/get_dds"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dds()</span></code></a>, <a class="reference internal" href="#f/outto_mod/get_ds" title="f/outto_mod/get_ds"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ds()</span></code></a>, <a class="reference internal" href="#f/outto_mod/initialize_outto_mod" title="f/outto_mod/initialize_outto_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_outto_mod()</span></code></a>, <a class="reference internal" href="#f/outto_mod/interp_theta" title="f/outto_mod/interp_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">interp_theta()</span></code></a>, <a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_oc()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/sdens" title="f/output_data/sdens"><code class="xref f f-func docutils literal notranslate"><span class="pre">sdens()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/zdens" title="f/output_data/zdens"><code class="xref f f-func docutils literal notranslate"><span class="pre">zdens()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal notranslate"><span class="pre">runid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/radial_balance" title="f/radial_data/radial_balance"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial_balance()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_tomovie" title="f/logic/l_tomovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_tomovie()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">lffac()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal notranslate"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="#f/torsional_oscillations/dzcoras_rloc" title="f/torsional_oscillations/dzcoras_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzcoras_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzdvpas_rloc" title="f/torsional_oscillations/dzdvpas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzdvpas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzddvpas_rloc" title="f/torsional_oscillations/dzddvpas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzddvpas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzrstras_rloc" title="f/torsional_oscillations/dzrstras_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzrstras_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzastras_rloc" title="f/torsional_oscillations/dzastras_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzastras_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzstras_rloc" title="f/torsional_oscillations/dzstras_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzstras_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzlfas_rloc" title="f/torsional_oscillations/dzlfas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzlfas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/v2as_rloc" title="f/torsional_oscillations/v2as_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">v2as_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bs2as_rloc" title="f/torsional_oscillations/bs2as_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bs2as_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspdas_rloc" title="f/torsional_oscillations/bspdas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bspdas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpsdas_rloc" title="f/torsional_oscillations/bpsdas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpsdas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bzpdas_rloc" title="f/torsional_oscillations/bzpdas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bzpdas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzdas_rloc" title="f/torsional_oscillations/bpzdas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpzdas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzas_rloc" title="f/torsional_oscillations/bpzas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpzas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspas_rloc" title="f/torsional_oscillations/bspas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bspas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bszas_rloc" title="f/torsional_oscillations/bszas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">bszas_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/vas_rloc" title="f/torsional_oscillations/vas_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">vas_rloc()</span></code></a>): This module contains information for TO calculation and output</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">logwrite()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/cylmean_otc" title="f/integration/cylmean_otc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_otc()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_itc" title="f/integration/cylmean_itc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_itc()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/simps" title="f/integration/simps"><code class="xref f f-func docutils literal notranslate"><span class="pre">simps()</span></code></a>): Radial integration functions</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bpsdas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bpsdas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bpsdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bpzas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bpzas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bpzas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bpzdas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bpzdas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bpzdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bs2as">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bs2as</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bs2as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bspas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bspas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bspas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bspdas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bspdas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bspdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bszas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bszas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bszas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/bzpdas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">bzpdas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/bzpdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/cyl">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">cyl</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/cyl" title="Permalink to this definition">¶</a></dt>
<dd><p>Cylindrical grid</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzastras">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzastras</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzastras" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzcoras">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzcoras</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzcoras" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzddvpas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzddvpas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzddvpas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzdvpas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzdvpas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzdvpas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzlfas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzlfas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzlfas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzrstras">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzrstras</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzrstras" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/dzstras">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">dzstras</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/dzstras" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/h">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">h</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/h" title="Permalink to this definition">¶</a></dt>
<dd><p>height</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/movfile">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">movfile</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=64)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/movfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/n_nhs_file">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">n_nhs_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/n_nhs_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/n_s_max">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">n_s_max</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/n_s_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/n_s_otc">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">n_s_otc</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/n_s_otc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/n_shs_file">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">n_shs_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/n_shs_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/n_to_file">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">n_to_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/n_to_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/n_tomov_file">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">n_tomov_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/n_tomov_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/ntomovsets">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">ntomovsets</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/ntomovsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of TO_mov frames</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/oh">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">oh</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/oh" title="Permalink to this definition">¶</a></dt>
<dd><p>1/h</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/tofile">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">tofile</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=64)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/tofile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/v2as">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">v2as</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/v2as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/vas">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">vas</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/vas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/outto_mod/volcyl_oc">
<span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">volcyl_oc</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/outto_mod/volcyl_oc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/outto_mod/initialize_outto_mod">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_outto_mod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/initialize_outto_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory allocation of arrays needed for TO outputs</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="derInt.html#f/integration/simps" title="f/integration/simps"><code class="xref f f-func docutils literal notranslate"><span class="pre">simps()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/finalize_outto_mod">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_outto_mod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/finalize_outto_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory de-allocation of arrays needed for TO outputs</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/outto">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">outto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">n_time_step</span></em>, <em class="sig-param"><span class="pre">ekin</span></em>, <em class="sig-param"><span class="pre">ekintas</span></em>, <em class="sig-param"><span class="pre">ltomov</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/outto" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Output of axisymmetric zonal flow, its relative strength,
its time variation, and all forces acting on it.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: time</p></li>
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: Iteration number</p></li>
<li><p><strong>ekin</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Kinetic energy</p></li>
<li><p><strong>ekintas</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Toroidal axisymmetric energy</p></li>
<li><p><strong>ltomov</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Do we need to store the movie files as well</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/outto_mod/gather_from_rloc_to_rank0" title="f/outto_mod/gather_from_rloc_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_rloc_to_rank0()</span></code></a>, <a class="reference internal" href="#f/outto_mod/cylmean" title="f/outto_mod/cylmean"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean()</span></code></a>, <a class="reference internal" href="#f/outto_mod/interp_theta" title="f/outto_mod/interp_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">interp_theta()</span></code></a>, <a class="reference internal" href="#f/outto_mod/get_ds" title="f/outto_mod/get_ds"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ds()</span></code></a>, <a class="reference internal" href="#f/outto_mod/get_dds" title="f/outto_mod/get_dds"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dds()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/simps" title="f/integration/simps"><code class="xref f f-func docutils literal notranslate"><span class="pre">simps()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">logwrite()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/cylmean">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">cylmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dat</span></em>, <em class="sig-param"><span class="pre">datn</span></em>, <em class="sig-param"><span class="pre">dats</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/cylmean" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine computes the z-average inside and outside TC</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: input data</p></li>
<li><p><strong>datn</strong> (<a class="reference internal" href="#f/outto_mod/n_s_max" title="f/outto_mod/n_s_max">n_s_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: z-average outside T.C. + N.H.</p></li>
<li><p><strong>dats</strong> (<a class="reference internal" href="#f/outto_mod/n_s_max" title="f/outto_mod/n_s_max">n_s_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: z-average outside T.C. + S.H.</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/geos/outgeos" title="f/geos/outgeos"><code class="xref f f-func docutils literal notranslate"><span class="pre">outgeos()</span></code></a>, <a class="reference internal" href="#f/geos/write_geos_frame" title="f/geos/write_geos_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_geos_frame()</span></code></a>, <a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/integration/cylmean_otc" title="f/integration/cylmean_otc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_otc()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_itc" title="f/integration/cylmean_itc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_itc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/interp_theta">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">interp_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">a</span></em>, <em class="sig-param"><span class="pre">ac</span></em>, <em class="sig-param"><span class="pre">rr</span></em>, <em class="sig-param"><span class="pre">cyl</span></em>, <em class="sig-param"><span class="pre">theta</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/interp_theta" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine computes the interpolation of a value at the surface of a
spherical shell onto the cylindrical grid. This is only a theta interpolation
using the cylindrical theta’s.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Field at the outer radius</p></li>
<li><p><strong>ac</strong> (2)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Surface values for NH and SH as a function of s</p></li>
<li><p><strong>rr</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Radius at which we compute the extrapolation (can be ri or ro)</p></li>
<li><p><strong>cyl</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Cylindrical radius</p></li>
<li><p><strong>theta</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Colatitude</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/get_ds">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">get_ds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">arr</span></em>, <em class="sig-param"><span class="pre">darr</span></em>, <em class="sig-param"><span class="pre">cyl</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/get_ds" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to compute the 4th order accurate first s-derivative
on the regularly spaced grid</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Array to be differentiated</p></li>
<li><p><strong>darr</strong> (*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: s-derivative of the input array</p></li>
<li><p><strong>cyl</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Cylindrical grid</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/get_dds">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">get_dds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">arr</span></em>, <em class="sig-param"><span class="pre">ddarr</span></em>, <em class="sig-param"><span class="pre">cyl</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/get_dds" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to compute the 4th order accurate 2nd s-derivative
on the regularly spaced grid</p>
<p><a class="reference external" href="https://bellaard.com/tools/Finite%20difference%20coefficient%20calculator/">https://bellaard.com/tools/Finite%20difference%20coefficient%20calculator/</a></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Array to be differentiated</p></li>
<li><p><strong>ddarr</strong> (*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: s-derivative of the input array</p></li>
<li><p><strong>cyl</strong> (*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Cylindrical grid</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/outto_mod/gather_from_rloc_to_rank0">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">outto_mod/</span></span><span class="sig-name descname"><span class="pre">gather_from_rloc_to_rank0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">arr_rloc</span></em>, <em class="sig-param"><span class="pre">arr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/gather_from_rloc_to_rank0" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine gathers the r-distributed array</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max">n_theta_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>arr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max">n_theta_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal notranslate"><span class="pre">outto()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/radial_spectra">
<span id="radial-spectra-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">radial_spectra.f90</span></code><a class="headerlink" href="#f/radial_spectra" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/radial_spectra/filehandle" title="f/radial_spectra/filehandle"><code class="xref f f-var docutils literal notranslate"><span class="pre">filehandle</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/radial_spectra/rbpspec" title="f/radial_spectra/rbpspec"><code class="xref f f-func docutils literal notranslate"><span class="pre">rbpspec()</span></code></a>, <a class="reference internal" href="#f/radial_spectra/rbrspec" title="f/radial_spectra/rbrspec"><code class="xref f f-func docutils literal notranslate"><span class="pre">rbrspec()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/reduce_radial" title="f/communications/reduce_radial"><code class="xref f f-func docutils literal notranslate"><span class="pre">reduce_radial()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/escale" title="f/num_param/escale"><code class="xref f f-func docutils literal notranslate"><span class="pre">escale()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/lmmapping" title="f/lmmapping"><code class="xref f f-mod docutils literal notranslate"><span class="pre">lmmapping</span></code></a> (<a class="reference internal" href="blocking.html#f/lmmapping/mappings" title="f/lmmapping/mappings"><code class="xref f f-func docutils literal notranslate"><span class="pre">mappings()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/radial_spectra/filehandle">
<span class="sig-prename descclassname"><span class="pre">radial_spectra/</span></span><span class="sig-name descname"><span class="pre">filehandle</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/radial_spectra/filehandle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/radial_spectra/rbrspec">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">radial_spectra/</span></span><span class="sig-name descname"><span class="pre">rbrspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">pol</span></em>, <em class="sig-param"><span class="pre">polic</span></em>, <em class="sig-param"><span class="pre">fileroot</span></em>, <em class="sig-param"><span class="pre">lic</span></em>, <em class="sig-param"><span class="pre">map</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/radial_spectra/rbrspec" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>pol</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>polic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>fileroot</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>map</strong><em> [</em><em>mappings </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblmfinish()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/radial_spectra/rbpspec">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">radial_spectra/</span></span><span class="sig-name descname"><span class="pre">rbpspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tor</span></em>, <em class="sig-param"><span class="pre">toric</span></em>, <em class="sig-param"><span class="pre">fileroot</span></em>, <em class="sig-param"><span class="pre">lic</span></em>, <em class="sig-param"><span class="pre">map</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/radial_spectra/rbpspec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Called from rank0, map gives the lm order of Tor and TorIC</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tor</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>toric</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>fileroot</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>map</strong><em> [</em><em>mappings </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblmfinish()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal notranslate"><span class="pre">cc2real()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/geos">
<span id="outgeos-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">outGeos.f90</span></code><a class="headerlink" href="#f/geos" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>This module is used to compute z-integrated diagnostics such as the degree
of geostrophy or the separation of energies between inside and outside the
tangent cylinder. This makes use of a local Simpson’s method. This also
handles the computation of the z-average profile of rotation when a Couette
flow setup is used</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/geos/geos_file" title="f/geos/geos_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">geos_file</span></code></a>, <a class="reference internal" href="#f/geos/n_geos_file" title="f/geos/n_geos_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_geos_file</span></code></a>, <a class="reference internal" href="#f/geos/npstart" title="f/geos/npstart"><code class="xref f f-var docutils literal notranslate"><span class="pre">npstart</span></code></a>, <a class="reference internal" href="#f/geos/npstop" title="f/geos/npstop"><code class="xref f f-var docutils literal notranslate"><span class="pre">npstop</span></code></a>, <a class="reference internal" href="#f/geos/phi_balance" title="f/geos/phi_balance"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi_balance</span></code></a>, <a class="reference internal" href="#f/geos/up_ploc" title="f/geos/up_ploc"><code class="xref f f-var docutils literal notranslate"><span class="pre">up_ploc</span></code></a>, <a class="reference internal" href="#f/geos/up_rloc" title="f/geos/up_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">up_rloc</span></code></a>, <a class="reference internal" href="#f/geos/us_ploc" title="f/geos/us_ploc"><code class="xref f f-var docutils literal notranslate"><span class="pre">us_ploc</span></code></a>, <a class="reference internal" href="#f/geos/us_rloc" title="f/geos/us_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">us_rloc</span></code></a>, <a class="reference internal" href="#f/geos/uz_ploc" title="f/geos/uz_ploc"><code class="xref f f-var docutils literal notranslate"><span class="pre">uz_ploc</span></code></a>, <a class="reference internal" href="#f/geos/uz_rloc" title="f/geos/uz_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">uz_rloc</span></code></a>, <a class="reference internal" href="#f/geos/vol_otc" title="f/geos/vol_otc"><code class="xref f f-var docutils literal notranslate"><span class="pre">vol_otc</span></code></a>, <a class="reference internal" href="#f/geos/wz_ploc" title="f/geos/wz_ploc"><code class="xref f f-var docutils literal notranslate"><span class="pre">wz_ploc</span></code></a>, <a class="reference internal" href="#f/geos/wz_rloc" title="f/geos/wz_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">wz_rloc</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/geos/calcgeos" title="f/geos/calcgeos"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcgeos()</span></code></a>, <a class="reference internal" href="#f/geos/finalize_geos" title="f/geos/finalize_geos"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_geos()</span></code></a>, <a class="reference internal" href="#f/geos/gather_ploc" title="f/geos/gather_ploc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_ploc()</span></code></a>, <a class="reference internal" href="#f/geos/initialize_geos" title="f/geos/initialize_geos"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_geos()</span></code></a>, <a class="reference internal" href="#f/geos/outgeos" title="f/geos/outgeos"><code class="xref f f-func docutils literal notranslate"><span class="pre">outgeos()</span></code></a>, <a class="reference internal" href="#f/geos/outomega" title="f/geos/outomega"><code class="xref f f-func docutils literal notranslate"><span class="pre">outomega()</span></code></a>, <a class="reference internal" href="#f/geos/transp_r2phi" title="f/geos/transp_r2phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">transp_r2phi()</span></code></a>, <a class="reference internal" href="#f/geos/write_geos_frame" title="f/geos/write_geos_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_geos_frame()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/radial_balance" title="f/radial_data/radial_balance"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial_balance()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho2" title="f/radial_functions/orho2"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/sdens" title="f/output_data/sdens"><code class="xref f f-func docutils literal notranslate"><span class="pre">sdens()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/zdens" title="f/output_data/zdens"><code class="xref f f-func docutils literal notranslate"><span class="pre">zdens()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta_e2" title="f/horizontal_data/o_sin_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="IOBinaryOutputs.html#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_type()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_file()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/simps" title="f/integration/simps"><code class="xref f f-func docutils literal notranslate"><span class="pre">simps()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_otc" title="f/integration/cylmean_otc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_otc()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_itc" title="f/integration/cylmean_itc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_itc()</span></code></a>): Radial integration functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/cyl">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">cyl</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/cyl" title="Permalink to this definition">¶</a></dt>
<dd><p>Cylindrical grid</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/geos_file">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">geos_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/geos_file" title="Permalink to this definition">¶</a></dt>
<dd><p>file name</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/h">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">h</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/h" title="Permalink to this definition">¶</a></dt>
<dd><p>h(s)</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/n_geos_file">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">n_geos_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/n_geos_file" title="Permalink to this definition">¶</a></dt>
<dd><p>file unit for geos.TAG</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/n_s_max">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">n_s_max</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/n_s_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of cylindrical points</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/n_s_otc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">n_s_otc</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/n_s_otc" title="Permalink to this definition">¶</a></dt>
<dd><p>Index for last point outside TC</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/npstart">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">npstart</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/npstart" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting nPhi index when MPI distributed</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/npstop">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">npstop</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/npstop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stoping nPhi index when MPI distributed</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/phi_balance">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">phi_balance</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><a class="reference internal" href="parallelModules.html#f/parallel_mod/load" title="f/parallel_mod/load"><em><span class="pre">load</span></em></a><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/phi_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>phi-distributed balance</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/up_ploc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">up_ploc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/up_ploc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/up_rloc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">up_rloc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/up_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/us_ploc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">us_ploc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/us_ploc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/us_rloc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">us_rloc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/us_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/uz_ploc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">uz_ploc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/uz_ploc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/uz_rloc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">uz_rloc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/uz_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/vol_otc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">vol_otc</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/vol_otc" title="Permalink to this definition">¶</a></dt>
<dd><p>volume outside tangent cylinder</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/wz_ploc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">wz_ploc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/wz_ploc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/geos/wz_rloc">
<span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">wz_rloc</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/geos/wz_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/geos/initialize_geos">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">initialize_geos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">l_geos</span></em>, <em class="sig-param"><span class="pre">l_sric</span></em>, <em class="sig-param"><span class="pre">l_geosmovie</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/initialize_geos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Memory allocation and definition of the cylindrical grid</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_geos</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Do we need the geos outputs</p></li>
<li><p><strong>l_sric</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Is the inner core rotating</p></li>
<li><p><strong>l_geosmovie</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Geos movie</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/getblocks" title="f/parallel_mod/getblocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">getblocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/simps" title="f/integration/simps"><code class="xref f f-func docutils literal notranslate"><span class="pre">simps()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/finalize_geos">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">finalize_geos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">l_geos</span></em>, <em class="sig-param"><span class="pre">l_sric</span></em>, <em class="sig-param"><span class="pre">l_geosmovie</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/finalize_geos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Memory deallocation</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_geos</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Do we need the geos outputs</p></li>
<li><p><strong>l_sric</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Is the inner core rotating?</p></li>
<li><p><strong>l_geosmovie</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: Do we have geos movies?</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/calcgeos">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">calcgeos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">cvr</span></em>, <em class="sig-param"><span class="pre">dvrdp</span></em>, <em class="sig-param"><span class="pre">dvpdr</span></em>, <em class="sig-param"><span class="pre">nr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/calcgeos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine computes the term needed for geos.TAG outputs in physical
space.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cvr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvpdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: Radial grid point</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/outgeos">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">outgeos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">geos</span></em>, <em class="sig-param"><span class="pre">geosa</span></em>, <em class="sig-param"><span class="pre">geosz</span></em>, <em class="sig-param"><span class="pre">geosm</span></em>, <em class="sig-param"><span class="pre">geosnap</span></em>, <em class="sig-param"><span class="pre">ekin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/outgeos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine handles the output of geos.TAG</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>geos</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>geosa</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>geosz</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>geosm</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>geosnap</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ekin</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/geos/transp_r2phi" title="f/geos/transp_r2phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">transp_r2phi()</span></code></a>, <a class="reference internal" href="#f/outto_mod/cylmean" title="f/outto_mod/cylmean"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/simps" title="f/integration/simps"><code class="xref f f-func docutils literal notranslate"><span class="pre">simps()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_otc" title="f/integration/cylmean_otc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_otc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/write_geos_frame">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">write_geos_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_movie</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/write_geos_frame" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the computation and the writing of geos movie
files.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_movie</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: The index of the movie in list of movies</p>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/write_movie_frame" title="f/out_movie/write_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_movie_frame()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/geos/transp_r2phi" title="f/geos/transp_r2phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">transp_r2phi()</span></code></a>, <a class="reference internal" href="#f/outto_mod/cylmean" title="f/outto_mod/cylmean"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean()</span></code></a>, <a class="reference internal" href="#f/geos/gather_ploc" title="f/geos/gather_ploc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_ploc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/outomega">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">outomega</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/outomega" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Output of axisymmetric zonal flow omega(s) into field omega.TAG,
where s is the cylindrical radius. This is done for the southern
and norther hemispheres at z=+-(r_icb+0.5)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Toroidal potential</p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Rotation rate of the inner core</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_otc" title="f/integration/cylmean_otc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_otc()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_itc" title="f/integration/cylmean_itc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_itc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/gather_ploc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">gather_ploc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">arr_ploc</span></em>, <em class="sig-param"><span class="pre">arr_full</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/gather_ploc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine gathers and transpose a phi-distributed array on rank0.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_ploc</strong> (<a class="reference internal" href="#f/geos/n_s_max" title="f/geos/n_s_max">n_s_max</a>,1 - <a class="reference internal" href="#f/geos/npstart" title="f/geos/npstart">npstart</a> + <a class="reference internal" href="#f/geos/npstop" title="f/geos/npstop">npstop</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>arr_full</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max">n_phi_max</a>,<a class="reference internal" href="#f/geos/n_s_max" title="f/geos/n_s_max">n_s_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/geos/write_geos_frame" title="f/geos/write_geos_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_geos_frame()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/transp_r2phi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">transp_r2phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">arr_rloc</span></em>, <em class="sig-param"><span class="pre">arr_ploc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/transp_r2phi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to compute a MPI transpose between a R-distributed
array and a Phi-distributed array</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max">n_theta_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max">n_phi_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>arr_ploc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max">n_theta_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,1 - <a class="reference internal" href="#f/geos/npstart" title="f/geos/npstart">npstart</a> + <a class="reference internal" href="#f/geos/npstop" title="f/geos/npstop">npstop</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/geos/outgeos" title="f/geos/outgeos"><code class="xref f f-func docutils literal notranslate"><span class="pre">outgeos()</span></code></a>, <a class="reference internal" href="#f/geos/write_geos_frame" title="f/geos/write_geos_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_geos_frame()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/geos/cylmean">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">geos/</span></span><span class="sig-name descname"><span class="pre">cylmean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dat</span></em>, <em class="sig-param"><span class="pre">dat_otc</span></em>, <em class="sig-param"><span class="pre">dat_itc_n</span></em>, <em class="sig-param"><span class="pre">dat_itc_s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/geos/cylmean" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine computes the z-average inside and outside TC</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dat_otc</strong> (<a class="reference internal" href="#f/geos/n_s_max" title="f/geos/n_s_max">n_s_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dat_itc_n</strong> (<a class="reference internal" href="#f/geos/n_s_max" title="f/geos/n_s_max">n_s_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dat_itc_s</strong> (<a class="reference internal" href="#f/geos/n_s_max" title="f/geos/n_s_max">n_s_max</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="derInt.html#f/integration/cylmean_otc" title="f/integration/cylmean_otc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_otc()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/cylmean_itc" title="f/integration/cylmean_itc"><code class="xref f f-func docutils literal notranslate"><span class="pre">cylmean_itc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="f/probe_mod">
<span id="probes-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">probes.f90</span></code><a class="headerlink" href="#f/probe_mod" title="Permalink to this heading">¶</a></h2>
<p class="rubric">Description</p>
<p>Module for artificial sensors to compare time series
of physical data with experiments.
Probes are located in a radially symmetrical way
on a radial surface given by r_probe (in terms of r_cmb),
theta_probe in degrees between 0 and 90 and n_phi_probes
denoting the number of probes in phi.
Probes will be located at ‘n_phi_probes’ points
at two equatorially symmetric latitudes - theta_probe and
(180 - theta_probe) on r = r_probe.</p>
<p>version 1.0: Works only for v_phi, for now. Will be extended for other data later.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/probe_mod/n_phi_probes" title="f/probe_mod/n_phi_probes"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_phi_probes</span></code></a>, <a class="reference internal" href="#f/probe_mod/n_probebr" title="f/probe_mod/n_probebr"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_probebr</span></code></a>, <a class="reference internal" href="#f/probe_mod/n_probebt" title="f/probe_mod/n_probebt"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_probebt</span></code></a>, <a class="reference internal" href="#f/probe_mod/n_probevp" title="f/probe_mod/n_probevp"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_probevp</span></code></a>, <a class="reference internal" href="#f/probe_mod/n_theta_usr" title="f/probe_mod/n_theta_usr"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_theta_usr</span></code></a>, <a class="reference internal" href="#f/probe_mod/probe_filebr" title="f/probe_mod/probe_filebr"><code class="xref f f-var docutils literal notranslate"><span class="pre">probe_filebr</span></code></a>, <a class="reference internal" href="#f/probe_mod/probe_filebt" title="f/probe_mod/probe_filebt"><code class="xref f f-var docutils literal notranslate"><span class="pre">probe_filebt</span></code></a>, <a class="reference internal" href="#f/probe_mod/probe_filevp" title="f/probe_mod/probe_filevp"><code class="xref f f-var docutils literal notranslate"><span class="pre">probe_filevp</span></code></a>, <a class="reference internal" href="#f/probe_mod/r_probe" title="f/probe_mod/r_probe"><code class="xref f f-var docutils literal notranslate"><span class="pre">r_probe</span></code></a>, <a class="reference internal" href="#f/probe_mod/rad_rank" title="f/probe_mod/rad_rank"><code class="xref f f-var docutils literal notranslate"><span class="pre">rad_rank</span></code></a>, <a class="reference internal" href="#f/probe_mod/rad_usr" title="f/probe_mod/rad_usr"><code class="xref f f-var docutils literal notranslate"><span class="pre">rad_usr</span></code></a>, <a class="reference internal" href="#f/probe_mod/theta_probe" title="f/probe_mod/theta_probe"><code class="xref f f-var docutils literal notranslate"><span class="pre">theta_probe</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/probe_mod/finalize_probes" title="f/probe_mod/finalize_probes"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_probes()</span></code></a>, <a class="reference internal" href="#f/probe_mod/initialize_probes" title="f/probe_mod/initialize_probes"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_probes()</span></code></a>, <a class="reference internal" href="#f/probe_mod/probe_out" title="f/probe_mod/probe_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">probe_out()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/vscale" title="f/num_param/vscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">vscale()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_ord2cal" title="f/horizontal_data/n_theta_ord2cal"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_ord2cal()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>): Module containing the logicals that control the run</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/n_phi_probes">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">n_phi_probes</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/n_phi_probes" title="Permalink to this definition">¶</a></dt>
<dd><p>number of probes in phi - symmetrically distributed</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/n_probebr">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">n_probebr</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/n_probebr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/n_probebt">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">n_probebt</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/n_probebt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/n_probevp">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">n_probevp</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/n_probevp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/n_theta_usr">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">n_theta_usr</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/n_theta_usr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/probe_filebr">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">probe_filebr</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/probe_filebr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/probe_filebt">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">probe_filebt</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/probe_filebt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/probe_filevp">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">probe_filevp</span></span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/probe_filevp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/r_probe">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">r_probe</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/r_probe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/rad_rank">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">rad_rank</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/rad_rank" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/rad_usr">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">rad_usr</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/rad_usr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/probe_mod/theta_probe">
<span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">theta_probe</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/probe_mod/theta_probe" title="Permalink to this definition">¶</a></dt>
<dd><p>probe locations, r_probe in terms of r_cmb and theta in degrees</p>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/probe_mod/initialize_probes">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_probes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/probe_mod/initialize_probes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/probe_mod/finalize_probes">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_probes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/probe_mod/finalize_probes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/probe_mod/probe_out">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">probe_mod/</span></span><span class="sig-name descname"><span class="pre">probe_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">n_r</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/probe_mod/probe_out" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Time</p></li>
<li><p><strong>n_r</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial grod point no.</p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">IO: RMS force balance, torsional oscillations, misc</a><ul>
<li><a class="reference internal" href="#f/rms"><code class="docutils literal notranslate"><span class="pre">RMS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/rms_helpers"><code class="docutils literal notranslate"><span class="pre">RMS_helpers.f90</span></code></a></li>
<li><a class="reference internal" href="#f/dtb_mod"><code class="docutils literal notranslate"><span class="pre">dtB.f90</span></code></a></li>
<li><a class="reference internal" href="#f/dtb_arrays_mod"><code class="docutils literal notranslate"><span class="pre">dtB_arrays.f90</span></code></a></li>
<li><a class="reference internal" href="#f/out_dtb_frame"><code class="docutils literal notranslate"><span class="pre">out_dtB_frame.f90</span></code></a></li>
<li><a class="reference internal" href="#f/torsional_oscillations"><code class="docutils literal notranslate"><span class="pre">TO.f90</span></code></a></li>
<li><a class="reference internal" href="#f/to_arrays_mod"><code class="docutils literal notranslate"><span class="pre">TO_arrays.f90</span></code></a></li>
<li><a class="reference internal" href="#f/outto_mod"><code class="docutils literal notranslate"><span class="pre">out_TO.f90</span></code></a></li>
<li><a class="reference internal" href="#f/radial_spectra"><code class="docutils literal notranslate"><span class="pre">radial_spectra.f90</span></code></a></li>
<li><a class="reference internal" href="#f/geos"><code class="docutils literal notranslate"><span class="pre">outGeos.f90</span></code></a></li>
<li><a class="reference internal" href="#f/probe_mod"><code class="docutils literal notranslate"><span class="pre">probes.f90</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="IOBinaryOutputs.html"
                          title="previous chapter">IO: graphic files, movie files, coeff files and potential files</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="checkPoints.html"
                          title="next chapter">Reading and storing check points (restart files)</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/IOAdd.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="checkPoints.html" title="Reading and storing check points (restart files)"
             >next</a> |</li>
        <li class="right" >
          <a href="IOBinaryOutputs.html" title="IO: graphic files, movie files, coeff files and potential files"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">IO: RMS force balance, torsional oscillations, misc</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>