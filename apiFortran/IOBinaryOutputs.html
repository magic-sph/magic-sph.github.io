
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>IO: graphic files, movie files, coeff files and potential files &#8212; Magic 6.0 documentation</title>
    <link rel="stylesheet" href="../_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.0 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IO: RMS force balance, torsional oscillations, misc" href="IOAdd.html" />
    <link rel="prev" title="IO: time series, radial profiles and spectra" href="IOGeneral.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="IOAdd.html" title="IO: RMS force balance, torsional oscillations, misc"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="IOGeneral.html" title="IO: time series, radial profiles and spectra"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="io-graphic-files-movie-files-coeff-files-and-potential-files">
<span id="secfortraniobinary"></span><h1>IO: graphic files, movie files, coeff files and potential files<a class="headerlink" href="#io-graphic-files-movie-files-coeff-files-and-potential-files" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/graphout_mod">
<span id="out-graph-file-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">out_graph_file.f90</span></code><a class="headerlink" href="#f/graphout_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains the subroutines that store the 3-D graphic files.</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/graphout_mod/graph_mpi_fh" title="f/graphout_mod/graph_mpi_fh"><code class="xref f f-var docutils literal notranslate"><span class="pre">graph_mpi_fh</span></code></a>, <a class="reference internal" href="#f/graphout_mod/info" title="f/graphout_mod/info"><code class="xref f f-var docutils literal notranslate"><span class="pre">info</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_fields" title="f/graphout_mod/n_fields"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_fields</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_graph" title="f/graphout_mod/n_graph"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_graph</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_graph_file" title="f/graphout_mod/n_graph_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_graph_file</span></code></a>, <a class="reference internal" href="#f/graphout_mod/size_of_header" title="f/graphout_mod/size_of_header"><code class="xref f f-var docutils literal notranslate"><span class="pre">size_of_header</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/graphout_mod/close_graph_file" title="f/graphout_mod/close_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">close_graph_file()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout" title="f/graphout_mod/graphout"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_header" title="f/graphout_mod/graphout_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_header()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi_header()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/open_graph_file" title="f/graphout_mod/open_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">open_graph_file()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_tot" title="f/truncation/n_phi_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_axi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic2" title="f/radial_functions/o_r_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic2()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/raxi" title="f/physical_parameters/raxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">raxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sc" title="f/physical_parameters/sc"><code class="xref f f-func docutils literal notranslate"><span class="pre">sc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/stef" title="f/physical_parameters/stef"><code class="xref f f-func docutils literal notranslate"><span class="pre">stef()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/vscale" title="f/num_param/vscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">vscale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_pressgraph" title="f/logic/l_pressgraph"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_pressgraph()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal notranslate"><span class="pre">runid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/graphout_mod/graph_mpi_fh">
<code class="descclassname">graphout_mod/</code><code class="descname">graph_mpi_fh</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/graphout_mod/graph_mpi_fh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/graphout_mod/info">
<code class="descclassname">graphout_mod/</code><code class="descname">info</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/graphout_mod/info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/graphout_mod/n_fields">
<code class="descclassname">graphout_mod/</code><code class="descname">n_fields</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/graphout_mod/n_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/graphout_mod/n_graph">
<code class="descclassname">graphout_mod/</code><code class="descname">n_graph</code><em> [</em><em>integer</em><em>,</em><em>private/optional/default=0</em><em>]</em><a class="headerlink" href="#f/graphout_mod/n_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/graphout_mod/n_graph_file">
<code class="descclassname">graphout_mod/</code><code class="descname">n_graph_file</code><em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/graphout_mod/n_graph_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/graphout_mod/size_of_header">
<code class="descclassname">graphout_mod/</code><code class="descname">size_of_header</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/graphout_mod/size_of_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/graphout_mod/open_graph_file">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">open_graph_file</code><span class="sig-paren">(</span><em>n_time_step</em>, <em>timescaled</em><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/open_graph_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_time_step</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>timescaled</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/parallel_mod/mpiio_setup" title="f/parallel_mod/mpiio_setup"><code class="xref f f-func docutils literal notranslate"><span class="pre">mpiio_setup()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/close_graph_file">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">close_graph_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/close_graph_file" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/graphout">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">graphout</code><span class="sig-paren">(</span><em>n_r</em>, <em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>sr</em>, <em>prer</em>, <em>xir</em>, <em>phir</em><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Output of components of velocity, magnetic field vector, entropy
and composition for graphic outputs.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: radial grod point no.</li>
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>prer</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/graphout_header">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">graphout_header</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_header" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/graphout_mpi">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">graphout_mpi</code><span class="sig-paren">(</span><em>n_r</em>, <em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>sr</em>, <em>prer</em>, <em>xir</em>, <em>phir</em><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_mpi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>MPI version of the graphOut subroutine (use of MPI_IO)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: radial grid point no.</li>
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>prer</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="checkPoints.html#f/storecheckpoints/write_one_field" title="f/storecheckpoints/write_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_one_field()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/graphout_mpi_header">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">graphout_mpi_header</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_mpi_header" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Writes the header of the G file (MPI version)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/write_one_field">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">write_one_field</code><span class="sig-paren">(</span><em>dummy</em>, <em>graph_mpi_fh</em>, <em>n_phis</em>, <em>n_thetas</em><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/write_one_field" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dummy</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>graph_mpi_fh</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_phis</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_thetas</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/graphout_mod/graphout_ic">
<em class="property">subroutine  </em><code class="descclassname">graphout_mod/</code><code class="descname">graphout_ic</code><span class="sig-paren">(</span><em>b_ic</em>, <em>db_ic</em>, <em>aj_ic</em>, <em>bicb</em><span class="optional">[</span>, <em>l_avg</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_ic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to write inner core magnetic
field onto graphic output file. If the inner core is
insulating (l_cond_ic=false) the potential field is calculated
from the outer core field at r=r_cmb.
This version assumes that the fields are fully local on the rank
which is calling this routine (usually rank 0).</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>b_ic</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_ic</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bicb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_avg</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/storecheckpoints/write_one_field" title="f/storecheckpoints/write_one_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_one_field()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/movie_data">
<span id="movie-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">movie.f90</span></code><a class="headerlink" href="#f/movie_data" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/movie_data/frames" title="f/movie_data/frames"><code class="xref f f-var docutils literal notranslate"><span class="pre">frames</span></code></a>, <a class="reference internal" href="#f/movie_data/licfield" title="f/movie_data/licfield"><code class="xref f f-var docutils literal notranslate"><span class="pre">licfield</span></code></a>, <a class="reference internal" href="#f/movie_data/lstoremov" title="f/movie_data/lstoremov"><code class="xref f f-var docutils literal notranslate"><span class="pre">lstoremov</span></code></a>, <a class="reference internal" href="#f/movie_data/movie" title="f/movie_data/movie"><code class="xref f f-var docutils literal notranslate"><span class="pre">movie</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_const" title="f/movie_data/movie_const"><code class="xref f f-var docutils literal notranslate"><span class="pre">movie_const</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_file" title="f/movie_data/movie_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">movie_file</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipcolat" title="f/movie_data/moviedipcolat"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviedipcolat</span></code></a>, <a class="reference internal" href="#f/movie_data/moviediplon" title="f/movie_data/moviediplon"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviediplon</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrength" title="f/movie_data/moviedipstrength"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviedipstrength</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrengthgeo" title="f/movie_data/moviedipstrengthgeo"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviedipstrengthgeo</span></code></a>, <a class="reference internal" href="#f/movie_data/n_frame_work" title="f/movie_data/n_frame_work"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_frame_work</span></code></a>, <a class="reference internal" href="#f/movie_data/n_md" title="f/movie_data/n_md"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_md</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_const</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_start" title="f/movie_data/n_movie_field_start"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_field_start</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_stop" title="f/movie_data/n_movie_field_stop"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_field_stop</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_field_type</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_fields</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_fields_ic</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_max" title="f/movie_data/n_movie_fields_max"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_fields_max</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_file</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_surface</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_type</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies" title="f/movie_data/n_movies"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movies</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies_max" title="f/movie_data/n_movies_max"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movies_max</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/movie_data/finalize_movie_data" title="f/movie_data/finalize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_movie_data()</span></code></a>, <a class="reference internal" href="#f/movie_data/get_movie_type" title="f/movie_data/get_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_movie_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/initialize_movie_data" title="f/movie_data/initialize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_movie_data()</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_gather_frames_to_rank0" title="f/movie_data/movie_gather_frames_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_gather_frames_to_rank0()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/ldtbmem" title="f/truncation/ldtbmem"><code class="xref f f-func docutils literal notranslate"><span class="pre">ldtbmem()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmoviemem" title="f/truncation/lmoviemem"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmoviemem()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_tot" title="f/truncation/n_r_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_tot()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_store_frame" title="f/logic/l_store_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_store_frame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie" title="f/logic/l_movie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_ic" title="f/logic/l_movie_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_htmovie" title="f/logic/l_htmovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_htmovie()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtbmovie" title="f/logic/l_dtbmovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_dtbmovie()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/radial_balance" title="f/radial_data/radial_balance"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial_balance()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/theta" title="f/horizontal_data/theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="misc.html#f/charmanip" title="f/charmanip: This module contains several useful routines to manipule character strings"><code class="xref f f-mod docutils literal notranslate"><span class="pre">charmanip</span></code></a> (<a class="reference internal" href="misc.html#f/charmanip/capitalize" title="f/charmanip/capitalize"><code class="xref f f-func docutils literal notranslate"><span class="pre">capitalize()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/delete_string" title="f/charmanip/delete_string"><code class="xref f f-func docutils literal notranslate"><span class="pre">delete_string()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/str2dble" title="f/charmanip/str2dble"><code class="xref f f-func docutils literal notranslate"><span class="pre">str2dble()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/length_to_blank" title="f/charmanip/length_to_blank"><code class="xref f f-func docutils literal notranslate"><span class="pre">length_to_blank()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal notranslate"><span class="pre">dble2str()</span></code></a>): This module contains several useful routines to manipule character strings</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">logwrite()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/movie_data/frames">
<code class="descclassname">movie_data/</code><code class="descname">frames</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/movie_data/frames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/licfield">
<code class="descclassname">movie_data/</code><code class="descname">licfield</code> (30)<em> [</em><em>logical</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/licfield" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/lstoremov">
<code class="descclassname">movie_data/</code><code class="descname">lstoremov</code> (30)<em> [</em><em>logical</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/lstoremov" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/movie">
<code class="descclassname">movie_data/</code><code class="descname">movie</code> (30)<em> [</em><em>character</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/movie" title="Permalink to this definition">¶</a></dt>
<dd><p>Only for input</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/movie_const">
<code class="descclassname">movie_data/</code><code class="descname">movie_const</code> (30)<em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/movie_const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/movie_file">
<code class="descclassname">movie_data/</code><code class="descname">movie_file</code> (30)<em> [</em><em>character</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/movie_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/moviedipcolat">
<code class="descclassname">movie_data/</code><code class="descname">moviedipcolat</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/moviedipcolat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/moviediplon">
<code class="descclassname">movie_data/</code><code class="descname">moviediplon</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/moviediplon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/moviedipstrength">
<code class="descclassname">movie_data/</code><code class="descname">moviedipstrength</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/moviedipstrength" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/moviedipstrengthgeo">
<code class="descclassname">movie_data/</code><code class="descname">moviedipstrengthgeo</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/moviedipstrengthgeo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_frame_work">
<code class="descclassname">movie_data/</code><code class="descname">n_frame_work</code><em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_frame_work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_md">
<code class="descclassname">movie_data/</code><code class="descname">n_md</code><em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_md" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_const">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_const</code> (30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_const" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_field_start">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_field_start</code> (6,30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_field_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_field_stop">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_field_stop</code> (6,30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_field_stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_field_type">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_field_type</code> (6,30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_field_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_fields">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_fields</code> (30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_fields_ic">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_fields_ic</code> (30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_fields_ic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_fields_max">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_fields_max</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>6<em>]</em><a class="headerlink" href="#f/movie_data/n_movie_fields_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Max no. of fields per movie</p>
</dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_file">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_file</code> (30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_surface">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_surface</code> (30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_surface" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movie_type">
<code class="descclassname">movie_data/</code><code class="descname">n_movie_type</code> (30)<em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movie_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movies">
<code class="descclassname">movie_data/</code><code class="descname">n_movies</code><em> [</em><em>integer</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/movie_data/n_movies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/movie_data/n_movies_max">
<code class="descclassname">movie_data/</code><code class="descname">n_movies_max</code><em> [</em><em>integer</em><em>,</em><em>parameter=</em>30<em>]</em><a class="headerlink" href="#f/movie_data/n_movies_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Max no. of different movies</p>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/movie_data/initialize_movie_data">
<em class="property">subroutine  </em><code class="descclassname">movie_data/</code><code class="descname">initialize_movie_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/initialize_movie_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine is called during the initialization of the code.
It allows to:</p>
<blockquote>
<div><ul class="simple">
<li>Estimate the required memory imprint and allocate the arrays
accordingly</li>
<li>Open the requested movie files</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="#f/movie_data/get_movie_type" title="f/movie_data/get_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_movie_type()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/movie_data/finalize_movie_data">
<em class="property">subroutine  </em><code class="descclassname">movie_data/</code><code class="descname">finalize_movie_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/finalize_movie_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Close movie files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/movie_data/get_movie_type">
<em class="property">subroutine  </em><code class="descclassname">movie_data/</code><code class="descname">get_movie_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/get_movie_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Purpose of this subroutine is to identify the different movie
types from the input string movies(*).
Note that generally blanks are not interpreted and that the
interpretation is not case sensitive.
In general two informations are needed:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">A word FIELDINFO that identifies the field to be plotted
(e.g. Br for radial magnetic field, see list below)
Possible keywords are (optional text in brackets):</p>
<blockquote>
<div><ul class="simple">
<li>B r[adial]     : radial magnetic field</li>
<li>B t[heta]      : theta component</li>
<li>B p[hi]        : azimuthal component</li>
<li>B h[orizontal] : the two horizontal components</li>
<li>B a[ll]        : all three components</li>
<li>FIELDLINE[S]   : field lines of axisymmetric
or FL            poloidal field for phi=constant</li>
<li>AX[ISYMMETRIC] B
or AB          : axisymmetric phi component of the
magnetic field for phi=constant</li>
<li>V r[adial]     : radial velocity field</li>
<li>V t[heta]      : theta component</li>
<li>V p[hi]        : azimuthal component</li>
<li>V h[orizontal] : the two horizontal components</li>
<li>V a[ll]        : all three components</li>
<li>STREAMLINE[S]  : field lines of axisymmetric
or SL          : poloidal field for phi=constant</li>
<li>AX[ISYMMETRIC] V
or AV          : axisymmetric phi component of the
velocity field for phi=constant</li>
<li>V z            : z component of velocity at equator
and z component of the vorticity at
the equator (closest point to equator)</li>
<li>Vo z          : z-component of vorticity</li>
<li>Vo r          : r-component of vorticity</li>
<li>Vo p          : phi-component of vorticity</li>
<li>T[emperature]  : sic</li>
<li>AX[ISYMMETRIC] T
or AT          : axisymmetric T field for phi=constant</li>
<li>Heat t[ransport]: radial derivative of T</li>
<li>C[omposition]  : sic</li>
<li>AX[ISYMMETRIC] C
or AC          : axisymmetric C field for phi=constant</li>
<li>FL Pro         : axisymmetric field line stretching</li>
<li>FL Adv         : axisymmetric field line advection</li>
<li>FL Dif         : axisymmetric field line diffusion</li>
<li>AB Pro         : axisymmetric (tor.) Bphi production</li>
<li>AB Dif         : axisymmetric (tor.) Bphi diffusion</li>
<li>Br Pro         : Br production</li>
<li>Br Adv         : Br advection</li>
<li>Br Dif         : Br diffusion</li>
<li>Jr             : Jr production</li>
<li>Jr Pro         : Jr production +  omega effects</li>
<li>Jr Adv         : Jr advection</li>
<li>Jr Dif         : Jr diffusion</li>
<li>Bz Pol         : poloidal Bz</li>
<li>Bz Pol Pro     : poloidal Bz production</li>
<li>Bz Pol Adv     : poloidal Bz advection</li>
<li>Bz Pol Dif     : poloidal Bz diffusion</li>
<li>Jz Tor         : poloidal Jz</li>
<li>Jz Tor Pro     : poloidal Jz production</li>
<li>Jz Tor Adv     : poloidal Jz advection</li>
<li>Jz Tor Dif     : poloidal Jz diffusion</li>
<li>Bp Tor         : toriodal Bphi</li>
<li>Bp Tor Pro     : toriodal Bphi production</li>
<li>Bp Tor Adv     : toriodal Bphi advection</li>
<li>Bp Tor Dif     : toriodal Bphi diffusion</li>
<li>HEL[ICITY]     : sic</li>
<li>AX[ISYMMETRIC HELICITY]  or
AHEL           : axisymmetric helicity</li>
<li>Bt Tor         : toroidal Btheta</li>
<li>Pot Tor        : toroidal Potential</li>
<li>Pol Fieldlines : toroidal Potential</li>
<li>Br Shear       : azimuthal Shear of Br</li>
<li>Lorentz[force] : Lorentz force (only phi component)</li>
<li>Br Inv         : Inverse field apperance at CMB</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">A second information that identifies the coordinate
to be kept constant (surface).
E.g. r=number for surface r=constant with number given
in units of the total core radius or
theta/phi=number with number given in degrees
Four keywords are also possible:</p>
<blockquote>
<div><ul class="simple">
<li>CMB       : core mantle boundary</li>
<li>EQ[UATOR] : equatorial plane</li>
<li>SUR[FACE] : Earth surface (only magnetic field)</li>
<li>3[D]      : 3D field throughout the OC [and IC for B]</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>On output the necessary information is coded into integers
and is used in this form by further subroutines:</p>
<blockquote>
<div><ul>
<li><p class="first">n_movies = total number of movies</p>
</li>
<li><p class="first">n_type(n_movie) =  movie type:</p>
<blockquote>
<div><ul class="simple">
<li>=  1  : Radial magnetic field</li>
<li>=  2  : Theta component of magnetic field</li>
<li>=  3  : Azimuthal magnetic field</li>
<li>=  4  : Horizontal magnetic field</li>
<li>=  5  : Total magnetic field (all compnents)</li>
<li>=  8  : Axisymmetric azimuthal
magnetic field (phi=constant)</li>
<li>=  9  : 3d magnetic field</li>
<li>= 11  : Radial velocity field</li>
<li>= 12  : Theta component of velocity field</li>
<li>= 13  : Azimuthal velocity field</li>
<li>= 14  : Horizontal velocity field</li>
<li>= 15  : Total velocity field (all compnents)</li>
<li>= 17  : Scalar field whose contours are the
stream lines of the axisymm. poloidal
velocity field (phi=constant)</li>
<li>= 18  : Axisymmetric azimuthal
velocity field (phi=constant)</li>
<li>= 19  : 3d velocity field</li>
<li>= 20  : z component of vorticity</li>
<li>= 21  : Temperature field</li>
<li>= 22  : radial conv. heat transport</li>
<li>= 23  : helicity</li>
<li>= 24  : axisymmetric helicity</li>
<li>= 25  : phi component of vorticity</li>
<li>= 26  : radial component of vorticity</li>
<li>= 28  : axisymmetric Temperature field
for phi=const.</li>
<li>= 29  : 3d temperature field</li>
<li>= 30  : Scalar field whose contours are the
fieldlines of the axisymm. poloidal
magnetic field (phi=constant)</li>
<li>= 31  : field line production</li>
<li>= 32  : field line advection</li>
<li>= 33  : field line diffusion</li>
<li>= 40  : Axisymmetric azimuthal
magnetic field (phi=constant)</li>
<li>= 41  : Axis. Bphi production +  omega eff.</li>
<li>= 42  : Axis. Bphi advection</li>
<li>= 43  : Axis. Bphi diffusion</li>
<li>= 44  : Axis. Bphi str.,dyn.,omega,diff.</li>
<li>= 50  : Bz</li>
<li>= 51  : Bz production</li>
<li>= 52  : Bz advection</li>
<li>= 53  : Bz diffusion</li>
<li>= 60  : toroidal Bphi</li>
<li>= 61  : toroidal Bphi production + omega eff.</li>
<li>= 62  : toroidal Bphi advection</li>
<li>= 63  : toroidal Bphi diffusion</li>
<li>= 71  : Br production</li>
<li>= 72  : Br advection</li>
<li>= 73  : Br diffusion</li>
<li>= 80  : Jr</li>
<li>= 81  : Jr production</li>
<li>= 82  : Jr advection</li>
<li>= 83  : Jr diffusion</li>
<li>= 90  : poloidal Jz pol.</li>
<li>= 91  : poloidal Jz pol. production</li>
<li>= 92  : poloidal Jz advection</li>
<li>= 93  : poloidal Jz diffusion</li>
<li>= 94  : z component of velovity</li>
<li>= 95  : toroidal Btheta</li>
<li>= 96  : toroidal Potential</li>
<li>= 97  : Function for Poloidal Fieldlines</li>
<li>= 98  : azimuthal shear of Br</li>
<li>= 99  : phi component of Lorentz force</li>
<li>=101  : Stress fields</li>
<li>=102  : Force fields</li>
<li>=103  : Br Inverse appearence at CMB</li>
<li>=110  : radial heat flow</li>
<li>=111  : Vz and Vorz north/south correlation</li>
<li>=112  : axisymm dtB tersm for Br and Bp</li>
<li>=114  : Cylindrically radial magnetic field</li>
<li>=115  : Composition field</li>
<li>=116  : axisymmetric Vs</li>
<li>=117  : axisymmetric Composition field</li>
<li>=118  : axisymmetric phase field</li>
<li>=121  : phase field
for phi=const.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">n_movie_surface(n_movie) = defines surface</p>
</li>
<li><p class="first">n_movie_surface =  1  : r=constant:</p>
<blockquote>
<div><ul class="simple">
<li>2  : theta=constant</li>
<li>3  : phi=constant</li>
<li>-1 : r=constant, Earth surface</li>
<li>0  : 3d volume</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">n_movie_fields(n_movie) = no. of fields for outer core</p>
</li>
<li><p class="first">n_movie_fields_ic(n_movie) = no. of fields for inner core</p>
</li>
<li><p class="first">n_movie_field_type(n_field,n_movie) = defines field</p>
</li>
<li><p class="first">n_movie_field_type:</p>
<blockquote>
<div><ul class="simple">
<li>= 1 : radial magnetic field</li>
<li>= 2 : theta comp. of the magnetic field</li>
<li>= 3 : azimuthal magnetic field</li>
<li>= 4 : radial velocity field</li>
<li>= 5 : theta comp. of the velocity field</li>
<li>= 6 : azimuthal velocity field</li>
<li>= 7 : temperature field</li>
<li>= 8 : scalar field for field lines</li>
<li>= 9 : axisymm. toroidal mag. field</li>
<li>=10 : scalar field for stream lines</li>
<li>=11 : axisymm. v_phi</li>
<li>=12 : axisymm. T</li>
<li>=13 : z-comp. of poloidal Bz</li>
<li>=14 : z-comp. of poloidal Jz</li>
<li>=15 : z-comp. of velocity</li>
<li>=16 : z-comp. of vorticity</li>
<li>=17 : radial derivative of T * vr</li>
<li>=18 : helicity</li>
<li>=19 : axisymmetric helicity</li>
<li>=20 : axisymm field-line production</li>
<li>=21 : axisymm field-line advection</li>
<li>=22 : axisymm field-line diffusion</li>
<li>=23 : axisymm Bphi production</li>
<li>=24 : axisymm Bphi omega effect</li>
<li>=25 : axisymm Bphi advection</li>
<li>=26 : axisymm Bphi diffusion</li>
<li>=27 : Br production</li>
<li>=28 : Br advection</li>
<li>=29 : Br diffusion</li>
<li>=30 : Jr</li>
<li>=31 : Jr production</li>
<li>=32 : Jr omega effect</li>
<li>=33 : Jr advection</li>
<li>=34 : Jr diffusion</li>
<li>=35 : poloidal Bz production</li>
<li>=36 : poloidal Bz advection</li>
<li>=37 : poloidal Bz diffusion</li>
<li>=38 : poloidal Jz production</li>
<li>=39 : poloidal Jz omega effect</li>
<li>=40 : poloidal Jz advection</li>
<li>=41 : poloidal Jz diffusion</li>
<li>=42 : toroidal Bp</li>
<li>=43 : toroidal Bp production</li>
<li>=44 : toroidal Bp omega effect</li>
<li>=45 : toroidal Bp advection</li>
<li>=46 : toroidal Bp diffusion</li>
<li>=47 : phi-comp. of vorticity</li>
<li>=48 : r-comp. of vorticity</li>
<li>=49 : toroidal Bp omega effect</li>
<li>=50 : toroidal Bt</li>
<li>=51 : toroidal Potential</li>
<li>=52 : poloidal Fieldlines in theta=const</li>
<li>=53 : Br dr ( vp/(r sin(theta))</li>
<li>=54 : phi Lorentz force</li>
<li>=61 : AS phi reynolds stress force</li>
<li>=62 : AS phi advective stress force</li>
<li>=63 : AS phi viscous stress force</li>
<li>=64 : AS phi Lorentz force</li>
<li>=66 : time derivative of axisym. v phi</li>
<li>=67 : relative strength of axisym. v phi</li>
<li>=81 : Br inverse appearence at CMB</li>
<li>=91 : radial derivative of T</li>
<li>=92 : Vz north/south correlation</li>
<li>=93 : Vorz north/south correlation</li>
<li>=94 : Hel north/south correlation</li>
<li>=101: AS poloidal Br production</li>
<li>=102: AS poloidal Br dynamo term</li>
<li>=103: AS poloidal Br diffusion</li>
<li>=104: AS toroidal Bp production</li>
<li>=105: AS toroidal Bp dynamo term</li>
<li>=106: AS toroidal Bp omega effect</li>
<li>=107: AS toroidal Bp diffusion</li>
<li>=108: Bs</li>
<li>=109: composition field</li>
<li>=110: axisymm. composition</li>
<li>=111: axisymm. phase</li>
<li>=112: phase field</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">n_movie_field_start(n_field,n_movie) = defines where first
element of a field is stored in <code class="docutils literal notranslate"><span class="pre">frames(*)</span></code></p>
</li>
<li><p class="first">n_movie_field_stop(n_field,n_movie) = defines where last
element of a field is stored in <code class="docutils literal notranslate"><span class="pre">frames(*)</span></code></p>
</li>
<li><p class="first">The subroutine also defines appropriate file names for
the movie files. These generally have the form TYPE_mov.TAG</p>
</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/movie_data/initialize_movie_data" title="f/movie_data/initialize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_movie_data()</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="misc.html#f/charmanip/delete_string" title="f/charmanip/delete_string"><code class="xref f f-func docutils literal notranslate"><span class="pre">delete_string()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/capitalize" title="f/charmanip/capitalize"><code class="xref f f-func docutils literal notranslate"><span class="pre">capitalize()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/str2dble" title="f/charmanip/str2dble"><code class="xref f f-func docutils literal notranslate"><span class="pre">str2dble()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal notranslate"><span class="pre">dble2str()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/length_to_blank" title="f/charmanip/length_to_blank"><code class="xref f f-func docutils literal notranslate"><span class="pre">length_to_blank()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/movie_data/movie_gather_frames_to_rank0">
<em class="property">subroutine  </em><code class="descclassname">movie_data/</code><code class="descname">movie_gather_frames_to_rank0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/movie_gather_frames_to_rank0" title="Permalink to this definition">¶</a></dt>
<dd><p>MPI communicators for movie files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/out_movie">
<span id="out-movie-file-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">out_movie_file.f90</span></code><a class="headerlink" href="#f/out_movie" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/out_movie/get_b_surface" title="f/out_movie/get_b_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_b_surface()</span></code></a>, <a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a>, <a class="reference internal" href="#f/out_movie/get_sl" title="f/out_movie/get_sl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_sl()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_3d" title="f/out_movie/store_fields_3d"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_3d()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_p" title="f/out_movie/store_fields_p"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_p()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_r" title="f/out_movie/store_fields_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_r()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_sur" title="f/out_movie/store_fields_sur"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_sur()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_t" title="f/out_movie/store_fields_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_t()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a>, <a class="reference internal" href="#f/out_movie/write_movie_frame" title="f/out_movie/write_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_movie_frame()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>): This module contains the different MPI communicators used in MagIC.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_axi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="#f/movie_data/frames" title="f/movie_data/frames"><code class="xref f f-func docutils literal notranslate"><span class="pre">frames()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies" title="f/movie_data/n_movies"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movies()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_surface()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_const()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_start" title="f/movie_data/n_movie_field_start"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_start()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_stop" title="f/movie_data/n_movie_field_stop"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_stop()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipcolat" title="f/movie_data/moviedipcolat"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviedipcolat()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviediplon" title="f/movie_data/moviediplon"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviediplon()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrength" title="f/movie_data/moviedipstrength"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviedipstrength()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrengthgeo" title="f/movie_data/moviedipstrengthgeo"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviedipstrengthgeo()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/lstoremov" title="f/movie_data/lstoremov"><code class="xref f f-func docutils literal notranslate"><span class="pre">lstoremov()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_file()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields_ic()</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_file" title="f/movie_data/movie_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_file()</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_const" title="f/movie_data/movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_const()</span></code></a>)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho2" title="f/radial_functions/orho2"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or3" title="f/radial_functions/or3"><code class="xref f f-func docutils literal notranslate"><span class="pre">or3()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal notranslate"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_surface" title="f/radial_functions/r_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_surface()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">lffac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/vscale" title="f/num_param/vscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">vscale()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta_e2" title="f/horizontal_data/o_sin_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn1" title="f/horizontal_data/osn1"><code class="xref f f-func docutils literal notranslate"><span class="pre">osn1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_rloc" title="f/fields/b_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">b_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_ic" title="f/fields/b_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">b_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/bicb" title="f/fields/bicb"><code class="xref f f-func docutils literal notranslate"><span class="pre">bicb()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="IOAdd.html#f/out_dtb_frame" title="f/out_dtb_frame"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_dtb_frame</span></code></a> (<a class="reference internal" href="IOAdd.html#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal notranslate"><span class="pre">runid()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/out_movie/store_movie_frame">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">store_movie_frame</code><span class="sig-paren">(</span><em>n_r</em>, <em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>sr</em>, <em>drsr</em>, <em>xir</em>, <em>phir</em>, <em>dvrdp</em>, <em>dvpdr</em>, <em>dvtdr</em>, <em>dvrdt</em>, <em>cvr</em>, <em>cbr</em>, <em>cbt</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_movie_frame" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Controls output of movie frames.
Usually called from radialLoop.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: radial grid point no.</li>
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>drsr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/radialloop" title="f/radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloop()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_movie/store_fields_sur" title="f/out_movie/store_fields_sur"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_sur()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_3d" title="f/out_movie/store_fields_3d"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_3d()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_r" title="f/out_movie/store_fields_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_r()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_t" title="f/out_movie/store_fields_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_t()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_p" title="f/out_movie/store_fields_p"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_p()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/write_movie_frame">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">write_movie_frame</code><span class="sig-paren">(</span><em>n_frame</em>, <em>time</em>, <em>b_lmloc</em>, <em>db_lmloc</em>, <em>aj_lmloc</em>, <em>dj_lmloc</em>, <em>b_ic</em>, <em>db_ic</em>, <em>aj_ic</em>, <em>dj_ic</em>, <em>omega_ic</em>, <em>omega_ma</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/write_movie_frame" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Writes different movie frames into respective output files.
Called from rank 0 with full arrays in standard LM order.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_frame</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/store_fields_sur">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">store_fields_sur</code><span class="sig-paren">(</span><em>n_store_last</em>, <em>n_field_type</em>, <em>bcmb</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_fields_sur" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to store movie frames for
surfaces r=const. into array frame(<em>,</em>)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_store_last</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Start position for storing -1</li>
<li><strong>n_field_type</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Defines field type</li>
<li><strong>bcmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_movie/get_b_surface" title="f/out_movie/get_b_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_b_surface()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/store_fields_r">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">store_fields_r</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>sr</em>, <em>drsr</em>, <em>xir</em>, <em>phir</em>, <em>dvrdp</em>, <em>dvpdr</em>, <em>dvtdr</em>, <em>dvrdt</em>, <em>cvr</em>, <em>n_r</em>, <em>n_store_last</em>, <em>n_field_type</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_fields_r" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to store movie frames for
surfaces r=const. into array frame(<em>,</em>)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>drsr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_store_last</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Start position in frame(*)-1</li>
<li><strong>n_field_type</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Defines field type</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/store_fields_p">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">store_fields_p</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bp</em>, <em>bt</em>, <em>sr</em>, <em>drsr</em>, <em>xir</em>, <em>phir</em>, <em>dvrdp</em>, <em>dvpdr</em>, <em>dvtdr</em>, <em>dvrdt</em>, <em>cvr</em>, <em>cbr</em>, <em>cbt</em>, <em>n_r</em>, <em>n_store_last</em>, <em>n_field_type</em>, <em>n_phi_const</em>, <em>n_field_size</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_fields_p" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to store movie frames for
surfaces phi=const. into array frames(<em>,</em>)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>drsr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of radial point</li>
<li><strong>n_store_last</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Start position in frame(*)-1</li>
<li><strong>n_field_type</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Defines field type</li>
<li><strong>n_phi_const</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of surface phi</li>
<li><strong>n_field_size</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Size of field</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a>, <a class="reference internal" href="#f/out_movie/get_sl" title="f/out_movie/get_sl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_sl()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/store_fields_t">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">store_fields_t</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>sr</em>, <em>drsr</em>, <em>xir</em>, <em>phir</em>, <em>dvrdp</em>, <em>dvpdr</em>, <em>dvtdr</em>, <em>dvrdt</em>, <em>cvr</em>, <em>cbt</em>, <em>n_r</em>, <em>n_store_last</em>, <em>n_field_type</em>, <em>n_theta</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_fields_t" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to store movie frames for
surfaces r=const. into array frame(<em>,</em>)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>drsr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</li>
<li><strong>n_store_last</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Position in frame(*)-1</li>
<li><strong>n_field_type</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Defines field</li>
<li><strong>n_theta</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of theta in block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/store_fields_3d">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">store_fields_3d</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>sr</em>, <em>drsr</em>, <em>xir</em>, <em>phir</em>, <em>dvrdp</em>, <em>dvpdr</em>, <em>dvtdr</em>, <em>dvrdt</em>, <em>cvr</em>, <em>cbr</em>, <em>cbt</em>, <em>n_r</em>, <em>n_store_last</em>, <em>n_field_type</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_fields_3d" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to store movie frames for
surfaces r=const. into array frame(<em>,</em>)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>drsr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phir</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbr</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbt</strong> (,)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</li>
<li><strong>n_store_last</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Position in frame(*)-1</li>
<li><strong>n_field_type</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Defines field</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/get_sl">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">get_sl</code><span class="sig-paren">(</span><em>sl</em>, <em>n_r</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/get_sl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return field sl whose contourlines are the stream lines
of the axisymmetric poloidal velocity field.</p>
<div class="math notranslate nohighlight">
\[s(r,\theta) = \dfrac{1}{r}\dfrac{\partial}{\partial \theta} u(r,\theta,m=0)\]</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sl</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Field for field lines</li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_movie/store_fields_p" title="f/out_movie/store_fields_p"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_p()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/get_fl">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">get_fl</code><span class="sig-paren">(</span><em>fl</em>, <em>n_r</em>, <em>l_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/get_fl" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return field fl whose contourlines are the fields lines
of the axisymmetric poloidal mangetic field.</p>
<div class="math notranslate nohighlight">
\[f(r,\theta) = \dfrac{1}{r}\dfrac{\partial}{\partial \theta} b(r,\theta,m=0)\]</div>
<p>This routine is called for l_ic=.true. only from rank 0 with full
field b_ic in standard lm ordering available.
The case l_ic=.false. is called from all ranks and uses b_Rloc.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fl</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Field for field lines</li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</li>
<li><strong>l_ic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: =true if inner core field</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_movie/store_fields_p" title="f/out_movie/store_fields_p"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_p()</span></code></a>, <a class="reference internal" href="#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_movie/get_b_surface">
<em class="property">subroutine  </em><code class="descclassname">out_movie/</code><code class="descname">get_b_surface</code><span class="sig-paren">(</span><em>b_r</em>, <em>b_t</em>, <em>b_p</em>, <em>bcmb</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/get_b_surface" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Upward continuation of laplacian field to Earths surface.
Field is given by poloidal harmonic coefficients b at CMB.
Spherical harmonic transforms of upward continued field
to r/theta/phi vector components for all logitudes and
latitude are returned in br/bt/bp.
Note that this routine given the real components of the magnetic
fields while other transforms in the code provide only:
<span class="math notranslate nohighlight">\(r^2 B_r\)</span>, <span class="math notranslate nohighlight">\(r^2 \sin\theta B_\theta\)</span>,
<span class="math notranslate nohighlight">\(r^2 \sin\theta B_\phi\)</span></div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>b_r</strong> (,)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Radial magnetic field in (theta,phi)-space</li>
<li><strong>b_t</strong> (,)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Latitudinal magnetic field</li>
<li><strong>b_p</strong> (,)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Azimuthal magnetic field.</li>
<li><strong>bcmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_movie/store_fields_sur" title="f/out_movie/store_fields_sur"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_fields_sur()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/out_movie_ic">
<span id="store-movie-ic-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">store_movie_IC.f90</span></code><a class="headerlink" href="#f/out_movie_ic" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_axi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic2" title="f/radial_functions/o_r_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">lffac()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="#f/movie_data/frames" title="f/movie_data/frames"><code class="xref f f-func docutils literal notranslate"><span class="pre">frames()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_stop" title="f/movie_data/n_movie_field_stop"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_stop()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_start" title="f/movie_data/n_movie_field_start"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_start()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_const()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields_ic()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_surface()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies" title="f/movie_data/n_movies"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movies()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields()</span></code></a>)</li>
<li><a class="reference internal" href="#f/out_movie" title="f/out_movie"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_movie</span></code></a> (<a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_curl_spat_ic" title="f/sht/torpol_to_curl_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_curl_spat_ic()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/out_movie_ic/store_movie_frame_ic">
<em class="property">subroutine  </em><code class="descclassname">out_movie_ic/</code><code class="descname">store_movie_frame_ic</code><span class="sig-paren">(</span><em>bicb</em>, <em>b_ic</em>, <em>db_ic</em>, <em>ddb_ic</em>, <em>aj_ic</em>, <em>dj_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie_ic/store_movie_frame_ic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Controls storage of IC magnetic field in movie frame.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bicb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddb_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_curl_spat_ic" title="f/sht/torpol_to_curl_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_curl_spat_ic()</span></code></a>, <a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/out_coeff">
<span id="out-coeff-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">out_coeff.f90</span></code><a class="headerlink" href="#f/out_coeff" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains the subroutines that calculate the Bcmb files,
the [B|V|T]_coeff_r files and the [B|V|T]_lmr files</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/out_coeff/b_r_file" title="f/out_coeff/b_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_b_r_file" title="f/out_coeff/n_b_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_b_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_b_r_sets" title="f/out_coeff/n_b_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_b_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_t_r_file" title="f/out_coeff/n_t_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_t_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_t_r_sets" title="f/out_coeff/n_t_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_t_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_v_r_file" title="f/out_coeff/n_v_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_v_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_v_r_sets" title="f/out_coeff/n_v_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_v_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_xi_r_file" title="f/out_coeff/n_xi_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_xi_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_xi_r_sets" title="f/out_coeff/n_xi_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_xi_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/t_r_file" title="f/out_coeff/t_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">t_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/v_r_file" title="f/out_coeff/v_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">v_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/xi_r_file" title="f/out_coeff/xi_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_r_file</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/out_coeff/finalize_coeff" title="f/out_coeff/finalize_coeff"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_coeff()</span></code></a>, <a class="reference internal" href="#f/out_coeff/initialize_coeff" title="f/out_coeff/initialize_coeff"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_coeff()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_bcmb" title="f/out_coeff/write_bcmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_bcmb()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_coeff_r" title="f/out_coeff/write_coeff_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_coeff_r()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_coeffs" title="f/out_coeff/write_coeffs"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_coeffs()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot" title="f/out_coeff/write_pot"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot_mpi" title="f/out_coeff/write_pot_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot_mpi()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_r_field" title="f/logic/l_r_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r_field()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cmb_field" title="f/logic/l_cmb_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cmb_field()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_average" title="f/logic/l_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_average()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_r_fieldt" title="f/logic/l_r_fieldt"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r_fieldt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_r_fieldxi" title="f/logic/l_r_fieldxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r_fieldxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/raxi" title="f/physical_parameters/raxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">raxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sc" title="f/physical_parameters/sc"><code class="xref f f-func docutils literal notranslate"><span class="pre">sc()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_ic()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>): This module contains the different MPI communicators used in MagIC.</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_coeff_r" title="f/output_data/n_coeff_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_coeff_r()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_r_array" title="f/output_data/n_r_array"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_array()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_r_step" title="f/output_data/n_r_step"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_step()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/l_max_r" title="f/output_data/l_max_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max_r()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_coeff_r_max" title="f/output_data/n_coeff_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_coeff_r_max()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/out_coeff/b_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">b_r_file</code> (*)<em> [</em><em>character</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/b_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/filehandle">
<code class="descclassname">out_coeff/</code><code class="descname">filehandle</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/out_coeff/filehandle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_b_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">n_b_r_file</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_b_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_b_r_sets">
<code class="descclassname">out_coeff/</code><code class="descname">n_b_r_sets</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_b_r_sets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_t_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">n_t_r_file</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_t_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_t_r_sets">
<code class="descclassname">out_coeff/</code><code class="descname">n_t_r_sets</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_t_r_sets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_v_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">n_v_r_file</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_v_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_v_r_sets">
<code class="descclassname">out_coeff/</code><code class="descname">n_v_r_sets</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_v_r_sets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_xi_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">n_xi_r_file</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_xi_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/n_xi_r_sets">
<code class="descclassname">out_coeff/</code><code class="descname">n_xi_r_sets</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/n_xi_r_sets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/t_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">t_r_file</code> (*)<em> [</em><em>character</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/t_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/v_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">v_r_file</code> (*)<em> [</em><em>character</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/v_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/out_coeff/xi_r_file">
<code class="descclassname">out_coeff/</code><code class="descname">xi_r_file</code> (*)<em> [</em><em>character</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/out_coeff/xi_r_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/out_coeff/initialize_coeff">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">initialize_coeff</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/initialize_coeff" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="IOGeneral.html#f/output_mod/initialize_output" title="f/output_mod/initialize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_output()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_coeff/finalize_coeff">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">finalize_coeff</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/finalize_coeff" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="IOGeneral.html#f/output_mod/finalize_output" title="f/output_mod/finalize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_output()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_coeff/write_bcmb">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">write_bcmb</code><span class="sig-paren">(</span><em>time</em>, <em>b_lmloc</em>, <em>l_max_cmb</em>, <em>n_cmb_sets</em>, <em>cmb_file</em>, <em>n_cmb_file</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_bcmb" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Each call of this subroutine writes time and the poloidal magnetic
potential coefficients b at the CMB up to degree and order l_max_cmb
at the end of output file cmb_file. The parameters l_max_cmb, minc and
the number of stored coeffs are written into the header of cmb_file.
Each further set contains:</p>
<p>Real and imaginary part of b(*) for all orders m&lt;=l are written
for a specific degree l, then for the degrees l+1, l+2, l_max_cmb.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Time</li>
<li><strong>b_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Poloidal field potential</li>
<li><strong>l_max_cmb</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Max degree of output</li>
<li><strong>n_cmb_sets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Total no. of cmb sets,</li>
<li><strong>cmb_file</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em> :: Name of output file</li>
<li><strong>n_cmb_file</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Output unit for $cmb_file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_coeff/write_coeffs">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">write_coeffs</code><span class="sig-paren">(</span><em>w_lmloc</em>, <em>dw_lmloc</em>, <em>ddw_lmloc</em>, <em>z_lmloc</em>, <em>b_lmloc</em>, <em>db_lmloc</em>, <em>ddb_lmloc</em>, <em>aj_lmloc</em>, <em>dj_lmloc</em>, <em>s_lmloc</em>, <em>xi_lmloc</em>, <em>timescaled</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This routine handles the writing of coefficients at a given depth</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dw_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddw_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddb_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>s_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xi_lmloc</strong> (,)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>timescaled</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_coeff/write_coeff_r" title="f/out_coeff/write_coeff_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_coeff_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_coeff/write_coeff_r">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">write_coeff_r</code><span class="sig-paren">(</span><em>time</em>, <em>w_lmloc</em>, <em>dw_lmloc</em>, <em>ddw_lmloc</em>, <em>z_lmloc</em>, <em>r</em>, <em>l_max_r</em>, <em>n_sets</em>, <em>file</em>, <em>n_file</em>, <em>nvbs</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_coeff_r" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Each call of this subroutine writes time and the poloidal and
toroidal coeffitients w,dw,z at a specific radius up to degree
and order l_max_r at the end of output file $file.
If the input is magnetic field (nVBS=2) ddw is stored as well.
If the input is entropy field (nVBS=3) only ddw=s is stored.
The parameters l_max_r, minc, the number of stored coeffs and
radius in the outer core are written into the first line of $file.
Each further set contains:</p>
<p>Real and imaginary part of w(*) for all orders m&lt;=l are written
for a specific degree l, then for the degrees l+1, l+2, l_max_r.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Time</li>
<li><strong>w_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Poloidal field potential</li>
<li><strong>dw_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: dr of Poloidal field potential</li>
<li><strong>ddw_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: dr^2 of Poloidal field potential</li>
<li><strong>z_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Toroidal field potential</li>
<li><strong>r</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radius of coeffs</li>
<li><strong>l_max_r</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Max degree of output</li>
<li><strong>n_sets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Total no. of cmb sets,</li>
<li><strong>file</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em> :: Name of output file</li>
<li><strong>n_file</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Output unit for $file</li>
<li><strong>nvbs</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: 1 if flow, 2 if magnetic field and 3 if temperature or composition</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_coeff/write_coeffs" title="f/out_coeff/write_coeffs"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_coeffs()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_coeff/write_pot_mpi">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">write_pot_mpi</code><span class="sig-paren">(</span><em>time</em>, <em>b</em>, <em>aj</em>, <em>b_ic</em>, <em>aj_ic</em>, <em>npotsets</em>, <em>root</em>, <em>omega_ma</em>, <em>omega_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_pot_mpi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This routine stores the fields in (lm,r) space using MPI-IO</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Time</li>
<li><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Poloidal potential</li>
<li><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Toroidal potential</li>
<li><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>npotsets</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>root</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/parallel_mod/mpiio_setup" title="f/parallel_mod/mpiio_setup"><code class="xref f f-func docutils literal notranslate"><span class="pre">mpiio_setup()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_coeff/write_pot">
<em class="property">subroutine  </em><code class="descclassname">out_coeff/</code><code class="descname">write_pot</code><span class="sig-paren">(</span><em>time</em>, <em>b</em>, <em>aj</em>, <em>b_ic</em>, <em>aj_ic</em>, <em>npotsets</em>, <em>root</em>, <em>omega_ma</em>, <em>omega_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_pot" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This routine stores the fields in spectral and radial space</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Output time</li>
<li><strong>b</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>npotsets</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>root</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em> :: File prefix</li>
<li><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/fields_average_mod">
<span id="field-average-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">field_average.f90</span></code><a class="headerlink" href="#f/fields_average_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module is used when one wants to store time-averaged quantities</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/fields_average_mod/aj_ave" title="f/fields_average_mod/aj_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/aj_ave_global" title="f/fields_average_mod/aj_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/aj_ic_ave" title="f/fields_average_mod/aj_ic_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ic_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/b_ave" title="f/fields_average_mod/b_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/b_ave_global" title="f/fields_average_mod/b_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/b_ic_ave" title="f/fields_average_mod/b_ic_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ic_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/bicb" title="f/fields_average_mod/bicb"><code class="xref f f-var docutils literal notranslate"><span class="pre">bicb</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/db_ave_global" title="f/fields_average_mod/db_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">db_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/dw_ave_global" title="f/fields_average_mod/dw_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">dw_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/p_ave" title="f/fields_average_mod/p_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">p_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/p_ave_global" title="f/fields_average_mod/p_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">p_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/phi_ave" title="f/fields_average_mod/phi_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/phi_ave_global" title="f/fields_average_mod/phi_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/s_ave" title="f/fields_average_mod/s_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">s_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/s_ave_global" title="f/fields_average_mod/s_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">s_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/w_ave" title="f/fields_average_mod/w_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">w_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/w_ave_global" title="f/fields_average_mod/w_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">w_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/xi_ave" title="f/fields_average_mod/xi_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/xi_ave_global" title="f/fields_average_mod/xi_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_ave_global</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/z_ave" title="f/fields_average_mod/z_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">z_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/z_ave_global" title="f/fields_average_mod/z_ave_global"><code class="xref f f-var docutils literal notranslate"><span class="pre">z_ave_global</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/finalize_fields_average_mod" title="f/fields_average_mod/finalize_fields_average_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_fields_average_mod()</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/initialize_fields_average_mod" title="f/fields_average_mod/initialize_fields_average_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_fields_average_mod()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a>: This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic" title="f/radial_functions/chebt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic_even" title="f/radial_functions/chebt_ic_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic_even()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_fac_ic" title="f/radial_functions/dr_fac_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_fac_ic()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/l_r" title="f/radial_functions/l_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="IOGeneral.html#f/kinetic_energy" title="f/kinetic_energy"><code class="xref f f-mod docutils literal notranslate"><span class="pre">kinetic_energy</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/kinetic_energy/get_e_kin" title="f/kinetic_energy/get_e_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_kin()</span></code></a>)</li>
<li><a class="reference internal" href="IOGeneral.html#f/magnetic_energy" title="f/magnetic_energy: This module handles the computation and the writing of the diagnostic files related to magnetic energy: e_mag_oc.TAG, e_mag_ic.TAG, dipole.TAG, eMagR.TAG"><code class="xref f f-mod docutils literal notranslate"><span class="pre">magnetic_energy</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/magnetic_energy/get_e_mag" title="f/magnetic_energy/get_e_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_mag()</span></code></a>): This module handles the computation and the writing of the diagnostic files related to magnetic energy: e_mag_oc.TAG, e_mag_ic.TAG, dipole.TAG, eMagR.TAG</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_graphs" title="f/output_data/n_graphs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_graphs()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/l_max_cmb" title="f/output_data/l_max_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max_cmb()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_spat" title="f/sht/scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_spat()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_ic" title="f/constants/vol_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/get_global_sum" title="f/communications/get_global_sum"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_global_sum()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_ic()</span></code></a>): This module contains the different MPI communicators used in MagIC.</li>
<li><a class="reference internal" href="#f/out_coeff" title="f/out_coeff: This module contains the subroutines that calculate the Bcmb files, the [B|V|T]_coeff_r files and the [B|V|T]_lmr files"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_coeff</span></code></a> (<a class="reference internal" href="#f/out_coeff/write_bcmb" title="f/out_coeff/write_bcmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_bcmb()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot" title="f/out_coeff/write_pot"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot()</span></code></a>): This module contains the subroutines that calculate the Bcmb files, the [B|V|T]_coeff_r files and the [B|V|T]_lmr files</li>
<li><a class="reference internal" href="IOGeneral.html#f/spectra" title="f/spectra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">spectra</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-func docutils literal notranslate"><span class="pre">spectrum()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/spectrum_temp" title="f/spectra/spectrum_temp"><code class="xref f f-func docutils literal notranslate"><span class="pre">spectrum_temp()</span></code></a>)</li>
<li><a class="reference internal" href="#f/graphout_mod" title="f/graphout_mod: This module contains the subroutines that store the 3-D graphic files."><code class="xref f f-mod docutils literal notranslate"><span class="pre">graphout_mod</span></code></a> (<a class="reference internal" href="#f/graphout_mod/graphout" title="f/graphout_mod/graphout"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_graph_file" title="f/graphout_mod/n_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_graph_file()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_header" title="f/graphout_mod/graphout_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_header()</span></code></a>): This module contains the subroutines that store the 3-D graphic files.</li>
<li><a class="reference internal" href="derInt.html#f/radial_der_even" title="f/radial_der_even"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der_even</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_drns_even()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_ddrns_even" title="f/radial_der_even/get_ddrns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddrns_even()</span></code></a>)</li>
<li><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>): Radial derivatives functions</li>
<li><a class="reference internal" href="baseModules.html#f/fieldslast" title="f/fieldslast: This module contains all the work arrays of the previous time-steps needed to time advance the code. They are needed in the time-stepping scheme...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fieldslast</span></code></a> (<a class="reference internal" href="baseModules.html#f/fieldslast/dwdt" title="f/fieldslast/dwdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dwdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dpdt" title="f/fieldslast/dpdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dpdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dzdt" title="f/fieldslast/dzdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dsdt" title="f/fieldslast/dsdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dsdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dxidt" title="f/fieldslast/dxidt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dxidt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dbdt" title="f/fieldslast/dbdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/djdt" title="f/fieldslast/djdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">djdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dbdt_ic" title="f/fieldslast/dbdt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbdt_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/djdt_ic" title="f/fieldslast/djdt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">djdt_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/domega_ma_dt" title="f/fieldslast/domega_ma_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">domega_ma_dt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/domega_ic_dt" title="f/fieldslast/domega_ic_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">domega_ic_dt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dphidt" title="f/fieldslast/dphidt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dphidt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/lorentz_torque_ic_dt" title="f/fieldslast/lorentz_torque_ic_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lorentz_torque_ic_dt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/lorentz_torque_ma_dt" title="f/fieldslast/lorentz_torque_ma_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lorentz_torque_ma_dt()</span></code></a>): This module contains all the work arrays of the previous time-steps needed to time advance the code. They are needed in the time-stepping scheme….</li>
<li><a class="reference internal" href="checkPoints.html#f/storecheckpoints" title="f/storecheckpoints: This module contains several subroutines that can be used to store the checkpoint_#.tag files"><code class="xref f f-mod docutils literal notranslate"><span class="pre">storecheckpoints</span></code></a> (<a class="reference internal" href="checkPoints.html#f/storecheckpoints/store" title="f/storecheckpoints/store"><code class="xref f f-func docutils literal notranslate"><span class="pre">store()</span></code></a>): This module contains several subroutines that can be used to store the checkpoint_#.tag files</li>
<li><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/fields_average_mod/aj_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">aj_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/aj_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/aj_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">aj_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/aj_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/aj_ic_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">aj_ic_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/aj_ic_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/b_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">b_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/b_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/b_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">b_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/b_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/b_ic_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">b_ic_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/b_ic_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/bicb">
<code class="descclassname">fields_average_mod/</code><code class="descname">bicb</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/bicb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/db_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">db_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/db_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/dw_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">dw_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/dw_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/p_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">p_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/p_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/p_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">p_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/p_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/phi_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">phi_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/phi_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/phi_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">phi_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/phi_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/s_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">s_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/s_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/s_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">s_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/s_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/w_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">w_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/w_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/w_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">w_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/w_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/xi_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">xi_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/xi_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/xi_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">xi_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/xi_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/z_ave">
<code class="descclassname">fields_average_mod/</code><code class="descname">z_ave</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/z_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/fields_average_mod/z_ave_global">
<code class="descclassname">fields_average_mod/</code><code class="descname">z_ave_global</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/fields_average_mod/z_ave_global" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/fields_average_mod/initialize_fields_average_mod">
<em class="property">subroutine  </em><code class="descclassname">fields_average_mod/</code><code class="descname">initialize_fields_average_mod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/fields_average_mod/initialize_fields_average_mod" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fields_average_mod/finalize_fields_average_mod">
<em class="property">subroutine  </em><code class="descclassname">fields_average_mod/</code><code class="descname">finalize_fields_average_mod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/fields_average_mod/finalize_fields_average_mod" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/fields_average_mod/fields_average">
<em class="property">subroutine  </em><code class="descclassname">fields_average_mod/</code><code class="descname">fields_average</code><span class="sig-paren">(</span><em>simtime</em>, <em>tscheme</em>, <em>nave</em>, <em>l_stop_time</em>, <em>time_passed</em>, <em>time_norm</em>, <em>omega_ic</em>, <em>omega_ma</em>, <em>w</em>, <em>z</em>, <em>p</em>, <em>s</em>, <em>xi</em>, <em>phi</em>, <em>b</em>, <em>aj</em>, <em>b_ic</em>, <em>aj_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/fields_average_mod/fields_average" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This subroutine averages fields b and v over time.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>simtime</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nave</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number for averaged time steps</li>
<li><strong>l_stop_time</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: true if this is the last time step</li>
<li><strong>time_passed</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: time passed since last log</li>
<li><strong>time_norm</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: time passed since start of time loop</li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>phi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="derInt.html#f/radial_der_even/get_ddrns_even" title="f/radial_der_even/get_ddrns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddrns_even()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_drns_even()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-func docutils literal notranslate"><span class="pre">spectrum()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/spectrum_temp" title="f/spectra/spectrum_temp"><code class="xref f f-func docutils literal notranslate"><span class="pre">spectrum_temp()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/kinetic_energy/get_e_kin" title="f/kinetic_energy/get_e_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_kin()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/magnetic_energy/get_e_mag" title="f/magnetic_energy/get_e_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_mag()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_header" title="f/graphout_mod/graphout_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_header()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_spat" title="f/sht/scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_spat()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout" title="f/graphout_mod/graphout"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_bcmb" title="f/out_coeff/write_bcmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_bcmb()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot" title="f/out_coeff/write_pot"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/storecheckpoints/store" title="f/storecheckpoints/store"><code class="xref f f-func docutils literal notranslate"><span class="pre">store()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">IO: graphic files, movie files, coeff files and potential files</a><ul>
<li><a class="reference internal" href="#f/graphout_mod"><code class="docutils literal notranslate"><span class="pre">out_graph_file.f90</span></code></a></li>
<li><a class="reference internal" href="#f/movie_data"><code class="docutils literal notranslate"><span class="pre">movie.f90</span></code></a></li>
<li><a class="reference internal" href="#f/out_movie"><code class="docutils literal notranslate"><span class="pre">out_movie_file.f90</span></code></a></li>
<li><a class="reference internal" href="#f/out_movie_ic"><code class="docutils literal notranslate"><span class="pre">store_movie_IC.f90</span></code></a></li>
<li><a class="reference internal" href="#f/out_coeff"><code class="docutils literal notranslate"><span class="pre">out_coeff.f90</span></code></a></li>
<li><a class="reference internal" href="#f/fields_average_mod"><code class="docutils literal notranslate"><span class="pre">field_average.f90</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="IOGeneral.html"
                        title="previous chapter">IO: time series, radial profiles and spectra</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="IOAdd.html"
                        title="next chapter">IO: RMS force balance, torsional oscillations, misc</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/IOBinaryOutputs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="IOAdd.html" title="IO: RMS force balance, torsional oscillations, misc"
             >next</a> |</li>
        <li class="right" >
          <a href="IOGeneral.html" title="IO: time series, radial profiles and spectra"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>