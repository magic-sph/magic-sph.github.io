<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>IO: graphic files, movie files, coeff files and potential files &#8212; Magic 6.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css?v=a97dc138" />
    
    <script src="../_static/documentation_options.js?v=ef7fcc1c"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.2 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="IO: RMS force balance, torsional oscillations, misc" href="IOAdd.html" />
    <link rel="prev" title="IO: time series, radial profiles and spectra" href="IOGeneral.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="IOAdd.html" title="IO: RMS force balance, torsional oscillations, misc"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="IOGeneral.html" title="IO: time series, radial profiles and spectra"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">IO: graphic files, movie files, coeff files and potential files</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="io-graphic-files-movie-files-coeff-files-and-potential-files">
<span id="secfortraniobinary"></span><h1>IO: graphic files, movie files, coeff files and potential files<a class="headerlink" href="#io-graphic-files-movie-files-coeff-files-and-potential-files" title="Link to this heading">¶</a></h1>
<section id="out-graph-file-f90">
<h2><code class="docutils literal notranslate"><span class="pre">out_graph_file.f90</span></code><a class="headerlink" href="#out-graph-file-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/graphout_mod">Description</p>
<p>This module contains the subroutines that store the 3-D graphic files.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/graphout_mod/graph_mpi_fh" title="f/graphout_mod/graph_mpi_fh"><code class="xref f f-var docutils literal notranslate"><span class="pre">graph_mpi_fh</span></code></a>, <a class="reference internal" href="#f/graphout_mod/info" title="f/graphout_mod/info"><code class="xref f f-var docutils literal notranslate"><span class="pre">info</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_fields" title="f/graphout_mod/n_fields"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_fields</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_graph" title="f/graphout_mod/n_graph"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_graph</span></code></a>, <a class="reference internal" href="#f/graphout_mod/n_graph_file" title="f/graphout_mod/n_graph_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_graph_file</span></code></a>, <a class="reference internal" href="#f/graphout_mod/size_of_header" title="f/graphout_mod/size_of_header"><code class="xref f f-var docutils literal notranslate"><span class="pre">size_of_header</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/graphout_mod/close_graph_file" title="f/graphout_mod/close_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">close_graph_file()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout" title="f/graphout_mod/graphout"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_header" title="f/graphout_mod/graphout_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_header()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi_header()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/open_graph_file" title="f/graphout_mod/open_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">open_graph_file()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_tot" title="f/truncation/n_phi_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic2" title="f/radial_functions/o_r_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic2()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/raxi" title="f/physical_parameters/raxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">raxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sc" title="f/physical_parameters/sc"><code class="xref f f-func docutils literal notranslate"><span class="pre">sc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/stef" title="f/physical_parameters/stef"><code class="xref f f-func docutils literal notranslate"><span class="pre">stef()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/vscale" title="f/num_param/vscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">vscale()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_pressgraph" title="f/logic/l_pressgraph"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_pressgraph()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal notranslate"><span class="pre">runid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/graph_mpi_fh">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">graph_mpi_fh</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/graph_mpi_fh" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/info">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">info</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/n_fields">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">n_fields</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/n_fields" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/n_graph">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">n_graph</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/optional/default=0</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/n_graph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/n_graph_file">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">n_graph_file</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/n_graph_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/size_of_header">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">size_of_header</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/size_of_header" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/graphout_mod/write_one_field">
<span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">write_one_field</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/graphout_mod/write_one_field" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/graphout_mod/open_graph_file">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">open_graph_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_time_step</span></em>, <em class="sig-param"><span class="pre">timescaled</span></em>, <em class="sig-param"><span class="pre">l_ave</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/open_graph_file" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_time_step</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timescaled</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_ave</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>inout,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/mpiio_setup" title="f/parallel_mod/mpiio_setup"><code class="xref f f-func docutils literal notranslate"><span class="pre">mpiio_setup()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/graphout_mod/close_graph_file">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">close_graph_file</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/close_graph_file" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine handles the closing of the Graphic files</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Options<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>inout,</em><em>]</em></p>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/graphout_mod/graphout">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">graphout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_r</span></em>, <em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">sr</span></em>, <em class="sig-param"><span class="pre">prer</span></em>, <em class="sig-param"><span class="pre">xir</span></em>, <em class="sig-param"><span class="pre">phir</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Output of components of velocity, magnetic field vector, entropy
and composition for graphic outputs.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_r</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial grod point no.</p></li>
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>prer</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xir</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phir</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em> :: File index</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/graphout_mod/graphout_header">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">graphout_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_header" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/graphout_mod/graphout_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">graphout_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_r</span></em>, <em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">sr</span></em>, <em class="sig-param"><span class="pre">prer</span></em>, <em class="sig-param"><span class="pre">xir</span></em>, <em class="sig-param"><span class="pre">phir</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_mpi" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>MPI version of the graphOut subroutine (use of MPI_IO)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_r</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial grid point no.</p></li>
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>prer</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xir</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phir</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/graphout_mod/graphout_mpi_header">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">graphout_mpi_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_mpi_header" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Writes the header of the G file (MPI version)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/graphout_mod/graphout_ic">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">graphout_mod/</span></span><span class="sig-name descname"><span class="pre">graphout_ic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">bicb</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">n_graph_handle</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/graphout_mod/graphout_ic" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to write inner core magnetic
field onto graphic output file. If the inner core is
insulating (l_cond_ic=false) the potential field is calculated
from the outer core field at r=r_cmb.
This version assumes that the fields are fully local on the rank
which is calling this routine (usually rank 0).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b_ic</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bicb</strong> (*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>n_graph_handle</strong><em> [</em><em>integer </em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="movie-f90">
<h2><code class="docutils literal notranslate"><span class="pre">movie.f90</span></code><a class="headerlink" href="#movie-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/movie_data">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/movie_data/frames" title="f/movie_data/frames"><code class="xref f f-var docutils literal notranslate"><span class="pre">frames</span></code></a>, <a class="reference internal" href="#f/movie_data/get_movie_type" title="f/movie_data/get_movie_type"><code class="xref f f-var docutils literal notranslate"><span class="pre">get_movie_type</span></code></a>, <a class="reference internal" href="#f/movie_data/licfield" title="f/movie_data/licfield"><code class="xref f f-var docutils literal notranslate"><span class="pre">licfield</span></code></a>, <a class="reference internal" href="#f/movie_data/lstoremov" title="f/movie_data/lstoremov"><code class="xref f f-var docutils literal notranslate"><span class="pre">lstoremov</span></code></a>, <a class="reference internal" href="#f/movie_data/movie" title="f/movie_data/movie"><code class="xref f f-var docutils literal notranslate"><span class="pre">movie</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_const" title="f/movie_data/movie_const"><code class="xref f f-var docutils literal notranslate"><span class="pre">movie_const</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_file" title="f/movie_data/movie_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">movie_file</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipcolat" title="f/movie_data/moviedipcolat"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviedipcolat</span></code></a>, <a class="reference internal" href="#f/movie_data/moviediplon" title="f/movie_data/moviediplon"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviediplon</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrength" title="f/movie_data/moviedipstrength"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviedipstrength</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrengthgeo" title="f/movie_data/moviedipstrengthgeo"><code class="xref f f-var docutils literal notranslate"><span class="pre">moviedipstrengthgeo</span></code></a>, <a class="reference internal" href="#f/movie_data/n_frame_work" title="f/movie_data/n_frame_work"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_frame_work</span></code></a>, <a class="reference internal" href="#f/movie_data/n_md" title="f/movie_data/n_md"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_md</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_const</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_start" title="f/movie_data/n_movie_field_start"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_field_start</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_stop" title="f/movie_data/n_movie_field_stop"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_field_stop</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_field_type</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_fields</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_fields_ic</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_max" title="f/movie_data/n_movie_fields_max"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_fields_max</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_file</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_surface</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movie_type</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies" title="f/movie_data/n_movies"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movies</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies_max" title="f/movie_data/n_movies_max"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_movies_max</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/movie_data/finalize_movie_data" title="f/movie_data/finalize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_movie_data()</span></code></a>, <a class="reference internal" href="#f/movie_data/initialize_movie_data" title="f/movie_data/initialize_movie_data"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_movie_data()</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_gather_frames_to_rank0" title="f/movie_data/movie_gather_frames_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_gather_frames_to_rank0()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_tot" title="f/truncation/n_r_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_tot()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_store_frame" title="f/logic/l_store_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_store_frame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie" title="f/logic/l_movie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_geosmovie" title="f/logic/l_geosmovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_geosmovie()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_ic" title="f/logic/l_movie_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_htmovie" title="f/logic/l_htmovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_htmovie()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtbmovie" title="f/logic/l_dtbmovie"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_dtbmovie()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/radial_balance" title="f/radial_data/radial_balance"><code class="xref f f-func docutils literal notranslate"><span class="pre">radial_balance()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_ord2cal" title="f/horizontal_data/n_theta_ord2cal"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_ord2cal()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="misc.html#f/charmanip" title="f/charmanip: This module contains several useful routines to manipule character strings"><code class="xref f f-mod docutils literal notranslate"><span class="pre">charmanip</span></code></a> (<a class="reference internal" href="misc.html#f/charmanip/capitalize" title="f/charmanip/capitalize"><code class="xref f f-func docutils literal notranslate"><span class="pre">capitalize()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/delete_string" title="f/charmanip/delete_string"><code class="xref f f-func docutils literal notranslate"><span class="pre">delete_string()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal notranslate"><span class="pre">dble2str()</span></code></a>): This module contains several useful routines to manipule character strings</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">logwrite()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/frames">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">frames</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/frames" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/get_movie_type">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">get_movie_type</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/get_movie_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/licfield">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">licfield</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/licfield" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/lstoremov">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">lstoremov</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/lstoremov" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/movie">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">movie</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">character(len=80)</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/movie" title="Link to this definition">¶</a></dt>
<dd><p>‘</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/movie_const">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">movie_const</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/movie_const" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/movie_file">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">movie_file</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/movie_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/moviedipcolat">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">moviedipcolat</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/moviedipcolat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/moviediplon">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">moviediplon</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/moviediplon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/moviedipstrength">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">moviedipstrength</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/moviedipstrength" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/moviedipstrengthgeo">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">moviedipstrengthgeo</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/moviedipstrengthgeo" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_frame_work">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_frame_work</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_frame_work" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_md">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_md</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_md" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_const">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_const</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_const" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_field_start">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_field_start</span></span> <span class="pre">(</span><span class="pre">6</span><span class="pre">,</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_field_start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_field_stop">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_field_stop</span></span> <span class="pre">(</span><span class="pre">6</span><span class="pre">,</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_field_stop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_field_type">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_field_type</span></span> <span class="pre">(</span><span class="pre">6</span><span class="pre">,</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_field_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_fields">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_fields</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_fields" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_fields_ic">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_fields_ic</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_fields_ic" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_fields_max">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_fields_max</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">parameter=</span></em><span class="pre">6</span><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_fields_max" title="Link to this definition">¶</a></dt>
<dd><p>Max no. of fields per movie</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_file">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_file</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_surface">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_surface</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_surface" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movie_type">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movie_type</span></span> <span class="pre">(</span><span class="pre">30</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movie_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movies">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movies</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/movie_data/n_movies_max">
<span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">n_movies_max</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">parameter=</span></em><span class="pre">30</span><em><span class="pre">]</span></em><a class="headerlink" href="#f/movie_data/n_movies_max" title="Link to this definition">¶</a></dt>
<dd><p>Max no. of different movies</p>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/movie_data/initialize_movie_data">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">initialize_movie_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/initialize_movie_data" title="Link to this definition">¶</a></dt>
<dd><p>This routine is called during the initialization of the code.
It allows to:</p>
<blockquote>
<div><ul class="simple">
<li><p>Estimate the required memory imprint and allocate the arrays
accordingly</p></li>
<li><p>Open the requested movie files</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/movie_data/finalize_movie_data">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">finalize_movie_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/finalize_movie_data" title="Link to this definition">¶</a></dt>
<dd><p>Close movie files</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/movie_data/movie_gather_frames_to_rank0">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">movie_data/</span></span><span class="sig-name descname"><span class="pre">movie_gather_frames_to_rank0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/movie_data/movie_gather_frames_to_rank0" title="Link to this definition">¶</a></dt>
<dd><p>MPI communicators for movie files</p>
<dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="out-movie-file-f90">
<h2><code class="docutils literal notranslate"><span class="pre">out_movie_file.f90</span></code><a class="headerlink" href="#out-movie-file-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/out_movie">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/out_movie/get_b_surface" title="f/out_movie/get_b_surface"><code class="xref f f-var docutils literal notranslate"><span class="pre">get_b_surface</span></code></a>, <a class="reference internal" href="#f/out_movie/get_sl" title="f/out_movie/get_sl"><code class="xref f f-var docutils literal notranslate"><span class="pre">get_sl</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_3d" title="f/out_movie/store_fields_3d"><code class="xref f f-var docutils literal notranslate"><span class="pre">store_fields_3d</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_p" title="f/out_movie/store_fields_p"><code class="xref f f-var docutils literal notranslate"><span class="pre">store_fields_p</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_r" title="f/out_movie/store_fields_r"><code class="xref f f-var docutils literal notranslate"><span class="pre">store_fields_r</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_sur" title="f/out_movie/store_fields_sur"><code class="xref f f-var docutils literal notranslate"><span class="pre">store_fields_sur</span></code></a>, <a class="reference internal" href="#f/out_movie/store_fields_t" title="f/out_movie/store_fields_t"><code class="xref f f-var docutils literal notranslate"><span class="pre">store_fields_t</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a>, <a class="reference internal" href="#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a>, <a class="reference internal" href="#f/out_movie/write_movie_frame" title="f/out_movie/write_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_movie_frame()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/geos" title="f/geos: This module is used to compute z-integrated diagnostics such as the degree of geostrophy or the separation of energies between inside and outside the tangent cylinder. This makes use of a local Simpson's method. This also"><code class="xref f f-mod docutils literal notranslate"><span class="pre">geos</span></code></a> (<a class="reference internal" href="IOAdd.html#f/geos/cyl" title="f/geos/cyl"><code class="xref f f-func docutils literal notranslate"><span class="pre">cyl()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos/n_s_max" title="f/geos/n_s_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_s_max()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos/write_geos_frame" title="f/geos/write_geos_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_geos_frame()</span></code></a>): This module is used to compute z-integrated diagnostics such as the degree of geostrophy or the separation of energies between inside and outside the tangent cylinder. This makes use of a local Simpson’s method. This also</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="#f/movie_data/frames" title="f/movie_data/frames"><code class="xref f f-func docutils literal notranslate"><span class="pre">frames()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies" title="f/movie_data/n_movies"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movies()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_surface()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_const()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_start" title="f/movie_data/n_movie_field_start"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_start()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_stop" title="f/movie_data/n_movie_field_stop"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_stop()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipcolat" title="f/movie_data/moviedipcolat"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviedipcolat()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviediplon" title="f/movie_data/moviediplon"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviediplon()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrength" title="f/movie_data/moviedipstrength"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviedipstrength()</span></code></a>, <a class="reference internal" href="#f/movie_data/moviedipstrengthgeo" title="f/movie_data/moviedipstrengthgeo"><code class="xref f f-func docutils literal notranslate"><span class="pre">moviedipstrengthgeo()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/lstoremov" title="f/movie_data/lstoremov"><code class="xref f f-func docutils literal notranslate"><span class="pre">lstoremov()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_file()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields_ic()</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_file" title="f/movie_data/movie_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_file()</span></code></a>, <a class="reference internal" href="#f/movie_data/movie_const" title="f/movie_data/movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">movie_const()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho2" title="f/radial_functions/orho2"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or3" title="f/radial_functions/or3"><code class="xref f f-func docutils literal notranslate"><span class="pre">or3()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal notranslate"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_surface" title="f/radial_functions/r_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_surface()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">lffac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/vscale" title="f/num_param/vscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">vscale()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta_e2" title="f/horizontal_data/o_sin_theta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">theta_ord()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_rloc" title="f/fields/b_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">b_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_ic" title="f/fields/b_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">b_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/bicb" title="f/fields/bicb"><code class="xref f f-func docutils literal notranslate"><span class="pre">bicb()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/out_dtb_frame" title="f/out_dtb_frame"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_dtb_frame</span></code></a> (<a class="reference internal" href="IOAdd.html#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal notranslate"><span class="pre">runid()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/get_b_surface">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">get_b_surface</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/get_b_surface" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/get_sl">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">get_sl</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/get_sl" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/store_fields_3d">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">store_fields_3d</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/store_fields_3d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/store_fields_p">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">store_fields_p</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/store_fields_p" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/store_fields_r">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">store_fields_r</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/store_fields_r" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/store_fields_sur">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">store_fields_sur</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/store_fields_sur" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_movie/store_fields_t">
<span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">store_fields_t</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_movie/store_fields_t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/out_movie/store_movie_frame">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">store_movie_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_r</span></em>, <em class="sig-param"><span class="pre">vr</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">bt</span></em>, <em class="sig-param"><span class="pre">bp</span></em>, <em class="sig-param"><span class="pre">sr</span></em>, <em class="sig-param"><span class="pre">drsr</span></em>, <em class="sig-param"><span class="pre">xir</span></em>, <em class="sig-param"><span class="pre">phir</span></em>, <em class="sig-param"><span class="pre">dvrdp</span></em>, <em class="sig-param"><span class="pre">dvpdr</span></em>, <em class="sig-param"><span class="pre">dvtdr</span></em>, <em class="sig-param"><span class="pre">dvrdt</span></em>, <em class="sig-param"><span class="pre">cvr</span></em>, <em class="sig-param"><span class="pre">cbr</span></em>, <em class="sig-param"><span class="pre">cbt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/store_movie_frame" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Controls output of movie frames.
Usually called from radialLoop.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_r</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: radial grid point no.</p></li>
<li><p><strong>vr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>sr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>drsr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xir</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phir</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvpdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvtdr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvrdt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cvr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cbr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>cbt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_movie/write_movie_frame">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">write_movie_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_frame</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">b_lmloc</span></em>, <em class="sig-param"><span class="pre">db_lmloc</span></em>, <em class="sig-param"><span class="pre">aj_lmloc</span></em>, <em class="sig-param"><span class="pre">dj_lmloc</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/write_movie_frame" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Writes different movie frames into respective output files.
Called from rank 0 with full arrays in standard LM order.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_frame</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/geos/write_geos_frame" title="f/geos/write_geos_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_geos_frame()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_dtb_frame()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_movie/get_fl">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_movie/</span></span><span class="sig-name descname"><span class="pre">get_fl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">fl</span></em>, <em class="sig-param"><span class="pre">n_r</span></em>, <em class="sig-param"><span class="pre">l_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie/get_fl" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return field fl whose contourlines are the fields lines
of the axisymmetric poloidal mangetic field.</p>
<div class="math notranslate nohighlight">
\[f(r,\theta) = \dfrac{1}{r}\dfrac{\partial}{\partial \theta} b(r,\theta,m=0)\]</div>
<p>This routine is called for l_ic=.true. only from rank 0 with full
field b_ic in standard lm ordering available.
The case l_ic=.false. is called from all ranks and uses b_Rloc.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fl</strong> (*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em> :: Field for field lines</p></li>
<li><p><strong>n_r</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</p></li>
<li><p><strong>l_ic</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: =true if inner core field</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/toraxi_to_spat" title="f/sht/toraxi_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">toraxi_to_spat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="store-movie-ic-f90">
<h2><code class="docutils literal notranslate"><span class="pre">store_movie_IC.f90</span></code><a class="headerlink" href="#store-movie-ic-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/out_movie_ic">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/out_movie_ic/store_movie_frame_ic" title="f/out_movie_ic/store_movie_frame_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame_ic()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic2" title="f/radial_functions/o_r_ic2"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">lffac()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sin_theta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal notranslate"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="#f/movie_data/frames" title="f/movie_data/frames"><code class="xref f f-func docutils literal notranslate"><span class="pre">frames()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_stop" title="f/movie_data/n_movie_field_stop"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_stop()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_start" title="f/movie_data/n_movie_field_start"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_start()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_const()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields_ic()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_surface()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movies" title="f/movie_data/n_movies"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movies()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_field_type()</span></code></a>, <a class="reference internal" href="#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_movie_fields()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="#f/out_movie" title="f/out_movie"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_movie</span></code></a> (<a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_curl_spat_ic" title="f/sht/torpol_to_curl_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_curl_spat_ic()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/out_movie_ic/store_movie_frame_ic">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_movie_ic/</span></span><span class="sig-name descname"><span class="pre">store_movie_frame_ic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">bicb</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">ddb_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_movie_ic/store_movie_frame_ic" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Controls storage of IC magnetic field in movie frame.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bicb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat_ic" title="f/sht/torpol_to_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat_ic()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_curl_spat_ic" title="f/sht/torpol_to_curl_spat_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_curl_spat_ic()</span></code></a>, <a class="reference internal" href="#f/out_movie/get_fl" title="f/out_movie/get_fl"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fl()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="out-coeff-f90">
<h2><code class="docutils literal notranslate"><span class="pre">out_coeff.f90</span></code><a class="headerlink" href="#out-coeff-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/out_coeff">Description</p>
<p>This module contains the subroutines that calculate the Bcmb files,
the [B|V|T]_coeff_r files and the [B|V|T]_lmr files</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/out_coeff/b_r_file" title="f/out_coeff/b_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_b_r_file" title="f/out_coeff/n_b_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_b_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_b_r_sets" title="f/out_coeff/n_b_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_b_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_t_r_file" title="f/out_coeff/n_t_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_t_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_t_r_sets" title="f/out_coeff/n_t_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_t_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_v_r_file" title="f/out_coeff/n_v_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_v_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_v_r_sets" title="f/out_coeff/n_v_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_v_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_xi_r_file" title="f/out_coeff/n_xi_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_xi_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/n_xi_r_sets" title="f/out_coeff/n_xi_r_sets"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_xi_r_sets</span></code></a>, <a class="reference internal" href="#f/out_coeff/t_r_file" title="f/out_coeff/t_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">t_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/v_r_file" title="f/out_coeff/v_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">v_r_file</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_coeff_r" title="f/out_coeff/write_coeff_r"><code class="xref f f-var docutils literal notranslate"><span class="pre">write_coeff_r</span></code></a>, <a class="reference internal" href="#f/out_coeff/xi_r_file" title="f/out_coeff/xi_r_file"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_r_file</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/out_coeff/finalize_coeff" title="f/out_coeff/finalize_coeff"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_coeff()</span></code></a>, <a class="reference internal" href="#f/out_coeff/initialize_coeff" title="f/out_coeff/initialize_coeff"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_coeff()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_bcmb" title="f/out_coeff/write_bcmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_bcmb()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_coeffs" title="f/out_coeff/write_coeffs"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_coeffs()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot" title="f/out_coeff/write_pot"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot_mpi" title="f/out_coeff/write_pot_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot_mpi()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_r_field" title="f/logic/l_r_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r_field()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cmb_field" title="f/logic/l_cmb_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cmb_field()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_average" title="f/logic/l_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_average()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_r_fieldt" title="f/logic/l_r_fieldt"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r_fieldt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_r_fieldxi" title="f/logic/l_r_fieldxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r_fieldxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal notranslate"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/raxi" title="f/physical_parameters/raxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">raxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sc" title="f/physical_parameters/sc"><code class="xref f f-func docutils literal notranslate"><span class="pre">sc()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal notranslate"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal notranslate"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_min" title="f/truncation/m_min"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_min()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_max" title="f/truncation/m_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_ic()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_coeff_r" title="f/output_data/n_coeff_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_coeff_r()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_r_array" title="f/output_data/n_r_array"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_array()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_r_step" title="f/output_data/n_r_step"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_step()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/l_max_r" title="f/output_data/l_max_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max_r()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_coeff_r_max" title="f/output_data/n_coeff_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_coeff_r_max()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/b_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">b_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/b_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/filehandle">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">filehandle</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/filehandle" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_b_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_b_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_b_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_b_r_sets">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_b_r_sets</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_b_r_sets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_t_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_t_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_t_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_t_r_sets">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_t_r_sets</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_t_r_sets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_v_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_v_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_v_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_v_r_sets">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_v_r_sets</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_v_r_sets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_xi_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_xi_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_xi_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/n_xi_r_sets">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">n_xi_r_sets</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/n_xi_r_sets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/t_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">t_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/t_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/v_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">v_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/v_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/write_coeff_r">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">write_coeff_r</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/write_coeff_r" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/out_coeff/xi_r_file">
<span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">xi_r_file</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">character(len=72)</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/out_coeff/xi_r_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/out_coeff/initialize_coeff">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">initialize_coeff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/initialize_coeff" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/initialize_output" title="f/output_mod/initialize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_output()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_coeff/finalize_coeff">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">finalize_coeff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/finalize_coeff" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/finalize_output" title="f/output_mod/finalize_output"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_output()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_coeff/write_bcmb">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">write_bcmb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">b_lmloc</span></em>, <em class="sig-param"><span class="pre">l_max_cmb</span></em>, <em class="sig-param"><span class="pre">n_cmb_sets</span></em>, <em class="sig-param"><span class="pre">cmb_file</span></em>, <em class="sig-param"><span class="pre">n_cmb_file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_bcmb" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Each call of this subroutine writes time and the poloidal magnetic
potential coefficients b at the CMB up to degree and order l_max_cmb
at the end of output file cmb_file. The parameters l_max_cmb, minc and
the number of stored coeffs are written into the header of cmb_file.
Each further set contains:</p>
<p>Real and imaginary part of b(*) for all orders m&lt;=l are written
for a specific degree l, then for the degrees l+1, l+2, l_max_cmb.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Time</p></li>
<li><p><strong>b_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Poloidal field potential</p></li>
<li><p><strong>l_max_cmb</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Max degree of output</p></li>
<li><p><strong>n_cmb_sets</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Total no. of cmb sets,</p></li>
<li><p><strong>cmb_file</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em> :: Name of output file</p></li>
<li><p><strong>n_cmb_file</strong><em> [</em><em>integer </em><em>,</em><em>inout</em><em>]</em> :: Output unit for $cmb_file</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_coeff/write_coeffs">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">write_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w_lmloc</span></em>, <em class="sig-param"><span class="pre">dw_lmloc</span></em>, <em class="sig-param"><span class="pre">ddw_lmloc</span></em>, <em class="sig-param"><span class="pre">z_lmloc</span></em>, <em class="sig-param"><span class="pre">b_lmloc</span></em>, <em class="sig-param"><span class="pre">db_lmloc</span></em>, <em class="sig-param"><span class="pre">ddb_lmloc</span></em>, <em class="sig-param"><span class="pre">aj_lmloc</span></em>, <em class="sig-param"><span class="pre">s_lmloc</span></em>, <em class="sig-param"><span class="pre">xi_lmloc</span></em>, <em class="sig-param"><span class="pre">timescaled</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_coeffs" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine handles the writing of coefficients at a given depth</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dw_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddw_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ddb_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>s_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi_lmloc</strong> (*,*)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timescaled</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_coeff/write_pot_mpi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">write_pot_mpi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">npotsets</span></em>, <em class="sig-param"><span class="pre">root</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_pot_mpi" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine stores the fields in (lm,r) space using MPI-IO</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Time</p></li>
<li><p><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Poloidal potential</p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: Toroidal potential</p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>npotsets</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>root</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/mpiio_setup" title="f/parallel_mod/mpiio_setup"><code class="xref f f-func docutils literal notranslate"><span class="pre">mpiio_setup()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/out_coeff/write_pot">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">out_coeff/</span></span><span class="sig-name descname"><span class="pre">write_pot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">npotsets</span></em>, <em class="sig-param"><span class="pre">root</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_coeff/write_pot" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine stores the fields in spectral and radial space</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: Output time</p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>npotsets</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>root</strong><em> [</em><em>character(len=*)</em><em>,</em><em>in</em><em>]</em> :: File prefix</p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="field-average-f90">
<h2><code class="docutils literal notranslate"><span class="pre">field_average.f90</span></code><a class="headerlink" href="#field-average-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/fields_average_mod">Description</p>
<p>This module is used when one wants to store time-averaged quantities</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/fields_average_mod/aj_ave_lmloc" title="f/fields_average_mod/aj_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/aj_ave_rloc" title="f/fields_average_mod/aj_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/aj_ic_ave" title="f/fields_average_mod/aj_ic_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ic_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/b_ave_lmloc" title="f/fields_average_mod/b_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/b_ave_rloc" title="f/fields_average_mod/b_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/b_ic_ave" title="f/fields_average_mod/b_ic_ave"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ic_ave</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/bicb" title="f/fields_average_mod/bicb"><code class="xref f f-var docutils literal notranslate"><span class="pre">bicb</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/p_ave_lmloc" title="f/fields_average_mod/p_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">p_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/p_ave_rloc" title="f/fields_average_mod/p_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">p_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/phi_ave_lmloc" title="f/fields_average_mod/phi_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/phi_ave_rloc" title="f/fields_average_mod/phi_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/s_ave_lmloc" title="f/fields_average_mod/s_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">s_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/s_ave_rloc" title="f/fields_average_mod/s_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">s_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/w_ave_lmloc" title="f/fields_average_mod/w_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">w_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/w_ave_rloc" title="f/fields_average_mod/w_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">w_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/xi_ave_lmloc" title="f/fields_average_mod/xi_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/xi_ave_rloc" title="f/fields_average_mod/xi_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_ave_rloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/z_ave_lmloc" title="f/fields_average_mod/z_ave_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">z_ave_lmloc</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/z_ave_rloc" title="f/fields_average_mod/z_ave_rloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">z_ave_rloc</span></code></a></p>
</dd>
<dt class="field-even">Routines<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/fields_average_mod/fields_average" title="f/fields_average_mod/fields_average"><code class="xref f f-func docutils literal notranslate"><span class="pre">fields_average()</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/finalize_fields_average_mod" title="f/fields_average_mod/finalize_fields_average_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_fields_average_mod()</span></code></a>, <a class="reference internal" href="#f/fields_average_mod/initialize_fields_average_mod" title="f/fields_average_mod/initialize_fields_average_mod"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_fields_average_mod()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a>: This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/get_global_sum" title="f/communications/get_global_sum"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_global_sum()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_oc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">gt_ic()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic" title="f/radial_functions/chebt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic_even" title="f/radial_functions/chebt_ic_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic_even()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_fac_ic" title="f/radial_functions/dr_fac_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_fac_ic()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/l_r" title="f/radial_functions/l_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_onset" title="f/logic/l_onset"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_onset()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/kinetic_energy" title="f/kinetic_energy: This module handles the computation of kinetic energy and the time-averaged radial profiles."><code class="xref f f-mod docutils literal notranslate"><span class="pre">kinetic_energy</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/kinetic_energy/get_e_kin" title="f/kinetic_energy/get_e_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_kin()</span></code></a>): This module handles the computation of kinetic energy and the time-averaged radial profiles.</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/magnetic_energy" title="f/magnetic_energy: This module handles the computation and the writing of the diagnostic files related to magnetic energy: e_mag_oc.TAG, e_mag_ic.TAG, dipole.TAG, eMagR.TAG"><code class="xref f f-mod docutils literal notranslate"><span class="pre">magnetic_energy</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/magnetic_energy/get_e_mag" title="f/magnetic_energy/get_e_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_mag()</span></code></a>): This module handles the computation and the writing of the diagnostic files related to magnetic energy: e_mag_oc.TAG, e_mag_ic.TAG, dipole.TAG, eMagR.TAG</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal notranslate"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal notranslate"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_graphs" title="f/output_data/n_graphs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_graphs()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/l_max_cmb" title="f/output_data/l_max_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max_cmb()</span></code></a>): This module contains the parameters for output control</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_spat" title="f/sht/scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_spat()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_ic" title="f/constants/vol_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">vol_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="#f/out_coeff" title="f/out_coeff: This module contains the subroutines that calculate the Bcmb files, the [B|V|T]_coeff_r files and the [B|V|T]_lmr files"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_coeff</span></code></a> (<a class="reference internal" href="#f/out_coeff/write_pot_mpi" title="f/out_coeff/write_pot_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot_mpi()</span></code></a>): This module contains the subroutines that calculate the Bcmb files, the [B|V|T]_coeff_r files and the [B|V|T]_lmr files</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/spectra" title="f/spectra: This module handles the computation and the writing of spectra. It handles both 2-D spectra in (r,l) and (r,m) spaces and usual spectra integrated over all radii in (l) or (m) spaces...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">spectra</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-func docutils literal notranslate"><span class="pre">spectrum()</span></code></a>): This module handles the computation and the writing of spectra. It handles both 2-D spectra in (r,l) and (r,m) spaces and usual spectra integrated over all radii in (l) or (m) spaces….</p></li>
<li><p><a class="reference internal" href="#f/graphout_mod" title="f/graphout_mod: This module contains the subroutines that store the 3-D graphic files."><code class="xref f f-mod docutils literal notranslate"><span class="pre">graphout_mod</span></code></a> (<a class="reference internal" href="#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi_header()</span></code></a>): This module contains the subroutines that store the 3-D graphic files.</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der_even" title="f/radial_der_even"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der_even</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_drns_even()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_ddrns_even" title="f/radial_der_even/get_ddrns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddrns_even()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fieldslast" title="f/fieldslast: This module contains all the work arrays of the previous time-steps needed to time advance the code. They are needed in the time-stepping scheme...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fieldslast</span></code></a> (<a class="reference internal" href="baseModules.html#f/fieldslast/dwdt" title="f/fieldslast/dwdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dwdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dpdt" title="f/fieldslast/dpdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dpdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dzdt" title="f/fieldslast/dzdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dzdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dsdt" title="f/fieldslast/dsdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dsdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dxidt" title="f/fieldslast/dxidt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dxidt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dbdt" title="f/fieldslast/dbdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/djdt" title="f/fieldslast/djdt"><code class="xref f f-func docutils literal notranslate"><span class="pre">djdt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dbdt_ic" title="f/fieldslast/dbdt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbdt_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/djdt_ic" title="f/fieldslast/djdt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">djdt_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/domega_ma_dt" title="f/fieldslast/domega_ma_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">domega_ma_dt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/domega_ic_dt" title="f/fieldslast/domega_ic_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">domega_ic_dt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/dphidt" title="f/fieldslast/dphidt"><code class="xref f f-func docutils literal notranslate"><span class="pre">dphidt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/lorentz_torque_ic_dt" title="f/fieldslast/lorentz_torque_ic_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lorentz_torque_ic_dt()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fieldslast/lorentz_torque_ma_dt" title="f/fieldslast/lorentz_torque_ma_dt"><code class="xref f f-func docutils literal notranslate"><span class="pre">lorentz_torque_ma_dt()</span></code></a>): This module contains all the work arrays of the previous time-steps needed to time advance the code. They are needed in the time-stepping scheme….</p></li>
<li><p><a class="reference internal" href="checkPoints.html#f/storecheckpoints" title="f/storecheckpoints: This module contains several subroutines that can be used to store the checkpoint_#.tag files"><code class="xref f f-mod docutils literal notranslate"><span class="pre">storecheckpoints</span></code></a>: This module contains several subroutines that can be used to store the checkpoint_#.tag files</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/aj_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">aj_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/aj_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/aj_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">aj_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/aj_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/aj_ic_ave">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">aj_ic_ave</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/aj_ic_ave" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/b_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">b_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/b_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/b_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">b_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/b_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/b_ic_ave">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">b_ic_ave</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/b_ic_ave" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/bicb">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">bicb</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/bicb" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/p_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">p_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/p_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/p_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">p_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/p_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/phi_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">phi_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/phi_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/phi_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">phi_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/phi_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/s_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">s_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/s_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/s_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">s_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/s_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/w_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">w_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/w_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/w_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">w_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/w_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/xi_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">xi_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/xi_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/xi_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">xi_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/xi_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/z_ave_lmloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">z_ave_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/z_ave_lmloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/fields_average_mod/z_ave_rloc">
<span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">z_ave_rloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/fields_average_mod/z_ave_rloc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/fields_average_mod/initialize_fields_average_mod">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_fields_average_mod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/fields_average_mod/initialize_fields_average_mod" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/fields_average_mod/finalize_fields_average_mod">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_fields_average_mod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/fields_average_mod/finalize_fields_average_mod" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/fields_average_mod/fields_average">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">fields_average_mod/</span></span><span class="sig-name descname"><span class="pre">fields_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">simtime</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">nave</span></em>, <em class="sig-param"><span class="pre">l_stop_time</span></em>, <em class="sig-param"><span class="pre">time_passed</span></em>, <em class="sig-param"><span class="pre">time_norm</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/fields_average_mod/fields_average" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine averages fields b and v over time.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simtime</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>nave</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: number for averaged time steps</p></li>
<li><p><strong>l_stop_time</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: true if this is the last time step</p></li>
<li><p><strong>time_passed</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: time passed since last log</p></li>
<li><p><strong>time_norm</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: time passed since start of time loop</p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal notranslate"><span class="pre">output()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der_even/get_ddrns_even" title="f/radial_der_even/get_ddrns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddrns_even()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_drns_even()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-func docutils literal notranslate"><span class="pre">spectrum()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/kinetic_energy/get_e_kin" title="f/kinetic_energy/get_e_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_kin()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/magnetic_energy/get_e_mag" title="f/magnetic_energy/get_e_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_e_mag()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/open_graph_file" title="f/graphout_mod/open_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">open_graph_file()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi_header()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_from_lo_to_rank0" title="f/communications/gather_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/torpol_to_spat" title="f/sht/torpol_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">torpol_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/sht/scal_to_spat" title="f/sht/scal_to_spat"><code class="xref f f-func docutils literal notranslate"><span class="pre">scal_to_spat()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal notranslate"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/graphout_ic" title="f/graphout_mod/graphout_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_ic()</span></code></a>, <a class="reference internal" href="#f/graphout_mod/close_graph_file" title="f/graphout_mod/close_graph_file"><code class="xref f f-func docutils literal notranslate"><span class="pre">close_graph_file()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_bcmb" title="f/out_coeff/write_bcmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_bcmb()</span></code></a>, <a class="reference internal" href="#f/out_coeff/write_pot_mpi" title="f/out_coeff/write_pot_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">write_pot_mpi()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/storecheckpoints/store_mpi" title="f/storecheckpoints/store_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_mpi()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">IO: graphic files, movie files, coeff files and potential files</a><ul>
<li><a class="reference internal" href="#out-graph-file-f90"><code class="docutils literal notranslate"><span class="pre">out_graph_file.f90</span></code></a></li>
<li><a class="reference internal" href="#movie-f90"><code class="docutils literal notranslate"><span class="pre">movie.f90</span></code></a></li>
<li><a class="reference internal" href="#out-movie-file-f90"><code class="docutils literal notranslate"><span class="pre">out_movie_file.f90</span></code></a></li>
<li><a class="reference internal" href="#store-movie-ic-f90"><code class="docutils literal notranslate"><span class="pre">store_movie_IC.f90</span></code></a></li>
<li><a class="reference internal" href="#out-coeff-f90"><code class="docutils literal notranslate"><span class="pre">out_coeff.f90</span></code></a></li>
<li><a class="reference internal" href="#field-average-f90"><code class="docutils literal notranslate"><span class="pre">field_average.f90</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="IOGeneral.html"
                          title="previous chapter">IO: time series, radial profiles and spectra</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="IOAdd.html"
                          title="next chapter">IO: RMS force balance, torsional oscillations, misc</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/IOBinaryOutputs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="IOAdd.html" title="IO: RMS force balance, torsional oscillations, misc"
             >next</a> |</li>
        <li class="right" >
          <a href="IOGeneral.html" title="IO: time series, radial profiles and spectra"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">IO: graphic files, movie files, coeff files and potential files</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>