
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear calculation part of the time stepping (LMLoop) &#8212; Magic 5.10 documentation</title>
    <link rel="stylesheet" href="../_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 5.10 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Non-linear part of the time stepping (radial loop)" href="timeAdvNonLinear.html" />
    <link rel="prev" title="Time stepping" href="timeAdvance.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timeAdvance.html" title="Time stepping"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.10 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Linear calculation part of the time stepping (LMLoop)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="linear-calculation-part-of-the-time-stepping-lmloop">
<span id="secfortranlin"></span><h1>Linear calculation part of the time stepping (LMLoop)<a class="headerlink" href="#linear-calculation-part-of-the-time-stepping-lmloop" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/lmloop_mod">
<span id="lmloop-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">LMLoop.f90</span></code><a class="headerlink" href="#f/lmloop_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a>: This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>, <code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscalar()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="#f/updates_mod" title="f/updates_mod: This module handles the time advance of the entropy s. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updates_mod</span></code></a>: This module handles the time advance of the entropy s. It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="#f/updatez_mod" title="f/updatez_mod: This module handles the time advance of the toroidal potential z It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatez_mod</span></code></a>: This module handles the time advance of the toroidal potential z It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="#f/updatewp_mod" title="f/updatewp_mod: This module handles the time advance of the poloidal potential w and the pressure p. It contains the computation of the implicit terms and the linear solves."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatewp_mod</span></code></a>: This module handles the time advance of the poloidal potential w and the pressure p. It contains the computation of the implicit terms and the linear solves.</p></li>
<li><p><a class="reference internal" href="#f/updatewps_mod" title="f/updatewps_mod: This module handles the time advance of the poloidal potential w, the pressure p and the entropy s in one single matrix per degree. It contains the computation of the implicit terms and the linear"><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatewps_mod</span></code></a>: This module handles the time advance of the poloidal potential w, the pressure p and the entropy s in one single matrix per degree. It contains the computation of the implicit terms and the linear</p></li>
<li><p><a class="reference internal" href="#f/updateb_mod" title="f/updateb_mod: This module handles the time advance of the magnetic field potentials b and aj as well as the inner core counterparts b_ic and aj_ic. It contains the computation of the implicit terms and the linear"><code class="xref f f-mod docutils literal notranslate"><span class="pre">updateb_mod</span></code></a>: This module handles the time advance of the magnetic field potentials b and aj as well as the inner core counterparts b_ic and aj_ic. It contains the computation of the implicit terms and the linear</p></li>
<li><p><a class="reference internal" href="#f/updatexi_mod" title="f/updatexi_mod: This module handles the time advance of the chemical composition xi. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatexi_mod</span></code></a>: This module handles the time advance of the chemical composition xi. It contains the computation of the implicit terms and the linear solves….</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/lmloop_mod/initialize_lmloop">
<em class="property">subroutine  </em><code class="sig-prename descclassname">lmloop_mod/</code><code class="sig-name descname">initialize_lmloop</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/initialize_lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the memory allocation of the matrices needed
in the time advance of MagIC</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/initialize_updatewps" title="f/updatewps_mod/initialize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updates_mod/initialize_updates" title="f/updates_mod/initialize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updates()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/initialize_updatewp" title="f/updatewp_mod/initialize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/initialize_updatexi" title="f/updatexi_mod/initialize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/initialize_updatez" title="f/updatez_mod/initialize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatez()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/initialize_updateb" title="f/updateb_mod/initialize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updateb()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/lmloop_mod/finalize_lmloop">
<em class="property">subroutine  </em><code class="sig-prename descclassname">lmloop_mod/</code><code class="sig-name descname">finalize_lmloop</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/finalize_lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine deallocates the matrices involved in the time advance
of MagIC.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/finalize_updatewps" title="f/updatewps_mod/finalize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finalize_updates" title="f/updates_mod/finalize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updates()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finalize_updatewp" title="f/updatewp_mod/finalize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finalize_updatez" title="f/updatez_mod/finalize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatez()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finalize_updatexi" title="f/updatexi_mod/finalize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finalize_updateb" title="f/updateb_mod/finalize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updateb()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/lmloop_mod/lmloop">
<em class="property">subroutine  </em><code class="sig-prename descclassname">lmloop_mod/</code><code class="sig-name descname">lmloop</code><span class="sig-paren">(</span><em class="sig-param">time</em>, <em class="sig-param">timenext</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lmat</em>, <em class="sig-param">lrmsnext</em>, <em class="sig-param">lpressnext</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">dzdt</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">dxidt</em>, <em class="sig-param">dbdt</em>, <em class="sig-param">djdt</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">b_nl_cmb</em>, <em class="sig-param">aj_nl_cmb</em>, <em class="sig-param">aj_nl_icb</em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine performs the actual time-stepping. It calls succesively
the update routines of the various fields.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timenext</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lmat</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_nl_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for b at CMB</p></li>
<li><p><strong>aj_nl_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for aj at CMB</p></li>
<li><p><strong>aj_nl_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for dr aj at ICB</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/lmloop_mod/finish_explicit_assembly">
<em class="property">subroutine  </em><code class="sig-prename descclassname">lmloop_mod/</code><code class="sig-name descname">finish_explicit_assembly</code><span class="sig-paren">(</span><em class="sig-param">omega_ic</em>, <em class="sig-param">w</em>, <em class="sig-param">b_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">dvsr_lmloc</em>, <em class="sig-param">dvxir_lmloc</em>, <em class="sig-param">dvxvh_lmloc</em>, <em class="sig-param">dvxbh_lmloc</em>, <em class="sig-param">lorentz_torque_ma</em>, <em class="sig-param">lorentz_torque_ic</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">dxidt</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">djdt</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/finish_explicit_assembly" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to finish the computation of the explicit terms.
This is only possible in a LM-distributed space since it mainly involves
computation of radial derivatives.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsr_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxir_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxvh_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxbh_lmloc</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/finish_exp_comp" title="f/updatexi_mod/finish_exp_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat" title="f/updatewps_mod/finish_exp_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy" title="f/updates_mod/finish_exp_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol" title="f/updatewp_mod/finish_exp_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finish_exp_tor" title="f/updatez_mod/finish_exp_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_tor()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag" title="f/updateb_mod/finish_exp_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_ic" title="f/updateb_mod/finish_exp_mag_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/lmloop_mod/finish_explicit_assembly_rdist">
<em class="property">subroutine  </em><code class="sig-prename descclassname">lmloop_mod/</code><code class="sig-name descname">finish_explicit_assembly_rdist</code><span class="sig-paren">(</span><em class="sig-param">omega_ic</em>, <em class="sig-param">w</em>, <em class="sig-param">b_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">dvsr_rloc</em>, <em class="sig-param">dvxir_rloc</em>, <em class="sig-param">dvxvh_rloc</em>, <em class="sig-param">dvxbh_rloc</em>, <em class="sig-param">lorentz_torque_ma</em>, <em class="sig-param">lorentz_torque_ic</em>, <em class="sig-param">dsdt_rloc</em>, <em class="sig-param">dxidt_rloc</em>, <em class="sig-param">dwdt_rloc</em>, <em class="sig-param">djdt_rloc</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to finish the computation of the explicit terms.
This is the version that handles R-distributed arrays used when FD are
employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsr_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxir_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxvh_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxbh_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/finish_exp_comp_rdist" title="f/updatexi_mod/finish_exp_comp_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat_rdist" title="f/updatewps_mod/finish_exp_smat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat_rdist()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy_rdist" title="f/updates_mod/finish_exp_entropy_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol_rdist" title="f/updatewp_mod/finish_exp_pol_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol_rdist()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finish_exp_tor" title="f/updatez_mod/finish_exp_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_tor()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_rdist" title="f/updateb_mod/finish_exp_mag_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_rdist()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_ic" title="f/updateb_mod/finish_exp_mag_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/lmloop_mod/assemble_stage">
<em class="property">subroutine  </em><code class="sig-prename descclassname">lmloop_mod/</code><code class="sig-name descname">assemble_stage</code><span class="sig-paren">(</span><em class="sig-param">time</em>, <em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">p</em>, <em class="sig-param">dp</em>, <em class="sig-param">z</em>, <em class="sig-param">dz</em>, <em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">xi</em>, <em class="sig-param">dxi</em>, <em class="sig-param">b</em>, <em class="sig-param">db</em>, <em class="sig-param">ddb</em>, <em class="sig-param">aj</em>, <em class="sig-param">dj</em>, <em class="sig-param">ddj</em>, <em class="sig-param">b_ic</em>, <em class="sig-param">db_ic</em>, <em class="sig-param">ddb_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">dj_ic</em>, <em class="sig-param">ddj_ic</em>, <em class="sig-param">omega_ic</em>, <em class="sig-param">omega_ic1</em>, <em class="sig-param">omega_ma</em>, <em class="sig-param">omega_ma1</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">dzdt</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">dxidt</em>, <em class="sig-param">dbdt</em>, <em class="sig-param">djdt</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">lpressnext</em>, <em class="sig-param">lrmsnext</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/assemble_stage" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine is used to call the different assembly stage of the different
equations. This is only used for a special subset of IMEX-RK schemes that
have <code class="docutils literal notranslate"><span class="pre">tscheme%l_assembly=.true.</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>b</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/assemble_comp" title="f/updatexi_mod/assemble_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/assemble_single" title="f/updatewps_mod/assemble_single"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_single()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy" title="f/updates_mod/assemble_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/assemble_pol" title="f/updatewp_mod/assemble_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatewps_mod">
<span id="updatewps-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateWPS.f90</span></code><a class="headerlink" href="#f/updatewps_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the poloidal potential w,
the pressure p and the entropy s in one single matrix per degree.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/buo" title="f/updatewps_mod/buo"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/cor00_fac" title="f/updatewps_mod/cor00_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">cor00_fac</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/lwpsmat" title="f/updatewps_mod/lwpsmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lwpsmat</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/pre" title="f/updatewps_mod/pre"><code class="xref f f-var docutils literal notranslate"><span class="pre">pre</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/ps0mat" title="f/updatewps_mod/ps0mat"><code class="xref f f-var docutils literal notranslate"><span class="pre">ps0mat</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/ps0mat_fac" title="f/updatewps_mod/ps0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">ps0mat_fac</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/ps0pivot" title="f/updatewps_mod/ps0pivot"><code class="xref f f-var docutils literal notranslate"><span class="pre">ps0pivot</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/workb" title="f/updatewps_mod/workb"><code class="xref f f-var docutils literal notranslate"><span class="pre">workb</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/workc" title="f/updatewps_mod/workc"><code class="xref f f-var docutils literal notranslate"><span class="pre">workc</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/wpsmat" title="f/updatewps_mod/wpsmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpsmat</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/wpsmat_fac" title="f/updatewps_mod/wpsmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpsmat_fac</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/wpspivot" title="f/updatewps_mod/wpspivot"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpspivot</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewps_mod/assemble_single" title="f/updatewps_mod/assemble_single"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_single()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finalize_updatewps" title="f/updatewps_mod/finalize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat" title="f/updatewps_mod/finish_exp_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat_rdist" title="f/updatewps_mod/finish_exp_smat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_ps0mat" title="f/updatewps_mod/get_ps0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ps0mat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_wpsmat" title="f/updatewps_mod/get_wpsmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpsmat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/initialize_updatewps" title="f/updatewps_mod/initialize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal notranslate"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlkappa" title="f/radial_functions/dlkappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlkappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dltemp0" title="f/radial_functions/dltemp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dltemp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddltemp0" title="f/radial_functions/ddltemp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddltemp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/alpha0" title="f/radial_functions/alpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">alpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlalpha0" title="f/radial_functions/dlalpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlalpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddlalpha0" title="f/radial_functions/ddlalpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddlalpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ogrun" title="f/radial_functions/ogrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">ogrun()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/kappa" title="f/radial_functions/kappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">kappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dentropy0" title="f/radial_functions/dentropy0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dentropy0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktops" title="f/physical_parameters/ktops"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktops()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbots" title="f/physical_parameters/kbots"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbots()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/opr" title="f/physical_parameters/opr"><code class="xref f f-func docutils literal notranslate"><span class="pre">opr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">vischeatfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/thexpnb" title="f/physical_parameters/thexpnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">thexpnb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/buofac" title="f/physical_parameters/buofac"><code class="xref f f-func docutils literal notranslate"><span class="pre">buofac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">corfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopp" title="f/physical_parameters/ktopp"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopp()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/tops" title="f/init_fields/tops"><code class="xref f f-func docutils literal notranslate"><span class="pre">tops()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/bots" title="f/init_fields/bots"><code class="xref f f-func docutils literal notranslate"><span class="pre">bots()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_s" title="f/horizontal_data/hdif_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_s()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_v" title="f/logic/l_update_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_v()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_temperature_diff" title="f/logic/l_temperature_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_temperature_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpol2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpollmr()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/algebra" title="f/algebra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">algebra</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/solve_mat" title="f/algebra/solve_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_mat()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/get_global_sum" title="f/communications/get_global_sum"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_global_sum()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/osq4pi" title="f/constants/osq4pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">osq4pi()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt id="f/updatewps_mod/buo">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">buo</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/buo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/cor00_fac">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">cor00_fac</code><em> [</em><em>real</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/cor00_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/dif">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">dif</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/lwpsmat">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">lwpsmat</code> (*)<em> [</em><em>logical</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/lwpsmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/maxthreads">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">maxthreads</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/pre">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">pre</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/pre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/ps0mat">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">ps0mat</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/ps0mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/ps0mat_fac">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">ps0mat_fac</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/ps0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/ps0pivot">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">ps0pivot</code> (*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/ps0pivot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/rhs1">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">rhs1</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/workb">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">workb</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/workb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/workc">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">workc</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/workc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/wpsmat">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">wpsmat</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/wpsmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/wpsmat_fac">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">wpsmat_fac</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/wpsmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewps_mod/wpspivot">
<code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">wpspivot</code> (*,*)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewps_mod/wpspivot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/updatewps_mod/initialize_updatewps">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">initialize_updatewps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/initialize_updatewps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/finalize_updatewps">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">finalize_updatewps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/finalize_updatewps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/updatewps">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">updatewps</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">z10</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">p</em>, <em class="sig-param">dp</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lrmsnext</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/updatewps" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>updates the poloidal velocity potential w, the pressure p, the entropy
and their radial derivatives.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>z10</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/get_ps0mat" title="f/updatewps_mod/get_ps0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ps0mat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_wpsmat" title="f/updatewps_mod/get_wpsmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpsmat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/finish_exp_smat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">finish_exp_smat</code><span class="sig-paren">(</span><em class="sig-param">dvsrlm</em>, <em class="sig-param">ds_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/finish_exp_smat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/finish_exp_smat_rdist">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">finish_exp_smat_rdist</code><span class="sig-paren">(</span><em class="sig-param">dvsrlm</em>, <em class="sig-param">ds_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/finish_exp_smat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/assemble_single">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">assemble_single</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lrmsnext</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/assemble_single" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine is used to assemble the solution in case IMEX RK with
an assembly stage are used</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/get_single_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">get_single_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">p</em>, <em class="sig-param">dp</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em>, <em class="sig-param">lrmsnext</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/get_single_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/get_wpsmat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">get_wpsmat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif_vel</em>, <em class="sig-param">hdif_s</em>, <em class="sig-param">wpsmat</em>, <em class="sig-param">wpspivot</em>, <em class="sig-param">wpsmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/get_wpsmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
wpmat  for the NS equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif_vel</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif_s</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>wpsmat</strong> (3*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,3*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: ‘)</p></li>
<li><p><strong>wpspivot</strong> (3*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>wpsmat_fac</strong> (3*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewps_mod/get_ps0mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewps_mod/</code><code class="sig-name descname">get_ps0mat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">psmat</em>, <em class="sig-param">pspivot</em>, <em class="sig-param">psmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/get_ps0mat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>psmat</strong> (2*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: entropy diffusion</p></li>
<li><p><strong>pspivot</strong> (2*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>psmat_fac</strong> (2*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatewp_mod">
<span id="updatewp-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateWP.f90</span></code><a class="headerlink" href="#f/updatewp_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the poloidal potential w and the pressure p.
It contains the computation of the implicit terms and the linear solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/ddddw" title="f/updatewp_mod/ddddw"><code class="xref f f-var docutils literal notranslate"><span class="pre">ddddw</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/dwold" title="f/updatewp_mod/dwold"><code class="xref f f-var docutils literal notranslate"><span class="pre">dwold</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/l_ellmat" title="f/updatewp_mod/l_ellmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">l_ellmat</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/lwpmat" title="f/updatewp_mod/lwpmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lwpmat</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/rhs0" title="f/updatewp_mod/rhs0"><code class="xref f f-var docutils literal notranslate"><span class="pre">rhs0</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/size_rhs1" title="f/updatewp_mod/size_rhs1"><code class="xref f f-var docutils literal notranslate"><span class="pre">size_rhs1</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/work" title="f/updatewp_mod/work"><code class="xref f f-var docutils literal notranslate"><span class="pre">work</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/wpmat_fac" title="f/updatewp_mod/wpmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpmat_fac</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/assemble_pol" title="f/updatewp_mod/assemble_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finalize_updatewp" title="f/updatewp_mod/finalize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol" title="f/updatewp_mod/finish_exp_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol_rdist" title="f/updatewp_mod/finish_exp_pol_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_elliptic_mat" title="f/updatewp_mod/get_elliptic_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_elliptic_mat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_p0mat" title="f/updatewp_mod/get_p0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_p0mat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol" title="f/updatewp_mod/get_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wmat" title="f/updatewp_mod/get_wmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wmat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wpmat" title="f/updatewp_mod/get_wpmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpmat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/initialize_updatewp" title="f/updatewp_mod/initialize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal notranslate"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/alpha0" title="f/radial_functions/alpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">alpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ogrun" title="f/radial_functions/ogrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">ogrun()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddlvisc" title="f/radial_functions/ddlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddbeta" title="f/radial_functions/ddbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/buofac" title="f/physical_parameters/buofac"><code class="xref f f-func docutils literal notranslate"><span class="pre">buofac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/chemfac" title="f/physical_parameters/chemfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">chemfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">vischeatfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/thexpnb" title="f/physical_parameters/thexpnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">thexpnb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopp" title="f/physical_parameters/ktopp"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopp()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_v" title="f/logic/l_update_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_v()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_fluxprofs" title="f/logic/l_fluxprofs"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_fluxprofs()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpol2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpollmr()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/get_global_sum" title="f/communications/get_global_sum"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_global_sum()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a>): Radial integration functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt id="f/updatewp_mod/buo">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">buo</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/buo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/ddddw">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">ddddw</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/ddddw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/dif">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">dif</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/dwold">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">dwold</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/dwold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/l_ellmat">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">l_ellmat</code> (*)<em> [</em><em>logical</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/l_ellmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/lwpmat">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">lwpmat</code> (*)<em> [</em><em>logical</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/lwpmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/maxthreads">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">maxthreads</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/pre">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">pre</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/pre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/rhs0">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">rhs0</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/rhs0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/rhs1">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">rhs1</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/size_rhs1">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">size_rhs1</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/size_rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/work">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">work</code> (*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatewp_mod/wpmat_fac">
<code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">wpmat_fac</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatewp_mod/wpmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/updatewp_mod/initialize_updatewp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">initialize_updatewp</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/initialize_updatewp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to allocate the matrices needed
to time advance the poloidal/pressure equations. Depending on the
radial scheme, it can be either full or band matrices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/finalize_updatewp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">finalize_updatewp</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/finalize_updatewp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Deallocation of the matrices used to time-advance the poloidal/pressure
equations.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/updatewp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">updatewp</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">xi</em>, <em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">p</em>, <em class="sig-param">dp</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lrmsnext</em>, <em class="sig-param">lpressnext</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/updatewp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>updates the poloidal velocity potential w, the pressure p, and
their radial derivatives.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_p0mat" title="f/updatewp_mod/get_p0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_p0mat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wmat" title="f/updatewp_mod/get_wmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wmat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wpmat" title="f/updatewp_mod/get_wpmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpmat()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/get_pol">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">get_pol</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">work</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_pol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Get the poloidal potential from the solve of an elliptic equation.
Careful: the output is in Chebyshev space!</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>work</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/assemble_pol" title="f/updatewp_mod/assemble_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_elliptic_mat" title="f/updatewp_mod/get_elliptic_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_elliptic_mat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/finish_exp_pol">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">finish_exp_pol</code><span class="sig-paren">(</span><em class="sig-param">dvxvhlm</em>, <em class="sig-param">dw_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/finish_exp_pol" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxvhlm</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/finish_exp_pol_rdist">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">finish_exp_pol_rdist</code><span class="sig-paren">(</span><em class="sig-param">dvxvhlm</em>, <em class="sig-param">dw_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/finish_exp_pol_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxvhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/get_pol_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">get_pol_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">xi</em>, <em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">p</em>, <em class="sig-param">dp</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em>, <em class="sig-param">lpressnext</em>, <em class="sig-param">lrmsnext</em>, <em class="sig-param">dp_expl</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_pol_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the derivatives of w and p and assemble the
implicit stage if needed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dp_expl</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/assemble_pol">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">assemble_pol</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">xi</em>, <em class="sig-param">w</em>, <em class="sig-param">dw</em>, <em class="sig-param">ddw</em>, <em class="sig-param">p</em>, <em class="sig-param">dp</em>, <em class="sig-param">dwdt</em>, <em class="sig-param">dpdt</em>, <em class="sig-param">dp_expl</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lpressnext</em>, <em class="sig-param">lrmsnext</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/assemble_pol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble w and dw/dr when IMEX RK time schemes
which necessitate an assembly stage are employed. Robin-type boundary
conditions are enforced using Canuto (1986) approach.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp_expl</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_pol" title="f/updatewp_mod/get_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/get_wpmat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">get_wpmat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">wpmat</em>, <em class="sig-param">wpmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_wpmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
<code class="docutils literal notranslate"><span class="pre">wpMat</span></code> for the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: hyperdiffusion</p></li>
<li><p><strong>wpmat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>wpmat_fac</strong> (2*<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/get_elliptic_mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">get_elliptic_mat</code><span class="sig-paren">(</span><em class="sig-param">l</em>, <em class="sig-param">ellmat</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_elliptic_mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the matrix needed
for the derivation of w for the time advance of the poloidal equation
if the double curl form is used.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>ellmat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/get_pol" title="f/updatewp_mod/get_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/get_wmat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">get_wmat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">wmat</em>, <em class="sig-param">wmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_wmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
wpmat  for the NS equation. This matrix corresponds here to the
radial component of the double-curl of the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: hyperdiffusion</p></li>
<li><p><strong>wmat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>wmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatewp_mod/get_p0mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatewp_mod/</code><code class="sig-name descname">get_p0mat</code><span class="sig-paren">(</span><em class="sig-param">pmat</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_p0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine solves the linear problem of the spherically-symmetric
pressure</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pmat</strong><em> [</em><em>real</em><em>]</em> :: matrix</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatez_mod">
<span id="updatez-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateZ.f90</span></code><a class="headerlink" href="#f/updatez_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the toroidal potential z
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/dif" title="f/updatez_mod/dif"><code class="xref f f-var docutils literal notranslate"><span class="pre">dif</span></code></a>, <a class="reference internal" href="#f/updatez_mod/lz10mat" title="f/updatez_mod/lz10mat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lz10mat</span></code></a>, <a class="reference internal" href="#f/updatez_mod/lzmat" title="f/updatez_mod/lzmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lzmat</span></code></a>, <a class="reference internal" href="#f/updatez_mod/maxthreads" title="f/updatez_mod/maxthreads"><code class="xref f f-var docutils literal notranslate"><span class="pre">maxthreads</span></code></a>, <a class="reference internal" href="#f/updatez_mod/rhs1" title="f/updatez_mod/rhs1"><code class="xref f f-var docutils literal notranslate"><span class="pre">rhs1</span></code></a>, <a class="reference internal" href="#f/updatez_mod/z10mat_fac" title="f/updatez_mod/z10mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">z10mat_fac</span></code></a>, <a class="reference internal" href="#f/updatez_mod/zmat_fac" title="f/updatez_mod/zmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">zmat_fac</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finalize_updatez" title="f/updatez_mod/finalize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finish_exp_tor" title="f/updatez_mod/finish_exp_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_tor()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_rot_rates" title="f/updatez_mod/get_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_rot_rates()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_z10mat" title="f/updatez_mod/get_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_z10mat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_zmat" title="f/updatez_mod/get_zmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_zmat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/initialize_updatez" title="f/updatez_mod/initialize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a>: This module is used to construct the initial solution.</p></li>
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prec_angle" title="f/physical_parameters/prec_angle"><code class="xref f f-func docutils literal notranslate"><span class="pre">prec_angle()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/po" title="f/physical_parameters/po"><code class="xref f f-func docutils literal notranslate"><span class="pre">po()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/oek" title="f/physical_parameters/oek"><code class="xref f f-func docutils literal notranslate"><span class="pre">oek()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/amstart" title="f/num_param/amstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">amstart()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal notranslate"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="IOAdd.html#f/torsional_oscillations/ddzasl" title="f/torsional_oscillations/ddzasl"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddzasl()</span></code></a>): This module contains information for TO calculation and output</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_srma" title="f/logic/l_srma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_srma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_sric" title="f/logic/l_sric"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_sric()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_z10mat" title="f/logic/l_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_z10mat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_precession" title="f/logic/l_precession"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_precession()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_correct_ame" title="f/logic/l_correct_ame"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_correct_ame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_correct_amz" title="f/logic/l_correct_amz"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_correct_amz()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_update_v" title="f/logic/l_update_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_v()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_to" title="f/logic/l_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_to()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/diftor2hint" title="f/rms/diftor2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">diftor2hint()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/c_lorentz_ma" title="f/constants/c_lorentz_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_lorentz_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_lorentz_ic" title="f/constants/c_lorentz_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_lorentz_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_dt_z10_ma" title="f/constants/c_dt_z10_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_dt_z10_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_dt_z10_ic" title="f/constants/c_dt_z10_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_dt_z10_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_ma" title="f/constants/c_moi_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_ic" title="f/constants/c_moi_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_z10_omega_ma" title="f/constants/c_z10_omega_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_z10_omega_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_z10_omega_ic" title="f/constants/c_z10_omega_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_z10_omega_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_oc" title="f/constants/c_moi_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/y10_norm" title="f/constants/y10_norm"><code class="xref f f-func docutils literal notranslate"><span class="pre">y10_norm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/y11_norm" title="f/constants/y11_norm"><code class="xref f f-func docutils literal notranslate"><span class="pre">y11_norm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/outrot" title="f/outrot"><code class="xref f f-mod docutils literal notranslate"><span class="pre">outrot</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outrot/get_angular_moment" title="f/outrot/get_angular_moment"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_angular_moment()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2tor" title="f/rms_helpers/hint2tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2tor()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>, <code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscalar()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/special" title="f/special: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes"><code class="xref f f-mod docutils literal notranslate"><span class="pre">special</span></code></a>: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt id="f/updatez_mod/dif">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">dif</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatez_mod/dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatez_mod/lz10mat">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">lz10mat</code><em> [</em><em>logical</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/updatez_mod/lz10mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatez_mod/lzmat">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">lzmat</code> (*)<em> [</em><em>logical</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/updatez_mod/lzmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatez_mod/maxthreads">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">maxthreads</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updatez_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatez_mod/rhs1">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">rhs1</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatez_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd><p>RHS for other modes</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatez_mod/z10mat_fac">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">z10mat_fac</code> (*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatez_mod/z10mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatez_mod/zmat_fac">
<code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">zmat_fac</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatez_mod/zmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/updatez_mod/initialize_updatez">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">initialize_updatez</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/initialize_updatez" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/finalize_updatez">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">finalize_updatez</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/finalize_updatez" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/updatez">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">updatez</code><span class="sig-paren">(</span><em class="sig-param">time</em>, <em class="sig-param">timenext</em>, <em class="sig-param">z</em>, <em class="sig-param">dz</em>, <em class="sig-param">dzdt</em>, <em class="sig-param">omega_ma</em>, <em class="sig-param">omega_ic</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lrmsnext</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/updatez" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the toroidal potential z and its radial derivative dz</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Current stage time</p></li>
<li><p><strong>timenext</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Next time</p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Toroidal velocity potential z</p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of z</p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Calculated OC rotation</p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Calculated IC rotation</p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Logical for storing update if (l_RMS.and.l_logNext)</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/get_zmat" title="f/updatez_mod/get_zmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_zmat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_z10mat" title="f/updatez_mod/get_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_z10mat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/get_tor_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">get_tor_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">time</em>, <em class="sig-param">z</em>, <em class="sig-param">dz</em>, <em class="sig-param">dzdt</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">omega_ic</em>, <em class="sig-param">omega_ma</em>, <em class="sig-param">omega_ic1</em>, <em class="sig-param">omega_ma1</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em>, <em class="sig-param">lrmsnext</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_tor_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/get_angular_moment" title="f/outrot/get_angular_moment"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_angular_moment()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2tor" title="f/rms_helpers/hint2tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2tor()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/assemble_tor">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">assemble_tor</code><span class="sig-paren">(</span><em class="sig-param">time</em>, <em class="sig-param">z</em>, <em class="sig-param">dz</em>, <em class="sig-param">dzdt</em>, <em class="sig-param">domega_ic_dt</em>, <em class="sig-param">domega_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">omega_ic</em>, <em class="sig-param">omega_ma</em>, <em class="sig-param">omega_ic1</em>, <em class="sig-param">omega_ma1</em>, <em class="sig-param">lrmsnext</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/assemble_tor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the toroidal flow potential when an IMEX
RK time scheme with an assembly stage is employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/update_rot_rates">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">update_rot_rates</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">lo_ma</em>, <em class="sig-param">lo_ic</em>, <em class="sig-param">lorentz_torque_ma_dt</em>, <em class="sig-param">lorentz_torque_ic_dt</em>, <em class="sig-param">omega_ma</em>, <em class="sig-param">omega_ma1</em>, <em class="sig-param">omega_ic</em>, <em class="sig-param">omega_ic1</em>, <em class="sig-param">istage</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/update_rot_rates" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lo_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lo_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: RHS when stress-free BCs are used</p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/get_rot_rates" title="f/updatez_mod/get_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_rot_rates()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/get_rot_rates">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">get_rot_rates</code><span class="sig-paren">(</span><em class="sig-param">omega</em>, <em class="sig-param">domega_old</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_rot_rates" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Rotation rate</p></li>
<li><p><strong>domega_old</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Old value of the rotation rate</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/finish_exp_tor">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">finish_exp_tor</code><span class="sig-paren">(</span><em class="sig-param">lorentz_torque_ma</em>, <em class="sig-param">lorentz_torque_ic</em>, <em class="sig-param">domega_ma_dt_exp</em>, <em class="sig-param">domega_ic_dt_exp</em>, <em class="sig-param">lorentz_ma_exp</em>, <em class="sig-param">lorentz_ic_exp</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/finish_exp_tor" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lorentz torque (for OC rotation)</p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lorentz torque (for IC rotation)</p></li>
<li><p><strong>domega_ma_dt_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lorentz_ma_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lorentz_ic_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/get_z10mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">get_z10mat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">zmat</em>, <em class="sig-param">zmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_z10mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to construct and LU-decompose the
inversion matrix <code class="docutils literal notranslate"><span class="pre">z10mat</span></code> for the implicit time step of the
toroidal velocity potential z of degree <span class="math notranslate nohighlight">\(\ell=1\)</span> and order <span class="math notranslate nohighlight">\(m=0\)</span>.
This differs from the the normal zmat only if either the ICB or
CMB have no-slip boundary condition and inner core or mantle are
chosen to rotate freely (either <code class="docutils literal notranslate"><span class="pre">kbotv=1</span></code> and/or <code class="docutils literal notranslate"><span class="pre">ktopv=1</span></code>).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: Time step internal</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Variable to loop over degrees</p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Value of hyperdiffusivity in zMat terms</p></li>
<li><p><strong>zmat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>zmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Inverse of max(zMat) for inversion</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatez_mod/get_zmat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatez_mod/</code><code class="sig-name descname">get_zmat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">zmat</em>, <em class="sig-param">zmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_zmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
<code class="docutils literal notranslate"><span class="pre">zmat(i,j)</span></code> for the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Variable to loop over degrees</p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Hyperdiffusivity</p></li>
<li><p><strong>zmat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>zmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Inverse of max(zMat) for the inversion</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updates_mod">
<span id="updates-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateS.f90</span></code><a class="headerlink" href="#f/updates_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the entropy s.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/lsmat" title="f/updates_mod/lsmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lsmat</span></code></a>, <a class="reference internal" href="#f/updates_mod/s0mat_fac" title="f/updates_mod/s0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">s0mat_fac</span></code></a>, <a class="reference internal" href="#f/updates_mod/smat_fac" title="f/updates_mod/smat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">smat_fac</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/assemble_entropy" title="f/updates_mod/assemble_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finalize_updates" title="f/updates_mod/finalize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy" title="f/updates_mod/finish_exp_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy_rdist" title="f/updates_mod/finish_exp_entropy_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy_rdist()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_s0mat" title="f/updates_mod/get_s0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_s0mat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_smat" title="f/updates_mod/get_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_smat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/initialize_updates" title="f/updates_mod/initialize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dentropy0" title="f/radial_functions/dentropy0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dentropy0()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/kappa" title="f/radial_functions/kappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">kappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlkappa" title="f/radial_functions/dlkappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlkappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dltemp0" title="f/radial_functions/dltemp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dltemp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/opr" title="f/physical_parameters/opr"><code class="xref f f-func docutils literal notranslate"><span class="pre">opr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbots" title="f/physical_parameters/kbots"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbots()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktops" title="f/physical_parameters/ktops"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktops()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/tops" title="f/init_fields/tops"><code class="xref f f-func docutils literal notranslate"><span class="pre">tops()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/bots" title="f/init_fields/bots"><code class="xref f f-func docutils literal notranslate"><span class="pre">bots()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_s" title="f/horizontal_data/hdif_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_s()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_s" title="f/logic/l_update_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_s()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anelastic_liquid" title="f/logic/l_anelastic_liquid"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_anelastic_liquid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt id="f/updates_mod/lsmat">
<code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">lsmat</code> (*)<em> [</em><em>logical</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/updates_mod/lsmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updates_mod/maxthreads">
<code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">maxthreads</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updates_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updates_mod/rhs1">
<code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">rhs1</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updates_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updates_mod/s0mat_fac">
<code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">s0mat_fac</code> (*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updates_mod/s0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updates_mod/smat_fac">
<code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">smat_fac</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updates_mod/smat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/updates_mod/initialize_updates">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">initialize_updates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/initialize_updates" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/finalize_updates">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">finalize_updates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/finalize_updates" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/updates">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">updates</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/updates" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the entropy field s and its radial derivative.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Entropy</p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of entropy</p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/get_s0mat" title="f/updates_mod/get_s0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_s0mat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_smat" title="f/updates_mod/get_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_smat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/finish_exp_entropy">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">finish_exp_entropy</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">dvsrlm</em>, <em class="sig-param">ds_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/finish_exp_entropy" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/finish_exp_entropy_rdist">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">finish_exp_entropy_rdist</code><span class="sig-paren">(</span><em class="sig-param">w</em>, <em class="sig-param">dvsrlm</em>, <em class="sig-param">ds_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/finish_exp_entropy_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/get_entropy_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">get_entropy_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_entropy_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy" title="f/updates_mod/assemble_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/assemble_entropy">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">assemble_entropy</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">ds</em>, <em class="sig-param">dsdt</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/assemble_entropy" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the entropy/temperature at assembly
stages of IMEX-RK time schemes</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/get_s0mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">get_s0mat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">smat</em>, <em class="sig-param">smat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_s0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
sMat0</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>smat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>smat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updates_mod/get_smat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updates_mod/</code><code class="sig-name descname">get_smat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">smat</em>, <em class="sig-param">smat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_smat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
sMat(i,j) and s0mat for the entropy equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>smat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>smat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatexi_mod">
<span id="updatexi-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateXI.f90</span></code><a class="headerlink" href="#f/updatexi_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the chemical composition xi.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/lximat" title="f/updatexi_mod/lximat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lximat</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/xi0mat_fac" title="f/updatexi_mod/xi0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi0mat_fac</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/ximat_fac" title="f/updatexi_mod/ximat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">ximat_fac</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/assemble_comp" title="f/updatexi_mod/assemble_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finalize_updatexi" title="f/updatexi_mod/finalize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finish_exp_comp" title="f/updatexi_mod/finish_exp_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finish_exp_comp_rdist" title="f/updatexi_mod/finish_exp_comp_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp_rdist()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_xi0mat" title="f/updatexi_mod/get_xi0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_xi0mat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_ximat" title="f/updatexi_mod/get_ximat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ximat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/initialize_updatexi" title="f/updatexi_mod/initialize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/osc" title="f/physical_parameters/osc"><code class="xref f f-func docutils literal notranslate"><span class="pre">osc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotxi" title="f/physical_parameters/kbotxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopxi" title="f/physical_parameters/ktopxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopxi()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/topxi" title="f/init_fields/topxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">topxi()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/botxi" title="f/init_fields/botxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">botxi()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_xi" title="f/horizontal_data/hdif_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_xi()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_xi" title="f/logic/l_update_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_xi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt id="f/updatexi_mod/lximat">
<code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">lximat</code> (*)<em> [</em><em>logical</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/updatexi_mod/lximat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatexi_mod/maxthreads">
<code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">maxthreads</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/updatexi_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatexi_mod/rhs1">
<code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">rhs1</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatexi_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatexi_mod/xi0mat_fac">
<code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">xi0mat_fac</code> (*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatexi_mod/xi0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updatexi_mod/ximat_fac">
<code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">ximat_fac</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updatexi_mod/ximat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/updatexi_mod/initialize_updatexi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">initialize_updatexi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/initialize_updatexi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/finalize_updatexi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">finalize_updatexi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/finalize_updatexi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/updatexi">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">updatexi</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">dxi</em>, <em class="sig-param">dxidt</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/updatexi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the chemical composition field s and its radial derivative.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Chemical composition</p></li>
<li><p><strong>dxi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of xi</p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/get_xi0mat" title="f/updatexi_mod/get_xi0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_xi0mat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_ximat" title="f/updatexi_mod/get_ximat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ximat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/finish_exp_comp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">finish_exp_comp</code><span class="sig-paren">(</span><em class="sig-param">dvxirlm</em>, <em class="sig-param">dxi_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/finish_exp_comp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxirlm</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/finish_exp_comp_rdist">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">finish_exp_comp_rdist</code><span class="sig-paren">(</span><em class="sig-param">dvxirlm</em>, <em class="sig-param">dxi_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/finish_exp_comp_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxirlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/get_comp_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">get_comp_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">dxi</em>, <em class="sig-param">dxidt</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_comp_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/assemble_comp" title="f/updatexi_mod/assemble_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/assemble_comp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">assemble_comp</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">dxi</em>, <em class="sig-param">dxidt</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/assemble_comp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the chemical composition when an
IMEX-RK with an assembly stage is employed. Non-Dirichlet boundary
conditions are handled using Canuto (1986) approach.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>-(<a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/get_xi0mat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">get_xi0mat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">ximat</em>, <em class="sig-param">ximat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_xi0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
xiMat0</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>ximat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>ximat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updatexi_mod/get_ximat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updatexi_mod/</code><code class="sig-name descname">get_ximat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">ximat</em>, <em class="sig-param">ximat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_ximat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
xiMat(i,j) for the equation for the chemical composition.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ximat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>ximat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updateb_mod">
<span id="updateb-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateB.f90</span></code><a class="headerlink" href="#f/updateb_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the magnetic field potentials
b and aj as well as the inner core counterparts b_ic and aj_ic.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updateb_mod/bmat_fac" title="f/updateb_mod/bmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">bmat_fac</span></code></a>, <a class="reference internal" href="#f/updateb_mod/dtp" title="f/updateb_mod/dtp"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtp</span></code></a>, <a class="reference internal" href="#f/updateb_mod/dtt" title="f/updateb_mod/dtt"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtt</span></code></a>, <a class="reference internal" href="#f/updateb_mod/jmat_fac" title="f/updateb_mod/jmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">jmat_fac</span></code></a>, <a class="reference internal" href="#f/updateb_mod/lbmat" title="f/updateb_mod/lbmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lbmat</span></code></a>, <a class="reference internal" href="#f/updateb_mod/rhs2" title="f/updateb_mod/rhs2"><code class="xref f f-var docutils literal notranslate"><span class="pre">rhs2</span></code></a>, <a class="reference internal" href="#f/updateb_mod/work_ic_lmloc" title="f/updateb_mod/work_ic_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">work_ic_lmloc</span></code></a>, <a class="reference internal" href="#f/updateb_mod/worka" title="f/updateb_mod/worka"><code class="xref f f-var docutils literal notranslate"><span class="pre">worka</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finalize_updateb" title="f/updateb_mod/finalize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag" title="f/updateb_mod/finish_exp_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_ic" title="f/updateb_mod/finish_exp_mag_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_ic()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_rdist" title="f/updateb_mod/finish_exp_mag_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_rdist()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_bmat" title="f/updateb_mod/get_bmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bmat()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/initialize_updateb" title="f/updateb_mod/initialize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_tot" title="f/truncation/n_r_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_cheb_ic_max" title="f/truncation/n_cheb_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_cheb_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_totmag" title="f/truncation/n_r_totmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_totmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic" title="f/radial_functions/chebt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic_even" title="f/radial_functions/chebt_ic_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic_even()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d2cheb_ic" title="f/radial_functions/d2cheb_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">d2cheb_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_norm_ic" title="f/radial_functions/cheb_norm_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">cheb_norm_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_fac_ic" title="f/radial_functions/dr_fac_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_fac_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/lambda" title="f/radial_functions/lambda"><code class="xref f f-func docutils literal notranslate"><span class="pre">lambda()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dllambda" title="f/radial_functions/dllambda"><code class="xref f f-func docutils literal notranslate"><span class="pre">dllambda()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_ic" title="f/radial_functions/cheb_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">cheb_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dcheb_ic" title="f/radial_functions/dcheb_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dcheb_ic()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_top_ic" title="f/radial_functions/dr_top_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_top_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/opm" title="f/physical_parameters/opm"><code class="xref f f-func docutils literal notranslate"><span class="pre">opm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/o_sr" title="f/physical_parameters/o_sr"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotb" title="f/physical_parameters/kbotb"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/imagcon" title="f/physical_parameters/imagcon"><code class="xref f f-func docutils literal notranslate"><span class="pre">imagcon()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/tmagcon" title="f/physical_parameters/tmagcon"><code class="xref f f-func docutils literal notranslate"><span class="pre">tmagcon()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/conductance_ma" title="f/physical_parameters/conductance_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">conductance_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopb" title="f/physical_parameters/ktopb"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopb()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/bpeaktop" title="f/init_fields/bpeaktop"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpeaktop()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/bpeakbot" title="f/init_fields/bpeakbot"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpeakbot()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_b" title="f/horizontal_data/hdif_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_b()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_lcr" title="f/logic/l_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_icb" title="f/logic/l_b_nl_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_b_nl_icb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_cmb" title="f/logic/l_b_nl_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_b_nl_cmb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_update_b" title="f/logic/l_update_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_b()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/dtbpollmr" title="f/rms/dtbpollmr"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbpollmr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/dtbpol2hint" title="f/rms/dtbpol2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbpol2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/dtbtor2hint" title="f/rms/dtbtor2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbtor2hint()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/special" title="f/special: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes"><code class="xref f f-mod docutils literal notranslate"><span class="pre">special</span></code></a>: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pollm" title="f/rms_helpers/hint2pollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pollm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2torlm" title="f/rms_helpers/hint2torlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2torlm()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains the potential fields and their radial derivatives</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der_even" title="f/radial_der_even"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der_even</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der_even/get_ddr_even" title="f/radial_der_even/get_ddr_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_even()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">bordered_matrices</span></code></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt id="f/updateb_mod/bmat_fac">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">bmat_fac</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/bmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/dtp">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">dtp</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/dtp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/dtt">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">dtt</code> (*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/dtt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/jmat_fac">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">jmat_fac</code> (*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/jmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/lbmat">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">lbmat</code> (*)<em> [</em><em>logical</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/updateb_mod/lbmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/rhs1">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">rhs1</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/rhs2">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">rhs2</code> (*,*,*)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/rhs2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/work_ic_lmloc">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">work_ic_lmloc</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/work_ic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/worka">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">worka</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/worka" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt id="f/updateb_mod/workb">
<code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">workb</code> (*,*)<em> [</em><em>complex</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/updateb_mod/workb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/updateb_mod/initialize_updateb">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">initialize_updateb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/initialize_updateb" title="Permalink to this definition">¶</a></dt>
<dd><p>Purpose of this subroutine is to allocate the matrices needed
to time advance the magnetic field. Depending on the
radial scheme and the inner core conductivity, it can be full,
bordered or band matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/finalize_updateb">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">finalize_updateb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finalize_updateb" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine deallocates the matrices involved in the time
advance of the magnetic field</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/updateb">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">updateb</code><span class="sig-paren">(</span><em class="sig-param">b</em>, <em class="sig-param">db</em>, <em class="sig-param">ddb</em>, <em class="sig-param">aj</em>, <em class="sig-param">dj</em>, <em class="sig-param">ddj</em>, <em class="sig-param">dbdt</em>, <em class="sig-param">djdt</em>, <em class="sig-param">b_ic</em>, <em class="sig-param">db_ic</em>, <em class="sig-param">ddb_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">dj_ic</em>, <em class="sig-param">ddj_ic</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">b_nl_cmb</em>, <em class="sig-param">aj_nl_cmb</em>, <em class="sig-param">aj_nl_icb</em>, <em class="sig-param">time</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">lrmsnext</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/updateb" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates update of magnetic field potentials.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_nl_cmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear BC for b at CMB</p></li>
<li><p><strong>aj_nl_cmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear BC for aj at CMB</p></li>
<li><p><strong>aj_nl_icb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear BC for dr aj at ICB</p></li>
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_bmat" title="f/updateb_mod/get_bmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bmat()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/finish_exp_mag_ic">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">finish_exp_mag_ic</code><span class="sig-paren">(</span><em class="sig-param">b_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">omega_ic</em>, <em class="sig-param">db_exp_last</em>, <em class="sig-param">dj_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finish_exp_mag_ic" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/finish_exp_mag">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">finish_exp_mag</code><span class="sig-paren">(</span><em class="sig-param">dvxbhlm</em>, <em class="sig-param">dj_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finish_exp_mag" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxbhlm</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_exp_last</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/finish_exp_mag_rdist">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">finish_exp_mag_rdist</code><span class="sig-paren">(</span><em class="sig-param">dvxbhlm</em>, <em class="sig-param">dj_exp_last</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finish_exp_mag_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxbhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/get_mag_ic_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">get_mag_ic_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">b_ic</em>, <em class="sig-param">db_ic</em>, <em class="sig-param">ddb_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">dj_ic</em>, <em class="sig-param">ddj_ic</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_ddr_even" title="f/radial_der_even/get_ddr_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_even()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/assemble_mag">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">assemble_mag</code><span class="sig-paren">(</span><em class="sig-param">b</em>, <em class="sig-param">db</em>, <em class="sig-param">ddb</em>, <em class="sig-param">aj</em>, <em class="sig-param">dj</em>, <em class="sig-param">ddj</em>, <em class="sig-param">b_ic</em>, <em class="sig-param">db_ic</em>, <em class="sig-param">ddb_ic</em>, <em class="sig-param">aj_ic</em>, <em class="sig-param">dj_ic</em>, <em class="sig-param">ddj_ic</em>, <em class="sig-param">dbdt</em>, <em class="sig-param">djdt</em>, <em class="sig-param">dbdt_ic</em>, <em class="sig-param">djdt_ic</em>, <em class="sig-param">lrmsnext</em>, <em class="sig-param">tscheme</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/assemble_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/get_mag_rhs_imp">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">get_mag_rhs_imp</code><span class="sig-paren">(</span><em class="sig-param">b</em>, <em class="sig-param">db</em>, <em class="sig-param">ddb</em>, <em class="sig-param">aj</em>, <em class="sig-param">dj</em>, <em class="sig-param">ddj</em>, <em class="sig-param">dbdt</em>, <em class="sig-param">djdt</em>, <em class="sig-param">tscheme</em>, <em class="sig-param">istage</em>, <em class="sig-param">l_calc_lin</em>, <em class="sig-param">lrmsnext</em><span class="optional">[</span>, <em class="sig-param">l_in_cheb_space</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_mag_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>-(<a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pollm" title="f/rms_helpers/hint2pollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pollm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2torlm" title="f/rms_helpers/hint2torlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2torlm()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="subroutine">
<dt id="f/updateb_mod/get_bmat">
<em class="property">subroutine  </em><code class="sig-prename descclassname">updateb_mod/</code><code class="sig-name descname">get_bmat</code><span class="sig-paren">(</span><em class="sig-param">tscheme</em>, <em class="sig-param">l</em>, <em class="sig-param">hdif</em>, <em class="sig-param">bmat</em>, <em class="sig-param">bmat_fac</em>, <em class="sig-param">jmat</em>, <em class="sig-param">jmat_fac</em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_bmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
<code class="docutils literal notranslate"><span class="pre">bmat(i,j)</span></code> and <code class="docutils literal notranslate"><span class="pre">ajmat</span></code> for the dynamo equations.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bmat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>bmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_totmag" title="f/truncation/n_r_totmag">n_r_totmag</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>jmat</strong><em> [</em><em>integer</em><em>]</em> :: ‘)</p></li>
<li><p><strong>jmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_totmag" title="f/truncation/n_r_totmag">n_r_totmag</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Linear calculation part of the time stepping (LMLoop)</a><ul>
<li><a class="reference internal" href="#f/lmloop_mod"><code class="docutils literal notranslate"><span class="pre">LMLoop.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatewps_mod"><code class="docutils literal notranslate"><span class="pre">updateWPS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatewp_mod"><code class="docutils literal notranslate"><span class="pre">updateWP.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatez_mod"><code class="docutils literal notranslate"><span class="pre">updateZ.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updates_mod"><code class="docutils literal notranslate"><span class="pre">updateS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatexi_mod"><code class="docutils literal notranslate"><span class="pre">updateXI.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updateb_mod"><code class="docutils literal notranslate"><span class="pre">updateB.f90</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="timeAdvance.html"
                        title="previous chapter">Time stepping</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="timeAdvNonLinear.html"
                        title="next chapter">Non-linear part of the time stepping (radial loop)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/timeAdvLinear.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             >next</a> |</li>
        <li class="right" >
          <a href="timeAdvance.html" title="Time stepping"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.10 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Linear calculation part of the time stepping (LMLoop)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
  </body>
</html>