
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Linear calculation part of the time stepping (LMLoop) &#8212; Magic 6.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.0 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Non-linear part of the time stepping (radial loop)" href="timeAdvNonLinear.html" />
    <link rel="prev" title="Time stepping" href="timeAdvance.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timeAdvance.html" title="Time stepping"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Linear calculation part of the time stepping (LMLoop)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="linear-calculation-part-of-the-time-stepping-lmloop">
<span id="secfortranlin"></span><h1>Linear calculation part of the time stepping (LMLoop)<a class="headerlink" href="#linear-calculation-part-of-the-time-stepping-lmloop" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/lmloop_mod">
<span id="lmloop-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">LMLoop.f90</span></code><a class="headerlink" href="#f/lmloop_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/array_of_requests" title="f/lmloop_mod/array_of_requests"><code class="xref f f-var docutils literal notranslate"><span class="pre">array_of_requests</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/block_sze" title="f/lmloop_mod/block_sze"><code class="xref f f-var docutils literal notranslate"><span class="pre">block_sze</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/n_penta" title="f/lmloop_mod/n_penta"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_penta</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/n_requests" title="f/lmloop_mod/n_requests"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_requests</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/n_tri" title="f/lmloop_mod/n_tri"><code class="xref f f-var docutils literal notranslate"><span class="pre">n_tri</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/nblocks" title="f/lmloop_mod/nblocks"><code class="xref f f-var docutils literal notranslate"><span class="pre">nblocks</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/parallel_solve" title="f/lmloop_mod/parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">parallel_solve()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/parallel_solve_phase" title="f/lmloop_mod/parallel_solve_phase"><code class="xref f f-func docutils literal notranslate"><span class="pre">parallel_solve_phase()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/set_block_number" title="f/lmloop_mod/set_block_number"><code class="xref f f-func docutils literal notranslate"><span class="pre">set_block_number()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/time_lm_loop" title="f/lmloop_mod/time_lm_loop"><code class="xref f f-func docutils literal notranslate"><span class="pre">time_lm_loop()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">iso_fortran_env</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">output_unit()</span></code>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a>: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">logwrite()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_update_s" title="f/logic/l_update_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_s()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_z10mat" title="f/logic/l_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_z10mat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_par_solve" title="f/logic/l_mag_par_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_par_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>, <code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscalar()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/timing" title="f/timing: This module contains functions that are used to measure the time spent."><code class="xref f f-mod docutils literal notranslate"><span class="pre">timing</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">timer_type()</span></code>): This module contains functions that are used to measure the time spent.</p></li>
<li><p><a class="reference internal" href="#f/updates_mod" title="f/updates_mod: This module handles the time advance of the entropy s. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updates_mod</span></code></a>: This module handles the time advance of the entropy s. It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="#f/updatez_mod" title="f/updatez_mod: This module handles the time advance of the toroidal potential z It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatez_mod</span></code></a>: This module handles the time advance of the toroidal potential z It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="#f/updatewp_mod" title="f/updatewp_mod: This module handles the time advance of the poloidal potential w and the pressure p. It contains the computation of the implicit terms and the linear solves."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatewp_mod</span></code></a>: This module handles the time advance of the poloidal potential w and the pressure p. It contains the computation of the implicit terms and the linear solves.</p></li>
<li><p><a class="reference internal" href="#f/updatewps_mod" title="f/updatewps_mod: This module handles the time advance of the poloidal potential w, the pressure p and the entropy s in one single matrix per degree. It contains the computation of the implicit terms and the linear"><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatewps_mod</span></code></a>: This module handles the time advance of the poloidal potential w, the pressure p and the entropy s in one single matrix per degree. It contains the computation of the implicit terms and the linear</p></li>
<li><p><a class="reference internal" href="#f/updateb_mod" title="f/updateb_mod: This module handles the time advance of the magnetic field potentials b and aj as well as the inner core counterparts b_ic and aj_ic. It contains the computation of the implicit terms and the linear"><code class="xref f f-mod docutils literal notranslate"><span class="pre">updateb_mod</span></code></a>: This module handles the time advance of the magnetic field potentials b and aj as well as the inner core counterparts b_ic and aj_ic. It contains the computation of the implicit terms and the linear</p></li>
<li><p><a class="reference internal" href="#f/updatexi_mod" title="f/updatexi_mod: This module handles the time advance of the chemical composition xi. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatexi_mod</span></code></a>: This module handles the time advance of the chemical composition xi. It contains the computation of the implicit terms and the linear solves….</p></li>
<li><p><a class="reference internal" href="#f/updatephi_mod" title="f/updatephi_mod: This module handles the time advance of the phase field phi. It contains the computation of the implicit terms and the linear solves...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">updatephi_mod</span></code></a>: This module handles the time advance of the phase field phi. It contains the computation of the implicit terms and the linear solves….</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/lmloop_mod/array_of_requests">
<span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">array_of_requests</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/lmloop_mod/array_of_requests" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/lmloop_mod/block_sze">
<span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">block_sze</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/lmloop_mod/block_sze" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/lmloop_mod/n_penta">
<span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">n_penta</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/lmloop_mod/n_penta" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of tridiagonal and pentadiagonal solvers</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/lmloop_mod/n_requests">
<span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">n_requests</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/lmloop_mod/n_requests" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/lmloop_mod/n_tri">
<span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">n_tri</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/lmloop_mod/n_tri" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/lmloop_mod/nblocks">
<span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">nblocks</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/lmloop_mod/nblocks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/initialize_lmloop">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_lmloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/initialize_lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the memory allocation of the matrices needed
in the time advance of MagIC</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/initialize_updatewps" title="f/updatewps_mod/initialize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updates_mod/initialize_updates" title="f/updates_mod/initialize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updates()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/initialize_updatewp" title="f/updatewp_mod/initialize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/initialize_updatexi" title="f/updatexi_mod/initialize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/initialize_updatephi" title="f/updatephi_mod/initialize_updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatephi()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/initialize_updatez" title="f/updatez_mod/initialize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatez()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/initialize_updateb" title="f/updateb_mod/initialize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updateb()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/set_block_number" title="f/lmloop_mod/set_block_number"><code class="xref f f-func docutils literal notranslate"><span class="pre">set_block_number()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/test_lmloop">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">test_lmloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/test_lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to solve dummy linear problem to estimate the best
blocking size. This is done once at the initialisation stage of MagIC.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/prepares_fd" title="f/updates_mod/prepares_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepares_fd()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/preparexi_fd" title="f/updatexi_mod/preparexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparexi_fd()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/preparez_fd" title="f/updatez_mod/preparez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparez_fd()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/preparew_fd" title="f/updatewp_mod/preparew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparew_fd()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/prepareb_fd" title="f/updateb_mod/prepareb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepareb_fd()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/find_faster_block" title="f/communications/find_faster_block"><code class="xref f f-func docutils literal notranslate"><span class="pre">find_faster_block()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/finalize_lmloop">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_lmloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/finalize_lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine deallocates the matrices involved in the time advance
of MagIC.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/finalize_updatewps" title="f/updatewps_mod/finalize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finalize_updates" title="f/updates_mod/finalize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updates()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finalize_updatewp" title="f/updatewp_mod/finalize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finalize_updatez" title="f/updatez_mod/finalize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatez()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finalize_updatexi" title="f/updatexi_mod/finalize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/finalize_updatephi" title="f/updatephi_mod/finalize_updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatephi()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finalize_updateb" title="f/updateb_mod/finalize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updateb()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/lmloop">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">lmloop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">timenext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lmat</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">b_nl_cmb</span></em>, <em class="sig-param"><span class="pre">aj_nl_cmb</span></em>, <em class="sig-param"><span class="pre">aj_nl_icb</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/lmloop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine performs the actual time-stepping. It calls succesively
the update routines of the various fields.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timenext</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lmat</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_nl_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for b at CMB</p></li>
<li><p><strong>aj_nl_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for aj at CMB</p></li>
<li><p><strong>aj_nl_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for dr aj at ICB</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/updatephi" title="f/updatephi_mod/updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephi()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/lmloop_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">lmloop_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">timenext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lmat</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">b_nl_cmb</span></em>, <em class="sig-param"><span class="pre">aj_nl_cmb</span></em>, <em class="sig-param"><span class="pre">aj_nl_icb</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/lmloop_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine performs the actual time-stepping. It calls succesively
the update routines of the various fields. This is used with the parallel
finite difference solver.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timenext</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lmat</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_nl_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for b at CMB</p></li>
<li><p><strong>aj_nl_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for aj at CMB</p></li>
<li><p><strong>aj_nl_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear bc for dr aj at ICB</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/preparephase_fd" title="f/updatephi_mod/preparephase_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparephase_fd()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/parallel_solve_phase" title="f/lmloop_mod/parallel_solve_phase"><code class="xref f f-func docutils literal notranslate"><span class="pre">parallel_solve_phase()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/fill_ghosts_phi" title="f/updatephi_mod/fill_ghosts_phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_phi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/updatephase_fd" title="f/updatephi_mod/updatephase_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephase_fd()</span></code></a>, <a class="reference internal" href="#f/updates_mod/prepares_fd" title="f/updates_mod/prepares_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepares_fd()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/preparexi_fd" title="f/updatexi_mod/preparexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparexi_fd()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/preparez_fd" title="f/updatez_mod/preparez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparez_fd()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/preparew_fd" title="f/updatewp_mod/preparew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparew_fd()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/prepareb_fd" title="f/updateb_mod/prepareb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepareb_fd()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/parallel_solve" title="f/lmloop_mod/parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">parallel_solve()</span></code></a>, <a class="reference internal" href="#f/updates_mod/fill_ghosts_s" title="f/updates_mod/fill_ghosts_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_s()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/fill_ghosts_xi" title="f/updatexi_mod/fill_ghosts_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_xi()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/fill_ghosts_z" title="f/updatez_mod/fill_ghosts_z"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_z()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/fill_ghosts_w" title="f/updatewp_mod/fill_ghosts_w"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_w()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/fill_ghosts_b" title="f/updateb_mod/fill_ghosts_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_b()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates_fd" title="f/updates_mod/updates_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates_fd()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi_fd" title="f/updatexi_mod/updatexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi_fd()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez_fd" title="f/updatez_mod/updatez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez_fd()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatew_fd" title="f/updatewp_mod/updatew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatew_fd()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb_fd" title="f/updateb_mod/updateb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb_fd()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/finish_explicit_assembly">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">finish_explicit_assembly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dvsr_lmloc</span></em>, <em class="sig-param"><span class="pre">dvxir_lmloc</span></em>, <em class="sig-param"><span class="pre">dvxvh_lmloc</span></em>, <em class="sig-param"><span class="pre">dvxbh_lmloc</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/finish_explicit_assembly" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to finish the computation of the explicit terms.
This is only possible in a LM-distributed space since it mainly involves
computation of radial derivatives.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsr_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxir_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxvh_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxbh_lmloc</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/finish_exp_comp" title="f/updatexi_mod/finish_exp_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat" title="f/updatewps_mod/finish_exp_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy" title="f/updates_mod/finish_exp_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol" title="f/updatewp_mod/finish_exp_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finish_exp_tor" title="f/updatez_mod/finish_exp_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_tor()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag" title="f/updateb_mod/finish_exp_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_ic" title="f/updateb_mod/finish_exp_mag_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/finish_explicit_assembly_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">finish_explicit_assembly_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dvsr_rloc</span></em>, <em class="sig-param"><span class="pre">dvxir_rloc</span></em>, <em class="sig-param"><span class="pre">dvxvh_rloc</span></em>, <em class="sig-param"><span class="pre">dvxbh_rloc</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic</span></em>, <em class="sig-param"><span class="pre">dsdt_rloc</span></em>, <em class="sig-param"><span class="pre">dxidt_rloc</span></em>, <em class="sig-param"><span class="pre">dwdt_rloc</span></em>, <em class="sig-param"><span class="pre">djdt_rloc</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to finish the computation of the explicit terms.
This is the version that handles R-distributed arrays used when FD are
employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsr_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxir_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxvh_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dvxbh_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_rloc</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/finish_exp_comp_rdist" title="f/updatexi_mod/finish_exp_comp_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat_rdist" title="f/updatewps_mod/finish_exp_smat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat_rdist()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy_rdist" title="f/updates_mod/finish_exp_entropy_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol_rdist" title="f/updatewp_mod/finish_exp_pol_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol_rdist()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finish_exp_tor" title="f/updatez_mod/finish_exp_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_tor()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_rdist" title="f/updateb_mod/finish_exp_mag_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_rdist()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_ic" title="f/updateb_mod/finish_exp_mag_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_ic()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/assemble_stage">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/assemble_stage" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine is used to call the different assembly stage of the different
equations. This is only used for a special subset of IMEX-RK schemes that
have <code class="docutils literal notranslate"><span class="pre">tscheme%l_assembly=.true.</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/assemble_comp" title="f/updatexi_mod/assemble_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/assemble_phase" title="f/updatephi_mod/assemble_phase"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/assemble_single" title="f/updatewps_mod/assemble_single"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_single()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy" title="f/updates_mod/assemble_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/assemble_pol" title="f/updatewp_mod/assemble_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/assemble_stage_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_stage_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/assemble_stage_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine is used to call the different assembly stage of the different
equations. This is only used for a special subset of IMEX-RK schemes that
have <code class="docutils literal notranslate"><span class="pre">tscheme%l_assembly=.true.</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/assemble_phase_rloc" title="f/updatephi_mod/assemble_phase_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase_rloc()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/assemble_comp_rloc" title="f/updatexi_mod/assemble_comp_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp_rloc()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy_rloc" title="f/updates_mod/assemble_entropy_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy_rloc()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/assemble_pol_rloc" title="f/updatewp_mod/assemble_pol_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol_rloc()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor_rloc" title="f/updatez_mod/assemble_tor_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor_rloc()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag_rloc" title="f/updateb_mod/assemble_mag_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag_rloc()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/parallel_solve_phase">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">parallel_solve_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">block_sze</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/parallel_solve_phase" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the parallel solve of the phase field matrices.
This needs to be updated before the temperature.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block_sze</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Size ot the LM blocks</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/parallel_solve">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">parallel_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">block_sze</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/parallel_solve" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the parallel solve of the time-advance matrices.
This works with R-distributed arrays (finite differences).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>block_sze</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Size ot the LM blocks</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/time_lm_loop" title="f/lmloop_mod/time_lm_loop"><code class="xref f f-func docutils literal notranslate"><span class="pre">time_lm_loop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/set_block_number">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">set_block_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nb</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/set_block_number" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine returns the number of lm-blocks for solving the LM loop.
This is adapted from xshells.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nb</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: No more than 2048 blocks</p>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p><strong>nbo</strong><em> [</em><em>integer</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/time_lm_loop" title="f/lmloop_mod/time_lm_loop"><code class="xref f f-func docutils literal notranslate"><span class="pre">time_lm_loop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/find_faster_block">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">find_faster_block</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/find_faster_block" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine is used to find the best lm-block size for MPI communication.
This is adapted from xshells.</p>
<dl class="field-list simple">
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">logwrite()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/set_block_number" title="f/lmloop_mod/set_block_number"><code class="xref f f-func docutils literal notranslate"><span class="pre">set_block_number()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/time_lm_loop" title="f/lmloop_mod/time_lm_loop"><code class="xref f f-func docutils literal notranslate"><span class="pre">time_lm_loop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/lmloop_mod/time_lm_loop">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">lmloop_mod/</span></span><span class="sig-name descname"><span class="pre">time_lm_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nblk</span></em>, <em class="sig-param"><span class="pre">nloops</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/lmloop_mod/time_lm_loop" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function is defined to measure the time of a call to the parallel solvers
when a a number of block nblk is used. This takes the average over nloop calls.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nblk</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em> :: Number of lm blocks</p></li>
<li><p><strong>nloops</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Number of calls</p></li>
</ul>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p><strong>time</strong><em> [</em><em>real</em><em>]</em></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/set_block_number" title="f/lmloop_mod/set_block_number"><code class="xref f f-func docutils literal notranslate"><span class="pre">set_block_number()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/parallel_solve" title="f/lmloop_mod/parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">parallel_solve()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatewps_mod">
<span id="updatewps-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateWPS.f90</span></code><a class="headerlink" href="#f/updatewps_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the poloidal potential w,
the pressure p and the entropy s in one single matrix per degree.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/buo" title="f/updatewps_mod/buo"><code class="xref f f-var docutils literal notranslate"><span class="pre">buo</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/cor00_fac" title="f/updatewps_mod/cor00_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">cor00_fac</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/lwpsmat" title="f/updatewps_mod/lwpsmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lwpsmat</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/pre" title="f/updatewps_mod/pre"><code class="xref f f-var docutils literal notranslate"><span class="pre">pre</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/ps0mat" title="f/updatewps_mod/ps0mat"><code class="xref f f-var docutils literal notranslate"><span class="pre">ps0mat</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/ps0mat_fac" title="f/updatewps_mod/ps0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">ps0mat_fac</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/ps0pivot" title="f/updatewps_mod/ps0pivot"><code class="xref f f-var docutils literal notranslate"><span class="pre">ps0pivot</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/workb" title="f/updatewps_mod/workb"><code class="xref f f-var docutils literal notranslate"><span class="pre">workb</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/workc" title="f/updatewps_mod/workc"><code class="xref f f-var docutils literal notranslate"><span class="pre">workc</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/wpsmat" title="f/updatewps_mod/wpsmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpsmat</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/wpsmat_fac" title="f/updatewps_mod/wpsmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpsmat_fac</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/wpspivot" title="f/updatewps_mod/wpspivot"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpspivot</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewps_mod/assemble_single" title="f/updatewps_mod/assemble_single"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_single()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finalize_updatewps" title="f/updatewps_mod/finalize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat" title="f/updatewps_mod/finish_exp_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/finish_exp_smat_rdist" title="f/updatewps_mod/finish_exp_smat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_smat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_ps0mat" title="f/updatewps_mod/get_ps0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ps0mat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_wpsmat" title="f/updatewps_mod/get_wpsmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpsmat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/initialize_updatewps" title="f/updatewps_mod/initialize_updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewps()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal notranslate"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlkappa" title="f/radial_functions/dlkappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlkappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dltemp0" title="f/radial_functions/dltemp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dltemp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddltemp0" title="f/radial_functions/ddltemp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddltemp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/alpha0" title="f/radial_functions/alpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">alpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlalpha0" title="f/radial_functions/dlalpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlalpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddlalpha0" title="f/radial_functions/ddlalpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddlalpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ogrun" title="f/radial_functions/ogrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">ogrun()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/kappa" title="f/radial_functions/kappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">kappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dentropy0" title="f/radial_functions/dentropy0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dentropy0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktops" title="f/physical_parameters/ktops"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktops()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbots" title="f/physical_parameters/kbots"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbots()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/opr" title="f/physical_parameters/opr"><code class="xref f f-func docutils literal notranslate"><span class="pre">opr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">vischeatfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/thexpnb" title="f/physical_parameters/thexpnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">thexpnb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/buofac" title="f/physical_parameters/buofac"><code class="xref f f-func docutils literal notranslate"><span class="pre">buofac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">corfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopp" title="f/physical_parameters/ktopp"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopp()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/tops" title="f/init_fields/tops"><code class="xref f f-func docutils literal notranslate"><span class="pre">tops()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/bots" title="f/init_fields/bots"><code class="xref f f-func docutils literal notranslate"><span class="pre">bots()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_s" title="f/horizontal_data/hdif_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_s()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_v" title="f/logic/l_update_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_v()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_temperature_diff" title="f/logic/l_temperature_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_temperature_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpol2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpollmr()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/algebra" title="f/algebra"><code class="xref f f-mod docutils literal notranslate"><span class="pre">algebra</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/solve_mat" title="f/algebra/solve_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_mat()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/get_global_sum" title="f/communications/get_global_sum"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_global_sum()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/osq4pi" title="f/constants/osq4pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">osq4pi()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/buo">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">buo</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/buo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/cor00_fac">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">cor00_fac</span></span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/cor00_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/dif">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">dif</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/lwpsmat">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">lwpsmat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/lwpsmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/maxthreads">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">maxthreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/pre">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">pre</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/pre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/ps0mat">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">ps0mat</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/ps0mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/ps0mat_fac">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">ps0mat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/ps0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/ps0pivot">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">ps0pivot</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/ps0pivot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/workb">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">workb</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/workb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/workc">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">workc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/workc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/wpsmat">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">wpsmat</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/wpsmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/wpsmat_fac">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">wpsmat_fac</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/wpsmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewps_mod/wpspivot">
<span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">wpspivot</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewps_mod/wpspivot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/initialize_updatewps">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updatewps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/initialize_updatewps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/finalize_updatewps">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updatewps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/finalize_updatewps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/updatewps">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">updatewps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">z10</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/updatewps" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>updates the poloidal velocity potential w, the pressure p, the entropy
and their radial derivatives.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>z10</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ds</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewps_mod/get_ps0mat" title="f/updatewps_mod/get_ps0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ps0mat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_wpsmat" title="f/updatewps_mod/get_wpsmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpsmat()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/get_single_rhs_imp" title="f/updatewps_mod/get_single_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_single_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/finish_exp_smat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_smat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvsrlm</span></em>, <em class="sig-param"><span class="pre">ds_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/finish_exp_smat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvsrlm</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/finish_exp_smat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_smat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvsrlm</span></em>, <em class="sig-param"><span class="pre">ds_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/finish_exp_smat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/assemble_single">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/assemble_single" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine is used to assemble the solution in case IMEX RK with
an assembly stage are used</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/get_single_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">get_single_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/get_single_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/get_wpsmat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">get_wpsmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif_vel</span></em>, <em class="sig-param"><span class="pre">hdif_s</span></em>, <em class="sig-param"><span class="pre">wpsmat</span></em>, <em class="sig-param"><span class="pre">wpspivot</span></em>, <em class="sig-param"><span class="pre">wpsmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/get_wpsmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
wpmat  for the NS equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif_vel</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif_s</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>wpsmat</strong> (3 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,3 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: ‘)</p></li>
<li><p><strong>wpspivot</strong> (3 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>wpsmat_fac</strong> (3 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewps_mod/get_ps0mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewps_mod/</span></span><span class="sig-name descname"><span class="pre">get_ps0mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">psmat</span></em>, <em class="sig-param"><span class="pre">pspivot</span></em>, <em class="sig-param"><span class="pre">psmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewps_mod/get_ps0mat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>psmat</strong> (2 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: entropy diffusion</p></li>
<li><p><strong>pspivot</strong> (2 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>psmat_fac</strong> (2 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewps_mod/updatewps" title="f/updatewps_mod/updatewps"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewps()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/algebra/prepare_mat" title="f/algebra/prepare_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepare_mat()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatewp_mod">
<span id="updatewp-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateWP.f90</span></code><a class="headerlink" href="#f/updatewp_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the poloidal potential w and the pressure p.
It contains the computation of the implicit terms and the linear solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/ddddw" title="f/updatewp_mod/ddddw"><code class="xref f f-var docutils literal notranslate"><span class="pre">ddddw</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/dwold" title="f/updatewp_mod/dwold"><code class="xref f f-var docutils literal notranslate"><span class="pre">dwold</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/ellmat_fd" title="f/updatewp_mod/ellmat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">ellmat_fd</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/l_ellmat" title="f/updatewp_mod/l_ellmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">l_ellmat</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/lwpmat" title="f/updatewp_mod/lwpmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lwpmat</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/p0_ghost" title="f/updatewp_mod/p0_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">p0_ghost</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/p0mat_fd" title="f/updatewp_mod/p0mat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">p0mat_fd</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/rhs0" title="f/updatewp_mod/rhs0"><code class="xref f f-var docutils literal notranslate"><span class="pre">rhs0</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/size_rhs1" title="f/updatewp_mod/size_rhs1"><code class="xref f f-var docutils literal notranslate"><span class="pre">size_rhs1</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/w_ghost" title="f/updatewp_mod/w_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">w_ghost</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/wmat_fd" title="f/updatewp_mod/wmat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">wmat_fd</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/work" title="f/updatewp_mod/work"><code class="xref f f-var docutils literal notranslate"><span class="pre">work</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/wpmat_fac" title="f/updatewp_mod/wpmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">wpmat_fac</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/assemble_pol" title="f/updatewp_mod/assemble_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/assemble_pol_rloc" title="f/updatewp_mod/assemble_pol_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol_rloc()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/fill_ghosts_w" title="f/updatewp_mod/fill_ghosts_w"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_w()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finalize_updatewp" title="f/updatewp_mod/finalize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol" title="f/updatewp_mod/finish_exp_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/finish_exp_pol_rdist" title="f/updatewp_mod/finish_exp_pol_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_pol_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_elliptic_mat" title="f/updatewp_mod/get_elliptic_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_elliptic_mat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_elliptic_mat_rdist" title="f/updatewp_mod/get_elliptic_mat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_elliptic_mat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_p0mat" title="f/updatewp_mod/get_p0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_p0mat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_p0mat_rdist" title="f/updatewp_mod/get_p0mat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_p0mat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol" title="f/updatewp_mod/get_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp_ghost" title="f/updatewp_mod/get_pol_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wmat" title="f/updatewp_mod/get_wmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wmat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wmat_rdist" title="f/updatewp_mod/get_wmat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wmat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wpmat" title="f/updatewp_mod/get_wpmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpmat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/initialize_updatewp" title="f/updatewp_mod/initialize_updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatewp()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/preparew_fd" title="f/updatewp_mod/preparew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparew_fd()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatew_fd" title="f/updatewp_mod/updatew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatew_fd()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal notranslate"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/alpha0" title="f/radial_functions/alpha0"><code class="xref f f-func docutils literal notranslate"><span class="pre">alpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ogrun" title="f/radial_functions/ogrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">ogrun()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddlvisc" title="f/radial_functions/ddlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ddbeta" title="f/radial_functions/ddbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddbeta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal notranslate"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/buofac" title="f/physical_parameters/buofac"><code class="xref f f-func docutils literal notranslate"><span class="pre">buofac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/chemfac" title="f/physical_parameters/chemfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">chemfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">vischeatfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/thexpnb" title="f/physical_parameters/thexpnb"><code class="xref f f-func docutils literal notranslate"><span class="pre">thexpnb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopp" title="f/physical_parameters/ktopp"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopp()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_v" title="f/logic/l_update_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_v()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_fluxprofs" title="f/logic/l_fluxprofs"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_fluxprofs()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpol2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-func docutils literal notranslate"><span class="pre">difpollmr()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/get_global_sum" title="f/communications/get_global_sum"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_global_sum()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddddr_ghost" title="f/radial_der/get_ddddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a>): Radial integration functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/s_rloc" title="f/fields/s_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">s_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/xi_rloc" title="f/fields/xi_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">xi_rloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_solvers" title="f/parallel_solvers: This module contains the routines that are used to solve linear banded problems with R-distributed arrays."><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_solvers</span></code></a>: This module contains the routines that are used to solve linear banded problems with R-distributed arrays.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/buo">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">buo</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/buo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/ddddw">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">ddddw</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/ddddw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/dif">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">dif</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/dwold">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">dwold</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/dwold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/ellmat_fd">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">ellmat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/ellmat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/l_ellmat">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">l_ellmat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/l_ellmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/lwpmat">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">lwpmat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/lwpmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/maxthreads">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">maxthreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/p0_ghost">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">p0_ghost</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/p0_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/p0mat_fd">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">p0mat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/p0mat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/pre">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">pre</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/pre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/rhs0">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">rhs0</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/rhs0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/size_rhs1">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">size_rhs1</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/size_rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/w_ghost">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">w_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/w_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/wmat_fd">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">wmat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_penta_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/wmat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/work">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">work</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatewp_mod/wpmat_fac">
<span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">wpmat_fac</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatewp_mod/wpmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/initialize_updatewp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updatewp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/initialize_updatewp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to allocate the matrices needed
to time advance the poloidal/pressure equations. Depending on the
radial scheme, it can be either full or band matrices.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/finalize_updatewp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updatewp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/finalize_updatewp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Deallocation of the matrices used to time-advance the poloidal/pressure
equations.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/updatewp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">updatewp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/updatewp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>updates the poloidal velocity potential w, the pressure p, and
their radial derivatives.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_p0mat" title="f/updatewp_mod/get_p0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_p0mat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wmat" title="f/updatewp_mod/get_wmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wmat()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_wpmat" title="f/updatewp_mod/get_wpmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wpmat()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">rint_r()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp" title="f/updatewp_mod/get_pol_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/preparew_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">preparew_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/preparew_fd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_wmat_rdist" title="f/updatewp_mod/get_wmat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_wmat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_p0mat_rdist" title="f/updatewp_mod/get_p0mat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_p0mat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/fill_ghosts_w">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">fill_ghosts_w</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">wg</span></em>, <em class="sig-param"><span class="pre">p0g</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/fill_ghosts_w" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to fill the ghost zones.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,5 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p0g</strong> (3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/assemble_pol_rloc" title="f/updatewp_mod/assemble_pol_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/updatew_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">updatew_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/updatew_fd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Poloidal potential</p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Radial derivative of w</p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of dw</p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Pressure</p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of p</p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp_ghost" title="f/updatewp_mod/get_pol_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_pol">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">work</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_pol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Get the poloidal potential from the solve of an elliptic equation.
Careful: the output is in Chebyshev space!</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>work</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/assemble_pol" title="f/updatewp_mod/assemble_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_elliptic_mat" title="f/updatewp_mod/get_elliptic_mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_elliptic_mat()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/finish_exp_pol">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvxvhlm</span></em>, <em class="sig-param"><span class="pre">dw_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/finish_exp_pol" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxvhlm</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/finish_exp_pol_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_pol_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvxvhlm</span></em>, <em class="sig-param"><span class="pre">dw_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/finish_exp_pol_rdist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxvhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_pol_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_pol_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">dp_expl</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_pol_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the derivatives of w and p and assemble the
implicit stage if needed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dp_expl</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dddr" title="f/radial_der/get_dddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_pol_rhs_imp_ghost">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_pol_rhs_imp_ghost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">wg</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">dp_expl</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_pol_rhs_imp_ghost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the derivatives of w and p and assemble the
implicit stage if needed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,5 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dp_expl</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/updatew_fd" title="f/updatewp_mod/updatew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatew_fd()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/assemble_pol_rloc" title="f/updatewp_mod/assemble_pol_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddddr_ghost" title="f/radial_der/get_ddddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/assemble_pol">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dp_expl</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/assemble_pol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble w and dw/dr when IMEX RK time schemes
which necessitate an assembly stage are employed. Robin-type boundary
conditions are enforced using Canuto (1986) approach.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dpdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp_expl</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_pol" title="f/updatewp_mod/get_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pol()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/assemble_pol_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_pol_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">block_sze</span></em>, <em class="sig-param"><span class="pre">nblocks</span></em>, <em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dw</span></em>, <em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">p</span></em>, <em class="sig-param"><span class="pre">dp</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dp_expl</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/assemble_pol_rloc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble w and dw/dr when IMEX RK time schemes
which necessitate an assembly stage are employed. Robin-type boundary
conditions are enforced using Canuto (1986) approach.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>block_sze</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>nblocks</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>p</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dwdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dp_expl</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatewp_mod/get_elliptic_mat_rdist" title="f/updatewp_mod/get_elliptic_mat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_elliptic_mat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/fill_ghosts_w" title="f/updatewp_mod/fill_ghosts_w"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_w()</span></code></a>, <a class="reference internal" href="#f/updatewp_mod/get_pol_rhs_imp_ghost" title="f/updatewp_mod/get_pol_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol_rhs_imp_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_wpmat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_wpmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">wpmat</span></em>, <em class="sig-param"><span class="pre">wpmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_wpmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
<code class="docutils literal notranslate"><span class="pre">wpMat</span></code> for the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: hyperdiffusion</p></li>
<li><p><strong>wpmat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>wpmat_fac</strong> (2 * <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_elliptic_mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_elliptic_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">ellmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_elliptic_mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the matrix needed
for the derivation of w for the time advance of the poloidal equation
if the double curl form is used.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>ellmat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/get_pol" title="f/updatewp_mod/get_pol"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_pol()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_wmat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_wmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">wmat</span></em>, <em class="sig-param"><span class="pre">wmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_wmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
wpmat  for the NS equation. This matrix corresponds here to the
radial component of the double-curl of the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: degree <span class="math notranslate nohighlight">\(\ell\)</span></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: hyperdiffusion</p></li>
<li><p><strong>wmat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>wmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>,2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_elliptic_mat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_elliptic_mat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ellmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_elliptic_mat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the matrix needed
for the derivation of w for the time advance of the poloidal equation
if the double curl form is used. This is the R-dist version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ellmat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/assemble_pol_rloc" title="f/updatewp_mod/assemble_pol_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_pol_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_wmat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_wmat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">wmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_wmat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
wMat_FD  for the NS equation. This matrix corresponds here to the
radial component of the double-curl of the Navier-Stokes equation.
This routine is used when parallel F.D. solvers are employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time scheme</p></li>
<li><p><strong>hdif</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: hyperdiffusion</p></li>
<li><p><strong>wmat</strong><em> [</em><em>type_penta_par</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/preparew_fd" title="f/updatewp_mod/preparew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparew_fd()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_p0mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_p0mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_p0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine solves the linear problem of the spherically-symmetric
pressure</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pmat</strong><em> [</em><em>real</em><em>]</em> :: matrix</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatewp()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatewp_mod/get_p0mat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatewp_mod/</span></span><span class="sig-name descname"><span class="pre">get_p0mat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">pmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatewp_mod/get_p0mat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine solves the linear problem of the spherically-symmetric
pressure. This is the R-distributed variant of the function used when
parallel F.D. solvers are employed</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pmat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em> :: matrix</p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatewp_mod/preparew_fd" title="f/updatewp_mod/preparew_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparew_fd()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatez_mod">
<span id="updatez-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateZ.f90</span></code><a class="headerlink" href="#f/updatez_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the toroidal potential z
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/dif" title="f/updatez_mod/dif"><code class="xref f f-var docutils literal notranslate"><span class="pre">dif</span></code></a>, <a class="reference internal" href="#f/updatez_mod/lz10mat" title="f/updatez_mod/lz10mat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lz10mat</span></code></a>, <a class="reference internal" href="#f/updatez_mod/lzmat" title="f/updatez_mod/lzmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lzmat</span></code></a>, <a class="reference internal" href="#f/updatez_mod/maxthreads" title="f/updatez_mod/maxthreads"><code class="xref f f-var docutils literal notranslate"><span class="pre">maxthreads</span></code></a>, <a class="reference internal" href="#f/updatez_mod/rhs1" title="f/updatez_mod/rhs1"><code class="xref f f-var docutils literal notranslate"><span class="pre">rhs1</span></code></a>, <a class="reference internal" href="#f/updatez_mod/z10_ghost" title="f/updatez_mod/z10_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">z10_ghost</span></code></a>, <a class="reference internal" href="#f/updatez_mod/z10mat_fac" title="f/updatez_mod/z10mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">z10mat_fac</span></code></a>, <a class="reference internal" href="#f/updatez_mod/z10mat_fd" title="f/updatez_mod/z10mat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">z10mat_fd</span></code></a>, <a class="reference internal" href="#f/updatez_mod/z_ghost" title="f/updatez_mod/z_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">z_ghost</span></code></a>, <a class="reference internal" href="#f/updatez_mod/zmat_fac" title="f/updatez_mod/zmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">zmat_fac</span></code></a>, <a class="reference internal" href="#f/updatez_mod/zmat_fd" title="f/updatez_mod/zmat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">zmat_fd</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor_rloc" title="f/updatez_mod/assemble_tor_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor_rloc()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/fill_ghosts_z" title="f/updatez_mod/fill_ghosts_z"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_z()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finalize_updatez" title="f/updatez_mod/finalize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/finish_exp_tor" title="f/updatez_mod/finish_exp_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_tor()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp_ghost" title="f/updatez_mod/get_tor_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_z10mat" title="f/updatez_mod/get_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_z10mat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_z10mat_rdist" title="f/updatez_mod/get_z10mat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_z10mat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_zmat" title="f/updatez_mod/get_zmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_zmat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_zmat_rdist" title="f/updatez_mod/get_zmat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_zmat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/initialize_updatez" title="f/updatez_mod/initialize_updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/preparez_fd" title="f/updatez_mod/preparez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparez_fd()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates_rloc" title="f/updatez_mod/update_rot_rates_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates_rloc()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez_fd" title="f/updatez_mod/updatez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez_fd()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a>: This module is used to construct the initial solution.</p></li>
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications: This module contains the different MPI communicators used in MagIC."><code class="xref f f-mod docutils literal notranslate"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/allgather_from_rloc" title="f/communications/allgather_from_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">allgather_from_rloc()</span></code></a>): This module contains the different MPI communicators used in MagIC.</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal notranslate"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlvisc" title="f/radial_functions/dlvisc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlvisc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal notranslate"><span class="pre">dbeta()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prec_angle" title="f/physical_parameters/prec_angle"><code class="xref f f-func docutils literal notranslate"><span class="pre">prec_angle()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/po" title="f/physical_parameters/po"><code class="xref f f-func docutils literal notranslate"><span class="pre">po()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/oek" title="f/physical_parameters/oek"><code class="xref f f-func docutils literal notranslate"><span class="pre">oek()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/amstart" title="f/num_param/amstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">amstart()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal notranslate"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="IOAdd.html#f/torsional_oscillations/ddzasl" title="f/torsional_oscillations/ddzasl"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddzasl()</span></code></a>): This module contains information for TO calculation and output</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_v()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_srma" title="f/logic/l_srma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_srma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_sric" title="f/logic/l_sric"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_sric()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_z10mat" title="f/logic/l_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_z10mat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_precession" title="f/logic/l_precession"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_precession()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_correct_ame" title="f/logic/l_correct_ame"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_correct_ame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_correct_amz" title="f/logic/l_correct_amz"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_correct_amz()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_update_v" title="f/logic/l_update_v"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_v()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_to" title="f/logic/l_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_to()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/diftor2hint" title="f/rms/diftor2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">diftor2hint()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/c_lorentz_ma" title="f/constants/c_lorentz_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_lorentz_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_lorentz_ic" title="f/constants/c_lorentz_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_lorentz_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_dt_z10_ma" title="f/constants/c_dt_z10_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_dt_z10_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_dt_z10_ic" title="f/constants/c_dt_z10_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_dt_z10_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_ma" title="f/constants/c_moi_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_ic" title="f/constants/c_moi_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_z10_omega_ma" title="f/constants/c_z10_omega_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_z10_omega_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_z10_omega_ic" title="f/constants/c_z10_omega_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_z10_omega_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/c_moi_oc" title="f/constants/c_moi_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">c_moi_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/y10_norm" title="f/constants/y10_norm"><code class="xref f f-func docutils literal notranslate"><span class="pre">y10_norm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/y11_norm" title="f/constants/y11_norm"><code class="xref f f-func docutils literal notranslate"><span class="pre">y11_norm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal notranslate"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal notranslate"><span class="pre">third()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/outrot" title="f/outrot: This module handles the writing of several diagnostic files related to the rotation: angular momentum (AM.TAG), drift (drift.TAG), inner core and mantle rotations...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">outrot</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outrot/get_angular_moment" title="f/outrot/get_angular_moment"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_angular_moment()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/get_angular_moment_rloc" title="f/outrot/get_angular_moment_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_angular_moment_rloc()</span></code></a>): This module handles the writing of several diagnostic files related to the rotation: angular momentum (AM.TAG), drift (drift.TAG), inner core and mantle rotations….</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2tor" title="f/rms_helpers/hint2tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2tor()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>, <code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscalar()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/special" title="f/special: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes"><code class="xref f f-mod docutils literal notranslate"><span class="pre">special</span></code></a>: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_solvers" title="f/parallel_solvers: This module contains the routines that are used to solve linear banded problems with R-distributed arrays."><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_solvers</span></code></a>: This module contains the routines that are used to solve linear banded problems with R-distributed arrays.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/dif">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">dif</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/dif" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/lz10mat">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">lz10mat</span></span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/lz10mat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/lzmat">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">lzmat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/lzmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/maxthreads">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">maxthreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd><p>RHS for other modes</p>
</dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/z10_ghost">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">z10_ghost</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/z10_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/z10mat_fac">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">z10mat_fac</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/z10mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/z10mat_fd">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">z10mat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/z10mat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/z_ghost">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">z_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/z_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/zmat_fac">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">zmat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/zmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatez_mod/zmat_fd">
<span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">zmat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatez_mod/zmat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updatez_mod/initialize_updatez">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updatez</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/initialize_updatez" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine handles the memory allocation of the arrays involved
in the time advance of the toroidal potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/finalize_updatez">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updatez</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/finalize_updatez" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory deallocation of arrays associated with time advance of Z</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/updatez">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">updatez</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">timenext</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dz</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/updatez" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the toroidal potential z and its radial derivative dz</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Current stage time</p></li>
<li><p><strong>timenext</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Next time</p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Toroidal velocity potential z</p></li>
<li><p><strong>dz</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of z</p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Calculated OC rotation</p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Calculated IC rotation</p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Logical for storing update if (l_RMS.and.l_logNext)</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/get_zmat" title="f/updatez_mod/get_zmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_zmat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_z10mat" title="f/updatez_mod/get_z10mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_z10mat()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/preparez_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">preparez_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/preparez_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input of variables:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: Calculated OC rotation</p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: Calculated IC rotation</p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/get_zmat_rdist" title="f/updatez_mod/get_zmat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_zmat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_z10mat_rdist" title="f/updatez_mod/get_z10mat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_z10mat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/fill_ghosts_z">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">fill_ghosts_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">zg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/fill_ghosts_z" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to fill the ghosts zones that are located at
nR=n_r_cmb-1 and nR=n_r_icb+1. This is used to properly set the Neuman
boundary conditions. In case Dirichlet BCs are used, a simple first order
extrapolation is employed. This is anyway only used for outputs (like Nusselt
numbers).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>zg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor_rloc" title="f/updatez_mod/assemble_tor_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/updatez_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">updatez_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">timenext</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dz</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/updatez_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input of variables:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Current stage time</p></li>
<li><p><strong>timenext</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Next time</p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Toroidal potential</p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of z</p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: Calculated OC rotation</p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: Calculated IC rotation</p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: Logical for storing update if (l_RMS.and.l_logNext)</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/update_rot_rates_rloc" title="f/updatez_mod/update_rot_rates_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates_rloc()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp_ghost" title="f/updatez_mod/get_tor_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/get_tor_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">get_tor_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dz</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_tor_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/get_angular_moment" title="f/outrot/get_angular_moment"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_angular_moment()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2tor" title="f/rms_helpers/hint2tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2tor()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/get_tor_rhs_imp_ghost">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">get_tor_rhs_imp_ghost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">zg</span></em>, <em class="sig-param"><span class="pre">dz</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_tor_rhs_imp_ghost" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>zg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/updatez_fd" title="f/updatez_mod/updatez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez_fd()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor_rloc" title="f/updatez_mod/assemble_tor_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/get_angular_moment_rloc" title="f/outrot/get_angular_moment_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_angular_moment_rloc()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2tor" title="f/rms_helpers/hint2tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2tor()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/assemble_tor">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_tor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dz</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/assemble_tor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the toroidal flow potential when an IMEX
RK time scheme with an assembly stage is employed (LM-distributed version).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates" title="f/updatez_mod/update_rot_rates"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp" title="f/updatez_mod/get_tor_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/assemble_tor_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_tor_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">dz</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/assemble_tor_rloc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used when a IMEX Runge-Kutta scheme with an assembly
stage is employed (R-distributed version)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>domega_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/fill_ghosts_z" title="f/updatez_mod/fill_ghosts_z"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_z()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/update_rot_rates_rloc" title="f/updatez_mod/update_rot_rates_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">update_rot_rates_rloc()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/get_tor_rhs_imp_ghost" title="f/updatez_mod/get_tor_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_tor_rhs_imp_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/update_rot_rates">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">update_rot_rates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">lo_ma</span></em>, <em class="sig-param"><span class="pre">lo_ic</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">istage</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/update_rot_rates" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine updates the rotation rate of inner core and mantle.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lo_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lo_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: RHS when stress-free BCs are used</p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em> :: Is z in Cheb space or not?</p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor" title="f/updatez_mod/assemble_tor"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/update_rot_rates_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">update_rot_rates_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">z</span></em>, <em class="sig-param"><span class="pre">lo_ma</span></em>, <em class="sig-param"><span class="pre">lo_ic</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma_dt</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic_dt</span></em>, <em class="sig-param"><span class="pre">omega_ma</span></em>, <em class="sig-param"><span class="pre">omega_ma1</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic1</span></em>, <em class="sig-param"><span class="pre">istage</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/update_rot_rates_rloc" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lo_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lo_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: RHS when stress-free BCs are used</p></li>
<li><p><strong>lorentz_torque_ma_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic_dt</strong><em> [</em><em>type_tscalar</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ma1</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>omega_ic1</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/updatez_fd" title="f/updatez_mod/updatez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez_fd()</span></code></a>, <a class="reference internal" href="#f/updatez_mod/assemble_tor_rloc" title="f/updatez_mod/assemble_tor_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_tor_rloc()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/finish_exp_tor">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_tor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lorentz_torque_ma</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic</span></em>, <em class="sig-param"><span class="pre">domega_ma_dt_exp</span></em>, <em class="sig-param"><span class="pre">domega_ic_dt_exp</span></em>, <em class="sig-param"><span class="pre">lorentz_ma_exp</span></em>, <em class="sig-param"><span class="pre">lorentz_ic_exp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/finish_exp_tor" title="Permalink to this definition">¶</a></dt>
<dd><p>– Input variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lorentz torque (for OC rotation)</p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Lorentz torque (for IC rotation)</p></li>
<li><p><strong>domega_ma_dt_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>domega_ic_dt_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lorentz_ma_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lorentz_ic_exp</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/get_z10mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">get_z10mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">zmat</span></em>, <em class="sig-param"><span class="pre">zmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_z10mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to construct and LU-decompose the
inversion matrix <code class="docutils literal notranslate"><span class="pre">z10mat</span></code> for the implicit time step of the
toroidal velocity potential z of degree <span class="math notranslate nohighlight">\(\ell=1\)</span> and order <span class="math notranslate nohighlight">\(m=0\)</span>.
This differs from the the normal zmat only if either the ICB or
CMB have no-slip boundary condition and inner core or mantle are
chosen to rotate freely (either <code class="docutils literal notranslate"><span class="pre">kbotv=1</span></code> and/or <code class="docutils literal notranslate"><span class="pre">ktopv=1</span></code>).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: Time step internal</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Variable to loop over degrees</p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Value of hyperdiffusivity in zMat terms</p></li>
<li><p><strong>zmat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>zmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Inverse of max(zMat) for inversion</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/get_zmat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">get_zmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">zmat</span></em>, <em class="sig-param"><span class="pre">zmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_zmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
<code class="docutils literal notranslate"><span class="pre">zmat(i,j)</span></code> for the Navier-Stokes equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Variable to loop over degrees</p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Hyperdiffusivity</p></li>
<li><p><strong>zmat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>zmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: Inverse of max(zMat) for the inversion</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatez()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/get_z10mat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">get_z10mat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">zmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_z10mat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is employed to construct the matrix for the z(l=1,m=0) mode
when the parallel F.D. solver is used.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: Time step internal</p></li>
<li><p><strong>hdif</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Value of hyperdiffusivity in zMat terms</p></li>
<li><p><strong>zmat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em> :: Tridiag matrix</p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/preparez_fd" title="f/updatez_mod/preparez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparez_fd()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatez_mod/get_zmat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatez_mod/</span></span><span class="sig-name descname"><span class="pre">get_zmat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">zmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatez_mod/get_zmat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to construct the z matrices when the parallel
F.D. solver is employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>hdif</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: Hyperdiffusivity</p></li>
<li><p><strong>zmat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatez_mod/preparez_fd" title="f/updatez_mod/preparez_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparez_fd()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updates_mod">
<span id="updates-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateS.f90</span></code><a class="headerlink" href="#f/updates_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the entropy s.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/lsmat" title="f/updates_mod/lsmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lsmat</span></code></a>, <a class="reference internal" href="#f/updates_mod/s0mat_fac" title="f/updates_mod/s0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">s0mat_fac</span></code></a>, <a class="reference internal" href="#f/updates_mod/s_ghost" title="f/updates_mod/s_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">s_ghost</span></code></a>, <a class="reference internal" href="#f/updates_mod/smat_fac" title="f/updates_mod/smat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">smat_fac</span></code></a>, <a class="reference internal" href="#f/updates_mod/smat_fd" title="f/updates_mod/smat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">smat_fd</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/assemble_entropy" title="f/updates_mod/assemble_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy_rloc" title="f/updates_mod/assemble_entropy_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy_rloc()</span></code></a>, <a class="reference internal" href="#f/updates_mod/fill_ghosts_s" title="f/updates_mod/fill_ghosts_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_s()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finalize_updates" title="f/updates_mod/finalize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy" title="f/updates_mod/finish_exp_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy()</span></code></a>, <a class="reference internal" href="#f/updates_mod/finish_exp_entropy_rdist" title="f/updates_mod/finish_exp_entropy_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_entropy_rdist()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp_ghost" title="f/updates_mod/get_entropy_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_s0mat" title="f/updates_mod/get_s0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_s0mat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_smat" title="f/updates_mod/get_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_smat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_smat_rdist" title="f/updates_mod/get_smat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_smat_rdist()</span></code></a>, <a class="reference internal" href="#f/updates_mod/initialize_updates" title="f/updates_mod/initialize_updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/prepares_fd" title="f/updates_mod/prepares_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepares_fd()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates_fd" title="f/updates_mod/updates_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates_fd()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dentropy0" title="f/radial_functions/dentropy0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dentropy0()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/kappa" title="f/radial_functions/kappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">kappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dlkappa" title="f/radial_functions/dlkappa"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlkappa()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dltemp0" title="f/radial_functions/dltemp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">dltemp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/opr" title="f/physical_parameters/opr"><code class="xref f f-func docutils literal notranslate"><span class="pre">opr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbots" title="f/physical_parameters/kbots"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbots()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktops" title="f/physical_parameters/ktops"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktops()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/stef" title="f/physical_parameters/stef"><code class="xref f f-func docutils literal notranslate"><span class="pre">stef()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/tops" title="f/init_fields/tops"><code class="xref f f-func docutils literal notranslate"><span class="pre">tops()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/bots" title="f/init_fields/bots"><code class="xref f f-func docutils literal notranslate"><span class="pre">bots()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_s" title="f/horizontal_data/hdif_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_s()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_s" title="f/logic/l_update_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_s()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anelastic_liquid" title="f/logic/l_anelastic_liquid"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_anelastic_liquid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_solvers" title="f/parallel_solvers: This module contains the routines that are used to solve linear banded problems with R-distributed arrays."><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_solvers</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tri_par()</span></code>): This module contains the routines that are used to solve linear banded problems with R-distributed arrays.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/fd_fac_bot">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">fd_fac_bot</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/fd_fac_bot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/fd_fac_top">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">fd_fac_top</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/fd_fac_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/lsmat">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">lsmat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/lsmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/maxthreads">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">maxthreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/s0mat_fac">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">s0mat_fac</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/s0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/s_ghost">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">s_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">public/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/s_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/smat_fac">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">smat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/smat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updates_mod/smat_fd">
<span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">smat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updates_mod/smat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updates_mod/initialize_updates">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/initialize_updates" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine allocates the arrays involved in the time-advance of the
entropy/temperature equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/finalize_updates">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/finalize_updates" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory deallocation of updateS module</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/updates">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">updates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/updates" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the entropy field s and its radial derivative.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Entropy</p></li>
<li><p><strong>ds</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of entropy</p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Phase field</p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/get_s0mat" title="f/updates_mod/get_s0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_s0mat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_smat" title="f/updates_mod/get_smat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_smat()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/prepares_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">prepares_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/prepares_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the r.h.s. of the entropy equation
when parallel F.D solvers are used. Boundary values are set here.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/get_smat_rdist" title="f/updates_mod/get_smat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_smat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/fill_ghosts_s">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">fill_ghosts_s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/fill_ghosts_s" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to fill the ghosts zones that are located at
nR=n_r_cmb-1 and nR=n_r_icb+1. This is used to properly set the Neuman
boundary conditions. In case Dirichlet BCs are used, a simple first order
extrapolation is employed. This is anyway only used for outputs (like Nusselt
numbers).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy_rloc" title="f/updates_mod/assemble_entropy_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/updates_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">updates_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/updates_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is called after the linear solves have been completed.
This is then assembling the linear terms that will be used in the r.h.s.
for the next iteration.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Entropy</p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of entropy</p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Phase field</p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp_ghost" title="f/updates_mod/get_entropy_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/finish_exp_entropy">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dvsrlm</span></em>, <em class="sig-param"><span class="pre">ds_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/finish_exp_entropy" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine completes the computation of the advection term by
computing the radial derivative (LM-distributed variant).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsrlm</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/finish_exp_entropy_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_entropy_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">w</span></em>, <em class="sig-param"><span class="pre">dvsrlm</span></em>, <em class="sig-param"><span class="pre">ds_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/finish_exp_entropy_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine completes the computation of the advection term by
computing the radial derivative (R-distributed variant).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/get_entropy_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">get_entropy_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_entropy_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms that enters the r.h.s.. This is
used with LM-distributed</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy" title="f/updates_mod/assemble_entropy"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/get_entropy_rhs_imp_ghost">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">get_entropy_rhs_imp_ghost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">sg</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_entropy_rhs_imp_ghost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms that enters the r.h.s.. This is
used with R-distributed</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updates_mod/updates_fd" title="f/updates_mod/updates_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates_fd()</span></code></a>, <a class="reference internal" href="#f/updates_mod/assemble_entropy_rloc" title="f/updates_mod/assemble_entropy_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_entropy_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/assemble_entropy_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_entropy_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/assemble_entropy_rloc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used when an IMEX Runge-Kutta time scheme with an assembly
stage is used. This is used when R is distributed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="#f/updates_mod/fill_ghosts_s" title="f/updates_mod/fill_ghosts_s"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_s()</span></code></a>, <a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp_ghost" title="f/updates_mod/get_entropy_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/assemble_entropy">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">s</span></em>, <em class="sig-param"><span class="pre">ds</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/assemble_entropy" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the entropy/temperature at assembly
stages of IMEX-RK time schemes. This is used when LM is distributed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ds</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dsdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updates_mod/get_entropy_rhs_imp" title="f/updates_mod/get_entropy_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_entropy_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/get_s0mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">get_s0mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">smat</span></em>, <em class="sig-param"><span class="pre">smat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_s0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
sMat0</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>smat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>smat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/get_smat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">get_smat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">smat</span></em>, <em class="sig-param"><span class="pre">smat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_smat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
sMat(i,j) and s0mat for the entropy equation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>smat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>smat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/updates" title="f/updates_mod/updates"><code class="xref f f-func docutils literal notranslate"><span class="pre">updates()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updates_mod/get_smat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updates_mod/</span></span><span class="sig-name descname"><span class="pre">get_smat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">smat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updates_mod/get_smat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to construct the matrices when the parallel
solver for F.D. is employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>hdif</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>smat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updates_mod/prepares_fd" title="f/updates_mod/prepares_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepares_fd()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatexi_mod">
<span id="updatexi-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateXI.f90</span></code><a class="headerlink" href="#f/updatexi_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the chemical composition xi.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/fd_fac_bot" title="f/updatexi_mod/fd_fac_bot"><code class="xref f f-var docutils literal notranslate"><span class="pre">fd_fac_bot</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/fd_fac_top" title="f/updatexi_mod/fd_fac_top"><code class="xref f f-var docutils literal notranslate"><span class="pre">fd_fac_top</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/lximat" title="f/updatexi_mod/lximat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lximat</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/xi0mat_fac" title="f/updatexi_mod/xi0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi0mat_fac</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/xi_ghost" title="f/updatexi_mod/xi_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">xi_ghost</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/ximat_fac" title="f/updatexi_mod/ximat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">ximat_fac</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/ximat_fd" title="f/updatexi_mod/ximat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">ximat_fd</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/assemble_comp" title="f/updatexi_mod/assemble_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/assemble_comp_rloc" title="f/updatexi_mod/assemble_comp_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp_rloc()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/fill_ghosts_xi" title="f/updatexi_mod/fill_ghosts_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_xi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finalize_updatexi" title="f/updatexi_mod/finalize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finish_exp_comp" title="f/updatexi_mod/finish_exp_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/finish_exp_comp_rdist" title="f/updatexi_mod/finish_exp_comp_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_comp_rdist()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp_ghost" title="f/updatexi_mod/get_comp_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_xi0mat" title="f/updatexi_mod/get_xi0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_xi0mat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_ximat" title="f/updatexi_mod/get_ximat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ximat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_ximat_rdist" title="f/updatexi_mod/get_ximat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ximat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/initialize_updatexi" title="f/updatexi_mod/initialize_updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/preparexi_fd" title="f/updatexi_mod/preparexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparexi_fd()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi_fd" title="f/updatexi_mod/updatexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi_fd()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/osc" title="f/physical_parameters/osc"><code class="xref f f-func docutils literal notranslate"><span class="pre">osc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotxi" title="f/physical_parameters/kbotxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopxi" title="f/physical_parameters/ktopxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopxi()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/topxi" title="f/init_fields/topxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">topxi()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/botxi" title="f/init_fields/botxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">botxi()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_xi" title="f/horizontal_data/hdif_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_xi()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_update_xi" title="f/logic/l_update_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_xi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_solvers" title="f/parallel_solvers: This module contains the routines that are used to solve linear banded problems with R-distributed arrays."><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_solvers</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tri_par()</span></code>): This module contains the routines that are used to solve linear banded problems with R-distributed arrays.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/fd_fac_bot">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">fd_fac_bot</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/fd_fac_bot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/fd_fac_top">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">fd_fac_top</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/fd_fac_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/lximat">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">lximat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/lximat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/maxthreads">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">maxthreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/xi0mat_fac">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">xi0mat_fac</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/xi0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/xi_ghost">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">xi_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/xi_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/ximat_fac">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">ximat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/ximat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatexi_mod/ximat_fd">
<span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">ximat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatexi_mod/ximat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/initialize_updatexi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updatexi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/initialize_updatexi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/finalize_updatexi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updatexi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/finalize_updatexi" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine deallocates the matrices involved in the time-advance of
xi.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/updatexi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">updatexi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/updatexi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the chemical composition field s and its radial derivative.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Chemical composition</p></li>
<li><p><strong>dxi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: Radial derivative of xi</p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/get_xi0mat" title="f/updatexi_mod/get_xi0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_xi0mat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_ximat" title="f/updatexi_mod/get_ximat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ximat()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/preparexi_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">preparexi_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/preparexi_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the r.h.s. of the composition equation
when parallel F.D solvers are used. Boundary values are set here.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/get_ximat_rdist" title="f/updatexi_mod/get_ximat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ximat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/fill_ghosts_xi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">fill_ghosts_xi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xig</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/fill_ghosts_xi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to fill the ghosts zones that are located at
nR=n_r_cmb-1 and nR=n_r_icb+1. This is used to properly set the Neuman
boundary conditions. In case Dirichlet BCs are used, a simple first order
extrapolation is employed. This is anyway only used for outputs (like Sherwood
numbers).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xig</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/assemble_comp_rloc" title="f/updatexi_mod/assemble_comp_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/updatexi_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">updatexi_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/updatexi_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is called after the linear solves have been completed.
This is then assembling the linear terms that will be used in the r.h.s.
for the next iteration.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Composition</p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp_ghost" title="f/updatexi_mod/get_comp_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/finish_exp_comp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvxirlm</span></em>, <em class="sig-param"><span class="pre">dxi_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/finish_exp_comp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine completes the computation of the advection term which
enters the composition equation by taking the radial derivative. This is
the LM-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxirlm</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/finish_exp_comp_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_comp_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvxirlm</span></em>, <em class="sig-param"><span class="pre">dxi_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/finish_exp_comp_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine completes the computation of the advection term which
enters the composition equation by taking the radial derivative. This is
the R-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxirlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/get_comp_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">get_comp_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_comp_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms which enter the r.h.s. of the
equation for composition. This is the LM-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/assemble_comp" title="f/updatexi_mod/assemble_comp"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/get_comp_rhs_imp_ghost">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">get_comp_rhs_imp_ghost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xig</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_comp_rhs_imp_ghost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms which enter the r.h.s. of the
equation for composition. This is the R-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xig</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/updatexi_fd" title="f/updatexi_mod/updatexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi_fd()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/assemble_comp_rloc" title="f/updatexi_mod/assemble_comp_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_comp_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/assemble_comp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/assemble_comp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the chemical composition when an
IMEX-RK with an assembly stage is employed. Non-Dirichlet boundary
conditions are handled using Canuto (1986) approach. This is the LM
distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp" title="f/updatexi_mod/get_comp_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/assemble_comp_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_comp_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">xi</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/assemble_comp_rloc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used when an IMEX Runge-Kutta time scheme with an assembly
stage is used. This is used when R is distributed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dxidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/fill_ghosts_xi" title="f/updatexi_mod/fill_ghosts_xi"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_xi()</span></code></a>, <a class="reference internal" href="#f/updatexi_mod/get_comp_rhs_imp_ghost" title="f/updatexi_mod/get_comp_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_comp_rhs_imp_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/get_xi0mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">get_xi0mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">ximat</span></em>, <em class="sig-param"><span class="pre">ximat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_xi0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
xiMat0</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>ximat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>ximat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/get_ximat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">get_ximat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">ximat</span></em>, <em class="sig-param"><span class="pre">ximat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_ximat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
xiMat(i,j) for the equation for the chemical composition.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ximat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>ximat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/updatexi" title="f/updatexi_mod/updatexi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatexi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatexi_mod/get_ximat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatexi_mod/</span></span><span class="sig-name descname"><span class="pre">get_ximat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">ximat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatexi_mod/get_ximat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
xiMat(i,j) for the equation for the chemical composition. This is
used when parallel F.D. solvers are employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>hdif</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ximat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatexi_mod/preparexi_fd" title="f/updatexi_mod/preparexi_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparexi_fd()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updateb_mod">
<span id="updateb-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updateB.f90</span></code><a class="headerlink" href="#f/updateb_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the magnetic field potentials
b and aj as well as the inner core counterparts b_ic and aj_ic.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updateb_mod/aj_ghost" title="f/updateb_mod/aj_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">aj_ghost</span></code></a>, <a class="reference internal" href="#f/updateb_mod/b_ghost" title="f/updateb_mod/b_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">b_ghost</span></code></a>, <a class="reference internal" href="#f/updateb_mod/bmat_fac" title="f/updateb_mod/bmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">bmat_fac</span></code></a>, <a class="reference internal" href="#f/updateb_mod/bmat_fd" title="f/updateb_mod/bmat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">bmat_fd</span></code></a>, <a class="reference internal" href="#f/updateb_mod/dtp" title="f/updateb_mod/dtp"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtp</span></code></a>, <a class="reference internal" href="#f/updateb_mod/dtt" title="f/updateb_mod/dtt"><code class="xref f f-var docutils literal notranslate"><span class="pre">dtt</span></code></a>, <a class="reference internal" href="#f/updateb_mod/jmat_fac" title="f/updateb_mod/jmat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">jmat_fac</span></code></a>, <a class="reference internal" href="#f/updateb_mod/jmat_fd" title="f/updateb_mod/jmat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">jmat_fd</span></code></a>, <a class="reference internal" href="#f/updateb_mod/lbmat" title="f/updateb_mod/lbmat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lbmat</span></code></a>, <a class="reference internal" href="#f/updateb_mod/rhs2" title="f/updateb_mod/rhs2"><code class="xref f f-var docutils literal notranslate"><span class="pre">rhs2</span></code></a>, <a class="reference internal" href="#f/updateb_mod/work_ic_lmloc" title="f/updateb_mod/work_ic_lmloc"><code class="xref f f-var docutils literal notranslate"><span class="pre">work_ic_lmloc</span></code></a>, <a class="reference internal" href="#f/updateb_mod/worka" title="f/updateb_mod/worka"><code class="xref f f-var docutils literal notranslate"><span class="pre">worka</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag_rloc" title="f/updateb_mod/assemble_mag_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag_rloc()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/fill_ghosts_b" title="f/updateb_mod/fill_ghosts_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_b()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finalize_updateb" title="f/updateb_mod/finalize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag" title="f/updateb_mod/finish_exp_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_ic" title="f/updateb_mod/finish_exp_mag_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_ic()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/finish_exp_mag_rdist" title="f/updateb_mod/finish_exp_mag_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_exp_mag_rdist()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_bmat" title="f/updateb_mod/get_bmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bmat()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_bmat_rdist" title="f/updateb_mod/get_bmat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bmat_rdist()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp_ghost" title="f/updateb_mod/get_mag_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/initialize_updateb" title="f/updateb_mod/initialize_updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/prepareb_fd" title="f/updateb_mod/prepareb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepareb_fd()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb_fd" title="f/updateb_mod/updateb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb_fd()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_tot" title="f/truncation/n_r_tot"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_cheb_ic_max" title="f/truncation/n_cheb_ic_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_cheb_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_totmag" title="f/truncation/n_r_totmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_totmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic" title="f/radial_functions/chebt_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/chebt_ic_even" title="f/radial_functions/chebt_ic_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">chebt_ic_even()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d2cheb_ic" title="f/radial_functions/d2cheb_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">d2cheb_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_norm_ic" title="f/radial_functions/cheb_norm_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">cheb_norm_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_fac_ic" title="f/radial_functions/dr_fac_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_fac_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/lambda" title="f/radial_functions/lambda"><code class="xref f f-func docutils literal notranslate"><span class="pre">lambda()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dllambda" title="f/radial_functions/dllambda"><code class="xref f f-func docutils literal notranslate"><span class="pre">dllambda()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_ic" title="f/radial_functions/cheb_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">cheb_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dcheb_ic" title="f/radial_functions/dcheb_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dcheb_ic()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_top_ic" title="f/radial_functions/dr_top_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">dr_top_ic()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/opm" title="f/physical_parameters/opm"><code class="xref f f-func docutils literal notranslate"><span class="pre">opm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/o_sr" title="f/physical_parameters/o_sr"><code class="xref f f-func docutils literal notranslate"><span class="pre">o_sr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotb" title="f/physical_parameters/kbotb"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/imagcon" title="f/physical_parameters/imagcon"><code class="xref f f-func docutils literal notranslate"><span class="pre">imagcon()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/tmagcon" title="f/physical_parameters/tmagcon"><code class="xref f f-func docutils literal notranslate"><span class="pre">tmagcon()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/conductance_ma" title="f/physical_parameters/conductance_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">conductance_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopb" title="f/physical_parameters/ktopb"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopb()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/bpeaktop" title="f/init_fields/bpeaktop"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpeaktop()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/bpeakbot" title="f/init_fields/bpeakbot"><code class="xref f f-func docutils literal notranslate"><span class="pre">bpeakbot()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_sub_map" title="f/blocking/st_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulmmag()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_b" title="f/horizontal_data/hdif_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">hdif_b()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_lcr" title="f/logic/l_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_icb" title="f/logic/l_b_nl_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_b_nl_icb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_cmb" title="f/logic/l_b_nl_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_b_nl_cmb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_update_b" title="f/logic/l_update_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_update_b()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_par_solve" title="f/logic/l_mag_par_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_par_solve()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/dtbpollmr" title="f/rms/dtbpollmr"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbpollmr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/dtbpol2hint" title="f/rms/dtbpol2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbpol2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/dtbtor2hint" title="f/rms/dtbtor2hint"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtbtor2hint()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal notranslate"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/three" title="f/constants/three"><code class="xref f f-func docutils literal notranslate"><span class="pre">three()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal notranslate"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/special" title="f/special: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes"><code class="xref f f-mod docutils literal notranslate"><span class="pre">special</span></code></a>: This module contains all variables for the case of an imposed IC dipole, an imposed external magnetic field and a special boundary forcing to excite inertial modes</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pollm" title="f/rms_helpers/hint2pollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pollm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2torlm" title="f/rms_helpers/hint2torlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2torlm()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der_even" title="f/radial_der_even"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der_even</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der_even/get_ddr_even" title="f/radial_der_even/get_ddr_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_even()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">bordered_matrices</span></code></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_solvers" title="f/parallel_solvers: This module contains the routines that are used to solve linear banded problems with R-distributed arrays."><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_solvers</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tri_par()</span></code>): This module contains the routines that are used to solve linear banded problems with R-distributed arrays.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/aj_ghost">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">aj_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">public/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/aj_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/b_ghost">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">b_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">public/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/b_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/bmat_fac">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">bmat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/bmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/bmat_fd">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">bmat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/bmat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/dtp">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">dtp</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/dtp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/dtt">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">dtt</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/dtt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/jmat_fac">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">jmat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/jmat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/jmat_fd">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">jmat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/jmat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/lbmat">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">lbmat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/lbmat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/rhs2">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">rhs2</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/rhs2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/work_ic_lmloc">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">work_ic_lmloc</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/work_ic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/worka">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">worka</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/worka" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updateb_mod/workb">
<span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">workb</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updateb_mod/workb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updateb_mod/initialize_updateb">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updateb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/initialize_updateb" title="Permalink to this definition">¶</a></dt>
<dd><p>Purpose of this subroutine is to allocate the matrices needed
to time advance the magnetic field. Depending on the
radial scheme and the inner core conductivity, it can be full,
bordered or band matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/finalize_updateb">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updateb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finalize_updateb" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine deallocates the matrices involved in the time
advance of the magnetic field.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/updateb">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">updateb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">ddb_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em>, <em class="sig-param"><span class="pre">ddj_ic</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">b_nl_cmb</span></em>, <em class="sig-param"><span class="pre">aj_nl_cmb</span></em>, <em class="sig-param"><span class="pre">aj_nl_icb</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/updateb" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates update of magnetic field potentials.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>b_nl_cmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear BC for b at CMB</p></li>
<li><p><strong>aj_nl_cmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear BC for aj at CMB</p></li>
<li><p><strong>aj_nl_icb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: nonlinear BC for dr aj at ICB</p></li>
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_bmat" title="f/updateb_mod/get_bmat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bmat()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/prepareb_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">prepareb_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/prepareb_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine assembles the r.h.s. when finite difference parallel
solver is employed</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/test_lmloop" title="f/lmloop_mod/test_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">test_lmloop()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updateb_mod/get_bmat_rdist" title="f/updateb_mod/get_bmat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_bmat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/fill_ghosts_b">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">fill_ghosts_b</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">bg</span></em>, <em class="sig-param"><span class="pre">ajg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/fill_ghosts_b" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to fill the ghosts zones that are located at
nR=n_r_cmb-1 and nR=n_r_icb+1. This is used to properly set the Neuman
boundary conditions. In case Dirichlet BCs are used, a simple first order
extrapolation is employed. This is anyway only used for outputs.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>ajg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag_rloc" title="f/updateb_mod/assemble_mag_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/updateb_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">updateb_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/updateb_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the IMEX postprocs once the solve has been
completed</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp_ghost" title="f/updateb_mod/get_mag_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/finish_exp_mag_ic">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_mag_ic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">omega_ic</span></em>, <em class="sig-param"><span class="pre">db_exp_last</span></em>, <em class="sig-param"><span class="pre">dj_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finish_exp_mag_ic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the nonlinear term at the inner core boundary
when there is a conducting inner core and stress-free boundary conditions.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>db_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/finish_exp_mag">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvxbhlm</span></em>, <em class="sig-param"><span class="pre">dj_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finish_exp_mag" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine finishes the computation of the nonlinear induction term
by taking the missing radial derivative (LM-distributed version).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxbhlm</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_exp_last</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly" title="f/lmloop_mod/finish_explicit_assembly"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/finish_exp_mag_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">finish_exp_mag_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dvxbhlm</span></em>, <em class="sig-param"><span class="pre">dj_exp_last</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/finish_exp_mag_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine finishes the computation of the nonlinear induction term
by taking the missing radial derivative (R-distributed version).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dvxbhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_exp_last</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/finish_explicit_assembly_rdist" title="f/lmloop_mod/finish_explicit_assembly_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">finish_explicit_assembly_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="derInt.html#f/radial_der/get_dr_rloc" title="f/radial_der/get_dr_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dr_rloc()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/get_mag_ic_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">get_mag_ic_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">ddb_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em>, <em class="sig-param"><span class="pre">ddj_ic</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms that enter the r.h.s. of the
inner core equations.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_ddr_even" title="f/radial_der_even/get_ddr_even"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_even()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/assemble_mag">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">b_ic</span></em>, <em class="sig-param"><span class="pre">db_ic</span></em>, <em class="sig-param"><span class="pre">ddb_ic</span></em>, <em class="sig-param"><span class="pre">aj_ic</span></em>, <em class="sig-param"><span class="pre">dj_ic</span></em>, <em class="sig-param"><span class="pre">ddj_ic</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dbdt_ic</span></em>, <em class="sig-param"><span class="pre">djdt_ic</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/assemble_mag" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used when an IMEX Runge Kutta with an assembly stage
is employed. This is the LM-distributed version</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>b_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj_ic</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dbdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt_ic</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a>, <a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp" title="f/updateb_mod/get_mag_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_ic_rhs_imp" title="f/updateb_mod/get_mag_ic_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_ic_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/assemble_mag_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_mag_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/assemble_mag_rloc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used when an IMEX Runge Kutta with an assembly stage
is employed. This is the R-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/fill_ghosts_b" title="f/updateb_mod/fill_ghosts_b"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_b()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/get_mag_rhs_imp_ghost" title="f/updateb_mod/get_mag_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_mag_rhs_imp_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/get_mag_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">get_mag_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">b</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">aj</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_mag_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the computation of the linear terms which enter
the r.h.s. of the induction equation (LM-distributed version).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>aj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llmmag" title="f/blocking/llmmag">llmmag</a> + <a class="reference internal" href="blocking.html#f/blocking/ulmmag" title="f/blocking/ulmmag">ulmmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_old" title="f/readcheckpoints/readstartfields_old"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_old()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields" title="f/readcheckpoints/readstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields()</span></code></a>, <a class="reference internal" href="checkPoints.html#f/readcheckpoints/readstartfields_mpi" title="f/readcheckpoints/readstartfields_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">readstartfields_mpi()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag" title="f/updateb_mod/assemble_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pollm" title="f/rms_helpers/hint2pollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pollm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2torlm" title="f/rms_helpers/hint2torlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2torlm()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/get_mag_rhs_imp_ghost">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">get_mag_rhs_imp_ghost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">bg</span></em>, <em class="sig-param"><span class="pre">db</span></em>, <em class="sig-param"><span class="pre">ddb</span></em>, <em class="sig-param"><span class="pre">ajg</span></em>, <em class="sig-param"><span class="pre">dj</span></em>, <em class="sig-param"><span class="pre">ddj</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em>, <em class="sig-param"><span class="pre">lrmsnext</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_mag_rhs_imp_ghost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine handles the computation of the linear terms which enter
the r.h.s. of the induction equation (R-distributed version).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>db</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ajg</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>ddj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>djdt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmsnext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/updateb_fd" title="f/updateb_mod/updateb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb_fd()</span></code></a>, <a class="reference internal" href="#f/updateb_mod/assemble_mag_rloc" title="f/updateb_mod/assemble_mag_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_mag_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2pollm" title="f/rms_helpers/hint2pollm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2pollm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms_helpers/hint2torlm" title="f/rms_helpers/hint2torlm"><code class="xref f f-func docutils literal notranslate"><span class="pre">hint2torlm()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/get_bmat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">get_bmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">bmat</span></em>, <em class="sig-param"><span class="pre">bmat_fac</span></em>, <em class="sig-param"><span class="pre">jmat</span></em>, <em class="sig-param"><span class="pre">jmat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_bmat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
<code class="docutils literal notranslate"><span class="pre">bmat(i,j)</span></code> and <code class="docutils literal notranslate"><span class="pre">ajmat</span></code> for the dynamo equations.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>hdif</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bmat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>bmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_totmag" title="f/truncation/n_r_totmag">n_r_totmag</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>jmat</strong><em> [</em><em>integer</em><em>]</em> :: ‘)</p></li>
<li><p><strong>jmat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_totmag" title="f/truncation/n_r_totmag">n_r_totmag</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal notranslate"><span class="pre">updateb()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updateb_mod/get_bmat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updateb_mod/</span></span><span class="sig-name descname"><span class="pre">get_bmat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">hdif</span></em>, <em class="sig-param"><span class="pre">bmat</span></em>, <em class="sig-param"><span class="pre">jmat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updateb_mod/get_bmat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
<code class="docutils literal notranslate"><span class="pre">bmat(i,j)</span></code> and <code class="docutils literal notranslate"><span class="pre">ajmat</span></code> for the dynamo equations when the parallel
F.D. solver is used</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>hdif</strong> (1 + <a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag">l_maxmag</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>bmat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>jmat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updateb_mod/prepareb_fd" title="f/updateb_mod/prepareb_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">prepareb_fd()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="f/updatephi_mod">
<span id="updatephi-f90"></span><h2><code class="docutils literal notranslate"><span class="pre">updatePHI.f90</span></code><a class="headerlink" href="#f/updatephi_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module handles the time advance of the phase field phi.
It contains the computation of the implicit terms and the linear
solves.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/lphimat" title="f/updatephi_mod/lphimat"><code class="xref f f-var docutils literal notranslate"><span class="pre">lphimat</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/phi0mat_fac" title="f/updatephi_mod/phi0mat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi0mat_fac</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/phi_ghost" title="f/updatephi_mod/phi_ghost"><code class="xref f f-var docutils literal notranslate"><span class="pre">phi_ghost</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/phimat_fac" title="f/updatephi_mod/phimat_fac"><code class="xref f f-var docutils literal notranslate"><span class="pre">phimat_fac</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/phimat_fd" title="f/updatephi_mod/phimat_fd"><code class="xref f f-var docutils literal notranslate"><span class="pre">phimat_fd</span></code></a></p>
</dd>
<dt class="field-even">Routines</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatephi_mod/assemble_phase" title="f/updatephi_mod/assemble_phase"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/assemble_phase_rloc" title="f/updatephi_mod/assemble_phase_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase_rloc()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/fill_ghosts_phi" title="f/updatephi_mod/fill_ghosts_phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_phi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/finalize_updatephi" title="f/updatephi_mod/finalize_updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_updatephi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phase_rhs_imp" title="f/updatephi_mod/get_phase_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phase_rhs_imp()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phase_rhs_imp_ghost" title="f/updatephi_mod/get_phase_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phase_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phi0mat" title="f/updatephi_mod/get_phi0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phi0mat()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phimat" title="f/updatephi_mod/get_phimat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phimat()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phimat_rdist" title="f/updatephi_mod/get_phimat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phimat_rdist()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/initialize_updatephi" title="f/updatephi_mod/initialize_updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_updatephi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/preparephase_fd" title="f/updatephi_mod/preparephase_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparephase_fd()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/updatephase_fd" title="f/updatephi_mod/updatephase_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephase_fd()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/updatephi" title="f/updatephi_mod/updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephi()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">omp_lib</span></code></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <code class="xref f f-func docutils literal notranslate"><span class="pre">rscheme_oc()</span></code>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/dct_counter" title="f/num_param/dct_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">dct_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/solve_counter" title="f/num_param/solve_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">solve_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal notranslate"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/phasedifffac" title="f/physical_parameters/phasedifffac"><code class="xref f f-func docutils literal notranslate"><span class="pre">phasedifffac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/stef" title="f/physical_parameters/stef"><code class="xref f f-func docutils literal notranslate"><span class="pre">stef()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopphi" title="f/physical_parameters/ktopphi"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopphi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotphi" title="f/physical_parameters/kbotphi"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotphi()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="initModules.html#f/init_fields" title="f/init_fields: This module is used to construct the initial solution."><code class="xref f f-mod docutils literal notranslate"><span class="pre">init_fields</span></code></a> (<a class="reference internal" href="initModules.html#f/init_fields/phi_top" title="f/init_fields/phi_top"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi_top()</span></code></a>, <a class="reference internal" href="initModules.html#f/init_fields/phi_bot" title="f/init_fields/phi_bot"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi_bot()</span></code></a>): This module is used to construct the initial solution.</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_sub_map" title="f/blocking/lo_sub_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">lo_sub_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm"><code class="xref f f-func docutils literal notranslate"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm"><code class="xref f f-func docutils literal notranslate"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal notranslate"><span class="pre">st_map()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_finite_diff" title="f/logic/l_finite_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_finite_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">rank()</span></code>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/chunksize" title="f/parallel_mod/chunksize"><code class="xref f f-func docutils literal notranslate"><span class="pre">chunksize()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_procs()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>): This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>): Radial derivatives functions</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal notranslate"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/work_lmloc" title="f/fields/work_lmloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">work_lmloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_array" title="f/time_array: This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_array</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tarray()</span></code>): This module defines two types that are defined to store the implicit/explicit terms at the different sub-stage/step.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/dense_matrices" title="f/dense_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dense_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/real_matrices" title="f/real_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">real_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/band_matrices" title="f/band_matrices"><code class="xref f f-mod docutils literal notranslate"><span class="pre">band_matrices</span></code></a></p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_solvers" title="f/parallel_solvers: This module contains the routines that are used to solve linear banded problems with R-distributed arrays."><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_solvers</span></code></a> (<code class="xref f f-func docutils literal notranslate"><span class="pre">type_tri_par()</span></code>): This module contains the routines that are used to solve linear banded problems with R-distributed arrays.</p></li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/lphimat">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">lphimat</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">logical</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/lphimat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/maxthreads">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">maxthreads</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/maxthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/phi0mat_fac">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">phi0mat_fac</span></span> <span class="pre">(</span><span class="pre">*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/phi0mat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/phi_ghost">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">phi_ghost</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">complex</span></em><em><span class="pre">,</span></em><em><span class="pre">allocatable/public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/phi_ghost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/phimat_fac">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">phimat_fac</span></span> <span class="pre">(</span><span class="pre">*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/phimat_fac" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/phimat_fd">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">phimat_fd</span></span><em> <span class="pre">[</span></em><em><span class="pre">type_tri_par</span></em><em><span class="pre">,</span></em><em><span class="pre">public</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/phimat_fd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/updatephi_mod/rhs1">
<span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">rhs1</span></span> <span class="pre">(</span><span class="pre">*,*,*</span><span class="pre">)</span><em> <span class="pre">[</span></em><em><span class="pre">real</span></em><em><span class="pre">,</span></em><em><span class="pre">private/allocatable</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/updatephi_mod/rhs1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/initialize_updatephi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">initialize_updatephi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/initialize_updatephi" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/initialize_lmloop" title="f/lmloop_mod/initialize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/finalize_updatephi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">finalize_updatephi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/finalize_updatephi" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine deallocates the matrices involved in the time-advance of
phi.</p>
<dl class="field-list simple">
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/lmloop_mod/finalize_lmloop" title="f/lmloop_mod/finalize_lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_lmloop()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/updatephi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">updatephi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/updatephi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Updates the phase field</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Chemical composition</p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop" title="f/lmloop_mod/lmloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/get_phi0mat" title="f/updatephi_mod/get_phi0mat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phi0mat()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phimat" title="f/updatephi_mod/get_phimat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phimat()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phase_rhs_imp" title="f/updatephi_mod/get_phase_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phase_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/preparephase_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">preparephase_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/preparephase_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the r.h.s. of the phase field equation
when parallel F.D solvers are used. Boundary values are set here.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/get_phimat_rdist" title="f/updatephi_mod/get_phimat_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phimat_rdist()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/fill_ghosts_phi">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">fill_ghosts_phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phig</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/fill_ghosts_phi" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to fill the ghosts zones that are located at
nR=n_r_cmb-1 and nR=n_r_icb+1. This is used to properly set the Neuman
boundary conditions. In case Dirichlet BCs are used, a simple first order
extrapolation is employed. This is anyway only used for outputs (like Sherwood
numbers).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>phig</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a>, <a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/assemble_phase_rloc" title="f/updatephi_mod/assemble_phase_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/updatephase_fd">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">updatephase_fd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/updatephase_fd" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is called after the linear solves have been completed.
This is then assembling the linear terms that will be used in the r.h.s.
for the next iteration.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em> :: Phase field</p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/lmloop_rdist" title="f/lmloop_mod/lmloop_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">lmloop_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/get_phase_rhs_imp_ghost" title="f/updatephi_mod/get_phase_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phase_rhs_imp_ghost()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/get_phase_rhs_imp">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">get_phase_rhs_imp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">l_in_cheb_space</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/get_phase_rhs_imp" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms which enter the r.h.s. of the
equation for phase field. This is the LM-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Options</dt>
<dd class="field-even"><p><strong>l_in_cheb_space</strong><em> [</em><em>logical</em><em>,</em><em>in,</em><em>]</em></p>
</dd>
<dt class="field-odd">Called from</dt>
<dd class="field-odd"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/updatephi" title="f/updatephi_mod/updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/assemble_phase" title="f/updatephi_mod/assemble_phase"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase()</span></code></a></p>
</dd>
<dt class="field-even">Call to</dt>
<dd class="field-even"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr" title="f/radial_der/get_ddr"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/get_phase_rhs_imp_ghost">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">get_phase_rhs_imp_ghost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phig</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">istage</span></em>, <em class="sig-param"><span class="pre">l_calc_lin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/get_phase_rhs_imp_ghost" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine computes the linear terms which enter the r.h.s. of the
equation for phase field. This is the R-distributed version.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phig</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,3 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>istage</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_calc_lin</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="initModules.html#f/start_fields/getstartfields" title="f/start_fields/getstartfields"><code class="xref f f-func docutils literal notranslate"><span class="pre">getstartfields()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/step_time_mod/start_from_another_scheme" title="f/step_time_mod/start_from_another_scheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">start_from_another_scheme()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/updatephase_fd" title="f/updatephi_mod/updatephase_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephase_fd()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/assemble_phase_rloc" title="f/updatephi_mod/assemble_phase_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_phase_rloc()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_ddr_ghost" title="f/radial_der/get_ddr_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ddr_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/assemble_phase">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/assemble_phase" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used to assemble the phase field when an
IMEX-RK with an assembly stage is employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (1 - <a class="reference internal" href="blocking.html#f/blocking/llm" title="f/blocking/llm">llm</a> + <a class="reference internal" href="blocking.html#f/blocking/ulm" title="f/blocking/ulm">ulm</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage" title="f/lmloop_mod/assemble_stage"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/updatephi_mod/get_phase_rhs_imp" title="f/updatephi_mod/get_phase_rhs_imp"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phase_rhs_imp()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/assemble_phase_rloc">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">assemble_phase_rloc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">phi</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/assemble_phase_rloc" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine is used when an IMEX Runge-Kutta time scheme with an assembly
stage is used. This is used when R is distributed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phi</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>dphidt</strong><em> [</em><em>type_tarray</em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/lmloop_mod/assemble_stage_rdist" title="f/lmloop_mod/assemble_stage_rdist"><code class="xref f f-func docutils literal notranslate"><span class="pre">assemble_stage_rdist()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="parallelModules.html#f/parallel_mod/get_openmp_blocks" title="f/parallel_mod/get_openmp_blocks"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_openmp_blocks()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/bulk_to_ghost" title="f/radial_der/bulk_to_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">bulk_to_ghost()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/exch_ghosts" title="f/radial_der/exch_ghosts"><code class="xref f f-func docutils literal notranslate"><span class="pre">exch_ghosts()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/fill_ghosts_phi" title="f/updatephi_mod/fill_ghosts_phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">fill_ghosts_phi()</span></code></a>, <a class="reference internal" href="#f/updatephi_mod/get_phase_rhs_imp_ghost" title="f/updatephi_mod/get_phase_rhs_imp_ghost"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_phase_rhs_imp_ghost()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/get_phi0mat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">get_phi0mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">phimat</span></em>, <em class="sig-param"><span class="pre">phimat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/get_phi0mat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrix
phiMat0</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>phimat</strong><em> [</em><em>real</em><em>]</em></p></li>
<li><p><strong>phimat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatephi_mod/updatephi" title="f/updatephi_mod/updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/get_phimat">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">get_phimat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">l</span></em>, <em class="sig-param"><span class="pre">phimat</span></em>, <em class="sig-param"><span class="pre">phimat_fac</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/get_phimat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
phiMat(i,j) for the equation for phase field.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>l</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>phimat</strong><em> [</em><em>real</em><em>]</em> :: ‘)</p></li>
<li><p><strong>phimat_fac</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatephi_mod/updatephi" title="f/updatephi_mod/updatephi"><code class="xref f f-func docutils literal notranslate"><span class="pre">updatephi()</span></code></a></p>
</dd>
<dt class="field-odd">Call to</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/updatephi_mod/get_phimat_rdist">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">updatephi_mod/</span></span><span class="sig-name descname"><span class="pre">get_phimat_rdist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">phimat</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/updatephi_mod/get_phimat_rdist" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to contruct the time step matrices
phiMat(i,j) for the equation for the phase field. This is
used when parallel F.D. solvers are employed.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tscheme</strong><em> [</em><em>real</em><em>]</em> :: time step</p></li>
<li><p><strong>phimat</strong><em> [</em><em>type_tri_par</em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from</dt>
<dd class="field-even"><p><a class="reference internal" href="#f/updatephi_mod/preparephase_fd" title="f/updatephi_mod/preparephase_fd"><code class="xref f f-func docutils literal notranslate"><span class="pre">preparephase_fd()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Linear calculation part of the time stepping (LMLoop)</a><ul>
<li><a class="reference internal" href="#f/lmloop_mod"><code class="docutils literal notranslate"><span class="pre">LMLoop.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatewps_mod"><code class="docutils literal notranslate"><span class="pre">updateWPS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatewp_mod"><code class="docutils literal notranslate"><span class="pre">updateWP.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatez_mod"><code class="docutils literal notranslate"><span class="pre">updateZ.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updates_mod"><code class="docutils literal notranslate"><span class="pre">updateS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatexi_mod"><code class="docutils literal notranslate"><span class="pre">updateXI.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updateb_mod"><code class="docutils literal notranslate"><span class="pre">updateB.f90</span></code></a></li>
<li><a class="reference internal" href="#f/updatephi_mod"><code class="docutils literal notranslate"><span class="pre">updatePHI.f90</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="timeAdvance.html"
                          title="previous chapter">Time stepping</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="timeAdvNonLinear.html"
                          title="next chapter">Non-linear part of the time stepping (radial loop)</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/timeAdvLinear.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="timeAdvNonLinear.html" title="Non-linear part of the time stepping (radial loop)"
             >next</a> |</li>
        <li class="right" >
          <a href="timeAdvance.html" title="Time stepping"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Linear calculation part of the time stepping (LMLoop)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>