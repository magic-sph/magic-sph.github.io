<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Non-linear part of the time stepping (radial loop) &#8212; Magic 6.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css?v=a97dc138" />
    
    <script src="../_static/documentation_options.js?v=4b074805"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.3 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Radial scheme" href="legFourierChebAlgebra.html" />
    <link rel="prev" title="Linear calculation part of the time stepping (LMLoop)" href="timeAdvLinear.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="legFourierChebAlgebra.html" title="Radial scheme"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timeAdvLinear.html" title="Linear calculation part of the time stepping (LMLoop)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Non-linear part of the time stepping (radial loop)</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="non-linear-part-of-the-time-stepping-radial-loop">
<span id="secfortrannl"></span><h1>Non-linear part of the time stepping (radial loop)<a class="headerlink" href="#non-linear-part-of-the-time-stepping-radial-loop" title="Link to this heading">¶</a></h1>
<section id="radialloop-f90">
<h2><code class="docutils literal notranslate"><span class="pre">radialLoop.f90</span></code><a class="headerlink" href="#radialloop-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/radialloop">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/radialloop/finalize_radialloop" title="f/radialloop/finalize_radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">finalize_radialloop()</span></code></a>, <a class="reference internal" href="#f/radialloop/initialize_radialloop" title="f/radialloop/initialize_radialloop"><code class="xref f f-func docutils literal notranslate"><span class="pre">initialize_radialloop()</span></code></a>, <a class="reference internal" href="#f/radialloop/radialloopg" title="f/radialloop/radialloopg"><code class="xref f f-func docutils literal notranslate"><span class="pre">radialloopg()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="#f/riteration" title="f/riteration: This module is used to define an abstract class for the radial loop"><code class="xref f f-mod docutils literal notranslate"><span class="pre">riteration</span></code></a> (<a class="reference internal" href="#f/riteration/riter_t" title="f/riteration/riter_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">riter_t()</span></code></a>): This module is used to define an abstract class for the radial loop</p></li>
<li><p><a class="reference internal" href="#f/riter_mod" title="f/riter_mod: This module actually handles the loop over the radial levels. It contains the spherical harmonic transforms and the operations on the arrays in physical space...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">riter_mod</span></code></a> (<a class="reference internal" href="#f/riter_mod/riter_single_t" title="f/riter_mod/riter_single_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">riter_single_t()</span></code></a>): This module actually handles the loop over the radial levels. It contains the spherical harmonic transforms and the operations on the arrays in physical space….</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/radialloop/initialize_radialloop">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">radialloop/</span></span><span class="sig-name descname"><span class="pre">initialize_radialloop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/radialloop/initialize_radialloop" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal notranslate"><span class="pre">memwrite()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/radialloop/finalize_radialloop">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">radialloop/</span></span><span class="sig-name descname"><span class="pre">finalize_radialloop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/radialloop/finalize_radialloop" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Called from<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal notranslate"><span class="pre">magic</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/radialloop/radialloopg">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">radialloop/</span></span><span class="sig-name descname"><span class="pre">radialloopg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">l_graph</span></em>, <em class="sig-param"><span class="pre">l_frame</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">timestage</span></em>, <em class="sig-param"><span class="pre">tscheme</span></em>, <em class="sig-param"><span class="pre">dtlast</span></em>, <em class="sig-param"><span class="pre">ltocalc</span></em>, <em class="sig-param"><span class="pre">ltonext</span></em>, <em class="sig-param"><span class="pre">ltonext2</span></em>, <em class="sig-param"><span class="pre">lhelcalc</span></em>, <em class="sig-param"><span class="pre">lpowercalc</span></em>, <em class="sig-param"><span class="pre">lrmscalc</span></em>, <em class="sig-param"><span class="pre">lpresscalc</span></em>, <em class="sig-param"><span class="pre">lpressnext</span></em>, <em class="sig-param"><span class="pre">lviscbccalc</span></em>, <em class="sig-param"><span class="pre">lfluxprofcalc</span></em>, <em class="sig-param"><span class="pre">lperpparcalc</span></em>, <em class="sig-param"><span class="pre">lgeoscalc</span></em>, <em class="sig-param"><span class="pre">lhemicalc</span></em>, <em class="sig-param"><span class="pre">lphasecalc</span></em>, <em class="sig-param"><span class="pre">l_probe_out</span></em>, <em class="sig-param"><span class="pre">dsdt</span></em>, <em class="sig-param"><span class="pre">dwdt</span></em>, <em class="sig-param"><span class="pre">dzdt</span></em>, <em class="sig-param"><span class="pre">dpdt</span></em>, <em class="sig-param"><span class="pre">dxidt</span></em>, <em class="sig-param"><span class="pre">dphidt</span></em>, <em class="sig-param"><span class="pre">dbdt</span></em>, <em class="sig-param"><span class="pre">djdt</span></em>, <em class="sig-param"><span class="pre">dvxvhlm</span></em>, <em class="sig-param"><span class="pre">dvxbhlm</span></em>, <em class="sig-param"><span class="pre">dvsrlm</span></em>, <em class="sig-param"><span class="pre">dvxirlm</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ic</span></em>, <em class="sig-param"><span class="pre">lorentz_torque_ma</span></em>, <em class="sig-param"><span class="pre">br_vt_lm_cmb</span></em>, <em class="sig-param"><span class="pre">br_vp_lm_cmb</span></em>, <em class="sig-param"><span class="pre">br_vt_lm_icb</span></em>, <em class="sig-param"><span class="pre">br_vp_lm_icb</span></em>, <em class="sig-param"><span class="pre">dtrkc</span></em>, <em class="sig-param"><span class="pre">dthkc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/radialloop/radialloopg" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine performs the actual time-stepping.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_graph</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_frame</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>time</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>timestage</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>tscheme</strong><em> [</em><em>real </em><em>]</em></p></li>
<li><p><strong>dtlast</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ltocalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ltonext</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>ltonext2</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lhelcalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpowercalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lrmscalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpresscalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lpressnext</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lviscbccalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lfluxprofcalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lperpparcalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lgeoscalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lhemicalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lphasecalc</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>l_probe_out</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>dsdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dwdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dzdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dpdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dxidt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dphidt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dbdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>djdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvxvhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvxbhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvsrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvxirlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ic</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>lorentz_torque_ma</strong><em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>br_vt_lm_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em> :: product br*vt at CMB</p></li>
<li><p><strong>br_vp_lm_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em> :: product br*vp at CMB</p></li>
<li><p><strong>br_vt_lm_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em> :: product br*vt at ICB</p></li>
<li><p><strong>br_vp_lm_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em> :: product br*vp at ICB</p></li>
<li><p><strong>dtrkc</strong> (1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dthkc</strong> (1 - <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a> + <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="riteration-f90">
<h2><code class="docutils literal notranslate"><span class="pre">rIteration.f90</span></code><a class="headerlink" href="#riteration-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/riteration">Description</p>
<p>This module is used to define an abstract class for the radial loop</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Types<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/riteration/riter_t" title="f/riteration/riter_t"><code class="xref f f-type docutils literal notranslate"><span class="pre">riter_t</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl>
<dt class="sig sig-object f" id="f/riteration/riter_t">
<em class="property"><span class="pre">type</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">riteration/</span></span><span class="sig-name descname"><span class="pre">riter_t</span></span><a class="headerlink" href="#f/riteration/riter_t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/riteration/unknown_interface">
<span class="sig-prename descclassname"><span class="pre">riteration/</span></span><span class="sig-name descname"><span class="pre">unknown_interface</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/riteration/unknown_interface" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</section>
<section id="riter-f90">
<h2><code class="docutils literal notranslate"><span class="pre">rIter.f90</span></code><a class="headerlink" href="#riter-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/riter_mod">Description</p>
<p>This module actually handles the loop over the radial levels. It contains
the spherical harmonic transforms and the operations on the arrays in
physical space.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Types<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/riter_mod/riter_single_t" title="f/riter_mod/riter_single_t"><code class="xref f f-type docutils literal notranslate"><span class="pre">riter_single_t</span></code></a></p>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/radialloop" title="f/radialloop"><code class="xref f f-var docutils literal notranslate"><span class="pre">radialloop</span></code></a>, <a class="reference internal" href="#f/riter_mod/transform_to_grid_space" title="f/riter_mod/transform_to_grid_space"><code class="xref f f-var docutils literal notranslate"><span class="pre">transform_to_grid_space</span></code></a>, <a class="reference internal" href="#f/riter_mod/transform_to_lm_space" title="f/riter_mod/transform_to_lm_space"><code class="xref f f-var docutils literal notranslate"><span class="pre">transform_to_lm_space</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/phy2lm_counter" title="f/num_param/phy2lm_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">phy2lm_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/lm2phy_counter" title="f/num_param/lm2phy_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2phy_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/nl_counter" title="f/num_param/nl_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">nl_counter()</span></code></a>, <a class="reference internal" href="baseModules.html#f/num_param/td_counter" title="f/num_param/td_counter"><code class="xref f f-func docutils literal notranslate"><span class="pre">td_counter()</span></code></a>): Module containing numerical and control parameters</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_ht" title="f/logic/l_ht"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_ht()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anel" title="f/logic/l_anel"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_anel()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_cmb" title="f/logic/l_b_nl_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_b_nl_cmb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_icb" title="f/logic/l_b_nl_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_b_nl_icb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ma" title="f/logic/l_cond_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_cond_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtb" title="f/logic/l_dtb"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_store_frame" title="f/logic/l_store_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_store_frame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_to" title="f/logic/l_to"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_to()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_probe" title="f/logic/l_probe"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_probe()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_full_sphere" title="f/logic/l_full_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_full_sphere()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_precession" title="f/logic/l_precession"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_precession()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_centrifuge" title="f/logic/l_centrifuge"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_centrifuge()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_adv_curl" title="f/logic/l_adv_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_adv_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_parallel_solve" title="f/logic/l_parallel_solve"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_parallel_solve()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_temperature_diff" title="f/logic/l_temperature_diff"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_temperature_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_phase_field" title="f/logic/l_phase_field"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_phase_field()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_onset" title="f/logic/l_onset"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_onset()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtrmagspec" title="f/logic/l_dtrmagspec"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_dtrmagspec()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">nrstopmag()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/l_r" title="f/radial_functions/l_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="#f/nonlinear_lm_mod" title="f/nonlinear_lm_mod: This module is used to finish the assembly of the nonlinear terms in :math:`(\ell,m)` space. Derivatives along :math:`\theta` and :math:`\phi` are handled using recurrence relations...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">nonlinear_lm_mod</span></code></a> (<a class="reference internal" href="#f/nonlinear_lm_mod/nonlinear_lm_t" title="f/nonlinear_lm_mod/nonlinear_lm_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">nonlinear_lm_t()</span></code></a>): This module is used to finish the assembly of the nonlinear terms in <span class="math notranslate nohighlight">\((\ell,m)\)</span> space. Derivatives along <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> are handled using recurrence relations….</p></li>
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">grid_space_arrays_mod</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">grid_space_arrays_t()</span></code>): This module is used to compute the nonlinear products in physical space <span class="math notranslate nohighlight">\((\theta,\phi)\)</span>.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/dtb_arrays_mod" title="f/dtb_arrays_mod"><code class="xref f f-mod docutils literal notranslate"><span class="pre">dtb_arrays_mod</span></code></a> (<a class="reference internal" href="IOAdd.html#f/dtb_arrays_mod/dtb_arrays_t" title="f/dtb_arrays_mod/dtb_arrays_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtb_arrays_t()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal notranslate"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="IOAdd.html#f/torsional_oscillations/prep_to_axi" title="f/torsional_oscillations/prep_to_axi"><code class="xref f f-func docutils literal notranslate"><span class="pre">prep_to_axi()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal notranslate"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/gettonext" title="f/torsional_oscillations/gettonext"><code class="xref f f-func docutils literal notranslate"><span class="pre">gettonext()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/gettofinish" title="f/torsional_oscillations/gettofinish"><code class="xref f f-func docutils literal notranslate"><span class="pre">gettofinish()</span></code></a>): This module contains information for TO calculation and output</p></li>
<li><p><a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod" title="f/graphout_mod: This module contains the subroutines that store the 3-D graphic files."><code class="xref f f-mod docutils literal notranslate"><span class="pre">graphout_mod</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal notranslate"><span class="pre">graphout_mpi_header()</span></code></a>): This module contains the subroutines that store the 3-D graphic files.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dh_dtblm" title="f/dtb_mod/get_dh_dtblm"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_dh_dtblm()</span></code></a>): This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output….</p></li>
<li><p><a class="reference internal" href="IOBinaryOutputs.html#f/out_movie" title="f/out_movie"><code class="xref f f-mod docutils literal notranslate"><span class="pre">out_movie</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal notranslate"><span class="pre">store_movie_frame()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/outrot" title="f/outrot: This module handles the writing of several diagnostic files related to the rotation: angular momentum (AM.TAG), drift (drift.TAG), inner core and mantle rotations...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">outrot</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outrot/get_lorentz_torque" title="f/outrot/get_lorentz_torque"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_lorentz_torque()</span></code></a>): This module handles the writing of several diagnostic files related to the rotation: angular momentum (AM.TAG), drift (drift.TAG), inner core and mantle rotations….</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/courant_mod" title="f/courant_mod: This module handles the computation of Courant factors on grid space. It then checks whether the timestep size needs to be modified."><code class="xref f f-mod docutils literal notranslate"><span class="pre">courant_mod</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/courant_mod/courant" title="f/courant_mod/courant"><code class="xref f f-func docutils literal notranslate"><span class="pre">courant()</span></code></a>): This module handles the computation of Courant factors on grid space. It then checks whether the timestep size needs to be modified.</p></li>
<li><p><a class="reference internal" href="#f/nonlinear_bcs" title="f/nonlinear_bcs"><code class="xref f f-mod docutils literal notranslate"><span class="pre">nonlinear_bcs</span></code></a> (<a class="reference internal" href="#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/v_rigid_boundary" title="f/nonlinear_bcs/v_rigid_boundary"><code class="xref f f-func docutils literal notranslate"><span class="pre">v_rigid_boundary()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/v_center_sphere" title="f/nonlinear_bcs/v_center_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">v_center_sphere()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/power" title="f/power: This module handles the writing of the power budget"><code class="xref f f-mod docutils literal notranslate"><span class="pre">power</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/power/get_visc_heat" title="f/power/get_visc_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_visc_heat()</span></code></a>): This module handles the writing of the power budget</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/outmisc_mod" title="f/outmisc_mod: This module contains several subroutines that can compute and store various informations: helicity (helicity.TAG), heat transfer (heat.TAG), phase field (phase.TAG) and North/South hemisphericity of energies (hemi.TAG)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">outmisc_mod</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outmisc_mod/get_ekin_solid_liquid" title="f/outmisc_mod/get_ekin_solid_liquid"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_ekin_solid_liquid()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outmisc_mod/get_hemi" title="f/outmisc_mod/get_hemi"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_hemi()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outmisc_mod/get_helicity" title="f/outmisc_mod/get_helicity"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_helicity()</span></code></a>): This module contains several subroutines that can compute and store various informations: helicity (helicity.TAG), heat transfer (heat.TAG), phase field (phase.TAG) and North/South hemisphericity of energies (hemi.TAG)</p></li>
<li><p><a class="reference internal" href="IOGeneral.html#f/outpar_mod" title="f/outpar_mod: This module is used to compute several time-averaged radial profiles: fluxes, boundary layers, etc."><code class="xref f f-mod docutils literal notranslate"><span class="pre">outpar_mod</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outpar_mod/get_fluxes" title="f/outpar_mod/get_fluxes"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/get_nlblayers" title="f/outpar_mod/get_nlblayers"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_nlblayers()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outpar_mod/get_perppar" title="f/outpar_mod/get_perppar"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_perppar()</span></code></a>): This module is used to compute several time-averaged radial profiles: fluxes, boundary layers, etc.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/geos" title="f/geos: This module is used to compute z-integrated diagnostics such as the degree of geostrophy or the separation of energies between inside and outside the tangent cylinder. This makes use of a local Simpson's method. This also"><code class="xref f f-mod docutils literal notranslate"><span class="pre">geos</span></code></a> (<a class="reference internal" href="IOAdd.html#f/geos/calcgeos" title="f/geos/calcgeos"><code class="xref f f-func docutils literal notranslate"><span class="pre">calcgeos()</span></code></a>): This module is used to compute z-integrated diagnostics such as the degree of geostrophy or the separation of energies between inside and outside the tangent cylinder. This makes use of a local Simpson’s method. This also</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a></p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/s_rloc" title="f/fields/s_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">s_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ds_rloc" title="f/fields/ds_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ds_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/z_rloc" title="f/fields/z_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">z_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dz_rloc" title="f/fields/dz_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dz_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/p_rloc" title="f/fields/p_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">p_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/b_rloc" title="f/fields/b_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">b_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/db_rloc" title="f/fields/db_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">db_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddb_rloc" title="f/fields/ddb_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddb_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/aj_rloc" title="f/fields/aj_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">aj_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dj_rloc" title="f/fields/dj_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dj_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dw_rloc" title="f/fields/dw_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddw_rloc" title="f/fields/ddw_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/xi_rloc" title="f/fields/xi_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">xi_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/omega_ic" title="f/fields/omega_ic"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/omega_ma" title="f/fields/omega_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">omega_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dp_rloc" title="f/fields/dp_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dp_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/phi_rloc" title="f/fields/phi_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi_rloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
<li><p><a class="reference internal" href="timeAdvance.html#f/time_schemes" title="f/time_schemes: This module defines an abstract class type_tscheme which is employed for the time advance of the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">time_schemes</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/time_schemes/type_tscheme" title="f/time_schemes/type_tscheme"><code class="xref f f-func docutils literal notranslate"><span class="pre">type_tscheme()</span></code></a>): This module defines an abstract class type_tscheme which is employed for the time advance of the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/ktops" title="f/physical_parameters/ktops"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktops()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbots" title="f/physical_parameters/kbots"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbots()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal notranslate"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal notranslate"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ellip_fac_cmb" title="f/physical_parameters/ellip_fac_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">ellip_fac_cmb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ellip_fac_icb" title="f/physical_parameters/ellip_fac_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">ellip_fac_icb()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="#f/riteration" title="f/riteration: This module is used to define an abstract class for the radial loop"><code class="xref f f-mod docutils literal notranslate"><span class="pre">riteration</span></code></a> (<a class="reference internal" href="#f/riteration/riter_t" title="f/riteration/riter_t"><code class="xref f f-func docutils literal notranslate"><span class="pre">riter_t()</span></code></a>): This module is used to define an abstract class for the radial loop</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of the RMS force balance and induction terms."><code class="xref f f-mod docutils literal notranslate"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/get_nl_rms" title="f/rms/get_nl_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_nl_rms()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/transform_to_lm_rms" title="f/rms/transform_to_lm_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_lm_rms()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/compute_lm_forces" title="f/rms/compute_lm_forces"><code class="xref f f-func docutils literal notranslate"><span class="pre">compute_lm_forces()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/transform_to_grid_rms" title="f/rms/transform_to_grid_rms"><code class="xref f f-func docutils literal notranslate"><span class="pre">transform_to_grid_rms()</span></code></a>): This module contains the calculation of the RMS force balance and induction terms.</p></li>
<li><p><a class="reference internal" href="IOAdd.html#f/probe_mod" title="f/probe_mod: Module for artificial sensors to compare time series of physical data with experiments. Probes are located in a radially symmetrical way"><code class="xref f f-mod docutils literal notranslate"><span class="pre">probe_mod</span></code></a>: Module for artificial sensors to compare time series of physical data with experiments. Probes are located in a radially symmetrical way</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl>
<dt class="sig sig-object f" id="f/riter_mod/riter_single_t">
<em class="property"><span class="pre">type</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">riter_mod/</span></span><span class="sig-name descname"><span class="pre">riter_single_t</span></span><a class="headerlink" href="#f/riter_mod/riter_single_t" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">dtb_arrays</span><em> [</em><em>dtb_arrays_t </em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">gsa</span><em> [</em><em>grid_space_arrays_t </em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">nl_lm</span><em> [</em><em>nonlinear_lm_t </em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/riter_mod/finalize">
<span class="sig-prename descclassname"><span class="pre">riter_mod/</span></span><span class="sig-name descname"><span class="pre">finalize</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/riter_mod/finalize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/riter_mod/initialize">
<span class="sig-prename descclassname"><span class="pre">riter_mod/</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/riter_mod/initialize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/riter_mod/radialloop">
<span class="sig-prename descclassname"><span class="pre">riter_mod/</span></span><span class="sig-name descname"><span class="pre">radialloop</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/riter_mod/radialloop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/riter_mod/transform_to_grid_space">
<span class="sig-prename descclassname"><span class="pre">riter_mod/</span></span><span class="sig-name descname"><span class="pre">transform_to_grid_space</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/riter_mod/transform_to_grid_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/riter_mod/transform_to_lm_space">
<span class="sig-prename descclassname"><span class="pre">riter_mod/</span></span><span class="sig-name descname"><span class="pre">transform_to_lm_space</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/riter_mod/transform_to_lm_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</section>
<section id="get-nl-f90">
<h2><code class="docutils literal notranslate"><span class="pre">get_nl.f90</span></code><a class="headerlink" href="#get-nl-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/general_arrays_mod">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Types<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/general_arrays_mod/general_arrays_t" title="f/general_arrays_mod/general_arrays_t"><code class="xref f f-type docutils literal notranslate"><span class="pre">general_arrays_t</span></code></a></p>
</dd>
</dl>
<p class="rubric">Types</p>
<ul>
<li><dl>
<dt class="sig sig-object f" id="f/general_arrays_mod/general_arrays_t">
<em class="property"><span class="pre">type</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">general_arrays_mod/</span></span><span class="sig-name descname"><span class="pre">general_arrays_t</span></span><a class="headerlink" href="#f/general_arrays_mod/general_arrays_t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
</section>
<section id="get-td-f90">
<h2><code class="docutils literal notranslate"><span class="pre">get_td.f90</span></code><a class="headerlink" href="#get-td-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/nonlinear_lm_mod">Description</p>
<p>This module is used to finish the assembly of the nonlinear terms in
<span class="math notranslate nohighlight">\((\ell,m)\)</span> space. Derivatives along <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>
are handled using recurrence relations.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Types<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/nonlinear_lm_mod/nonlinear_lm_t" title="f/nonlinear_lm_mod/nonlinear_lm_t"><code class="xref f f-type docutils literal notranslate"><span class="pre">nonlinear_lm_t</span></code></a></p>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#f/nonlinear_lm_mod/get_td" title="f/nonlinear_lm_mod/get_td"><code class="xref f f-var docutils literal notranslate"><span class="pre">get_td</span></code></a>, <a class="reference internal" href="#f/nonlinear_lm_mod/lm_min" title="f/nonlinear_lm_mod/lm_min"><code class="xref f f-var docutils literal notranslate"><span class="pre">lm_min</span></code></a>, <a class="reference internal" href="#f/nonlinear_lm_mod/set_zero" title="f/nonlinear_lm_mod/set_zero"><code class="xref f f-var docutils literal notranslate"><span class="pre">set_zero</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal notranslate"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_min" title="f/truncation/m_min"><code class="xref f f-func docutils literal notranslate"><span class="pre">m_min()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal notranslate"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_anel" title="f/logic/l_anel"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_anel()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_corr" title="f/logic/l_corr"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_corr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anelastic_liquid" title="f/logic/l_anelastic_liquid"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_anelastic_liquid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_double_curl()</span></code></a>): Module containing the logicals that control the run</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal notranslate"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal notranslate"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal notranslate"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal notranslate"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/epscprof" title="f/radial_functions/epscprof"><code class="xref f f-func docutils literal notranslate"><span class="pre">epscprof()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal notranslate"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal notranslate"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal notranslate"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/l_r" title="f/radial_functions/l_r"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_r()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal notranslate"><span class="pre">corfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/epsc" title="f/physical_parameters/epsc"><code class="xref f f-func docutils literal notranslate"><span class="pre">epsc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/epscxi" title="f/physical_parameters/epscxi"><code class="xref f f-func docutils literal notranslate"><span class="pre">epscxi()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lma" title="f/blocking/lm2lma"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2lma()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lms" title="f/blocking/lm2lms"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2lms()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal notranslate"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal notranslate"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta2a" title="f/horizontal_data/dtheta2a"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta2a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta3a" title="f/horizontal_data/dtheta3a"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta3a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta4a" title="f/horizontal_data/dtheta4a"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta4a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta2s" title="f/horizontal_data/dtheta2s"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta2s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta3s" title="f/horizontal_data/dtheta3s"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta3s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta4s" title="f/horizontal_data/dtheta4s"><code class="xref f f-func docutils literal notranslate"><span class="pre">dtheta4s()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal notranslate"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays...."><code class="xref f f-mod docutils literal notranslate"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dw_rloc" title="f/fields/dw_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddw_rloc" title="f/fields/ddw_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">ddw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/z_rloc" title="f/fields/z_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">z_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dz_rloc" title="f/fields/dz_rloc"><code class="xref f f-func docutils literal notranslate"><span class="pre">dz_rloc()</span></code></a>): This module contains all the fields used in MagIC in the hybrid (LM,r) space as well as their radial derivatives. It defines both the LM-distributed arrays and the R-distributed arrays….</p></li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl>
<dt class="sig sig-object f" id="f/nonlinear_lm_mod/nonlinear_lm_t">
<em class="property"><span class="pre">type</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">nonlinear_lm_mod/</span></span><span class="sig-name descname"><span class="pre">nonlinear_lm_t</span></span><a class="headerlink" href="#f/nonlinear_lm_mod/nonlinear_lm_t" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type fields<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">advplm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">advrlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">advtlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">heattermslm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vsplm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vstlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vxbplm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vxbrlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vxbtlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vxiplm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
<li><p><span class="sig-name descname">% </span><span class="sig-name descname">vxitlm</span> (*)<em> [</em><em>complex </em><em>,</em><em>allocatable</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/nonlinear_lm_mod/finalize">
<span class="sig-prename descclassname"><span class="pre">nonlinear_lm_mod/</span></span><span class="sig-name descname"><span class="pre">finalize</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/nonlinear_lm_mod/finalize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/nonlinear_lm_mod/get_td">
<span class="sig-prename descclassname"><span class="pre">nonlinear_lm_mod/</span></span><span class="sig-name descname"><span class="pre">get_td</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/nonlinear_lm_mod/get_td" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/nonlinear_lm_mod/initialize">
<span class="sig-prename descclassname"><span class="pre">nonlinear_lm_mod/</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/nonlinear_lm_mod/initialize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/nonlinear_lm_mod/lm_min">
<span class="sig-prename descclassname"><span class="pre">nonlinear_lm_mod/</span></span><span class="sig-name descname"><span class="pre">lm_min</span></span><em> <span class="pre">[</span></em><em><span class="pre">integer</span></em><em><span class="pre">,</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/nonlinear_lm_mod/lm_min" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="f variable">
<dt class="sig sig-object f" id="f/nonlinear_lm_mod/set_zero">
<span class="sig-prename descclassname"><span class="pre">nonlinear_lm_mod/</span></span><span class="sig-name descname"><span class="pre">set_zero</span></span><em> <span class="pre">[</span></em><em><span class="pre">private</span></em><em><span class="pre">]</span></em><a class="headerlink" href="#f/nonlinear_lm_mod/set_zero" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</section>
<section id="nonlinear-bcs-f90">
<h2><code class="docutils literal notranslate"><span class="pre">nonlinear_bcs.f90</span></code><a class="headerlink" href="#nonlinear-bcs-f90" title="Link to this heading">¶</a></h2>
<p class="rubric" id="f/nonlinear_bcs">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/nonlinear_bcs/get_b_nl_bcs" title="f/nonlinear_bcs/get_b_nl_bcs"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_b_nl_bcs()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal notranslate"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/v_center_sphere" title="f/nonlinear_bcs/v_center_sphere"><code class="xref f f-func docutils literal notranslate"><span class="pre">v_center_sphere()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/v_rigid_boundary" title="f/nonlinear_bcs/v_rigid_boundary"><code class="xref f f-func docutils literal notranslate"><span class="pre">v_rigid_boundary()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><p><code class="xref f f-mod docutils literal notranslate"><span class="pre">iso_fortran_env</span></code> (<code class="xref f f-func docutils literal notranslate"><span class="pre">output_unit()</span></code>)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal notranslate"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</p></li>
<li><p><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal notranslate"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm2()</span></code></a>): Module containing blocking information</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal notranslate"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_theta_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nlat_padded" title="f/truncation/nlat_padded"><code class="xref f f-func docutils literal notranslate"><span class="pre">nlat_padded()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal notranslate"><span class="pre">lm_max()</span></code></a>): This module defines the grid points and the truncation</p></li>
<li><p><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal notranslate"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal notranslate"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal notranslate"><span class="pre">rho0()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal notranslate"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal notranslate"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/conductance_ma" title="f/physical_parameters/conductance_ma"><code class="xref f f-func docutils literal notranslate"><span class="pre">conductance_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal notranslate"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/oek" title="f/physical_parameters/oek"><code class="xref f f-func docutils literal notranslate"><span class="pre">oek()</span></code></a>): Module containing the physical parameters</p></li>
<li><p><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal notranslate"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">costheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta_e2" title="f/horizontal_data/sintheta_e2"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal notranslate"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal notranslate"><span class="pre">sintheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</p></li>
<li><p><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal notranslate"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal notranslate"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/y10_norm" title="f/constants/y10_norm"><code class="xref f f-func docutils literal notranslate"><span class="pre">y10_norm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/y11_norm" title="f/constants/y11_norm"><code class="xref f f-func docutils literal notranslate"><span class="pre">y11_norm()</span></code></a>): module containing constants and parameters used in the code.</p></li>
<li><p><a class="reference internal" href="misc.html#f/useful" title="f/useful: This module contains several useful routines."><code class="xref f f-mod docutils literal notranslate"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a>): This module contains several useful routines.</p></li>
<li><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht" title="f/sht"><code class="xref f f-mod docutils literal notranslate"><span class="pre">sht</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sphertor" title="f/sht/spat_to_sphertor"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sphertor()</span></code></a>)</p></li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/nonlinear_bcs/get_br_v_bcs">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">nonlinear_bcs/</span></span><span class="sig-name descname"><span class="pre">get_br_v_bcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">br</span></em>, <em class="sig-param"><span class="pre">vt</span></em>, <em class="sig-param"><span class="pre">vp</span></em>, <em class="sig-param"><span class="pre">omega</span></em>, <em class="sig-param"><span class="pre">o_r_e_2</span></em>, <em class="sig-param"><span class="pre">o_rho</span></em>, <em class="sig-param"><span class="pre">br_vt_lm</span></em>, <em class="sig-param"><span class="pre">br_vp_lm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/get_br_v_bcs" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the nonlinear term
of the magnetic boundary condition for a conducting mantle or
inner core in space (r,lm).
Calculation is performed for the theta block:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">n_theta_min</span><span class="o">&lt;=</span><span class="n">n_theta</span><span class="o">&lt;=</span><span class="n">n_theta_min</span><span class="o">+</span><span class="n">n_theta_block</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>On input <code class="docutils literal notranslate"><span class="pre">br</span></code>, <code class="docutils literal notranslate"><span class="pre">vt</span></code> and <code class="docutils literal notranslate"><span class="pre">vp</span></code> are given on all phi points and
thetas in the specific block.
On output the contribution of these grid points to all
degree and orders is stored in <code class="docutils literal notranslate"><span class="pre">br_vt_lm</span></code> and <code class="docutils literal notranslate"><span class="pre">br_vp_lm</span></code>.
Output is <code class="docutils literal notranslate"><span class="pre">[r/sin(theta)*Br*U]=[(0,br_vt_lm,br_vp_lm)]</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>br</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(r^2 B_r\)</span></p></li>
<li><p><strong>vt</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(r \sin\theta u_\theta\)</span></p></li>
<li><p><strong>vp</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(r \sin\theta u_\phi\)</span></p></li>
<li><p><strong>omega</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: rotation rate of mantle or IC</p></li>
<li><p><strong>o_r_e_2</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(1/r^2\)</span></p></li>
<li><p><strong>o_rho</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(1/\tilde{\rho}\)</span> (anelastic)</p></li>
<li><p><strong>br_vt_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
<li><p><strong>br_vp_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>inout</em><em>]</em></p></li>
</ul>
</dd>
<dt class="field-even">Call to<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="legFourierChebAlgebra.html#f/sht/spat_to_sphertor" title="f/sht/spat_to_sphertor"><code class="xref f f-func docutils literal notranslate"><span class="pre">spat_to_sphertor()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/nonlinear_bcs/get_b_nl_bcs">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">nonlinear_bcs/</span></span><span class="sig-name descname"><span class="pre">get_b_nl_bcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">bc</span></em>, <em class="sig-param"><span class="pre">br_vt_lm</span></em>, <em class="sig-param"><span class="pre">br_vp_lm</span></em>, <em class="sig-param"><span class="pre">lm_min_b</span></em>, <em class="sig-param"><span class="pre">lm_max_b</span></em>, <em class="sig-param"><span class="pre">b_nl_bc</span></em>, <em class="sig-param"><span class="pre">aj_nl_bc</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/get_b_nl_bcs" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the nonlinear term
of the magnetic boundary condition for a conducting mantle in
physical space (theta,phi), assuming that the conductance
of the mantle is much smaller than that of the core.
Calculation is performed for the theta block:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">n_theta_min</span><span class="o">&lt;=</span><span class="n">n_theta</span><span class="o">&lt;=</span><span class="n">n_theta_min</span><span class="o">+</span><span class="n">n_theta_block</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bc</strong><em> [</em><em>character(len=3)</em><em>,</em><em>in</em><em>]</em> :: Distinguishes ‘CMB’ and ‘ICB’</p></li>
<li><p><strong>br_vt_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(B_r u_\theta/(r^2\sin^2\theta)\)</span></p></li>
<li><p><strong>br_vp_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em> :: <span class="math notranslate nohighlight">\(B_r u_\phi/(r^2\sin^2\theta)\)</span></p></li>
<li><p><strong>lm_min_b</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>lm_max_b</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: limits of lm-block</p></li>
<li><p><strong>b_nl_bc</strong> (1 + lm_max_b - lm_min_b)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em> :: nonlinear bc for b</p></li>
<li><p><strong>aj_nl_bc</strong> (1 + lm_max_b - lm_min_b)<em> [</em><em>complex </em><em>,</em><em>out</em><em>]</em> :: nonlinear bc for aj</p></li>
</ul>
</dd>
<dt class="field-even">Called from<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal notranslate"><span class="pre">step_time()</span></code></a></p>
</dd>
<dt class="field-odd">Call to<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal notranslate"><span class="pre">abortrun()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/nonlinear_bcs/v_rigid_boundary">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">nonlinear_bcs/</span></span><span class="sig-name descname"><span class="pre">v_rigid_boundary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">nr</span></em>, <em class="sig-param"><span class="pre">omega</span></em>, <em class="sig-param"><span class="pre">lderiv</span></em>, <em class="sig-param"><span class="pre">vrr</span></em>, <em class="sig-param"><span class="pre">vtr</span></em>, <em class="sig-param"><span class="pre">vpr</span></em>, <em class="sig-param"><span class="pre">cvrr</span></em>, <em class="sig-param"><span class="pre">dvrdtr</span></em>, <em class="sig-param"><span class="pre">dvrdpr</span></em>, <em class="sig-param"><span class="pre">dvtdpr</span></em>, <em class="sig-param"><span class="pre">dvpdpr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/v_rigid_boundary" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to set the velocities and their
derivatives at a fixed boundary.
While <code class="docutils literal notranslate"><span class="pre">vt</span></code> is zero, since we only allow for rotation about the
<span class="math notranslate nohighlight">\(z\)</span>-axis, <code class="docutils literal notranslate"><span class="pre">vp=</span> <span class="pre">r</span> <span class="pre">\sin(theta)</span> <span class="pre">v_phi</span> <span class="pre">=</span> <span class="pre">r**2</span> <span class="pre">sin(theta)**2</span> <span class="pre">omega</span></code>
and <code class="docutils literal notranslate"><span class="pre">cvr=</span> <span class="pre">r**2</span> <span class="pre">*</span> <span class="pre">radial</span> <span class="pre">component</span> <span class="pre">of</span> <span class="pre">(\curl</span> <span class="pre">v)</span> <span class="pre">=</span> <span class="pre">r**2</span>&#160; <span class="pre">2</span> <span class="pre">cos(theta)</span> <span class="pre">omega</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong><em> [</em><em>integer </em><em>,</em><em>in</em><em>]</em> :: no of radial grid point</p></li>
<li><p><strong>omega</strong><em> [</em><em>real </em><em>,</em><em>in</em><em>]</em> :: boundary rotation rate</p></li>
<li><p><strong>lderiv</strong><em> [</em><em>logical </em><em>,</em><em>in</em><em>]</em> :: derivatives required ?</p></li>
<li><p><strong>vrr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vtr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vpr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>cvrr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvrdtr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvrdpr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvtdpr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>dvpdpr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/nonlinear_bcs/v_center_sphere">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">nonlinear_bcs/</span></span><span class="sig-name descname"><span class="pre">v_center_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ddw</span></em>, <em class="sig-param"><span class="pre">vrr</span></em>, <em class="sig-param"><span class="pre">vtr</span></em>, <em class="sig-param"><span class="pre">vpr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/v_center_sphere" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This routine is only called for full sphere computations to construct
a vector field at the center of the the sphere. At the center, we have
wlm propto r^{l+1} and so vr = d2wlm/dr2 for l=1, 0 otherwise
vtheta, vphi = sht(1/l*ddwlm, 0) for l=1, 0 otherwise</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex </em><em>,</em><em>in</em><em>]</em></p></li>
<li><p><strong>vrr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vtr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
<li><p><strong>vpr</strong> (*,*)<em> [</em><em>real </em><em>,</em><em>out</em><em>]</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Non-linear part of the time stepping (radial loop)</a><ul>
<li><a class="reference internal" href="#radialloop-f90"><code class="docutils literal notranslate"><span class="pre">radialLoop.f90</span></code></a></li>
<li><a class="reference internal" href="#riteration-f90"><code class="docutils literal notranslate"><span class="pre">rIteration.f90</span></code></a></li>
<li><a class="reference internal" href="#riter-f90"><code class="docutils literal notranslate"><span class="pre">rIter.f90</span></code></a></li>
<li><a class="reference internal" href="#get-nl-f90"><code class="docutils literal notranslate"><span class="pre">get_nl.f90</span></code></a></li>
<li><a class="reference internal" href="#get-td-f90"><code class="docutils literal notranslate"><span class="pre">get_td.f90</span></code></a></li>
<li><a class="reference internal" href="#nonlinear-bcs-f90"><code class="docutils literal notranslate"><span class="pre">nonlinear_bcs.f90</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="timeAdvLinear.html"
                          title="previous chapter">Linear calculation part of the time stepping (LMLoop)</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="legFourierChebAlgebra.html"
                          title="next chapter">Radial scheme</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/timeAdvNonLinear.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="legFourierChebAlgebra.html" title="Radial scheme"
             >next</a> |</li>
        <li class="right" >
          <a href="timeAdvLinear.html" title="Linear calculation part of the time stepping (LMLoop)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Non-linear part of the time stepping (radial loop)</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>