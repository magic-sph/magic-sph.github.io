
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Non-linear part of the time stepping (radial loop) &#8212; Magic 5.6 documentation</title>
    <link rel="stylesheet" href="../_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chebyshev polynomials and cosine transforms" href="legFourierChebAlgebra.html" />
    <link rel="prev" title="Linear calculation part of the time stepping (LMLoop)" href="timeAdvLinear.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="legFourierChebAlgebra.html" title="Chebyshev polynomials and cosine transforms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="timeAdvLinear.html" title="Linear calculation part of the time stepping (LMLoop)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="non-linear-part-of-the-time-stepping-radial-loop">
<span id="secfortrannl"></span><h1>Non-linear part of the time stepping (radial loop)<a class="headerlink" href="#non-linear-part-of-the-time-stepping-radial-loop" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/radialloop">
<span id="radialloop-f90"></span><h2><code class="docutils literal"><span class="pre">radialLoop.f90</span></code><a class="headerlink" href="#f/radialloop" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/radialloop/finalize_radialloop" title="f/radialloop/finalize_radialloop"><code class="xref f f-func docutils literal"><span class="pre">finalize_radialloop()</span></code></a>, <a class="reference internal" href="#f/radialloop/initialize_radialloop" title="f/radialloop/initialize_radialloop"><code class="xref f f-func docutils literal"><span class="pre">initialize_radialloop()</span></code></a>, <a class="reference internal" href="#f/radialloop/radialloopg" title="f/radialloop/radialloopg"><code class="xref f f-func docutils literal"><span class="pre">radialloopg()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal"><span class="pre">memwrite()</span></code></a>, <a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</li>
<li><a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod" title="f/graphout_mod: This module contains the subroutines that store the 3-D graphic files."><code class="xref f f-mod docutils literal"><span class="pre">graphout_mod</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal"><span class="pre">graphout_mpi_header()</span></code></a>): This module contains the subroutines that store the 3-D graphic files.</li>
<li><a class="reference internal" href="#f/riterthetablocking_mod" title="f/riterthetablocking_mod"><code class="xref f f-mod docutils literal"><span class="pre">riterthetablocking_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">riterthetablocking_t()</span></code>)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag"><code class="xref f f-func docutils literal"><span class="pre">nrstopmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag"><code class="xref f f-func docutils literal"><span class="pre">nrstartmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal"><span class="pre">nrstop()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal"><span class="pre">nrstart()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a> (<a class="reference internal" href="parallelModules.html#f/parallel_mod/n_procs" title="f/parallel_mod/n_procs"><code class="xref f f-func docutils literal"><span class="pre">n_procs()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtb" title="f/logic/l_dtb"><code class="xref f f-func docutils literal"><span class="pre">l_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ma" title="f/logic/l_cond_ma"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal"><span class="pre">lverbose()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal"><span class="pre">l_mag()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="#f/riteration_mod" title="f/riteration_mod"><code class="xref f f-mod docutils literal"><span class="pre">riteration_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">riteration_t()</span></code>)</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal"><span class="pre">ktopv()</span></code></a>): Module containing the physical parameters</li>
<li><code class="xref f f-mod docutils literal"><span class="pre">riterthetablocking_seq_mod</span></code> (<code class="xref f f-func docutils literal"><span class="pre">riterthetablocking_seq_t()</span></code>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nthetabs" title="f/blocking/nthetabs"><code class="xref f f-func docutils literal"><span class="pre">nthetabs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal"><span class="pre">lmp_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag"><code class="xref f f-func docutils literal"><span class="pre">l_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/radialloop/initialize_radialloop">
<em class="property">subroutine  </em><code class="descclassname">radialloop/</code><code class="descname">initialize_radialloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/radialloop/initialize_radialloop" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="misc.html#f/mem_alloc/memwrite" title="f/mem_alloc/memwrite"><code class="xref f f-func docutils literal"><span class="pre">memwrite()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/radialloop/finalize_radialloop">
<em class="property">subroutine  </em><code class="descclassname">radialloop/</code><code class="descname">finalize_radialloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/radialloop/finalize_radialloop" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/radialloop/radialloopg">
<em class="property">subroutine  </em><code class="descclassname">radialloop/</code><code class="descname">radialloopg</code><span class="sig-paren">(</span><em>l_graph</em>, <em>l_cour</em>, <em>l_frame</em>, <em>time</em>, <em>dt</em>, <em>dtlast</em>, <em>ltocalc</em>, <em>ltonext</em>, <em>ltonext2</em>, <em>lhelcalc</em>, <em>lpowercalc</em>, <em>lrmscalc</em>, <em>lpresscalc</em>, <em>lviscbccalc</em>, <em>lfluxprofcalc</em>, <em>lperpparcalc</em>, <em>l_probe_out</em>, <em>dsdt</em>, <em>dwdt</em>, <em>dzdt</em>, <em>dpdt</em>, <em>dxidt</em>, <em>dbdt</em>, <em>djdt</em>, <em>dvxvhlm</em>, <em>dvxbhlm</em>, <em>dvsrlm</em>, <em>dvprlm</em>, <em>dvxirlm</em>, <em>lorentz_torque_ic</em>, <em>lorentz_torque_ma</em>, <em>br_vt_lm_cmb</em>, <em>br_vp_lm_cmb</em>, <em>br_vt_lm_icb</em>, <em>br_vp_lm_icb</em>, <em>hellmr</em>, <em>hel2lmr</em>, <em>helnalmr</em>, <em>helna2lmr</em>, <em>visclmr</em>, <em>uhlmr</em>, <em>duhlmr</em>, <em>gradslmr</em>, <em>fconvlmr</em>, <em>fkinlmr</em>, <em>fvisclmr</em>, <em>fpoynlmr</em>, <em>freslmr</em>, <em>eperplmr</em>, <em>eparlmr</em>, <em>eperpaxilmr</em>, <em>eparaxilmr</em>, <em>dtrkc</em>, <em>dthkc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/radialloop/radialloopg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This subroutine performs the actual time-stepping.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l_graph</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_cour</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_frame</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dtlast</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltocalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltonext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltonext2</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lhelcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lpowercalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lrmscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lpresscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lviscbccalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lfluxprofcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lperpparcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_probe_out</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dsdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dwdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dzdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dpdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dxidt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dbdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>djdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxvhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxbhlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvsrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvprlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxirlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>br_vt_lm_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vt at CMB</li>
<li><strong>br_vp_lm_cmb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vp at CMB</li>
<li><strong>br_vt_lm_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vt at ICB</li>
<li><strong>br_vp_lm_icb</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vp at ICB</li>
<li><strong>hellmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>hel2lmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>helnalmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>helna2lmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>visclmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>uhlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>duhlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>gradslmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fconvlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fkinlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fvisclmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fpoynlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag">l_maxmag</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>freslmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag">l_maxmag</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstopmag" title="f/radial_data/nrstopmag">nrstopmag</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstartmag" title="f/radial_data/nrstartmag">nrstartmag</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eperplmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eparlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eperpaxilmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eparaxilmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dtrkc</strong> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dthkc</strong> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal"><span class="pre">step_time()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi_header" title="f/graphout_mod/graphout_mpi_header"><code class="xref f f-func docutils literal"><span class="pre">graphout_mpi_header()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/riteration_mod">
<span id="riteration-f90"></span><h2><code class="docutils literal"><span class="pre">rIteration.f90</span></code><a class="headerlink" href="#f/riteration_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/riteration_mod/set_steering_variables" title="f/riteration_mod/set_steering_variables"><code class="xref f f-func docutils literal"><span class="pre">set_steering_variables()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/riteration_mod/unknown_type">
<em class="property">type  </em><code class="descclassname">riteration_mod/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/riteration_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">dthkc</code><em> [</em><em>real</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">dtrkc</code><em> [</em><em>real</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">isradialboundarypoint</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">l_cour</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">l_frame</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">l_graph</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">l_probe_out</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lderiv</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lfluxprofcalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lhelcalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lmagnlbc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lperpparcalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lpowercalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lpresscalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lrmscalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">ltocalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">ltonext</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">ltonext2</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lviscbccalc</code><em> [</em><em>logical</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">nbc</code><em> [</em><em>integer</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">nr</code><em> [</em><em>integer</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/riteration_mod/set_steering_variables">
<em class="property">subroutine  </em><code class="descclassname">riteration_mod/</code><code class="descname">set_steering_variables</code><span class="sig-paren">(</span><em>this</em>, <em>l_cour</em>, <em>ltocalc</em>, <em>ltonext</em>, <em>ltonext2</em>, <em>lderiv</em>, <em>lrmscalc</em>, <em>lhelcalc</em>, <em>lpowercalc</em>, <em>l_frame</em>, <em>lmagnlbc</em>, <em>l_graph</em>, <em>lviscbccalc</em>, <em>lfluxprofcalc</em>, <em>lperpparcalc</em>, <em>lpresscalc</em>, <em>l_probe_out</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riteration_mod/set_steering_variables" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>l_cour</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltocalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltonext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltonext2</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lrmscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lhelcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lpowercalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_frame</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmagnlbc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_graph</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lviscbccalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lfluxprofcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lperpparcalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lpresscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_probe_out</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/riterthetablocking_mod">
<span id="riterthetablocking-f90"></span><h2><code class="docutils literal"><span class="pre">rIterThetaBlocking.f90</span></code><a class="headerlink" href="#f/riterthetablocking_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/riterthetablocking_mod/allocate_common_arrays" title="f/riterthetablocking_mod/allocate_common_arrays"><code class="xref f f-func docutils literal"><span class="pre">allocate_common_arrays()</span></code></a>, <a class="reference internal" href="#f/riterthetablocking_mod/deallocate_common_arrays" title="f/riterthetablocking_mod/deallocate_common_arrays"><code class="xref f f-func docutils literal"><span class="pre">deallocate_common_arrays()</span></code></a>, <a class="reference internal" href="#f/riterthetablocking_mod/set_thetablocking" title="f/riterthetablocking_mod/set_thetablocking"><code class="xref f f-func docutils literal"><span class="pre">set_thetablocking()</span></code></a>, <a class="reference internal" href="#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_grid_space()</span></code></a>, <a class="reference internal" href="#f/riterthetablocking_mod/transform_to_lm_space" title="f/riterthetablocking_mod/transform_to_lm_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_lm_space()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</li>
<li><code class="xref f f-mod docutils literal"><span class="pre">grid_space_arrays_mod</span></code> (<code class="xref f f-func docutils literal"><span class="pre">grid_space_arrays_t()</span></code>)</li>
<li><a class="reference internal" href="#f/nonlinear_lm_mod" title="f/nonlinear_lm_mod"><code class="xref f f-mod docutils literal"><span class="pre">nonlinear_lm_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">nonlinear_lm_t()</span></code>)</li>
<li><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/ds_rloc" title="f/fields/ds_rloc"><code class="xref f f-func docutils literal"><span class="pre">ds_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/xi_rloc" title="f/fields/xi_rloc"><code class="xref f f-func docutils literal"><span class="pre">xi_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/s_rloc" title="f/fields/s_rloc"><code class="xref f f-func docutils literal"><span class="pre">s_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/p_rloc" title="f/fields/p_rloc"><code class="xref f f-func docutils literal"><span class="pre">p_rloc()</span></code></a>): This module contains the potential fields and their radial derivatives</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/fft" title="f/fft: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5"><code class="xref f f-mod docutils literal"><span class="pre">fft</span></code></a>: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid" title="f/legendre_spec_to_grid"><code class="xref f f-mod docutils literal"><span class="pre">legendre_spec_to_grid</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/leg_scal_to_spat" title="f/legendre_spec_to_grid/leg_scal_to_spat"><code class="xref f f-func docutils literal"><span class="pre">leg_scal_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/legtfgnomag" title="f/legendre_spec_to_grid/legtfgnomag"><code class="xref f f-func docutils literal"><span class="pre">legtfgnomag()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/legtfg" title="f/legendre_spec_to_grid/legtfg"><code class="xref f f-func docutils literal"><span class="pre">legtfg()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/leg_scal_to_grad_spat" title="f/legendre_spec_to_grid/leg_scal_to_grad_spat"><code class="xref f f-func docutils literal"><span class="pre">leg_scal_to_grad_spat()</span></code></a>)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal"><span class="pre">nrstop()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec" title="f/legendre_grid_to_spec"><code class="xref f f-mod docutils literal"><span class="pre">legendre_grid_to_spec</span></code></a></li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ma" title="f/logic/l_cond_ma"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_icb" title="f/logic/l_b_nl_icb"><code class="xref f f-func docutils literal"><span class="pre">l_b_nl_icb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anel" title="f/logic/l_anel"><code class="xref f f-func docutils literal"><span class="pre">l_anel()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_precession" title="f/logic/l_precession"><code class="xref f f-func docutils literal"><span class="pre">l_precession()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_store_frame" title="f/logic/l_store_frame"><code class="xref f f-func docutils literal"><span class="pre">l_store_frame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_centrifuge" title="f/logic/l_centrifuge"><code class="xref f f-func docutils literal"><span class="pre">l_centrifuge()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_ht" title="f/logic/l_ht"><code class="xref f f-func docutils literal"><span class="pre">l_ht()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtb" title="f/logic/l_dtb"><code class="xref f f-func docutils literal"><span class="pre">l_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_cmb" title="f/logic/l_b_nl_cmb"><code class="xref f f-func docutils literal"><span class="pre">l_b_nl_cmb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_tp_form" title="f/logic/l_tp_form"><code class="xref f f-func docutils literal"><span class="pre">l_tp_form()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="#f/riteration_mod" title="f/riteration_mod"><code class="xref f f-mod docutils literal"><span class="pre">riteration_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">riteration_t()</span></code>)</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/kbots" title="f/physical_parameters/kbots"><code class="xref f f-func docutils literal"><span class="pre">kbots()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktops" title="f/physical_parameters/ktops"><code class="xref f f-func docutils literal"><span class="pre">ktops()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/leg_helper_mod" title="f/leg_helper_mod"><code class="xref f f-mod docutils literal"><span class="pre">leg_helper_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">leg_helper_t()</span></code>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="#f/nonlinear_bcs" title="f/nonlinear_bcs"><code class="xref f f-mod docutils literal"><span class="pre">nonlinear_bcs</span></code></a> (<a class="reference internal" href="#f/nonlinear_bcs/v_rigid_boundary" title="f/nonlinear_bcs/v_rigid_boundary"><code class="xref f f-func docutils literal"><span class="pre">v_rigid_boundary()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxstr" title="f/truncation/n_r_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max_dtb" title="f/truncation/lmp_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">lmp_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal"><span class="pre">lmp_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal"><span class="pre">l_axi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_theta_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_phi_maxstr()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/riterthetablocking_mod/unknown_type">
<em class="property">type  </em><code class="descclassname">riterthetablocking_mod/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/riterthetablocking_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">bplast</code> (,,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">bslast</code> (,,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">bzlast</code> (,,*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">leg_helper</code><em> [</em><em>leg_helper_t</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">nthetabs</code><em> [</em><em>integer</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">sizethetab</code><em> [</em><em>integer</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/riterthetablocking_mod/allocate_common_arrays">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_mod/</code><code class="descname">allocate_common_arrays</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_mod/allocate_common_arrays" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_mod/deallocate_common_arrays">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_mod/</code><code class="descname">deallocate_common_arrays</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_mod/deallocate_common_arrays" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_mod/set_thetablocking">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_mod/</code><code class="descname">set_thetablocking</code><span class="sig-paren">(</span><em>this</em>, <em>nthetabs</em>, <em>sizethetab</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_mod/set_thetablocking" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nthetabs</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sizethetab</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_mod/transform_to_grid_space">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_mod/</code><code class="descname">transform_to_grid_space</code><span class="sig-paren">(</span><em>this</em>, <em>nthetastart</em>, <em>nthetastop</em>, <em>gsa</em>, <em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_mod/transform_to_grid_space" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>gsa</strong><em> [</em><em>grid_space_arrays_t</em><em>]</em></li>
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/legtfg" title="f/legendre_spec_to_grid/legtfg"><code class="xref f f-func docutils literal"><span class="pre">legtfg()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/legtfgnomag" title="f/legendre_spec_to_grid/legtfgnomag"><code class="xref f f-func docutils literal"><span class="pre">legtfgnomag()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/leg_scal_to_spat" title="f/legendre_spec_to_grid/leg_scal_to_spat"><code class="xref f f-func docutils literal"><span class="pre">leg_scal_to_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_spec_to_grid/leg_scal_to_grad_spat" title="f/legendre_spec_to_grid/leg_scal_to_grad_spat"><code class="xref f f-func docutils literal"><span class="pre">leg_scal_to_grad_spat()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/v_rigid_boundary" title="f/nonlinear_bcs/v_rigid_boundary"><code class="xref f f-func docutils literal"><span class="pre">v_rigid_boundary()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_mod/transform_to_lm_space">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_mod/</code><code class="descname">transform_to_lm_space</code><span class="sig-paren">(</span><em>this</em>, <em>nthetastart</em>, <em>nthetastop</em>, <em>gsa</em>, <em>nl_lm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_mod/transform_to_lm_space" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>gsa</strong><em> [</em><em>grid_space_arrays_t</em><em>]</em></li>
<li><strong>nl_lm</strong><em> [</em><em>nonlinear_lm_t</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf3" title="f/legendre_grid_to_spec/legtf3"><code class="xref f f-func docutils literal"><span class="pre">legtf3()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal"><span class="pre">legtf2()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf1" title="f/legendre_grid_to_spec/legtf1"><code class="xref f f-func docutils literal"><span class="pre">legtf1()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf_spher_tor" title="f/legendre_grid_to_spec/legtf_spher_tor"><code class="xref f f-func docutils literal"><span class="pre">legtf_spher_tor()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/riterthetablocking_openmp_mod">
<span id="riterthetablocking-openmp-f90"></span><h2><code class="docutils literal"><span class="pre">rIterThetaBlocking_OpenMP.f90</span></code><a class="headerlink" href="#f/riterthetablocking_openmp_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <a class="reference internal" href="#f/riterthetablocking_openmp_mod/finalize_riterthetablocking_openmp" title="f/riterthetablocking_openmp_mod/finalize_riterthetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">finalize_riterthetablocking_openmp()</span></code></a>, <a class="reference internal" href="#f/riterthetablocking_openmp_mod/initialize_riterthetablocking_openmp" title="f/riterthetablocking_openmp_mod/initialize_riterthetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">initialize_riterthetablocking_openmp()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="IOAdd.html#f/probe_mod" title="f/probe_mod"><code class="xref f f-mod docutils literal"><span class="pre">probe_mod</span></code></a></li>
<li><a class="reference internal" href="#f/nonlinear_lm_mod" title="f/nonlinear_lm_mod"><code class="xref f f-mod docutils literal"><span class="pre">nonlinear_lm_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">nonlinear_lm_t()</span></code>)</li>
<li><code class="xref f f-mod docutils literal"><span class="pre">grid_space_arrays_mod</span></code> (<code class="xref f f-func docutils literal"><span class="pre">grid_space_arrays_t()</span></code>)</li>
<li><a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod" title="f/graphout_mod: This module contains the subroutines that store the 3-D graphic files."><code class="xref f f-mod docutils literal"><span class="pre">graphout_mod</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal"><span class="pre">graphout_mpi()</span></code></a>): This module contains the subroutines that store the 3-D graphic files.</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="IOAdd.html#f/nl_special_calc" title="f/nl_special_calc: This module allows to calculcate several diagnostics that need to be computed in the physical space (non-linear quantities)"><code class="xref f f-mod docutils literal"><span class="pre">nl_special_calc</span></code></a>: This module allows to calculcate several diagnostics that need to be computed in the physical space (non-linear quantities)</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxstr" title="f/truncation/n_r_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max_dtb" title="f/truncation/lmp_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">lmp_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal"><span class="pre">lmp_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_theta_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_phi_maxstr()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/leg_helper_mod" title="f/leg_helper_mod"><code class="xref f f-mod docutils literal"><span class="pre">leg_helper_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">leg_helper_t()</span></code>)</li>
<li><a class="reference internal" href="IOAdd.html#f/dtb_arrays_mod" title="f/dtb_arrays_mod"><code class="xref f f-mod docutils literal"><span class="pre">dtb_arrays_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">dtb_arrays_t()</span></code>)</li>
<li><a class="reference internal" href="IOAdd.html#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="IOAdd.html#f/torsional_oscillations/gettonext" title="f/torsional_oscillations/gettonext"><code class="xref f f-func docutils literal"><span class="pre">gettonext()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/gettofinish" title="f/torsional_oscillations/gettofinish"><code class="xref f f-func docutils literal"><span class="pre">gettofinish()</span></code></a>): This module contains information for TO calculation and output</li>
<li><a class="reference internal" href="IOAdd.html#f/to_arrays_mod" title="f/to_arrays_mod"><code class="xref f f-mod docutils literal"><span class="pre">to_arrays_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">to_arrays_t()</span></code>)</li>
<li><a class="reference internal" href="timeAdvance.html#f/courant_mod" title="f/courant_mod"><code class="xref f f-mod docutils literal"><span class="pre">courant_mod</span></code></a> (<a class="reference internal" href="timeAdvance.html#f/courant_mod/courant" title="f/courant_mod/courant"><code class="xref f f-func docutils literal"><span class="pre">courant()</span></code></a>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="#f/nonlinear_bcs" title="f/nonlinear_bcs"><code class="xref f f-mod docutils literal"><span class="pre">nonlinear_bcs</span></code></a> (<a class="reference internal" href="#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal"><span class="pre">get_br_v_bcs()</span></code></a>)</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="IOGeneral.html#f/outrot" title="f/outrot"><code class="xref f f-mod docutils literal"><span class="pre">outrot</span></code></a> (<a class="reference internal" href="IOGeneral.html#f/outrot/get_lorentz_torque" title="f/outrot/get_lorentz_torque"><code class="xref f f-func docutils literal"><span class="pre">get_lorentz_torque()</span></code></a>)</li>
<li><a class="reference internal" href="#f/riterthetablocking_mod" title="f/riterthetablocking_mod"><code class="xref f f-mod docutils literal"><span class="pre">riterthetablocking_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">riterthetablocking_t()</span></code>)</li>
<li><a class="reference internal" href="IOBinaryOutputs.html#f/out_movie" title="f/out_movie"><code class="xref f f-mod docutils literal"><span class="pre">out_movie</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal"><span class="pre">store_movie_frame()</span></code></a>)</li>
<li><a class="reference internal" href="IOAdd.html#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dh_dtblm" title="f/dtb_mod/get_dh_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dh_dtblm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dtblm()</span></code></a>): This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output….</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_to" title="f/logic/l_to"><code class="xref f f-func docutils literal"><span class="pre">l_to()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ma" title="f/logic/l_cond_ma"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_icb" title="f/logic/l_b_nl_icb"><code class="xref f f-func docutils literal"><span class="pre">l_b_nl_icb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ic" title="f/logic/l_rot_ic"><code class="xref f f-func docutils literal"><span class="pre">l_rot_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anel" title="f/logic/l_anel"><code class="xref f f-func docutils literal"><span class="pre">l_anel()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_probe" title="f/logic/l_probe"><code class="xref f f-func docutils literal"><span class="pre">l_probe()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_movie_oc" title="f/logic/l_movie_oc"><code class="xref f f-func docutils literal"><span class="pre">l_movie_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_store_frame" title="f/logic/l_store_frame"><code class="xref f f-func docutils literal"><span class="pre">l_store_frame()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rot_ma" title="f/logic/l_rot_ma"><code class="xref f f-func docutils literal"><span class="pre">l_rot_ma()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_ht" title="f/logic/l_ht"><code class="xref f f-func docutils literal"><span class="pre">l_ht()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtb" title="f/logic/l_dtb"><code class="xref f f-func docutils literal"><span class="pre">l_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_b_nl_cmb" title="f/logic/l_b_nl_cmb"><code class="xref f f-func docutils literal"><span class="pre">l_b_nl_cmb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_tp_form" title="f/logic/l_tp_form"><code class="xref f f-func docutils literal"><span class="pre">l_tp_form()</span></code></a>): Module containing the logicals that control the run</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/riterthetablocking_openmp_mod/unknown_type">
<em class="property">type  </em><code class="descclassname">riterthetablocking_openmp_mod/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/riterthetablocking_openmp_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">dtb_arrays</code> (*)<em> [</em><em>dtb_arrays_t</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">gsa</code> (*)<em> [</em><em>grid_space_arrays_t</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lorentz_torque_ic</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lorentz_torque_ma</code> (*)<em> [</em><em>real</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">nl_lm</code> (*)<em> [</em><em>nonlinear_lm_t</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">nthreads</code><em> [</em><em>integer</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">to_arrays</code> (*)<em> [</em><em>to_arrays_t</em><em>,</em><em>allocatable</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="function">
<dt id="f/riterthetablocking_openmp_mod/getthistype">
<em class="property">function  </em><code class="descclassname">riterthetablocking_openmp_mod/</code><code class="descname">getthistype</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_openmp_mod/getthistype" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><strong>getthistype</strong><em> [</em><em>character</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_openmp_mod/initialize_riterthetablocking_openmp">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_openmp_mod/</code><code class="descname">initialize_riterthetablocking_openmp</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_openmp_mod/initialize_riterthetablocking_openmp" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_openmp_mod/finalize_riterthetablocking_openmp">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_openmp_mod/</code><code class="descname">finalize_riterthetablocking_openmp</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_openmp_mod/finalize_riterthetablocking_openmp" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp">
<em class="property">subroutine  </em><code class="descclassname">riterthetablocking_openmp_mod/</code><code class="descname">do_iteration_thetablocking_openmp</code><span class="sig-paren">(</span><em>this</em>, <em>nr</em>, <em>nbc</em>, <em>time</em>, <em>dt</em>, <em>dtlast</em>, <em>dsdt</em>, <em>dwdt</em>, <em>dzdt</em>, <em>dpdt</em>, <em>dxidt</em>, <em>dbdt</em>, <em>djdt</em>, <em>dvxvhlm</em>, <em>dvxbhlm</em>, <em>dvsrlm</em>, <em>dvprlm</em>, <em>dvxirlm</em>, <em>br_vt_lm_cmb</em>, <em>br_vp_lm_cmb</em>, <em>br_vt_lm_icb</em>, <em>br_vp_lm_icb</em>, <em>lorentz_torque_ic</em>, <em>lorentz_torque_ma</em>, <em>hellmr</em>, <em>hel2lmr</em>, <em>helnalmr</em>, <em>helna2lmr</em>, <em>visclmr</em>, <em>uhlmr</em>, <em>duhlmr</em>, <em>gradslmr</em>, <em>fconvlmr</em>, <em>fkinlmr</em>, <em>fvisclmr</em>, <em>fpoynlmr</em>, <em>freslmr</em>, <em>eperplmr</em>, <em>eparlmr</em>, <em>eperpaxilmr</em>, <em>eparaxilmr</em><span class="sig-paren">)</span><a class="headerlink" href="#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nbc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dtlast</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dsdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dwdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dzdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dpdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dxidt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dbdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>djdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxvhlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxbhlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvsrlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvprlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxirlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>br_vt_lm_cmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vt at CMB</li>
<li><strong>br_vp_lm_cmb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vp at CMB</li>
<li><strong>br_vt_lm_icb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vt at ICB</li>
<li><strong>br_vp_lm_icb</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: product br*vp at ICB</li>
<li><strong>lorentz_torque_ic</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>lorentz_torque_ma</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>hellmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>hel2lmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>helnalmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>helna2lmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>visclmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>uhlmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>duhlmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>gradslmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fconvlmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fkinlmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fvisclmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fpoynlmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>freslmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eperplmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eparlmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eperpaxilmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eparaxilmr</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="IOGeneral.html#f/outrot/get_lorentz_torque" title="f/outrot/get_lorentz_torque"><code class="xref f f-func docutils literal"><span class="pre">get_lorentz_torque()</span></code></a>, <a class="reference internal" href="timeAdvance.html#f/courant_mod/courant" title="f/courant_mod/courant"><code class="xref f f-func docutils literal"><span class="pre">courant()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/graphout_mod/graphout_mpi" title="f/graphout_mod/graphout_mpi"><code class="xref f f-func docutils literal"><span class="pre">graphout_mpi()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/probe_mod/probe_out" title="f/probe_mod/probe_out"><code class="xref f f-func docutils literal"><span class="pre">probe_out()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_helicity" title="f/nl_special_calc/get_helicity"><code class="xref f f-func docutils literal"><span class="pre">get_helicity()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_visc_heat" title="f/nl_special_calc/get_visc_heat"><code class="xref f f-func docutils literal"><span class="pre">get_visc_heat()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_nlblayers" title="f/nl_special_calc/get_nlblayers"><code class="xref f f-func docutils literal"><span class="pre">get_nlblayers()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_fluxes" title="f/nl_special_calc/get_fluxes"><code class="xref f f-func docutils literal"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/nl_special_calc/get_perppar" title="f/nl_special_calc/get_perppar"><code class="xref f f-func docutils literal"><span class="pre">get_perppar()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/store_movie_frame" title="f/out_movie/store_movie_frame"><code class="xref f f-func docutils literal"><span class="pre">store_movie_frame()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/gettonext" title="f/torsional_oscillations/gettonext"><code class="xref f f-func docutils literal"><span class="pre">gettonext()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/torsional_oscillations/gettofinish" title="f/torsional_oscillations/gettofinish"><code class="xref f f-func docutils literal"><span class="pre">gettofinish()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/dtb_mod/get_dh_dtblm" title="f/dtb_mod/get_dh_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dh_dtblm()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/general_arrays_mod">
<span id="get-nl-f90"></span><h2><code class="docutils literal"><span class="pre">get_nl.f90</span></code><a class="headerlink" href="#f/general_arrays_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/general_arrays_mod/unknown_type">
<em class="property">type  </em><code class="descclassname">general_arrays_mod/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/general_arrays_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div>
<div class="section" id="f/nonlinear_lm_mod">
<span id="get-td-f90"></span><h2><code class="docutils literal"><span class="pre">get_td.f90</span></code><a class="headerlink" href="#f/nonlinear_lm_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/nonlinear_lm_mod/get_td" title="f/nonlinear_lm_mod/get_td"><code class="xref f f-func docutils literal"><span class="pre">get_td()</span></code></a>, <a class="reference internal" href="#f/nonlinear_lm_mod/set_zero" title="f/nonlinear_lm_mod/set_zero"><code class="xref f f-func docutils literal"><span class="pre">set_zero()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta3a" title="f/horizontal_data/dtheta3a"><code class="xref f f-func docutils literal"><span class="pre">dtheta3a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_b" title="f/horizontal_data/hdif_b"><code class="xref f f-func docutils literal"><span class="pre">hdif_b()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi0" title="f/horizontal_data/dphi0"><code class="xref f f-func docutils literal"><span class="pre">dphi0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta4a" title="f/horizontal_data/dtheta4a"><code class="xref f f-func docutils literal"><span class="pre">dtheta4a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1a" title="f/horizontal_data/dtheta1a"><code class="xref f f-func docutils literal"><span class="pre">dtheta1a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta2a" title="f/horizontal_data/dtheta2a"><code class="xref f f-func docutils literal"><span class="pre">dtheta2a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta3s" title="f/horizontal_data/dtheta3s"><code class="xref f f-func docutils literal"><span class="pre">dtheta3s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal"><span class="pre">hdif_v()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta4s" title="f/horizontal_data/dtheta4s"><code class="xref f f-func docutils literal"><span class="pre">dtheta4s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1s" title="f/horizontal_data/dtheta1s"><code class="xref f f-func docutils literal"><span class="pre">dtheta1s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta2s" title="f/horizontal_data/dtheta2s"><code class="xref f f-func docutils literal"><span class="pre">dtheta2s()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="misc.html#f/mem_alloc" title="f/mem_alloc: This little module is used to estimate the global memory allocation used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">mem_alloc</span></code></a> (<a class="reference internal" href="misc.html#f/mem_alloc/bytes_allocated" title="f/mem_alloc/bytes_allocated"><code class="xref f f-func docutils literal"><span class="pre">bytes_allocated()</span></code></a>): This little module is used to estimate the global memory allocation used in MagIC</li>
<li><a class="reference internal" href="IOAdd.html#f/rms" title="f/rms: This module contains the calculation of thr RMS force balance and induction terms."><code class="xref f f-mod docutils literal"><span class="pre">rms</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms/lf2hint" title="f/rms/lf2hint"><code class="xref f f-func docutils literal"><span class="pre">lf2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/pre2hint" title="f/rms/pre2hint"><code class="xref f f-func docutils literal"><span class="pre">pre2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/clf2hint" title="f/rms/clf2hint"><code class="xref f f-func docutils literal"><span class="pre">clf2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/geo2hint" title="f/rms/geo2hint"><code class="xref f f-func docutils literal"><span class="pre">geo2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/arcmag2hint" title="f/rms/arcmag2hint"><code class="xref f f-func docutils literal"><span class="pre">arcmag2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/arc2hint" title="f/rms/arc2hint"><code class="xref f f-func docutils literal"><span class="pre">arc2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/cia2hint" title="f/rms/cia2hint"><code class="xref f f-func docutils literal"><span class="pre">cia2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/cor2hint" title="f/rms/cor2hint"><code class="xref f f-func docutils literal"><span class="pre">cor2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/adv2hint" title="f/rms/adv2hint"><code class="xref f f-func docutils literal"><span class="pre">adv2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/mag2hint" title="f/rms/mag2hint"><code class="xref f f-func docutils literal"><span class="pre">mag2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/buo2hint" title="f/rms/buo2hint"><code class="xref f f-func docutils literal"><span class="pre">buo2hint()</span></code></a>, <a class="reference internal" href="IOAdd.html#f/rms/plf2hint" title="f/rms/plf2hint"><code class="xref f f-func docutils literal"><span class="pre">plf2hint()</span></code></a>): This module contains the calculation of thr RMS force balance and induction terms.</li>
<li><a class="reference internal" href="baseModules.html#f/fields" title="f/fields: This module contains the potential fields and their radial derivatives"><code class="xref f f-mod docutils literal"><span class="pre">fields</span></code></a> (<a class="reference internal" href="baseModules.html#f/fields/z_rloc" title="f/fields/z_rloc"><code class="xref f f-func docutils literal"><span class="pre">z_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/s_rloc" title="f/fields/s_rloc"><code class="xref f f-func docutils literal"><span class="pre">s_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/ddw_rloc" title="f/fields/ddw_rloc"><code class="xref f f-func docutils literal"><span class="pre">ddw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dw_rloc" title="f/fields/dw_rloc"><code class="xref f f-func docutils literal"><span class="pre">dw_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/w_rloc" title="f/fields/w_rloc"><code class="xref f f-func docutils literal"><span class="pre">w_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/p_rloc" title="f/fields/p_rloc"><code class="xref f f-func docutils literal"><span class="pre">p_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dp_rloc" title="f/fields/dp_rloc"><code class="xref f f-func docutils literal"><span class="pre">dp_rloc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/fields/dz_rloc" title="f/fields/dz_rloc"><code class="xref f f-func docutils literal"><span class="pre">dz_rloc()</span></code></a>): This module contains the potential fields and their radial derivatives</li>
<li><a class="reference internal" href="IOAdd.html#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="IOAdd.html#f/rms_helpers/hintrms" title="f/rms_helpers/hintrms"><code class="xref f f-func docutils literal"><span class="pre">hintrms()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_anelastic_liquid" title="f/logic/l_anelastic_liquid"><code class="xref f f-func docutils literal"><span class="pre">l_anelastic_liquid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal"><span class="pre">l_mag_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_double_curl" title="f/logic/l_double_curl"><code class="xref f f-func docutils literal"><span class="pre">l_double_curl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_chemical_conv" title="f/logic/l_chemical_conv"><code class="xref f f-func docutils literal"><span class="pre">l_chemical_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_kin" title="f/logic/l_mag_kin"><code class="xref f f-func docutils literal"><span class="pre">l_mag_kin()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_single_matrix" title="f/logic/l_single_matrix"><code class="xref f f-func docutils literal"><span class="pre">l_single_matrix()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anel" title="f/logic/l_anel"><code class="xref f f-func docutils literal"><span class="pre">l_anel()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_tp_form" title="f/logic/l_tp_form"><code class="xref f f-func docutils literal"><span class="pre">l_tp_form()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_rms" title="f/logic/l_rms"><code class="xref f f-func docutils literal"><span class="pre">l_rms()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal"><span class="pre">l_conv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_corr" title="f/logic/l_corr"><code class="xref f f-func docutils literal"><span class="pre">l_corr()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/buofac" title="f/physical_parameters/buofac"><code class="xref f f-func docutils literal"><span class="pre">buofac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/epscxi" title="f/physical_parameters/epscxi"><code class="xref f f-func docutils literal"><span class="pre">epscxi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/epsc" title="f/physical_parameters/epsc"><code class="xref f f-func docutils literal"><span class="pre">epsc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal"><span class="pre">vischeatfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/n_r_lcr" title="f/physical_parameters/n_r_lcr"><code class="xref f f-func docutils literal"><span class="pre">n_r_lcr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/thexpnb" title="f/physical_parameters/thexpnb"><code class="xref f f-func docutils literal"><span class="pre">thexpnb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal"><span class="pre">corfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ohmlossfac" title="f/physical_parameters/ohmlossfac"><code class="xref f f-func docutils literal"><span class="pre">ohmlossfac()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal"><span class="pre">lmp_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal"><span class="pre">lm_maxmag()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lmp2lmps" title="f/blocking/lmp2lmps"><code class="xref f f-func docutils literal"><span class="pre">lmp2lmps()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lms" title="f/blocking/lm2lms"><code class="xref f f-func docutils literal"><span class="pre">lm2lms()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lmp" title="f/blocking/lm2lmp"><code class="xref f f-func docutils literal"><span class="pre">lm2lmp()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lmp2lmpa" title="f/blocking/lmp2lmpa"><code class="xref f f-func docutils literal"><span class="pre">lmp2lmpa()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal"><span class="pre">st_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lma" title="f/blocking/lm2lma"><code class="xref f f-func docutils literal"><span class="pre">lm2lma()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/alpha0" title="f/radial_functions/alpha0"><code class="xref f f-func docutils literal"><span class="pre">alpha0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/epscprof" title="f/radial_functions/epscprof"><code class="xref f f-func docutils literal"><span class="pre">epscprof()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal"><span class="pre">rho0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal"><span class="pre">temp0()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ogrun" title="f/radial_functions/ogrun"><code class="xref f f-func docutils literal"><span class="pre">ogrun()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
</ul>
<p class="rubric">Types</p>
<ul>
<li><dl class="type">
<dt id="f/nonlinear_lm_mod/unknown_type">
<em class="property">type  </em><code class="descclassname">nonlinear_lm_mod/</code><code class="descname">unknown_type</code><a class="headerlink" href="#f/nonlinear_lm_mod/unknown_type" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">advp2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">advplm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">advrlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">advt2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">advtlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">cfp2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">cft2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lfp2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lfplm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lfrlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lft2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">lftlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">ohmlosslm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">pfp2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">pft2lm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vischeatlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vprlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vsplm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vsrlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vstlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vxbplm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vxbrlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vxbtlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vxiplm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vxirlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
<li><code class="descname">% </code><code class="descname">vxitlm</code> (*)<em> [</em><em>complex</em><em>,</em><em>allocatable</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/nonlinear_lm_mod/initialize">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_lm_mod/</code><code class="descname">initialize</code><span class="sig-paren">(</span><em>this</em>, <em>lmp_max</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_lm_mod/initialize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>lmp_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nonlinear_lm_mod/finalize">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_lm_mod/</code><code class="descname">finalize</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_lm_mod/finalize" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nonlinear_lm_mod/set_zero">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_lm_mod/</code><code class="descname">set_zero</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_lm_mod/set_zero" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nonlinear_lm_mod/output">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_lm_mod/</code><code class="descname">output</code><span class="sig-paren">(</span><em>this</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_lm_mod/output" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>this</strong><em> [</em><em>real</em><em>]</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nonlinear_lm_mod/get_td">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_lm_mod/</code><code class="descname">get_td</code><span class="sig-paren">(</span><em>this</em>, <em>nr</em>, <em>nbc</em>, <em>lrmscalc</em>, <em>lpresscalc</em>, <em>dvsrlm</em>, <em>dvprlm</em>, <em>dvxirlm</em>, <em>dvxvhlm</em>, <em>dvxbhlm</em>, <em>dwdt</em>, <em>dzdt</em>, <em>dpdt</em>, <em>dsdt</em>, <em>dxidt</em>, <em>dbdt</em>, <em>djdt</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_lm_mod/get_td" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this to calculate time derivatives</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dwdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: +CorPol_loc
and auxiliary arrays dVSrLM, dVXirLM and dVxBhLM, dVxVhLM
from non-linear terms in spectral form,
contained in flmw1-3,flms1-3, flmb1-3 (input)</li>
<li><strong>this</strong><em> [</em><em>real</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nbc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: signifies boundary conditions</li>
<li><strong>lrmscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lpresscalc</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvsrlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvprlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxirlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxvhlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvxbhlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dzdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dpdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dsdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dxidt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dbdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>djdt</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="IOAdd.html#f/rms_helpers/hintrms" title="f/rms_helpers/hintrms"><code class="xref f f-func docutils literal"><span class="pre">hintrms()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/nonlinear_bcs">
<span id="nonlinear-bcs-f90"></span><h2><code class="docutils literal"><span class="pre">nonlinear_bcs.f90</span></code><a class="headerlink" href="#f/nonlinear_bcs" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/nonlinear_bcs/get_b_nl_bcs" title="f/nonlinear_bcs/get_b_nl_bcs"><code class="xref f f-func docutils literal"><span class="pre">get_b_nl_bcs()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/get_br_v_bcs" title="f/nonlinear_bcs/get_br_v_bcs"><code class="xref f f-func docutils literal"><span class="pre">get_br_v_bcs()</span></code></a>, <a class="reference internal" href="#f/nonlinear_bcs/v_rigid_boundary" title="f/nonlinear_bcs/v_rigid_boundary"><code class="xref f f-func docutils literal"><span class="pre">v_rigid_boundary()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1a" title="f/horizontal_data/dtheta1a"><code class="xref f f-func docutils literal"><span class="pre">dtheta1a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sn2" title="f/horizontal_data/sn2"><code class="xref f f-func docutils literal"><span class="pre">sn2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta" title="f/horizontal_data/o_sin_theta"><code class="xref f f-func docutils literal"><span class="pre">o_sin_theta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1s" title="f/horizontal_data/dtheta1s"><code class="xref f f-func docutils literal"><span class="pre">dtheta1s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal"><span class="pre">costheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec" title="f/legendre_grid_to_spec"><code class="xref f f-mod docutils literal"><span class="pre">legendre_grid_to_spec</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal"><span class="pre">legtf2()</span></code></a>)</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal"><span class="pre">abortrun()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/fft" title="f/fft: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5"><code class="xref f f-mod docutils literal"><span class="pre">fft</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>): This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data: This module defines the MPI decomposition in the radial direction."><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>): This module defines the MPI decomposition in the radial direction.</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_diff_prec" title="f/logic/l_diff_prec"><code class="xref f f-func docutils literal"><span class="pre">l_diff_prec()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/po_diff" title="f/physical_parameters/po_diff"><code class="xref f f-func docutils literal"><span class="pre">po_diff()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/diff_prec_angle" title="f/physical_parameters/diff_prec_angle"><code class="xref f f-func docutils literal"><span class="pre">diff_prec_angle()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/sigma_ratio" title="f/physical_parameters/sigma_ratio"><code class="xref f f-func docutils literal"><span class="pre">sigma_ratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/oek" title="f/physical_parameters/oek"><code class="xref f f-func docutils literal"><span class="pre">oek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/conductance_ma" title="f/physical_parameters/conductance_ma"><code class="xref f f-func docutils literal"><span class="pre">conductance_ma()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_axi" title="f/truncation/l_axi"><code class="xref f f-func docutils literal"><span class="pre">l_axi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max"><code class="xref f f-func docutils literal"><span class="pre">lmp_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lmp2lmps" title="f/blocking/lmp2lmps"><code class="xref f f-func docutils literal"><span class="pre">lmp2lmps()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lmp" title="f/blocking/lm2lmp"><code class="xref f f-func docutils literal"><span class="pre">lm2lmp()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lmp2lmpa" title="f/blocking/lmp2lmpa"><code class="xref f f-func docutils literal"><span class="pre">lmp2lmpa()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions: This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rho0" title="f/radial_functions/rho0"><code class="xref f f-func docutils literal"><span class="pre">rho0()</span></code></a>): This module initiates all the radial functions (transport properties, density, temperature, cheb transforms, etc.)</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/nonlinear_bcs/get_br_v_bcs">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_bcs/</code><code class="descname">get_br_v_bcs</code><span class="sig-paren">(</span><em>br</em>, <em>vt</em>, <em>vp</em>, <em>omega</em>, <em>o_r_e_2</em>, <em>o_rho</em>, <em>n_theta_min</em>, <em>n_theta_block</em>, <em>br_vt_lm</em>, <em>br_vp_lm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/get_br_v_bcs" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the nonlinear term
of the magnetic boundary condition for a conducting mantle or
inner core in space (r,lm).
Calculation is performed for the theta block:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_theta_min</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: <p>absolute number of theta</p>
<p>On input br, vt and vp are given on all phi points and
thetas in the specific block.
On output the contribution of these grid points to all
degree and orders is stored in br_vt_lm and br_vp_lm.
Output is [r/sin(theta)*Br*U]=[(0,br_vt_lm,br_vp_lm)]</p>
</li>
<li><strong>br</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: r**2 * B_r</li>
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: r*sin(theta) U_theta</li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: r*sin(theta) U_phi</li>
<li><strong>omega</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: rotation rate of mantle or IC</li>
<li><strong>o_r_e_2</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: 1/r**2</li>
<li><strong>o_rho</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: 1/rho0 (anelastic)</li>
<li><strong>n_theta_block</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: size of theta_block</li>
<li><strong>br_vt_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>br_vp_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_shtns()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft/fft_thetab" title="f/fft/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal"><span class="pre">legtf2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nonlinear_bcs/get_b_nl_bcs">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_bcs/</code><code class="descname">get_b_nl_bcs</code><span class="sig-paren">(</span><em>bc</em>, <em>br_vt_lm</em>, <em>br_vp_lm</em>, <em>lm_min_b</em>, <em>lm_max_b</em>, <em>b_nl_bc</em>, <em>aj_nl_bc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/get_b_nl_bcs" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Purpose of this subroutine is to calculate the nonlinear term
of the magnetic boundary condition for a conducting mantle in
physical space (phi,theta), assuming that the conductance
of the mantle is much smaller than that of the core.
Calculation is performed for the theta block:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="n">n_theta_min</span><span class="o">&lt;=</span><span class="n">n_theta</span><span class="o">&lt;=</span><span class="n">n_theta_min</span><span class="o">+</span><span class="n">n_theta_block</span><span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bc</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em> :: Distinguishes ‘CMB’ and ‘ICB’</li>
<li><strong>br_vt_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: [br*vt/(r**2*sin(theta)**2)]</li>
<li><strong>br_vp_lm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lmp_max" title="f/truncation/lmp_max">lmp_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: [br*vp/(r**2*sin(theta)**2)</li>
<li><strong>lm_min_b</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lm_max_b</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: limits of lm-block</li>
<li><strong>b_nl_bc</strong> (lm_max_b-lm_min_b+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: nonlinear bc for b</li>
<li><strong>aj_nl_bc</strong> (lm_max_b-lm_min_b+1)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em> :: nonlinear bc for aj</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvance.html#f/step_time_mod/step_time" title="f/step_time_mod/step_time"><code class="xref f f-func docutils literal"><span class="pre">step_time()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/abortrun" title="f/useful/abortrun"><code class="xref f f-func docutils literal"><span class="pre">abortrun()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nonlinear_bcs/v_rigid_boundary">
<em class="property">subroutine  </em><code class="descclassname">nonlinear_bcs/</code><code class="descname">v_rigid_boundary</code><span class="sig-paren">(</span><em>nr</em>, <em>omega</em>, <em>lderiv</em>, <em>vrr</em>, <em>vtr</em>, <em>vpr</em>, <em>cvrr</em>, <em>dvrdtr</em>, <em>dvrdpr</em>, <em>dvtdpr</em>, <em>dvpdpr</em>, <em>nthetastart</em>, <em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nonlinear_bcs/v_rigid_boundary" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to set the velocities and their
derivatives at a fixed boundary.
While vt is zero, since we only allow for rotation about the
z-axix, vp= r sin(theta) v_phi = r**2 sin(theta)**2 omega
cvr= r**2 * radial component of (curl v) =
r**2  2 cos(theta) omega</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: no of radial grid point</li>
<li><strong>omega</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: derivatives required ?</li>
<li><strong>vrr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vtr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vpr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvrr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdtr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvrdpr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvtdpr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dvpdpr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: no of theta to start with</li>
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/riterthetablocking_mod/transform_to_grid_space" title="f/riterthetablocking_mod/transform_to_grid_space"><code class="xref f f-func docutils literal"><span class="pre">transform_to_grid_space()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">transform_to_grid_space_shtns()</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Non-linear part of the time stepping (radial loop)</a><ul>
<li><a class="reference internal" href="#f/radialloop"><code class="docutils literal"><span class="pre">radialLoop.f90</span></code></a></li>
<li><a class="reference internal" href="#f/riteration_mod"><code class="docutils literal"><span class="pre">rIteration.f90</span></code></a></li>
<li><a class="reference internal" href="#f/riterthetablocking_mod"><code class="docutils literal"><span class="pre">rIterThetaBlocking.f90</span></code></a></li>
<li><a class="reference internal" href="#f/riterthetablocking_openmp_mod"><code class="docutils literal"><span class="pre">rIterThetaBlocking_OpenMP.f90</span></code></a></li>
<li><a class="reference internal" href="#f/general_arrays_mod"><code class="docutils literal"><span class="pre">get_nl.f90</span></code></a></li>
<li><a class="reference internal" href="#f/nonlinear_lm_mod"><code class="docutils literal"><span class="pre">get_td.f90</span></code></a></li>
<li><a class="reference internal" href="#f/nonlinear_bcs"><code class="docutils literal"><span class="pre">nonlinear_bcs.f90</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="timeAdvLinear.html"
                        title="previous chapter">Linear calculation part of the time stepping (LMLoop)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="legFourierChebAlgebra.html"
                        title="next chapter">Chebyshev polynomials and cosine transforms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/timeAdvNonLinear.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="legFourierChebAlgebra.html" title="Chebyshev polynomials and cosine transforms"
             >next</a> |</li>
        <li class="right" >
          <a href="timeAdvLinear.html" title="Linear calculation part of the time stepping (LMLoop)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.6 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.
    </div>
  </body>
</html>