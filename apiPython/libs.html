
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Spectral tansforms &#8212; Magic 6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Description of the Fortran modules" href="../api.html" />
    <link rel="prev" title="Additional possible analyses" href="misc.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../api.html" title="Description of the Fortran modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="misc.html" title="Additional possible analyses"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../postProc.html" accesskey="U">Data visualisation and post-processing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Spectral tansforms</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-magic.spectralTransforms">
<span id="spectral-tansforms"></span><span id="secpythonlibs"></span><h1>Spectral tansforms<a class="headerlink" href="#module-magic.spectralTransforms" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="magic.spectralTransforms.SpectralTransforms">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">magic.spectralTransforms.</span></span><span class="sig-name descname"><span class="pre">SpectralTransforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">561</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_theta_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/spectralTransforms.html#SpectralTransforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.spectralTransforms.SpectralTransforms" title="Permalink to this definition">¶</a></dt>
<dd><p>This python class is used to compute Legendre and Fourier transforms
from spectral to physical space. It works in two steps: one first needs
to initialize the transform</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">SpectralTransforms</span><span class="p">(</span> <span class="n">l_max</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">lm_max</span><span class="o">=</span><span class="mi">33153</span><span class="p">,</span> <span class="n">n_theta_max</span><span class="o">=</span><span class="mi">384</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Tlm</span><span class="p">[:,</span> <span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># lm_max (Temperature at ir=10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">spec_spat</span><span class="p">(</span><span class="n">Tlm</span><span class="p">)</span> <span class="c1"># T[n_phi_max, n_theta_max]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="magic.spectralTransforms.SpectralTransforms.spat_spec">
<span class="sig-name descname"><span class="pre">spat_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/spectralTransforms.html#SpectralTransforms.spat_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.spectralTransforms.SpectralTransforms.spat_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine computes a transfrom from spatial representation
(n_phi,n_theta) to spectral representation (lm_max). It returns
one complex 1-D array (dimension(n_phi_max))</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagicGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sh</span> <span class="o">=</span> <span class="n">SpectralTransforms</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">l_max</span><span class="p">,</span> <span class="n">gr</span><span class="o">.</span><span class="n">minc</span><span class="p">,</span> <span class="n">gr</span><span class="o">.</span><span class="n">lm_max</span><span class="p">,</span> <span class="n">gr</span><span class="o">.</span><span class="n">n_theta_max</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vr</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">vr</span><span class="p">[:,:,</span><span class="mi">30</span><span class="p">]</span> <span class="c1"># Radius ir=30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vrlm</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">spat_spec</span><span class="p">(</span><span class="n">vr</span><span class="p">)</span> <span class="c1"># vrlm is a complex array (lm_max)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Caculation of the poloidal potential from vr:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wlm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">vrlm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wlm</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">vrlm</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">/</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">ell</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">ell</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">gr</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spheroidal/Toroidal transform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vtlm</span><span class="p">,</span> <span class="n">vplm</span> <span class="o">=</span> <span class="n">spec_spat</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">vtheta</span><span class="p">,</span> <span class="n">gr</span><span class="o">.</span><span class="n">vphi</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input</strong> (<em>numpy.ndarray</em>) – input array in the physical space (n_phi,n_theta)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output array in the spectral space (lm_max)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="magic.spectralTransforms.SpectralTransforms.spec_spat">
<span class="sig-name descname"><span class="pre">spec_spat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/spectralTransforms.html#SpectralTransforms.spec_spat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.spectralTransforms.SpectralTransforms.spec_spat" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine computes a transfrom from spectral to spatial
for all latitudes. It returns either  one or two 2-D arrays
(dimension(n_phi_max,n_theta_max)) depending if only the poloidal
or both the poloidal and the toroidal potentials are given as
input quantities.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wlmr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># lm_max</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vr</span> <span class="o">=</span> <span class="n">spec_spat_equat</span><span class="p">(</span><span class="n">wlmr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># n_phi, n_theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">spec_spat_equat</span><span class="p">(</span><span class="n">dwdrlmr</span><span class="p">,</span> <span class="n">zlmr</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="magic.spectralTransforms.SpectralTransforms.spec_spat_dphi">
<span class="sig-name descname"><span class="pre">spec_spat_dphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/spectralTransforms.html#SpectralTransforms.spec_spat_dphi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.spectralTransforms.SpectralTransforms.spec_spat_dphi" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine computes the phi-derivative and the transform from spectral
to spatrial spaces. It returns a 2-D array of dimension (n_phi,n_theta)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">MagicPotential</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vrlm</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">pol</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">ell</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ell</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">p</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span><span class="n">ir</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">.</span><span class="n">rho0</span><span class="p">[</span><span class="n">ir</span><span class="p">]</span> <span class="c1"># vr at r=ir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvrdp</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">sh</span><span class="o">.</span><span class="n">spec_spat_dphi</span><span class="p">(</span><span class="n">vrlm</span><span class="p">)</span> <span class="c1"># phi-derivative of vr</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>polo</strong> (<em>numpy.ndarray</em>) – the input array(lm_max) in spectral space</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the phi derivative in the physical space (n_phi, n_theta)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="magic.spectralTransforms.SpectralTransforms.spec_spat_dtheta">
<span class="sig-name descname"><span class="pre">spec_spat_dtheta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_axi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/spectralTransforms.html#SpectralTransforms.spec_spat_dtheta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.spectralTransforms.SpectralTransforms.spec_spat_dtheta" title="Permalink to this definition">¶</a></dt>
<dd><p>This routine computes the theta-derivative and the transform from spectral
to spatrial spaces. It returns a 2-D array of dimension (n_phi,n_theta)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">MagicPotential</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vrlm</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">pol</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">ell</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">ell</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">p</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span><span class="n">ir</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">p</span><span class="o">.</span><span class="n">rho0</span><span class="p">[</span><span class="n">ir</span><span class="p">]</span> <span class="c1"># vr at r=ir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvrdt</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">sh</span><span class="o">.</span><span class="n">spec_spat_dtheta</span><span class="p">(</span><span class="n">vrlm</span><span class="p">)</span> <span class="c1"># theta-derivative of vr</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polo</strong> (<em>numpy.ndarray</em>) – the input array(lm_max) in spectral space</p></li>
<li><p><strong>l_axi</strong> (<em>bool</em>) – switch to True, if only the axisymmetric field is needed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the theta derivative in the physical space (n_phi, n_theta)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="magic.spectralTransforms.SpectralTransforms.spec_spat_equat">
<span class="sig-name descname"><span class="pre">spec_spat_equat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/spectralTransforms.html#SpectralTransforms.spec_spat_equat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.spectralTransforms.SpectralTransforms.spec_spat_equat" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine computes a transfrom from spectral to spatial
at the equator. It returns either one or two 1-D arrays
(dimension(n_phi_max)) depending if only the poloidal or both the
poloidal and the toroidal potentials are given as input quantities.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wlmr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># lm_max</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vr</span> <span class="o">=</span> <span class="n">spec_spat_equat</span><span class="p">(</span><span class="n">wlmr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># n_phi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">spec_spat_equat</span><span class="p">(</span><span class="n">dwdrlmr</span><span class="p">,</span> <span class="n">zlmr</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-magic.plotlib">
<span id="plotting-functions"></span><h1>Plotting functions<a class="headerlink" href="#module-magic.plotlib" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="magic.plotlib.cut">
<span class="sig-prename descclassname"><span class="pre">magic.plotlib.</span></span><span class="sig-name descname"><span class="pre">cut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/plotlib.html#cut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.plotlib.cut" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions truncates the values of an input array that are beyond
vmax or below vmin and replace them by vmax and vmin, respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Keep only values between -1e3 and 1e3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datNew</span> <span class="o">=</span> <span class="n">cut</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>numpy.ndarray</em>) – an input array</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum upper bound</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – minimum lower bound</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array where the values &gt;=vmax have been replaced by vmax
and the values &lt;=vmin have been replaced by vmin</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.plotlib.equatContour">
<span class="sig-prename descclassname"><span class="pre">magic.plotlib.</span></span><span class="sig-name descname"><span class="pre">equatContour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seismic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normRad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deminc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/plotlib.html#equatContour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.plotlib.equatContour" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the equatorial cut of a given field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – the input data (an array of size (nphi,nr))</p></li>
<li><p><strong>radius</strong> (<em>numpy.ndarray</em>) – the input radius</p></li>
<li><p><strong>minc</strong> (<em>int</em>) – azimuthal symmetry</p></li>
<li><p><strong>label</strong> (<em>str</em>) – the name of the input physical quantity you want to
display</p></li>
<li><p><strong>normRad</strong> (<em>bool</em>) – when set to True, the contour levels are normalised
radius by radius (default is False)</p></li>
<li><p><strong>levels</strong> (<em>int</em>) – the number of levels in the contour</p></li>
<li><p><strong>cm</strong> (<em>str</em>) – name of the colormap (‘jet’, ‘seismic’, ‘RdYlBu_r’, etc.)</p></li>
<li><p><strong>tit</strong> (<em>bool</em>) – display the title of the figure when set to True</p></li>
<li><p><strong>cbar</strong> (<em>bool</em>) – display the colorbar when set to True</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum value of the contour levels</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – minimum value of the contour levels</p></li>
<li><p><strong>normed</strong> (<em>bool</em>) – when set to True, the colormap is centered around zero.
Default is True, except for entropy/temperature plots.</p></li>
<li><p><strong>deminc</strong> (<em>bool</em>) – a logical to indicate if one wants do get rid of the
possible azimuthal symmetry</p></li>
<li><p><strong>bounds</strong> (<em>bool</em>) – a boolean to determine if one wants to plot the limits
of the domain (True by default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.plotlib.hammer2cart">
<span class="sig-prename descclassname"><span class="pre">magic.plotlib.</span></span><span class="sig-name descname"><span class="pre">hammer2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ttheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pphi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/plotlib.html#hammer2cart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.plotlib.hammer2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is used to define the Hammer projection used when
plotting surface contours in <a class="reference internal" href="graphMovCoeff.html#magic.Surf" title="magic.Surf"><code class="xref py py-class docutils literal notranslate"><span class="pre">magic.Surf</span></code></a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load Graphic file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagicGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Meshgrid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pphi</span><span class="p">,</span> <span class="n">ttheta</span> <span class="o">=</span> <span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="n">gr</span><span class="o">.</span><span class="n">nphi</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">:</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">:</span><span class="n">gr</span><span class="o">.</span><span class="n">ntheta</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">hammer2cart</span><span class="p">(</span><span class="n">ttheta</span><span class="p">,</span> <span class="n">pphi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Contour plots</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">gr</span><span class="o">.</span><span class="n">vphi</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ttheta</strong> (<em>numpy.ndarray</em>) – meshgrid [nphi, ntheta] for the latitudinal direction</p></li>
<li><p><strong>pphi</strong> – meshgrid [nphi, ntheta] for the azimuthal direction</p></li>
<li><p><strong>colat</strong> (<em>numpy.ndarray</em>) – colatitudes (when not specified a regular grid is assumed)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple that contains two [nphi, ntheta] arrays: the x, y meshgrid
used in contour plots</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.ndarray, numpy.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.plotlib.merContour">
<span class="sig-prename descclassname"><span class="pre">magic.plotlib.</span></span><span class="sig-name descname"><span class="pre">merContour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seismic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/plotlib.html#merContour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.plotlib.merContour" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a meridional cut of a given field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – the input data (an array of size (ntheta,nr))</p></li>
<li><p><strong>radius</strong> (<em>numpy.ndarray</em>) – the input radius</p></li>
<li><p><strong>label</strong> (<em>str</em>) – the name of the input physical quantity you want to
display</p></li>
<li><p><strong>levels</strong> (<em>int</em>) – the number of levels in the contour</p></li>
<li><p><strong>cm</strong> (<em>str</em>) – name of the colormap (‘jet’, ‘seismic’, ‘RdYlBu_r’, etc.)</p></li>
<li><p><strong>tit</strong> (<em>bool</em>) – display the title of the figure when set to True</p></li>
<li><p><strong>cbar</strong> (<em>bool</em>) – display the colorbar when set to True</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum value of the contour levels</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – minimum value of the contour levels</p></li>
<li><p><strong>normed</strong> (<em>bool</em>) – when set to True, the colormap is centered around zero.
Default is True, except for entropy/temperature plots.</p></li>
<li><p><strong>bounds</strong> (<em>bool</em>) – a boolean to determine if one wants to plot the limits
of the domain (True by default)</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – a pre-existing figure (if needed)</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes._subplots.AxesSubplot</em>) – a pre-existing axis</p></li>
<li><p><strong>lines</strong> (<em>bool</em>) – when set to True, over-plot solid lines to highlight
the limits between two adjacent contour levels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.plotlib.radialContour">
<span class="sig-prename descclassname"><span class="pre">magic.plotlib.</span></span><span class="sig-name descname"><span class="pre">radialContour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hammer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">65</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seismic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/plotlib.html#radialContour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.plotlib.radialContour" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the radial cut of a given field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – the input data (an array of size (nphi,ntheta))</p></li>
<li><p><strong>rad</strong> (<em>float</em>) – the value of the selected radius</p></li>
<li><p><strong>label</strong> (<em>str</em>) – the name of the input physical quantity you want to
display</p></li>
<li><p><strong>proj</strong> (<em>str</em>) – the type of projection. Default is Hammer, in case
you want to use ‘ortho’ or ‘moll’, then Basemap is
required.</p></li>
<li><p><strong>levels</strong> (<em>int</em>) – the number of levels in the contour</p></li>
<li><p><strong>cm</strong> (<em>str</em>) – name of the colormap (‘jet’, ‘seismic’, ‘RdYlBu_r’, etc.)</p></li>
<li><p><strong>tit</strong> (<em>bool</em>) – display the title of the figure when set to True</p></li>
<li><p><strong>cbar</strong> (<em>bool</em>) – display the colorbar when set to True</p></li>
<li><p><strong>lines</strong> (<em>bool</em>) – when set to True, over-plot solid lines to highlight
the limits between two adjacent contour levels</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum value of the contour levels</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – minimum value of the contour levels</p></li>
<li><p><strong>normed</strong> (<em>bool</em>) – when set to True, the colormap is centered around zero.
Default is True, except for entropy/temperature plots.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – a pre-existing figure (if needed)</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes._subplots.AxesSubplot</em>) – a pre-existing axis</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-magic.libmagic">
<span id="various-useful-functions"></span><h1>Various useful functions<a class="headerlink" href="#module-magic.libmagic" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.ReadBinaryTimeseries">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">ReadBinaryTimeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endianness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'&gt;'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#ReadBinaryTimeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.ReadBinaryTimeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>This function reads binary timeseries. It is then faster than
the fast_read function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infile</strong> (<em>string</em>) – the file to read</p></li>
<li><p><strong>ncols</strong> (<em>int</em>) – number of columns of the file</p></li>
<li><p><strong>datatype</strong> (<em>string</em>) – ‘f8’ = 64-bit floating-point number
‘f4’ = 32-bit floating-point number</p></li>
<li><p><strong>endianness</strong> (<em>string</em>) – ‘&gt;’ = big-endian ; ‘&lt;’ = small-endian</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array[nlines, ncols] that contains
the data of the binary file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.anelprof">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">anelprof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#anelprof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.anelprof" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions calculates the reference temperature and density profiles
of an anelastic model.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rad</span> <span class="o">=</span> <span class="n">chebgrid</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temp</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">anelprof</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="n">strat</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">polind</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>numpy.ndarray</em>) – the radial gridpoints</p></li>
<li><p><strong>polind</strong> (<em>float</em>) – the polytropic index</p></li>
<li><p><strong>strat</strong> (<em>float</em>) – the number of the density scale heights between the inner
and the outer boundary</p></li>
<li><p><strong>g0</strong> (<em>float</em>) – gravity profile: g=g0</p></li>
<li><p><strong>g1</strong> (<em>float</em>) – gravity profile: g=g1*r/r_o</p></li>
<li><p><strong>g2</strong> (<em>float</em>) – gravity profile: g=g2*(r_o/r)**2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple that contains the temperature profile, the density profile
and the log-derivative of the density profile versus radius</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.ndarray, numpy.ndarray, numpy.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.avgField">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">avgField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#avgField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.avgField" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine computes the time-average (and the std) of a time series</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">MagicTs</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;misc&#39;</span><span class="p">,</span> <span class="n">iplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nuavg</span> <span class="o">=</span> <span class="n">avgField</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">topnuss</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nuavg</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>numpy.ndarray</em>) – time</p></li>
<li><p><strong>field</strong> (<em>numpy.ndarray</em>) – the time series of a given field</p></li>
<li><p><strong>tstart</strong> (<em>float</em>) – the starting time of the averaging</p></li>
<li><p><strong>std</strong> (<em>bool</em>) – when set to True, the standard deviation is also calculated</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the time-averaged quantity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.chebgrid">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">chebgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#chebgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.chebgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>This function defines a Gauss-Lobatto grid from a to b.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_icb</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="p">;</span> <span class="n">r_cmb</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span> <span class="n">n_r_max</span><span class="o">=</span><span class="mi">65</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rr</span> <span class="o">=</span> <span class="n">chebgrid</span><span class="p">(</span><span class="n">n_r_max</span><span class="p">,</span> <span class="n">r_icb</span><span class="p">,</span> <span class="n">r_cmb</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> (<em>int</em>) – number of radial grid points plus one (Nr+1)</p></li>
<li><p><strong>a</strong> (<em>float</em>) – lower limit of the Gauss-Lobatto grid</p></li>
<li><p><strong>b</strong> (<em>float</em>) – upper limit of the Gauss-Lobatto grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the Gauss-Lobatto grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.cylSder">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">cylSder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#cylSder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.cylSder" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the s derivative of an input array defined on
a regularly-spaced cylindrical grid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">129</span> <span class="p">;</span> <span class="n">dat</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ddatds</span> <span class="o">=</span> <span class="n">cylSder</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>numpy.ndarray</em>) – cylindrical radius</p></li>
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input data</p></li>
<li><p><strong>order</strong> (<em>int</em>) – order of the finite-difference scheme (possible values are 2 or 4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>s derivative</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.cylZder">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">cylZder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#cylZder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.cylZder" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the z derivative of an input array defined on
a regularly-spaced cylindrical grid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">129</span> <span class="p">;</span> <span class="n">dat</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ddatdz</span> <span class="o">=</span> <span class="n">cylZder</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>numpy.ndarray</em>) – height of the cylinder</p></li>
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>z derivative</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.fast_read">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">fast_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skiplines=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#fast_read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.fast_read" title="Permalink to this definition">¶</a></dt>
<dd><p>This function reads an input ascii table
(can read both formatted or unformatted fortran)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read &#39;e_kin.test&#39;, skip the first 10 lines</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">fast_read</span><span class="p">(</span><span class="s1">&#39;e_kin.test&#39;</span><span class="p">,</span> <span class="n">skiplines</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – name of the input file</p></li>
<li><p><strong>skiplines</strong> (<em>int</em>) – number of header lines to be skept during reading</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – when set to True, try to read an unformatted binray Fortran
file (default is False)</p></li>
<li><p><strong>precision</strong> (<em>str</em>) – single (np.float32) or double precision (np.float64)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array[nlines, ncols] that contains the data of the ascii file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.fd_grid">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">fd_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fd_stretching</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fd_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#fd_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.fd_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>This function defines a stretched grid between a and b</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_icb</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="p">;</span> <span class="n">r_cmb</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span> <span class="n">n_r_max</span><span class="o">=</span><span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rr</span> <span class="o">=</span> <span class="n">fd_grid</span><span class="p">(</span><span class="n">n_r_max</span><span class="p">,</span> <span class="n">r_cmb</span><span class="p">,</span> <span class="n">r_icb</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> (<em>int</em>) – number of radial grid points</p></li>
<li><p><strong>a</strong> (<em>float</em>) – upper boundary of the grid</p></li>
<li><p><strong>b</strong> (<em>float</em>) – lower boundary of the grid</p></li>
<li><p><strong>fd_stretching</strong> (<em>float</em>) – fraction of points in the bulk</p></li>
<li><p><strong>fd_ratio</strong> (<em>float</em>) – ratio of minimum to maximum spacing</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the radial grid</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the radial grid</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.getCpuTime">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">getCpuTime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#getCpuTime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.getCpuTime" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates the CPU time from one given log file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>file</em>) – the log file you want to analyze</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the total CPU time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.getTotalRunTime">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">getTotalRunTime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#getTotalRunTime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.getTotalRunTime" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates the total CPU time of one run directory</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the total RUN time</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.intcheb">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">intcheb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#intcheb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.intcheb" title="Permalink to this definition">¶</a></dt>
<dd><p>This function integrates an input function f defined on the Gauss-Lobatto grid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">intcheb</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – an input array</p></li>
<li><p><strong>nr</strong> (<em>int</em>) – number of radial grid points</p></li>
<li><p><strong>z1</strong> (<em>float</em>) – lower limit of the Gauss-Lobatto grid</p></li>
<li><p><strong>z2</strong> (<em>float</em>) – upper limit of the Gauss-Lobatto grid</p></li>
</ul>
</dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the integrated quantity</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.matder">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">matder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#matder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.matder" title="Permalink to this definition">¶</a></dt>
<dd><p>This function calculates the derivative in Chebyshev space.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_icb</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="p">;</span> <span class="n">r_cmb</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span> <span class="n">n_r_max</span><span class="o">=</span><span class="mi">65</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d1</span> <span class="o">=</span> <span class="n">matder</span><span class="p">(</span><span class="n">n_r_max</span><span class="p">,</span> <span class="n">r_icb</span><span class="p">,</span> <span class="n">r_cmb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Chebyshev grid and data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rr</span> <span class="o">=</span> <span class="n">chebgrid</span><span class="p">(</span><span class="n">n_r_max</span><span class="p">,</span> <span class="n">r_icb</span><span class="p">,</span> <span class="n">r_cmb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">rr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Radial derivative</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nr</strong> (<em>int</em>) – number of radial grid points</p></li>
<li><p><strong>z1</strong> (<em>float</em>) – lower limit of the Gauss-Lobatto grid</p></li>
<li><p><strong>z2</strong> (<em>float</em>) – upper limit of the Gauss-Lobatto grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a matrix of dimension (nr,nr) to calculate the derivatives</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.phideravg">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">phideravg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#phideravg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.phideravg" title="Permalink to this definition">¶</a></dt>
<dd><p>phi-derivative of an input array</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagicGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvphidp</span> <span class="o">=</span> <span class="n">phideravg</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">vphi</span><span class="p">,</span> <span class="n">minc</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">minc</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input array</p></li>
<li><p><strong>minc</strong> (<em>int</em>) – azimuthal symmetry</p></li>
<li><p><strong>order</strong> (<em>int</em>) – order of the finite-difference scheme (possible values are 2 or 4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the phi-derivative of the input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.prime_factors">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">prime_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#prime_factors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.prime_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns all prime factors of a number</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>all prime factors</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.progressbar">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">progressbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">it</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#progressbar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.progressbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Fancy progress-bar for loops</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">progressbar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">i</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<em>str</em>) – prefix string before progress bar</p></li>
<li><p><strong>size</strong> (<em>int</em>) – width of the progress bar (in points of xterm width)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.rderavg">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">rderavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#rderavg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.rderavg" title="Permalink to this definition">¶</a></dt>
<dd><p>Radial derivative of an input array</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagiGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvrdr</span> <span class="o">=</span> <span class="n">rderavg</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">vr</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">radratio</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input array</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – aspect ratio of the spherical shell</p></li>
<li><p><strong>spectral</strong> (<em>bool</em>) – when set to True use Chebyshev derivatives, otherwise use
finite differences (default is True)</p></li>
<li><p><strong>exclude</strong> (<em>bool</em>) – when set to True, exclude the first and last radial grid points
and replace them by a spline extrapolation (default is False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the radial derivative of the input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.scanDir">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">scanDir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#scanDir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.scanDir" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sorts the files which match a given input pattern from the oldest
to the most recent one (in the current working directory)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span> <span class="o">=</span> <span class="n">scanDir</span><span class="p">(</span><span class="s1">&#39;log.*&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> (<em>str</em>) – a classical regexp pattern</p></li>
<li><p><strong>tfix</strong> (<em>float</em>) – in case you want to add only the files that are more recent than
a certain date, use tfix (computer 1970 format!!)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of files that match the input pattern</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.sderavg">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">sderavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#sderavg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.sderavg" title="Permalink to this definition">¶</a></dt>
<dd><p>s derivative of an input array</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagiGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvpds</span> <span class="o">=</span> <span class="n">sderavg</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">vphi</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">radratio</span><span class="p">,</span> <span class="n">colat</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">colatitude</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input array</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – aspect ratio of the spherical shell</p></li>
<li><p><strong>spectral</strong> (<em>bool</em>) – when set to True use Chebyshev derivatives, otherwise use
finite differences (default is True)</p></li>
<li><p><strong>exclude</strong> (<em>bool</em>) – when set to True, exclude the first and last radial grid points
and replace them by a spline extrapolation (default is False)</p></li>
<li><p><strong>colat</strong> (<em>numpy.ndarray</em>) – colatitudes (when not specified a regular grid is assumed)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the s derivative of the input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.secondtimeder">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">secondtimeder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#secondtimeder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.secondtimeder" title="Permalink to this definition">¶</a></dt>
<dd><p>second time derivative of an input array</p>
<p>computed with central differences (numpy.gradient)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">MagicTs</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;e_kin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt_ekinpol</span> <span class="o">=</span> <span class="n">secondtimeder</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;ekin_pol&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.selectField">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">selectField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labTex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#selectField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.selectField" title="Permalink to this definition">¶</a></dt>
<dd><p>This function selects for you which field you want to display. It actually
allows to avoid possible variables miss-spelling: i.e. ‘Bphi’=’bp’=’Bp’=’bphi’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference internal" href="graphMovCoeff.html#magic.MagicGraph" title="magic.MagicGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">magic.MagicGraph</span></code></a>) – a graphic output file</p></li>
<li><p><strong>field</strong> (<em>str</em>) – the name of the field one wants to select</p></li>
<li><p><strong>labTex</strong> (<em>bool</em>) – when set to True, format the labels using LaTeX fonts</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple that contains the selected physical field and its label</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.ndarray, str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.symmetrize">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">symmetrize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reversed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#symmetrize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.symmetrize" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrise an array which is defined only with an azimuthal symmetry minc=ms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – the input array</p></li>
<li><p><strong>ms</strong> (<em>int</em>) – the azimuthal symmetry</p></li>
<li><p><strong>reversed</strong> (<em>bool</em>) – set to True, in case the array is reversed (i.e. n_phi is the last column)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an output array of dimension (data.shape[0]*ms+1)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.thetaderavg">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">thetaderavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#thetaderavg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.thetaderavg" title="Permalink to this definition">¶</a></dt>
<dd><p>Theta-derivative of an input array (finite differences)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagiGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvtdt</span> <span class="o">=</span> <span class="n">thetaderavg</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">vtheta</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input array</p></li>
<li><p><strong>order</strong> (<em>int</em>) – order of the finite-difference scheme (possible values are 2 or 4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the theta-derivative of the input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.timeder">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">timeder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#timeder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.timeder" title="Permalink to this definition">¶</a></dt>
<dd><p>time derivative of an input array</p>
<p>computed with central differences (numpy.gradient)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">MagicTs</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;e_kin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt_ekinpol</span> <span class="o">=</span> <span class="n">timeder</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;ekin_pol&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.writeVpEq">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">writeVpEq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tstart</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#writeVpEq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.writeVpEq" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the time-averaged surface zonal flow (and Rolc) and
format the output</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reads all the par.* files from the current directory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">par</span> <span class="o">=</span> <span class="n">MagicTs</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;par&#39;</span><span class="p">,</span> <span class="n">iplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Time-average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">writeVpEq</span><span class="p">(</span><span class="n">par</span><span class="p">,</span> <span class="n">tstart</span><span class="o">=</span><span class="mf">2.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par</strong> (<a class="reference internal" href="timeSeries.html#magic.MagicTs" title="magic.MagicTs"><code class="xref py py-class docutils literal notranslate"><span class="pre">magic.MagicTs</span></code></a>) – a <a class="reference internal" href="timeSeries.html#magic.MagicTs" title="magic.MagicTs"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicTs</span></code></a> object containing the par file</p></li>
<li><p><strong>tstart</strong> (<em>float</em>) – the starting time of the averaging</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a formatted string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="magic.libmagic.zderavg">
<span class="sig-prename descclassname"><span class="pre">magic.libmagic.</span></span><span class="sig-name descname"><span class="pre">zderavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/magic/libmagic.html#zderavg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#magic.libmagic.zderavg" title="Permalink to this definition">¶</a></dt>
<dd><p>z derivative of an input array</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gr</span> <span class="o">=</span> <span class="n">MagiGraph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvrdz</span> <span class="o">=</span> <span class="n">zderavg</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">vr</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">radratio</span><span class="p">,</span> <span class="n">colat</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">colatitude</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – input array</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – aspect ratio of the spherical shell</p></li>
<li><p><strong>spectral</strong> (<em>bool</em>) – when set to True use Chebyshev derivatives, otherwise use
finite differences (default is True)</p></li>
<li><p><strong>exclude</strong> (<em>bool</em>) – when set to True, exclude the first and last radial grid points
and replace them by a spline extrapolation (default is False)</p></li>
<li><p><strong>colat</strong> (<em>numpy.ndarray</em>) – colatitudes (when not specified a regular grid is assumed)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the z derivative of the input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Spectral tansforms</a></li>
<li><a class="reference internal" href="#module-magic.plotlib">Plotting functions</a></li>
<li><a class="reference internal" href="#module-magic.libmagic">Various useful functions</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="misc.html"
                          title="previous chapter">Additional possible analyses</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../api.html"
                          title="next chapter">Description of the Fortran modules</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiPython/libs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../api.html" title="Description of the Fortran modules"
             >next</a> |</li>
        <li class="right" >
          <a href="misc.html" title="Additional possible analyses"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../postProc.html" >Data visualisation and post-processing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Spectral tansforms</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>