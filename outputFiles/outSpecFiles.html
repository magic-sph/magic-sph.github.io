
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Spectra &#8212; Magic 6.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/magic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Magic 6.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Graphic files G_#.TAG and G_ave.TAG" href="outGraph.html" />
    <link rel="prev" title="Transport properties of the reference state" href="outTransportProp.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="galleria/galleria-1.4.2.min.js"></script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../numerics.html">Numerical methods</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="outGraph.html" title="Graphic files G_#.TAG and G_ave.TAG"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="outTransportProp.html" title="Transport properties of the reference state"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="outFiles.html" accesskey="U">Output files</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Spectra</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="spectra">
<span id="secspecfiles"></span><h1>Spectra<a class="headerlink" href="#spectra" title="Permalink to this heading">¶</a></h1>
<section id="kin-spec-tag">
<span id="seckinspecfile"></span><h2><code class="docutils literal notranslate"><span class="pre">kin_spec_#.TAG</span></code><a class="headerlink" href="#kin-spec-tag" title="Permalink to this heading">¶</a></h2>
<p>This file contains the kinetic energy spectra. This file is written by the
subroutine <a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree / order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Poloidal kinetic energy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Poloidal kinetic energy versus order</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Toroidal kinetic energy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Toroidal kinetic energy versus order</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This file can be read using <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum" title="magic.MagicSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;ekin&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mag-spec-tag">
<span id="secmagspecfile"></span><h2><code class="docutils literal notranslate"><span class="pre">mag_spec_#.TAG</span></code><a class="headerlink" href="#mag-spec-tag" title="Permalink to this heading">¶</a></h2>
<p>This file contains the magnetic energy spectra. This file is written by the
subroutine <a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree / order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Poloidal magnetic energy in the outer core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Poloidal magnetic energy in the outer core versus order</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Toroidal magnetic energy in the outer core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Toroidal magnetic energy in the outer core versus order</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Poloidal magnetic energy in the inner core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Poloidal magnetic energy in the inner core versus order</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Toroidal magnetic energy in the inner core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Toroidal magnetic energy in the inner core versus order</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Poloidal magnetic energy at the CMB versus degree</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>Poloidal magnetic energy at the CMB versus order</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Poloidal magnetic energy at the CMB</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This file can be read using <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum" title="magic.MagicSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;emag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="u2-spec-tag">
<span id="secu2specfile"></span><h2><code class="docutils literal notranslate"><span class="pre">u2_spec_#.TAG</span></code><a class="headerlink" href="#u2-spec-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is <strong>only</strong> written in anelastic models, i.e. either when
<a class="reference internal" href="../inputNamelists/physNamelist.html#varstrat"><span class="std std-ref">strat/=0</span></a> or when <a class="reference internal" href="../inputNamelists/physNamelist.html#varinterior-model"><span class="std std-ref">interior_model/=”None”</span></a></p>
</div>
<p>This file contains the spectra of the square velocity. This file is written by the
subroutine <a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree / order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Poloidal contribution per degree in the outer core</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Poloidal contribution per order in the outer core</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Toroidal contribution per degree in the outer core</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Toroidal contribution per order in the outer core</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This file can be read using <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum" title="magic.MagicSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># To read the file ``u2_spec_1.test``:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;u2&#39;</span><span class="p">,</span> <span class="n">ispec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="t-spec-tag">
<span id="sectspecfile"></span><h2><code class="docutils literal notranslate"><span class="pre">T_spec_#.TAG</span></code><a class="headerlink" href="#t-spec-tag" title="Permalink to this heading">¶</a></h2>
<p>This file contains the temperature/entropy spectra. It is written by the subroutine
<a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum_temp" title="f/spectra/spectrum_temp"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum_temp</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree / order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>RMS temperature/entropy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>RMS temperature/entropy versus order</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>RMS temperature/entropy at the ICB versus degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>RMS temperature/entropy at the ICB versus order</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>RMS radial derivative of temperature/entropy at the ICB
versus degree</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>RMS radial derivative of temperature/entropy at the ICB
versus order</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="d-spectra-2d-kin-mag-spec-tag-and-2d-kin-mag-spec-ave-tag">
<span id="sec2dspectra"></span><h2>2D spectra <code class="docutils literal notranslate"><span class="pre">2D_[kin|mag]_spec_#.TAG</span></code> and <code class="docutils literal notranslate"><span class="pre">2D_[kin|mag]_spec_ave.TAG</span></code><a class="headerlink" href="#d-spectra-2d-kin-mag-spec-tag-and-2d-kin-mag-spec-ave-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Those files are <strong>only</strong> written when <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlStd.html#varl-2d-spectra"><span class="std std-ref">l_2D_spectra=.true.</span></a>. The time-averaged files also require that <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlStd.html#varl-spec-avg"><span class="std std-ref">l_spec_avg=.true.</span></a>.</p>
</div>
<p>Those files contain 2-D spectra in the <span class="math notranslate nohighlight">\((r,\ell)\)</span> and in the
<span class="math notranslate nohighlight">\((r,m)\)</span> planes.  In other words, the poloidal and toroidal energies
versus degree <span class="math notranslate nohighlight">\(\ell\)</span> or versus order <span class="math notranslate nohighlight">\(m\)</span> are computed for all
radii. There are two kinds of those files that correspond to the
aforementioned spectra, namely <strong>2D_kin_spec_#.TAG</strong>, <strong>2D_mag_spec_#.TAG</strong>.
In case time-averages are requested, <strong>2D_kin_spec_ave.TAG</strong> and
<strong>2D_mag_spec_ave.TAG</strong> will also be stored. The calculations are done
in the subroutine
<a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum</span></code></a>. The structure of the output files
are same for these three outputs. They are stored as fortran unformatted files.</p>
<p>Unformatted files are not directly human readable, and are used to store binary
data and move it around without changing the internal representation. In
fortran, the open, read and write operations for these files are performed as follows:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">open</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">)</span><span class="w"></span>
<span class="k">read</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">readVar</span><span class="w"></span>
<span class="k">write</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">n_out</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">ios</span><span class="p">)</span><span class="w"> </span><span class="n">writeVar</span><span class="w"> </span><span class="c">!Unformatted write</span>
</pre></div>
</div>
<p>The structure of the 2D spectra files are as follows:</p>
<blockquote>
<div><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!-------------</span>
<span class="c">! Line 1</span>
<span class="c">!-------------</span>

<span class="nb">time</span><span class="p">,</span><span class="w"> </span><span class="n">n_r_max</span><span class="p">,</span><span class="w"> </span><span class="n">l_max</span><span class="p">,</span><span class="w"> </span><span class="n">minc</span><span class="w"> </span><span class="c">! Time, resolution, max(\ell), azimuthal symmetry</span>

<span class="c">!-------------</span>
<span class="c">! Line 2</span>
<span class="c">!-------------</span>

<span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">n_r_max</span><span class="p">)</span><span class="w">                  </span><span class="c">! Radius</span>

<span class="c">!-------------</span>
<span class="c">! Line 3</span>
<span class="c">!-------------</span>

<span class="n">e_p_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w">      </span><span class="c">! Poloidal energy</span>
<span class="p">...</span><span class="w">                                                             </span><span class="c">! versus degree</span>
<span class="n">e_p_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w"></span>

<span class="c">!-------------</span>
<span class="c">! Line 4</span>
<span class="c">!-------------</span>

<span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w">      </span><span class="c">! Poloidal energy</span>
<span class="p">...</span><span class="w">                                                             </span><span class="c">! versus order</span>
<span class="n">e_p_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_p_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w"></span>

<span class="c">!-------------</span>
<span class="c">! Line 3</span>
<span class="c">!-------------</span>

<span class="n">e_t_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w">      </span><span class="c">! Toroidal energy</span>
<span class="p">...</span><span class="w">                                                             </span><span class="c">! versus degree</span>
<span class="n">e_t_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w"></span>

<span class="c">!-------------</span>
<span class="c">! Line 4</span>
<span class="c">!-------------</span>

<span class="n">e_t_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w">      </span><span class="c">! Toroidal energy</span>
<span class="p">...</span><span class="w">                                                             </span><span class="c">! versus order</span>
<span class="n">e_t_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_t_l</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
<p>Those files can be read using the python class <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum2D" title="magic.MagicSpectrum2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum2D</span></code></a> with
the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read the file 2D_mag_spec_3.ext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum2D</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;ext&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;e_mag&#39;</span><span class="p">,</span> <span class="n">ispec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print e_pol_l and e_tor_m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">e_pol_l</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">e_tor_m</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="kin-spec-ave-tag">
<span id="seckinspecavefile"></span><h2><code class="docutils literal notranslate"><span class="pre">kin_spec_ave.TAG</span></code><a class="headerlink" href="#kin-spec-ave-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is <strong>only</strong> written when <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlStd.html#varl-spec-avg"><span class="std std-ref">l_spec_avg=.true.</span></a></p>
</div>
<p>This file contains the time-average kinetic energy spectra as well as squared quantities
to allow a possible further reconstruction of the standard deviation.
This file is written by the subroutine <a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree / order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Time-averaged poloidal kinetic energy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Time-averaged poloidal kinetic energy versus order</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Time-averaged toroidal kinetic energy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Time-averaged toroidal kinetic energy versus order</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Standard deviation of poloidal kinetic energy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Standard deviation of poloidal kinetic energy versus order</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Standard deviation of toroidal kinetic energy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Standard deviation of toroidal kinetic energy versus order</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This file can be read using <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum" title="magic.MagicSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># To read the file ``kin_spec_ave.test``:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;kin&#39;</span><span class="p">,</span> <span class="n">ave</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mag-spec-ave-tag">
<span id="secmagspecavefile"></span><h2><code class="docutils literal notranslate"><span class="pre">mag_spec_ave.TAG</span></code><a class="headerlink" href="#mag-spec-ave-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is <strong>only</strong> written when <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlStd.html#varl-spec-avg"><span class="std std-ref">l_spec_avg=.true.</span></a> and
the run is magnetic</p>
</div>
<p>This file contains the time-average magnetic energy spectra. This file is written by the
subroutine <a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/spectrum" title="f/spectra/spectrum"><code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree / order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Time-averaged poloidal magnetic energy in the outer core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Time-averaged poloidal magnetic energy in the outer core versus order</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Time-averaged toroidal magnetic energy in the outer core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Time-averaged toroidal magnetic energy in the outer core versus order</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Time-averaged poloidal magnetic energy at the CMB versus degree</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Time-averaged poloidal magnetic energy at the CMB versus order</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Standard deviation of the poloidal magnetic energy in the outer
core versus degree</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Standard deviation of the poloidal magnetic energy in the outer core
versus order</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Standard deviation of the toroidal magnetic energy in the outer core
versus degree</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>Standard deviation of the toroidal magnetic energy in the outer core
versus order</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Standard deviation of the magnetic energy at the CMB
versus degree</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Standard deviation of the magnetic energy at the CMB
versus order</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This file can be read using <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum" title="magic.MagicSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># To read the file ``mag_spec_ave.test``:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;mag&#39;</span><span class="p">,</span> <span class="n">ave</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="t-spec-ave-tag">
<span id="sectempspecavefile"></span><h2><code class="docutils literal notranslate"><span class="pre">T_spec_ave.TAG</span></code><a class="headerlink" href="#t-spec-ave-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is <strong>only</strong> written when <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlStd.html#varl-spec-avg"><span class="std std-ref">l_spec_avg=.true.</span></a></p>
</div>
<p>This file contains the time-averaged temperature/entropy spectra and their standard
deviation. It is written by the subroutine <code class="xref f f-subr docutils literal notranslate"><span class="pre">spectrum_temp_average</span></code>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Spherical harmonic degree/order</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Time-averaged RMS temperature/entropy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Time-averaged RMS temperature/entropy versus order</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Time-averaged RMS temperature/entropy at the ICB versus
degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Time-averaged RMS temperature/entropy at the ICB versus
order</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Time-averaged temperature/entropy gradient at the ICB
versus degree</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Time-averaged temperature/entropy gradient at the ICB
versus order</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Standard deviation of the temperature/entropy versus
degree</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Standard deviation of the temperature/entropy versus
order</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Standard deviation of the temperature/entropy at the ICB
versus degree</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>Standard deviation of the temperature/entropy at the ICB
versus order</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Standard deviation of the temperature/entropy gradient
at the ICB  versus degree</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Standard deviation of the temperature/entropy gradient
at the ICB  versus order</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="dtvrms-spec-tag">
<span id="secrmsspectra"></span><h2><code class="docutils literal notranslate"><span class="pre">dtVrms_spec.TAG</span></code><a class="headerlink" href="#dtvrms-spec-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This file is <strong>only</strong> written when <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlMisc.html#varl-rms"><span class="std std-ref">l_RMS=.true.</span></a></p>
</div>
<p>This file contains the time-averaged force balance spectra as well as their standard deviation.
The calculations are done in the subroutine <a class="reference internal" href="../apiFortran/IOAdd.html#f/rms/dtvrms" title="f/rms/dtvrms"><code class="xref f f-subr docutils literal notranslate"><span class="pre">dtVrms</span></code></a>.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>No. of column</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>degree + 1</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Time-averaged Inertia versus degree</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Time-averaged Coriolis force versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Time-averaged Lorentz force versus degree</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Time-averaged Advection term versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Time-averaged Viscous force versus degree</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Time-averaged thermal Buoyancy versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Time-averaged chemical Buoyancy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Time-averaged Pressure gradient versus degree</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>10             | Time-averaged Pressure/Coriolis balance versus degree</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>Time-averaged Pressure/Coriolis/Lorentz balance versus
degree</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Time-averaged Pressure/Coriolis/Buoyancy balance versus
degree</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Time-averaged Pressure/Coriolis/Lorentz/Buoyancy balance
versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Time-averaged Coriolis/Lorentz balance versus degree</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>Time-averaged Pressure/Lorentz balance versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>Time-averaged Coriolis/Inertia/Buoyancy balance versus
degree</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>Standard deviation of Inertia versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>Standard deviation of Coriolis force versus degree</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>Standard deviation of Lorentz force versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td><p>Standard deviation of Advection term versus degree</p></td>
</tr>
<tr class="row-even"><td><p>21</p></td>
<td><p>Standard deviation of Viscous force versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>22</p></td>
<td><p>Standard deviation of thermal Buoyancy versus degree</p></td>
</tr>
<tr class="row-even"><td><p>23</p></td>
<td><p>Standard deviation of chemical Buoyancy versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>24</p></td>
<td><p>Standard deviation of Pressure gradient versus degree</p></td>
</tr>
<tr class="row-even"><td><p>25</p></td>
<td><p>Standard deviation of Pressure/Coriolis balance versus
degree</p></td>
</tr>
<tr class="row-odd"><td><p>26</p></td>
<td><p>Standard deviation of Pressure/Coriolis/Lorentz balance
versus degree</p></td>
</tr>
<tr class="row-even"><td><p>27</p></td>
<td><p>Standard deviation of Pressure/Coriolis/Buoyancy balance
versus degree</p></td>
</tr>
<tr class="row-odd"><td><p>28</p></td>
<td><p>Standard deviation of Pressure/Coriolis/Lorentz/Buoyancy
balance versus degree</p></td>
</tr>
<tr class="row-even"><td><p>29</p></td>
<td><p>Standard deviation of Coriolis/Lorentz balance versus
degree</p></td>
</tr>
<tr class="row-odd"><td><p>30</p></td>
<td><p>Standard deviation of Pressure/Lorentz balance versus
degree</p></td>
</tr>
<tr class="row-even"><td><p>31</p></td>
<td><p>Standard deviation of Coriolis/Inertia/Buoyancy balance
versus degree</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This file can be read using <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum" title="magic.MagicSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># To read the file ``dtVrms_spec.test``:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;dtVrms&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="d-force-balance-spectra-2d-dtvrms-spec-tag">
<span id="sec2drmsspectra"></span><h2>2D force balance spectra <code class="docutils literal notranslate"><span class="pre">2D_dtVrms_spec.TAG</span></code><a class="headerlink" href="#d-force-balance-spectra-2d-dtvrms-spec-tag" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Those files are <strong>only</strong> written when <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlMisc.html#varl-rms"><span class="std std-ref">l_RMS=.true.</span></a> and <a class="reference internal" href="../inputNamelists/outputNamelist/outputNmlMisc.html#varl-2d-rms"><span class="std std-ref">l_2D_RMS=.true.</span></a>.</p>
</div>
<p>Those files contain 2-D force balance spectra in the <span class="math notranslate nohighlight">\((r,\ell)\)</span> plane.
The calculations are done in the subroutine <a class="reference internal" href="../apiFortran/IOAdd.html#f/rms/dtvrms" title="f/rms/dtvrms"><code class="xref f f-subr docutils literal notranslate"><span class="pre">dtVrms</span></code></a>.
The output file is stored as a Fortran unformatted file.</p>
<p>The structure of the 2D force balance spectra files are as follows:</p>
<blockquote>
<div><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!------------</span>
<span class="c">! Line 1</span>
<span class="c">!------------</span>

<span class="n">version</span><span class="w"></span>

<span class="c">!-------------</span>
<span class="c">! Line 2</span>
<span class="c">!-------------</span>

<span class="n">n_r_max</span><span class="p">,</span><span class="w"> </span><span class="n">l_max</span><span class="w"> </span><span class="c">! radial resolution, max(\ell)</span>

<span class="c">!-------------</span>
<span class="c">! Line 3</span>
<span class="c">!-------------</span>

<span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">r</span><span class="p">(</span><span class="n">n_r_max</span><span class="p">)</span><span class="w">                  </span><span class="c">! Radius</span>

<span class="c">!-------------</span>
<span class="c">! Line 4</span>
<span class="c">!-------------</span>

<span class="n">Cor_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Cor_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">Cor_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w">      </span><span class="c">! Coriolis force</span>
<span class="p">...</span><span class="w">                                                             </span><span class="c">! versus degree</span>
<span class="n">Cor_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">Cor_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">Cor_l</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">l_max</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">n_r_max</span><span class="p">),</span><span class="w"></span>

<span class="c">!-------------</span>
<span class="c">! Line 5</span>
<span class="c">!-------------</span>

<span class="n">Adv_l</span><span class="w"> </span><span class="c">! Advection</span>

<span class="c">!-------------</span>
<span class="c">! Line 6</span>
<span class="c">!-------------</span>

<span class="n">LF_l</span><span class="w"> </span><span class="c">! Lorentz force</span>

<span class="c">!-------------</span>
<span class="c">! Line 7</span>
<span class="c">!-------------</span>

<span class="n">Buo_temp_l</span><span class="w"> </span><span class="c">! Thermal buoyancy</span>

<span class="c">!------------</span>
<span class="c">! Line 8</span>
<span class="c">!------------</span>

<span class="n">Buo_xi_l</span><span class="w"> </span><span class="c">! Chemical buoyancy</span>

<span class="c">!-------------</span>
<span class="c">! Line 9</span>
<span class="c">!-------------</span>

<span class="n">Pre_l</span><span class="w"> </span><span class="c">! Pressure</span>

<span class="c">!-------------</span>
<span class="c">! Line 10</span>
<span class="c">!-------------</span>

<span class="n">Dif_l</span><span class="w"> </span><span class="c">! Viscosity</span>

<span class="c">!-------------</span>
<span class="c">! Line 11</span>
<span class="c">!-------------</span>

<span class="n">Iner_l</span><span class="w"> </span><span class="c">! Inertia</span>

<span class="c">!-------------</span>
<span class="c">! Line 12</span>
<span class="c">!-------------</span>

<span class="n">Geo_l</span><span class="w"> </span><span class="c">! Sum of force terms: geostrophic balance</span>

<span class="c">!-------------</span>
<span class="c">! Line 13</span>
<span class="c">!-------------</span>

<span class="n">Mag_l</span><span class="w"> </span><span class="c">! Sum of force terms: pressure, Coriolis and Lorentz</span>

<span class="c">!-------------</span>
<span class="c">! Line 14</span>
<span class="c">!-------------</span>

<span class="n">Arc_l</span><span class="w"> </span><span class="c">! Sum of force terms: pressure, buoyancy and Coriolis</span>

<span class="c">!-------------</span>
<span class="c">! Line 15</span>
<span class="c">!-------------</span>

<span class="n">ArcMag_l</span><span class="w"> </span><span class="c">! Sum of force terms: pressure, buoyancy, Coriolis and Lorentz</span>

<span class="c">!-------------</span>
<span class="c">! Line 16</span>
<span class="c">!-------------</span>

<span class="n">CIA_l</span><span class="w"> </span><span class="c">! Sum of force terms Coriolis/Inertia/Archimedean</span>

<span class="c">!-------------</span>
<span class="c">! Line 17</span>
<span class="c">!-------------</span>

<span class="n">CLF_l</span><span class="w"> </span><span class="c">! Sum of force terms Coriolis/Lorentz</span>

<span class="c">!-------------</span>
<span class="c">! Line 18</span>
<span class="c">!-------------</span>

<span class="n">PLF_l</span><span class="w"> </span><span class="c">! Sum of force terms Pression/Lorentz</span>
</pre></div>
</div>
</div></blockquote>
<p>Those files can be read using the python class <a class="reference internal" href="../apiPython/spectra.html#magic.MagicSpectrum2D" title="magic.MagicSpectrum2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicSpectrum2D</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read the file 2D_dtVrms_spec.ext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">MagicSpectrum2D</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="s1">&#39;ext&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s1">&#39;dtVrms&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print Cor_l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">Cor_l</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="d-spectra-am-kin-mag-pol-tor-tag">
<span id="sectimespectrafiles"></span><h2>2D spectra <cite>am_[kin|mag]_[pol|tor].TAG</cite><a class="headerlink" href="#d-spectra-am-kin-mag-pol-tor-tag" title="Permalink to this heading">¶</a></h2>
<p>Those files contain the time evolution of the poloidal and toroidal kinetic and
magnetic spectra for a given range of spherical harmonic orders <span class="math notranslate nohighlight">\(m\)</span>.
There are four kinds of those files that correspond to the aforementioned
spectra, namely <strong>am_kin_pol.TAG</strong>, <strong>am_kin_tor.TAG</strong>, <strong>am_mag_pol.TAG</strong> and
<strong>am_mag_tor.TAG</strong>. The calculations are done in the subroutine
<a class="reference internal" href="../apiFortran/IOGeneral.html#f/spectra/get_amplitude" title="f/spectra/get_amplitude"><code class="xref f f-subr docutils literal notranslate"><span class="pre">get_amplitude</span></code></a>. The structure of the output
files is the same for the four outputs (fortran unformatted
files):</p>
<blockquote>
<div><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!-------------</span>
<span class="c">! Line 1</span>
<span class="c">!-------------</span>

<span class="nb">time</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m_max_modes</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="p">...</span><span class="w"></span>

<span class="c">!-------------</span>
<span class="c">! Line N</span>
<span class="c">!-------------</span>

<span class="nb">time</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">N</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">N</span><span class="p">),</span><span class="w"> </span><span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">N</span><span class="p">),</span><span class="w"> </span><span class="p">...,</span><span class="w"> </span><span class="n">e_p_m</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m_max_modes</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">N</span><span class="p">)</span><span class="w"></span>

<span class="p">...</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
<p>Those files can be read using the python class <a class="reference internal" href="../apiPython/timeSeries.html#magic.MagicTs" title="magic.MagicTs"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagicTs</span></code></a> with the following options:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read the file am_mag_pol.ext</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">MagicTs</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">&#39;am_mag_pol&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;ext&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print the time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print the energy content in m=11 for all times</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[:,</span> <span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Spectra</a><ul>
<li><a class="reference internal" href="#kin-spec-tag"><code class="docutils literal notranslate"><span class="pre">kin_spec_#.TAG</span></code></a></li>
<li><a class="reference internal" href="#mag-spec-tag"><code class="docutils literal notranslate"><span class="pre">mag_spec_#.TAG</span></code></a></li>
<li><a class="reference internal" href="#u2-spec-tag"><code class="docutils literal notranslate"><span class="pre">u2_spec_#.TAG</span></code></a></li>
<li><a class="reference internal" href="#t-spec-tag"><code class="docutils literal notranslate"><span class="pre">T_spec_#.TAG</span></code></a></li>
<li><a class="reference internal" href="#d-spectra-2d-kin-mag-spec-tag-and-2d-kin-mag-spec-ave-tag">2D spectra <code class="docutils literal notranslate"><span class="pre">2D_[kin|mag]_spec_#.TAG</span></code> and <code class="docutils literal notranslate"><span class="pre">2D_[kin|mag]_spec_ave.TAG</span></code></a></li>
<li><a class="reference internal" href="#kin-spec-ave-tag"><code class="docutils literal notranslate"><span class="pre">kin_spec_ave.TAG</span></code></a></li>
<li><a class="reference internal" href="#mag-spec-ave-tag"><code class="docutils literal notranslate"><span class="pre">mag_spec_ave.TAG</span></code></a></li>
<li><a class="reference internal" href="#t-spec-ave-tag"><code class="docutils literal notranslate"><span class="pre">T_spec_ave.TAG</span></code></a></li>
<li><a class="reference internal" href="#dtvrms-spec-tag"><code class="docutils literal notranslate"><span class="pre">dtVrms_spec.TAG</span></code></a></li>
<li><a class="reference internal" href="#d-force-balance-spectra-2d-dtvrms-spec-tag">2D force balance spectra <code class="docutils literal notranslate"><span class="pre">2D_dtVrms_spec.TAG</span></code></a></li>
<li><a class="reference internal" href="#d-spectra-am-kin-mag-pol-tor-tag">2D spectra <cite>am_[kin|mag]_[pol|tor].TAG</cite></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="outTransportProp.html"
                          title="previous chapter">Transport properties of the reference state</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="outGraph.html"
                          title="next chapter">Graphic files <code class="docutils literal notranslate"><span class="pre">G_#.TAG</span></code> and <code class="docutils literal notranslate"><span class="pre">G_ave.TAG</span></code></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/outputFiles/outSpecFiles.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="outGraph.html" title="Graphic files G_#.TAG and G_ave.TAG"
             >next</a> |</li>
        <li class="right" >
          <a href="outTransportProp.html" title="Transport properties of the reference state"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="outFiles.html" >Output files</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Spectra</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
  </body>
</html>